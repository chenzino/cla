<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Claude Code Monitor</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#8b7cf6">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #08080c;
      --bg2: #0c0c12;
      --surface: rgba(255,255,255,0.03);
      --surface-hover: rgba(255,255,255,0.05);
      --surface-solid: #111118;
      --border: rgba(255,255,255,0.06);
      --border-hover: rgba(255,255,255,0.1);
      --text: #ebebf0;
      --text-secondary: #7a7a8e;
      --text-tertiary: #4a4a5e;
      --accent: #8b7cf6;
      --accent-dim: rgba(139,124,246,0.12);
      --accent-glow: rgba(139,124,246,0.25);
      --green: #34d399;
      --green-dim: rgba(52,211,153,0.1);
      --green-glow: rgba(52,211,153,0.25);
      --red: #fb7185;
      --red-dim: rgba(251,113,133,0.1);
      --yellow: #fbbf24;
      --yellow-dim: rgba(251,191,36,0.1);
      --radius: 16px;
      --radius-sm: 10px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ===== AMBIENT BACKGROUND ===== */
    body::before {
      content: '';
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(139,124,246,0.04) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(52,211,153,0.03) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(139,124,246,0.02) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
      animation: ambientShift 20s ease-in-out infinite alternate;
    }

    @keyframes ambientShift {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(-2%, -1%) rotate(1deg); }
    }

    /* ===== AUTH GATE ===== */
    #auth-gate {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 100;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20vh;
      gap: 16px;
      overflow: hidden;
      touch-action: manipulation;
    }
    .auth-logo {
      width: 56px; height: 56px; border-radius: 16px;
      background: linear-gradient(135deg, var(--accent) 0%, #6366f1 100%);
      display: flex; align-items: center; justify-content: center;
      font-size: 24px; font-weight: 700; color: white;
      box-shadow: 0 8px 32px rgba(139,124,246,0.3);
    }
    #auth-gate h1 { font-size: 1.5rem; font-weight: 600; color: var(--text); letter-spacing: -0.02em; margin: 0; }
    #auth-gate .subtitle { color: var(--text-tertiary); font-size: 0.85rem; margin: 0; }
    #auth-gate .auth-input-wrap { width: 90%; max-width: 300px; }
    #auth-gate input {
      display: block; width: 100%; box-sizing: border-box;
      background: var(--surface-solid); border: 1px solid var(--border);
      color: var(--text); padding: 14px 16px;
      font-family: 'Inter', sans-serif; font-size: 16px;
      border-radius: 10px; text-align: center; outline: none;
      letter-spacing: 2px; -webkit-appearance: none; appearance: none;
      touch-action: manipulation;
    }
    #auth-gate input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-dim); }
    #auth-gate input::placeholder { color: var(--text-tertiary); letter-spacing: 1px; }
    .auth-error { color: var(--red); font-size: 0.8rem; height: 20px; font-weight: 500; margin: 0; }
    @keyframes shake { 0%,100%{transform:translateX(0)} 20%{transform:translateX(-10px)} 40%{transform:translateX(10px)} 60%{transform:translateX(-6px)} 80%{transform:translateX(6px)} }
    .shake { animation: shake 0.4s cubic-bezier(0.36,0.07,0.19,0.97); }

    /* ===== DASHBOARD ===== */
    #dashboard {
      display: none;
      padding: 24px 28px;
      max-width: 960px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in { animation: fadeUp 0.5s cubic-bezier(0.4,0,0.2,1) forwards; opacity: 0; }
    .fade-in:nth-child(1) { animation-delay: 0s; }
    .fade-in:nth-child(2) { animation-delay: 0.06s; }
    .fade-in:nth-child(3) { animation-delay: 0.12s; }
    .fade-in:nth-child(4) { animation-delay: 0.18s; }
    .fade-in:nth-child(5) { animation-delay: 0.24s; }

    /* ===== HEADER ===== */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 20px 0 24px;
      margin-bottom: 28px;
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .header-logo {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--accent) 0%, #6366f1 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      font-weight: 700;
      color: white;
      box-shadow: 0 4px 16px rgba(139,124,246,0.25);
      flex-shrink: 0;
    }

    .header-text h1 {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text);
      letter-spacing: -0.01em;
    }

    .header-text span {
      font-size: 0.72rem;
      color: var(--text-tertiary);
      font-weight: 400;
    }

    .header-right {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .conn-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.72rem;
      font-weight: 500;
      padding: 5px 12px;
      border-radius: 20px;
      transition: all 0.3s;
    }

    .conn-badge.ok {
      color: var(--green);
      background: var(--green-dim);
    }

    .conn-badge.err {
      color: var(--red);
      background: var(--red-dim);
    }

    .conn-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      animation: pulse 2.5s ease-in-out infinite;
    }

    .conn-badge.ok .conn-dot { background: var(--green); }
    .conn-badge.err .conn-dot { background: var(--red); }

    .btn {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 6px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.75rem;
      font-weight: 500;
      transition: all 0.2s;
      backdrop-filter: blur(8px);
    }

    .btn:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
    }

    .btn-danger:hover {
      border-color: rgba(251,113,133,0.3);
      color: var(--red);
      background: var(--red-dim);
    }

    /* ===== HEADER NAV ===== */
    .header-nav {
      display: flex;
      gap: 2px;
      align-items: center;
    }

    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      padding: 7px 16px;
      border-radius: 7px;
      font-size: 0.82rem;
      font-weight: 500;
      transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
      letter-spacing: -0.01em;
    }

    .nav-link:hover {
      color: var(--text);
      background: rgba(255,255,255,0.04);
    }

    .nav-link.active {
      background: var(--accent-dim);
      color: var(--accent);
    }

    /* ===== PAGES ===== */
    .page { display: none; opacity: 0; transition: opacity 0.25s ease; }
    .page.active { display: block; opacity: 1; }
    .page.fade-enter { opacity: 0; transform: translateY(8px); }
    .page.fade-active { opacity: 1; transform: translateY(0); transition: opacity 0.3s ease, transform 0.3s ease; }

    /* ===== LIVE CLOCK ===== */
    .header-clock {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.72rem;
      color: var(--text-tertiary);
      letter-spacing: 0.5px;
      text-align: right;
      line-height: 1.4;
    }
    .header-clock .clock-time {
      color: var(--text-secondary);
      font-size: 0.78rem;
      font-weight: 500;
    }

    /* ===== CARDS ===== */
    .cards {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px;
      margin-bottom: 20px;
    }

    @media (max-width: 700px) {
      .cards { grid-template-columns: repeat(2, 1fr); }
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px 22px;
      backdrop-filter: blur(12px);
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06), transparent);
    }

    .card:hover {
      border-color: var(--border-hover);
      background: var(--surface-hover);
      transform: translateY(-1px);
    }
    .card::after {
      content: '';
      position: absolute;
      inset: -1px;
      border-radius: inherit;
      background: conic-gradient(from var(--gradient-angle, 0deg), transparent 60%, rgba(99,102,241,0.3) 80%, transparent 100%);
      z-index: -1;
      opacity: 0;
      transition: opacity 0.4s;
    }
    .card:hover::after {
      opacity: 1;
      animation: rotateGradient 3s linear infinite;
    }
    @keyframes rotateGradient {
      to { --gradient-angle: 360deg; }
    }
    @property --gradient-angle {
      syntax: '<angle>';
      initial-value: 0deg;
      inherits: false;
    }

    .card .label {
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      margin-bottom: 10px;
      font-weight: 500;
    }

    .card .value {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: -0.02em;
      display: flex;
      align-items: center;
    }

    .card .value.active { color: var(--green); }
    .card .value.limited { color: var(--red); }
    .card .value.warning { color: var(--yellow); }
    .card .value.dim { color: var(--text-secondary); font-size: 0.88rem; font-weight: 500; }

    .status-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .status-dot.active {
      background: var(--green);
      box-shadow: 0 0 12px var(--green-glow);
      animation: pulse 2.5s ease-in-out infinite;
    }

    .status-dot.limited {
      background: var(--red);
      box-shadow: 0 0 12px rgba(251,113,133,0.4);
      animation: pulse 1.5s ease-in-out infinite;
    }

    .status-dot.idle {
      background: var(--yellow);
      box-shadow: 0 0 12px rgba(251,191,36,0.3);
      animation: pulse 3s ease-in-out infinite;
    }

    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

    /* ===== SECTIONS ===== */
    .section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 16px;
      overflow: hidden;
      backdrop-filter: blur(12px);
      position: relative;
    }

    .section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }

    .section-header {
      padding: 16px 22px;
      border-bottom: 1px solid var(--border);
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* ===== ACTIVITY NOTE ===== */
    .notes-box {
      padding: 18px 22px;
      color: var(--text-secondary);
      font-size: 0.88rem;
      line-height: 1.6;
      font-weight: 400;
    }

    /* ===== LOG ===== */
    .log-viewer {
      padding: 8px 12px;
      max-height: 420px;
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    .log-entry {
      padding: 10px 12px;
      border-radius: 8px;
      display: flex;
      gap: 12px;
      align-items: flex-start;
      transition: background 0.15s;
      margin: 2px 0;
    }

    .log-entry:hover {
      background: rgba(255,255,255,0.02);
    }

    .log-ts {
      color: var(--text-tertiary);
      white-space: nowrap;
      font-size: 0.72rem;
      font-family: 'JetBrains Mono', monospace;
      padding-top: 2px;
      min-width: 72px;
    }

    .log-type {
      padding: 2px 10px;
      border-radius: 6px;
      font-size: 0.65rem;
      text-transform: uppercase;
      white-space: nowrap;
      flex-shrink: 0;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .log-type.system { background: var(--accent-dim); color: var(--accent); }
    .log-type.output { background: var(--green-dim); color: var(--green); }
    .log-type.error { background: var(--red-dim); color: var(--red); }
    .log-type.user { background: var(--yellow-dim); color: var(--yellow); }
    .log-type.claude { background: var(--accent-dim); color: var(--accent); }

    .log-msg {
      color: var(--text);
      word-break: break-word;
      font-size: 0.84rem;
      line-height: 1.5;
      font-weight: 400;
    }

    /* ===== MESSAGE INPUT ===== */
    .msg-area {
      padding: 18px 22px;
    }

    .msg-area textarea {
      width: 100%;
      background: rgba(255,255,255,0.02);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 14px 16px;
      font-family: 'Inter', sans-serif;
      font-size: 0.88rem;
      border-radius: var(--radius-sm);
      resize: none;
      min-height: 88px;
      outline: none;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      line-height: 1.6;
    }

    .msg-area textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
      background: rgba(255,255,255,0.03);
    }

    .msg-area textarea::placeholder {
      color: var(--text-tertiary);
    }

    .send-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px;
    }

    .send-row .hint {
      font-size: 0.72rem;
      color: var(--text-tertiary);
      font-weight: 400;
    }

    .btn-send {
      background: linear-gradient(135deg, var(--accent), #6366f1);
      border: none;
      color: white;
      padding: 9px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      box-shadow: 0 2px 12px rgba(139,124,246,0.25);
      letter-spacing: 0.01em;
    }

    .btn-send:hover {
      box-shadow: 0 4px 24px rgba(139,124,246,0.4);
      transform: translateY(-1px);
    }

    .btn-send:active {
      transform: translateY(0);
    }

    .btn-send:disabled {
      opacity: 0.35;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* ===== KANBAN BOARD ===== */
    .kanban-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .kanban-toolbar-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      font-weight: 600;
    }

    .btn-add-task {
      background: linear-gradient(135deg, var(--accent), #6366f1);
      border: none;
      color: white;
      padding: 8px 18px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      box-shadow: 0 2px 12px rgba(139,124,246,0.25);
      letter-spacing: 0.01em;
    }

    .btn-add-task:hover {
      box-shadow: 0 4px 24px rgba(139,124,246,0.4);
      transform: translateY(-1px);
    }

    .kanban-add-form {
      display: none;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px 22px;
      margin-bottom: 16px;
      backdrop-filter: blur(12px);
      position: relative;
      overflow: hidden;
    }

    .kanban-add-form.visible {
      display: block;
    }

    .kanban-add-form::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }

    .kanban-form-row {
      margin-bottom: 12px;
    }

    .kanban-form-row:last-child {
      margin-bottom: 0;
    }

    .kanban-form-label {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 500;
      margin-bottom: 6px;
      display: block;
    }

    .kanban-form-input {
      width: 100%;
      background: rgba(255,255,255,0.02);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 10px 14px;
      font-family: 'Inter', sans-serif;
      font-size: 0.88rem;
      border-radius: 8px;
      outline: none;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    }

    .kanban-form-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
      background: rgba(255,255,255,0.03);
    }

    .kanban-form-input::placeholder {
      color: var(--text-tertiary);
    }

    textarea.kanban-form-input {
      resize: none;
      min-height: 60px;
      line-height: 1.5;
    }

    .kanban-form-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 14px;
    }

    .kanban-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
      min-height: 300px;
    }

    @media (max-width: 700px) {
      .kanban-board { grid-template-columns: 1fr; }
    }

    .kanban-column {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(12px);
      position: relative;
      overflow: hidden;
      transition: border-color 0.2s;
    }

    .kanban-column::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }

    .kanban-column.drag-over {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent-dim);
    }

    .kanban-col-header {
      padding: 16px 18px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .kanban-col-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      font-weight: 600;
    }

    .kanban-col-count {
      font-size: 0.68rem;
      font-weight: 600;
      color: var(--text-tertiary);
      background: rgba(255,255,255,0.04);
      padding: 2px 8px;
      border-radius: 10px;
      min-width: 22px;
      text-align: center;
    }

    .kanban-col-tasks {
      padding: 10px;
      flex: 1;
      min-height: 80px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .kanban-task-card {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 14px 16px;
      cursor: grab;
      transition: all 0.2s cubic-bezier(0.4,0,0.2,1);
      position: relative;
    }

    /* Active / In-Progress column highlighting */
    .kanban-column[data-column-id="inprogress"] .kanban-task-card {
      border-color: rgba(139,124,246,0.25);
      background: linear-gradient(135deg, rgba(139,124,246,0.06) 0%, var(--surface-solid) 100%);
      box-shadow: 0 0 20px rgba(139,124,246,0.08);
    }
    .kanban-column[data-column-id="inprogress"] .kanban-task-card::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, var(--accent), #6366f1);
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    }
    .kanban-column[data-column-id="inprogress"] .kanban-col-header {
      color: var(--accent);
    }
    .kanban-column[data-column-id="inprogress"] .kanban-col-count {
      background: var(--accent-dim);
      color: var(--accent);
    }
    .kanban-column[data-column-id="done"] .kanban-task-card {
      opacity: 0.6;
    }
    .kanban-column[data-column-id="done"] .kanban-task-card:hover {
      opacity: 0.85;
    }

    .kanban-task-card:hover {
      border-color: var(--border-hover);
      background: rgba(255,255,255,0.04);
      transform: translateY(-1px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .kanban-task-card.dragging {
      opacity: 0.4;
      transform: rotate(2deg);
    }
    .kanban-task-card.drag-insert-before {
      border-top: 2px solid var(--accent);
      margin-top: -1px;
    }
    .kanban-task-card.drag-insert-after {
      border-bottom: 2px solid var(--accent);
      margin-bottom: -1px;
    }

    .kanban-task-title {
      font-size: 0.84rem;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 4px;
      padding-right: 20px;
      line-height: 1.4;
    }

    .kanban-task-desc {
      font-size: 0.75rem;
      color: var(--text-secondary);
      line-height: 1.5;
      margin-bottom: 8px;
    }

    .kanban-task-actions {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .kanban-task-btn {
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--border);
      color: var(--text-tertiary);
      width: 26px;
      height: 26px;
      border-radius: 6px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.72rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      padding: 0;
      line-height: 1;
    }

    .kanban-task-btn:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
    }

    .kanban-task-btn.delete-btn:hover {
      border-color: rgba(251,113,133,0.3);
      color: var(--red);
      background: var(--red-dim);
    }

    .kanban-task-delete {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      color: var(--text-tertiary);
      width: 20px;
      height: 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.72rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      opacity: 0;
      padding: 0;
      line-height: 1;
    }

    .kanban-task-card:hover .kanban-task-delete {
      opacity: 1;
    }

    .kanban-task-delete:hover {
      color: var(--red);
      background: var(--red-dim);
    }

    .kanban-empty {
      color: var(--text-tertiary);
      font-size: 0.75rem;
      text-align: center;
      padding: 24px 12px;
      font-weight: 400;
    }

    /* ===== NOTE CARDS ===== */
    .note-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px 22px;
      margin-bottom: 12px;
      backdrop-filter: blur(12px);
      position: relative;
      transition: all 0.2s;
    }
    .note-card::before {
      content:'';position:absolute;top:0;left:0;right:0;height:1px;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.05),transparent);
    }
    .note-card:hover { border-color: var(--border-hover); }
    .note-card-header { display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px; }
    .note-card-title { font-size:0.95rem;font-weight:600;color:var(--text); }
    .note-card-date { font-size:0.68rem;color:var(--text-tertiary);white-space:nowrap; }
    .note-card-content {
      font-size:0.84rem;color:var(--text-secondary);line-height:1.7;
      white-space:pre-wrap;word-break:break-word;
    }
    .note-card-actions {
      display:flex;gap:6px;margin-top:12px;padding-top:12px;border-top:1px solid var(--border);
    }
    .note-empty { color:var(--text-tertiary);font-size:0.85rem;text-align:center;padding:40px; }
    .note-card.editing .note-card-content { display:none; }
    .note-edit-area {
      display:none;width:100%;background:rgba(255,255,255,0.02);border:1px solid var(--border);
      color:var(--text);padding:12px;font-family:'Inter',sans-serif;font-size:0.84rem;
      border-radius:8px;resize:vertical;min-height:100px;outline:none;line-height:1.6;
      margin-top:8px;
    }
    .note-card.editing .note-edit-area { display:block; }

    /* ===== HEALTH ITEMS ===== */
    .health-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.82rem;
      font-weight: 500;
      color: var(--text-secondary);
    }
    .h-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-tertiary);
      flex-shrink: 0;
    }
    .h-dot.up { background: var(--green); box-shadow: 0 0 8px var(--green-glow); }
    .h-dot.down { background: var(--red); box-shadow: 0 0 8px rgba(251,113,133,0.4); }

    /* ===== FOOTER ===== */
    .footer {
      font-size: 0.7rem;
      color: var(--text-tertiary);
      text-align: center;
      padding: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .footer .dot {
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: var(--text-tertiary);
      opacity: 0.5;
    }

    .footer span { color: var(--accent); font-weight: 500; }

    /* ===== GALLERY FULLSCREEN SLIDESHOW ===== */
    .gallery-slideshow {
      position: relative;
      width: 100%;
      min-height: calc(100vh - 180px);
      overflow: hidden;
    }
    .gallery-slide {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: calc(100vh - 180px);
      padding: 40px 20px;
      position: relative;
      animation: galleryFadeIn 0.5s ease;
    }
    .gallery-slide.active { display: flex; }
    @keyframes galleryFadeIn {
      from { opacity: 0; transform: scale(0.97); }
      to { opacity: 1; transform: scale(1); }
    }
    .gallery-art-frame {
      background: rgba(0,0,0,0.6);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 32px 40px;
      backdrop-filter: blur(20px);
      position: relative;
      overflow: auto;
      max-width: 95vw;
      max-height: 65vh;
      box-shadow: 0 0 80px rgba(99,102,241,0.08), 0 0 2px rgba(255,255,255,0.05) inset;
      animation: galleryGlow 4s ease-in-out infinite alternate;
    }
    @keyframes galleryGlow {
      0% { box-shadow: 0 0 60px rgba(99,102,241,0.06), 0 0 2px rgba(255,255,255,0.05) inset; }
      100% { box-shadow: 0 0 100px rgba(99,102,241,0.15), 0 0 4px rgba(255,255,255,0.08) inset; border-color: rgba(99,102,241,0.25); }
    }
    .gallery-art-frame::before {
      content:'';position:absolute;top:0;left:0;right:0;height:1px;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.08),transparent);
    }
    .gallery-art-frame::after {
      content:'';position:absolute;top:-1px;left:-1px;right:-1px;bottom:-1px;
      border-radius: 17px;
      background: linear-gradient(45deg, transparent 40%, rgba(99,102,241,0.1) 50%, transparent 60%);
      background-size: 300% 300%;
      animation: galleryShimmer 6s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }
    @keyframes galleryShimmer {
      0% { background-position: 100% 0; }
      50% { background-position: 0 100%; }
      100% { background-position: 100% 0; }
    }
    .gallery-art {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.55rem;
      line-height: 1.15;
      white-space: pre;
      text-align: left;
      color: var(--text);
    }
    .gallery-meta {
      text-align: center;
      margin-top: 28px;
      max-width: 640px;
    }
    .gallery-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--text);
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 12px;
    }
    .gallery-desc {
      font-size: 0.82rem;
      color: var(--text-secondary);
      line-height: 1.8;
      white-space: pre-wrap;
      font-family: 'Inter', sans-serif;
      opacity: 0.8;
    }
    .gallery-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--border);
      color: var(--text);
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.4rem;
      transition: all 0.2s;
      backdrop-filter: blur(10px);
      z-index: 10;
    }
    .gallery-nav:hover {
      background: rgba(255,255,255,0.12);
      border-color: var(--accent);
      box-shadow: 0 0 20px rgba(99,102,241,0.3);
    }
    .gallery-nav.prev { left: 16px; }
    .gallery-nav.next { right: 16px; }
    .gallery-dots {
      display: flex;
      gap: 10px;
      justify-content: center;
      padding: 20px 0 8px;
    }
    .gallery-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.1);
      cursor: pointer;
      transition: all 0.3s;
    }
    .gallery-dot.active {
      background: var(--accent);
      box-shadow: 0 0 10px rgba(99,102,241,0.5);
      transform: scale(1.2);
    }
    .gallery-dot:hover { background: rgba(255,255,255,0.3); }
    .gallery-counter {
      text-align: center;
      font-size: 0.75rem;
      color: var(--text-secondary);
      opacity: 0.5;
      margin-top: 8px;
      letter-spacing: 2px;
    }

    /* ===== CALENDAR VIEW ===== */
    .cal-header {
      display: flex; align-items: center; gap: 12px; margin-bottom: 16px;
      justify-content: center;
    }
    .cal-month { font-size: 1rem; font-weight: 700; letter-spacing: 1px; min-width: 180px; text-align: center; }
    .cal-grid {
      display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;
      border-radius: 12px; overflow: hidden; border: 1px solid var(--border);
    }
    .cal-day-header {
      padding: 8px 4px; text-align: center; font-size: 0.68rem;
      font-weight: 600; text-transform: uppercase; letter-spacing: 1px;
      color: var(--text-tertiary); background: rgba(255,255,255,0.03);
    }
    .cal-day {
      min-height: 90px; padding: 6px; background: rgba(0,0,0,0.15);
      border: 1px solid transparent; transition: border-color 0.2s;
      overflow: hidden;
    }
    .cal-day:hover { border-color: var(--border); }
    .cal-day.cal-today { background: rgba(99,102,241,0.08); border-color: var(--accent); }
    .cal-day.cal-other { opacity: 0.3; }
    .cal-day-num {
      font-size: 0.72rem; font-weight: 600; color: var(--text-secondary);
      margin-bottom: 4px;
    }
    .cal-today .cal-day-num { color: var(--accent); }
    .cal-task {
      font-size: 0.62rem; padding: 2px 5px; margin-bottom: 2px;
      border-radius: 4px; overflow: hidden; text-overflow: ellipsis;
      white-space: nowrap; cursor: default;
      background: rgba(99,102,241,0.15); color: var(--text);
      border-left: 2px solid var(--accent);
    }
    .cal-task.cal-done { opacity: 0.4; text-decoration: line-through; border-left-color: #22c55e; }
    .cal-task.cal-overdue { border-left-color: #f87171; background: rgba(248,113,113,0.1); }

    /* ===== SOUNDCLOUD PAGE ===== */
    .sc-header { margin-bottom: 16px; }
    .sc-title-row { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    .sc-title { font-size: 1.1rem; font-weight: 700; letter-spacing: 1px; }
    .sc-count { font-size: 0.78rem; color: var(--text-secondary); background: rgba(255,255,255,0.05); padding: 3px 10px; border-radius: 20px; }
    .sc-refresh-btn { font-size: 1rem; padding: 4px 10px; min-width: auto; }
    .sc-controls { display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
    .sc-search {
      flex: 1; min-width: 200px; padding: 8px 14px; border-radius: 10px;
      border: 1px solid var(--border); background: rgba(255,255,255,0.03);
      color: var(--text); font-size: 0.8rem; font-family: inherit;
      outline: none; transition: border-color 0.2s;
    }
    .sc-search:focus { border-color: var(--accent); }
    .sc-genre-filter {
      padding: 8px 12px; border-radius: 10px; border: 1px solid var(--border);
      background: rgba(255,255,255,0.03); color: var(--text); font-size: 0.78rem;
      font-family: inherit; outline: none; cursor: pointer; min-width: 140px;
    }
    .sc-stats {
      display: flex; gap: 20px; font-size: 0.72rem; color: var(--text-secondary);
      padding: 6px 0; flex-wrap: wrap;
    }
    .sc-stats span { white-space: nowrap; }
    .sc-stats strong { color: var(--accent); font-weight: 600; }
    .sc-table-wrap {
      overflow-x: auto; border-radius: 12px;
      border: 1px solid var(--border); background: rgba(0,0,0,0.2);
      max-height: calc(100vh - 280px); overflow-y: auto;
    }
    .sc-table-wrap::-webkit-scrollbar { width: 6px; height: 6px; }
    .sc-table-wrap::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }
    .sc-table { width: 100%; border-collapse: collapse; font-size: 0.78rem; }
    .sc-th {
      position: sticky; top: 0; z-index: 2;
      padding: 10px 12px; text-align: left; font-weight: 600; font-size: 0.72rem;
      letter-spacing: 0.5px; text-transform: uppercase; color: var(--text-secondary);
      background: var(--card); border-bottom: 2px solid var(--border);
      white-space: nowrap; user-select: none;
    }
    .sc-sortable { cursor: pointer; transition: color 0.2s; }
    .sc-sortable:hover { color: var(--accent); }
    .sc-sort-active { color: var(--accent); }
    .sc-sort-icon { font-size: 0.65rem; margin-left: 2px; }
    .sc-th-num { width: 40px; text-align: center; }
    .sc-th-art { width: 42px; }
    .sc-th-title { min-width: 200px; }
    .sc-th-artist { min-width: 120px; }
    .sc-th-duration { width: 80px; }
    .sc-th-genre { width: 100px; }
    .sc-th-plays { width: 80px; text-align: right; }
    .sc-th-likes { width: 70px; text-align: right; }
    .sc-th-date { width: 90px; }
    .sc-table tbody tr {
      border-bottom: 1px solid rgba(255,255,255,0.04);
      transition: background 0.15s;
    }
    .sc-table tbody tr:hover { background: rgba(99,102,241,0.08); }
    .sc-table td {
      padding: 8px 12px; vertical-align: middle;
      max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .sc-td-num { text-align: center; color: var(--text-tertiary); font-size: 0.7rem; }
    .sc-artwork {
      width: 34px; height: 34px; border-radius: 6px; object-fit: cover;
      background: rgba(255,255,255,0.05); display: block;
    }
    .sc-track-title {
      color: var(--text); font-weight: 500;
      text-decoration: none; transition: color 0.2s;
    }
    .sc-track-title:hover { color: var(--accent); }
    .sc-artist { color: var(--text-secondary); }
    .sc-duration {
      font-family: 'JetBrains Mono', monospace; font-size: 0.75rem;
      color: var(--accent); font-weight: 600;
    }
    .sc-genre-tag {
      font-size: 0.68rem; padding: 2px 8px; border-radius: 10px;
      background: rgba(99,102,241,0.12); color: var(--accent);
      display: inline-block; max-width: 100px; overflow: hidden;
      text-overflow: ellipsis; white-space: nowrap;
    }
    .sc-plays, .sc-likes-ct { text-align: right; color: var(--text-secondary); font-size: 0.75rem; }
    .sc-date { color: var(--text-tertiary); font-size: 0.72rem; }
    .sc-loading {
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; padding: 80px 20px; gap: 16px;
      color: var(--text-secondary); font-size: 0.85rem;
    }
    .sc-loading-sub { font-size: 0.72rem; opacity: 0.5; }
    .sc-spinner {
      width: 36px; height: 36px; border: 3px solid rgba(255,255,255,0.1);
      border-top-color: var(--accent); border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .sc-long-bar {
      height: 4px; border-radius: 2px; background: var(--accent);
      display: inline-block; vertical-align: middle; opacity: 0.7;
      min-width: 2px; max-width: 120px;
    }

    /* ===== SPINNIN SORTABLE ===== */
    .sp-sortable { cursor: pointer; transition: color 0.2s; }
    .sp-sortable:hover { color: #00d856; }
    .sp-sort-active { color: #00d856; }
    .sp-sort-icon { font-size: 0.65rem; margin-left: 2px; }
    #page-spinnin .sc-table tbody tr:hover { background: rgba(0,216,86,0.08); }
    #page-spinnin .sc-track-title:hover { color: #00d856; }
    #page-spinnin .sc-duration { color: #00d856; }
    #page-spinnin .sc-spinner { border-top-color: #00d856; }

    /* (Old mobile responsive block replaced by comprehensive version near end of style) */

    /* ===== DREAMS BOOK ===== */
    #page-dreams { padding: 0 16px 80px; }
    .dreams-header-bar { padding: 20px 0 12px; text-align: center; }
    .dreams-sidebar-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); font-weight: 700; margin-bottom: 4px; }
    .dreams-sidebar-subtitle { font-size: 0.75rem; color: var(--muted); }
    .dreams-part { padding: 0; }
    .dreams-part-title { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); padding: 14px 0 6px; font-weight: 700; }
    .dreams-chapter-link { display: flex; align-items: center; gap: 10px; padding: 12px 14px; cursor: pointer; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 6px; transition: all 0.15s; font-size: 0.85rem; color: var(--text); background: var(--surface); }
    .dreams-chapter-link:hover { border-color: var(--accent); background: rgba(139,92,246,0.06); }
    .dreams-chapter-link.active { border-color: var(--accent); background: rgba(139,92,246,0.1); color: #fff; }
    .dreams-ch-num { font-size: 0.7rem; color: var(--muted); min-width: 22px; font-weight: 600; }
    .dreams-ch-title { flex: 1; }
    .dreams-ch-status { display: none; }
    .dreams-back-btn { display: inline-block; padding: 8px 14px; border-radius: 6px; background: var(--surface); border: 1px solid var(--border); color: var(--text); cursor: pointer; font-size: 0.8rem; margin-bottom: 16px; transition: all 0.15s; }
    .dreams-back-btn:hover { border-color: var(--accent); color: #fff; }
    .dreams-reader-header { margin-bottom: 30px; }
    .dreams-reader-ch { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); font-weight: 600; }
    .dreams-reader-title { font-size: 1.5rem; font-weight: 800; margin: 6px 0 8px; color: #fff; line-height: 1.2; }
    .dreams-reader-subtitle { font-size: 0.9rem; color: var(--muted); font-style: italic; }
    .dreams-reader-meta { display: flex; gap: 16px; margin-top: 12px; font-size: 0.75rem; color: var(--muted); }
    .dreams-reader-body { font-size: 0.95rem; line-height: 1.8; color: rgba(255,255,255,0.85); }
    .dreams-reader-body p { margin-bottom: 16px; }
    .dreams-reader-body h2 { font-size: 1.2rem; font-weight: 700; color: #fff; margin: 28px 0 12px; }
    .dreams-reader-body h3 { font-size: 1.05rem; font-weight: 600; color: var(--accent); margin: 22px 0 10px; }
    .dreams-reader-body blockquote { border-left: 3px solid var(--accent); padding-left: 14px; color: var(--muted); font-style: italic; margin: 18px 0; }
    .dreams-reader-body hr { border: none; border-top: 1px solid var(--border); margin: 26px 0; }
    .dreams-reader-nav { display: flex; justify-content: space-between; margin-top: 32px; padding-top: 16px; border-top: 1px solid var(--border); gap: 8px; }
    .dreams-nav-btn { padding: 10px 16px; border-radius: 6px; background: var(--surface); border: 1px solid var(--border); color: var(--text); cursor: pointer; font-size: 0.8rem; transition: all 0.15s; }
    .dreams-nav-btn:hover { border-color: var(--accent); color: #fff; }
    .dreams-nav-btn:disabled { opacity: 0.3; cursor: default; }

    @media (min-width: 701px) {
      #page-dreams { max-width: 720px; margin: 0 auto; padding: 0 24px 40px; }
    }

    /* ===== KALSHI LIVE TRADING DASHBOARD ===== */
    #page-kalshi { padding: 0 16px 80px; max-width: 960px; margin: 0 auto; }
    .kl-top { display: flex; align-items: center; justify-content: space-between; padding: 18px 0 14px; flex-wrap: wrap; gap: 10px; }
    .kl-brand { display: flex; align-items: center; gap: 10px; }
    .kl-logo { font-size: 1.4rem; }
    .kl-title { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 2px; color: #f59e0b; font-weight: 700; }
    .kl-subtitle { font-size: 0.65rem; color: var(--muted); }
    .kl-status-pill { display: inline-flex; align-items: center; gap: 6px; padding: 5px 12px; border-radius: 20px; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.5px; }
    .kl-status-pill.active { background: rgba(34,197,94,0.12); color: #22c55e; border: 1px solid rgba(34,197,94,0.3); }
    .kl-status-pill.sleeping { background: rgba(148,163,184,0.1); color: #94a3b8; border: 1px solid rgba(148,163,184,0.2); }
    .kl-status-pill.error { background: rgba(239,68,68,0.1); color: #ef4444; border: 1px solid rgba(239,68,68,0.2); }
    .kl-dot { width: 7px; height: 7px; border-radius: 50%; }
    .kl-dot.pulse { animation: klPulse 1.5s infinite; }
    @keyframes klPulse { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }
    .kl-dot.active { background: #22c55e; }
    .kl-dot.sleeping { background: #94a3b8; }
    .kl-dot.error { background: #ef4444; }
    .kl-stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; margin-bottom: 16px; }
    .kl-stat-card { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; text-align: center; }
    .kl-stat-card .val { font-size: 1.3rem; font-weight: 800; color: #fff; }
    .kl-stat-card .val.green { color: #22c55e; }
    .kl-stat-card .val.red { color: #ef4444; }
    .kl-stat-card .val.amber { color: #f59e0b; }
    .kl-stat-card .lbl { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-top: 4px; }
    .kl-section { margin-bottom: 20px; }
    .kl-section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
    .kl-section-title { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; color: #f59e0b; font-weight: 700; }
    .kl-section-badge { font-size: 0.65rem; background: rgba(245,158,11,0.12); color: #f59e0b; padding: 3px 10px; border-radius: 10px; font-weight: 600; }
    .kl-game-card { background: var(--surface); border: 1px solid var(--border); border-radius: 10px; padding: 16px; margin-bottom: 10px; transition: border-color 0.2s; }
    .kl-game-card:hover { border-color: rgba(245,158,11,0.4); }
    .kl-game-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
    .kl-game-name { font-size: 0.9rem; font-weight: 700; color: #fff; }
    .kl-game-clock { font-size: 0.75rem; color: #f59e0b; font-weight: 600; background: rgba(245,158,11,0.1); padding: 3px 10px; border-radius: 6px; }
    .kl-game-score { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
    .kl-score-team { font-size: 0.8rem; color: var(--text); }
    .kl-score-num { font-size: 1.6rem; font-weight: 800; color: #fff; min-width: 32px; text-align: center; }
    .kl-score-dash { font-size: 1rem; color: var(--muted); }
    .kl-game-metrics { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
    .kl-metric { text-align: center; padding: 8px 4px; background: rgba(255,255,255,0.02); border-radius: 6px; }
    .kl-metric .mv { font-size: 0.95rem; font-weight: 700; }
    .kl-metric .mv.pos { color: #22c55e; }
    .kl-metric .mv.neg { color: #ef4444; }
    .kl-metric .mv.neutral { color: #94a3b8; }
    .kl-metric .ml { font-size: 0.55rem; text-transform: uppercase; letter-spacing: 1px; color: var(--muted); margin-top: 2px; }
    .kl-signal-row { display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 6px; font-size: 0.8rem; }
    .kl-signal-row .strat { font-weight: 700; color: #f59e0b; min-width: 100px; font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.5px; }
    .kl-signal-row .side { padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; }
    .kl-signal-row .side.yes { background: rgba(34,197,94,0.15); color: #22c55e; }
    .kl-signal-row .side.no { background: rgba(239,68,68,0.15); color: #ef4444; }
    .kl-signal-row .edge { font-weight: 600; }
    .kl-signal-row .edge.pos { color: #22c55e; }
    .kl-signal-row .edge.neg { color: #ef4444; }
    .kl-signal-row .strength { display: flex; gap: 2px; align-items: center; }
    .kl-signal-row .str-bar { width: 4px; height: 12px; border-radius: 2px; background: var(--border); }
    .kl-signal-row .str-bar.filled { background: #f59e0b; }
    .kl-signal-row .reason { flex: 1; color: var(--muted); font-size: 0.72rem; text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .kl-signal-row .time { color: var(--muted); font-size: 0.7rem; min-width: 56px; text-align: right; }
    .kl-pos-card { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; margin-bottom: 6px; }
    .kl-pos-card .ticker { font-weight: 700; color: #fff; font-size: 0.82rem; min-width: 140px; }
    .kl-pos-card .side { padding: 2px 8px; border-radius: 4px; font-size: 0.68rem; font-weight: 700; text-transform: uppercase; }
    .kl-pos-card .side.yes { background: rgba(34,197,94,0.15); color: #22c55e; }
    .kl-pos-card .side.no { background: rgba(239,68,68,0.15); color: #ef4444; }
    .kl-pos-card .entry { color: var(--muted); font-size: 0.78rem; }
    .kl-pos-card .pnl { font-weight: 700; font-size: 0.85rem; margin-left: auto; }
    .kl-pos-card .pnl.pos { color: #22c55e; }
    .kl-pos-card .pnl.neg { color: #ef4444; }
    .kl-empty { text-align: center; padding: 30px 16px; color: var(--muted); font-size: 0.8rem; border: 1px dashed var(--border); border-radius: 10px; }
    .kl-tabs { display: flex; gap: 4px; margin-bottom: 16px; }
    .kl-tab { padding: 7px 16px; border-radius: 8px; font-size: 0.72rem; font-weight: 600; cursor: pointer; color: var(--muted); background: transparent; border: 1px solid transparent; transition: all 0.15s; text-transform: uppercase; letter-spacing: 1px; }
    .kl-tab:hover { color: var(--text); }
    .kl-tab.active { color: #f59e0b; background: rgba(245,158,11,0.08); border-color: rgba(245,158,11,0.25); }
    .kl-updated { font-size: 0.62rem; color: var(--muted); text-align: right; padding: 4px 0; }
    @media (max-width: 700px) {
      .kl-stats-row { grid-template-columns: repeat(2, 1fr); }
      .kl-game-metrics { grid-template-columns: repeat(2, 1fr); }
      .kl-signal-row .reason { display: none; }
      .kl-pos-card .ticker { min-width: 100px; font-size: 0.72rem; }
    }
    @media (min-width: 701px) {
      #page-kalshi { padding: 0 24px 40px; }
    }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.12); }

    /* ===== TOAST ===== */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 12px 20px;
      font-size: 0.82rem;
      color: var(--text);
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      z-index: 100;
      animation: toastIn 0.3s cubic-bezier(0.4,0,0.2,1);
      backdrop-filter: blur(16px);
    }

    @keyframes toastIn {
      from { opacity: 0; transform: translateY(12px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .toast.fade-out {
      animation: toastOut 0.3s cubic-bezier(0.4,0,0.2,1) forwards;
    }

    @keyframes toastOut {
      to { opacity: 0; transform: translateY(8px) scale(0.95); }
    }

    .log-filter-btn.active {
      background: var(--accent-dim);
      color: var(--accent);
      border-color: rgba(139,124,246,0.2);
    }

    @keyframes confettiFall {
      0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) translateX(var(--drift)) rotate(var(--spin)); opacity: 0; }
    }

    /* ===== THEME TOGGLE ===== */
    .theme-toggle {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      transition: all 0.3s;
      flex-shrink: 0;
    }
    .theme-toggle:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
      transform: rotate(15deg);
    }

    /* Light theme overrides */
    body.light {
      --bg: #f5f5f7;
      --bg2: #eeeef0;
      --surface: rgba(0,0,0,0.03);
      --surface-hover: rgba(0,0,0,0.06);
      --surface-solid: #ffffff;
      --border: rgba(0,0,0,0.08);
      --border-hover: rgba(0,0,0,0.15);
      --text: #1a1a2e;
      --text-secondary: #555570;
      --text-tertiary: #8888a0;
      --accent: #6d5ce7;
      --accent-dim: rgba(109,92,231,0.1);
      --accent-glow: rgba(109,92,231,0.2);
      --green: #10b981;
      --green-dim: rgba(16,185,129,0.1);
      --green-glow: rgba(16,185,129,0.2);
      --red: #ef4444;
      --red-dim: rgba(239,68,68,0.1);
      --yellow: #f59e0b;
      --yellow-dim: rgba(245,158,11,0.1);
    }
    body.light::before {
      background:
        radial-gradient(ellipse at 20% 20%, rgba(109,92,231,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(16,185,129,0.04) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(109,92,231,0.03) 0%, transparent 70%);
    }
    body.light .auth-logo,
    body.light .header-logo {
      box-shadow: 0 4px 16px rgba(109,92,231,0.2);
    }
    body.light ::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); }
    body.light ::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.18); }

    /* ===== SKELETON LOADING ===== */
    @keyframes skeletonShimmer {
      0% { background-position: -200px 0; }
      100% { background-position: calc(200px + 100%) 0; }
    }
    .skeleton {
      background: linear-gradient(90deg, var(--surface) 0px, rgba(255,255,255,0.05) 40px, var(--surface) 80px);
      background-size: 200px 100%;
      animation: skeletonShimmer 1.5s ease-in-out infinite;
      border-radius: 6px;
    }
    body.light .skeleton {
      background: linear-gradient(90deg, rgba(0,0,0,0.04) 0px, rgba(0,0,0,0.08) 40px, rgba(0,0,0,0.04) 80px);
      background-size: 200px 100%;
    }
    .skeleton-line { height: 14px; margin-bottom: 8px; }
    .skeleton-line.short { width: 60%; }
    .skeleton-line.medium { width: 80%; }
    .skeleton-card { height: 80px; }

    /* ===== STATS BAR ===== */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin-bottom: 16px;
    }
    .stat-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 14px 16px;
      text-align: center;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      position: relative;
      overflow: hidden;
    }
    .stat-item::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .stat-item:hover::before { opacity: 1; }
    .stat-item:hover { transform: translateY(-2px); border-color: var(--border-hover); }
    .stat-number {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent);
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: -0.02em;
      transition: all 0.3s;
    }
    .stat-number.counting { animation: countPop 0.3s ease; }
    @keyframes countPop {
      0% { transform: scale(1); }
      50% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }
    .stat-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      margin-top: 4px;
      font-weight: 500;
    }

    /* ===== NOTIFICATION CENTER ===== */
    .notif-bell {
      position: relative;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      transition: all 0.3s;
      flex-shrink: 0;
    }
    .notif-bell:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
    }
    .notif-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      background: var(--red);
      color: white;
      font-size: 0.55rem;
      font-weight: 700;
      min-width: 16px;
      height: 16px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 4px;
      box-shadow: 0 2px 8px rgba(251,113,133,0.4);
      animation: notifPop 0.3s ease;
    }
    @keyframes notifPop {
      0% { transform: scale(0); }
      60% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    .notif-badge:empty, .notif-badge[data-count="0"] { display: none; }
    .notif-dropdown {
      position: absolute;
      top: 40px;
      right: 0;
      width: 320px;
      max-height: 400px;
      overflow-y: auto;
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 12px 48px rgba(0,0,0,0.4);
      z-index: 150;
      display: none;
    }
    .notif-dropdown.open { display: block; }
    .notif-header {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .notif-clear {
      background: none;
      border: none;
      color: var(--accent);
      font-size: 0.68rem;
      cursor: pointer;
      font-weight: 500;
      font-family: 'Inter', sans-serif;
    }
    .notif-clear:hover { text-decoration: underline; }
    .notif-item {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      transition: background 0.15s;
      cursor: default;
    }
    .notif-item:last-child { border-bottom: none; }
    .notif-item:hover { background: var(--surface-hover); }
    .notif-item.unread { border-left: 3px solid var(--accent); }
    .notif-item-title {
      font-size: 0.82rem;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 2px;
    }
    .notif-item-time {
      font-size: 0.68rem;
      color: var(--text-tertiary);
    }
    .notif-empty {
      padding: 24px 16px;
      text-align: center;
      color: var(--text-tertiary);
      font-size: 0.82rem;
    }

    /* ===== MICRO-INTERACTIONS ===== */
    .btn, .btn-send, .btn-add-task, .kanban-task-btn, .nav-link {
      transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
    }
    .btn:active, .btn-send:active, .btn-add-task:active {
      transform: scale(0.96);
    }
    .card {
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1), box-shadow 0.3s ease;
    }
    .card:hover {
      box-shadow: 0 8px 32px rgba(0,0,0,0.15), 0 0 0 1px var(--border-hover);
    }
    .kanban-task-card {
      transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
    }
    .kanban-task-card:hover {
      box-shadow: 0 8px 24px rgba(0,0,0,0.2), 0 0 0 1px var(--border-hover);
    }
    .note-card {
      transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
    }
    .note-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .section {
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .section:hover {
      border-color: var(--border-hover);
    }
    /* Ripple effect for buttons */
    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255,255,255,0.15);
      transform: scale(0);
      animation: rippleAnim 0.6s ease-out;
      pointer-events: none;
    }
    @keyframes rippleAnim {
      to { transform: scale(4); opacity: 0; }
    }

    @media (max-width: 600px) {
      .stats-bar { grid-template-columns: repeat(2, 1fr); gap: 8px; }
      .stat-item { padding: 10px 12px; }
      .stat-number { font-size: 1.2rem; }
      .notif-dropdown { width: 280px; right: -40px; }
      .cmd-palette { width: 90vw; max-width: 480px; }
      .pomodoro-widget { width: 280px; }
    }

    /* ===== COMMAND PALETTE ===== */
    .cmd-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 500;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 15vh;
      backdrop-filter: blur(6px);
      animation: cmdFadeIn 0.15s ease;
    }
    @keyframes cmdFadeIn { from { opacity: 0; } to { opacity: 1; } }
    .cmd-palette {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      width: 540px;
      max-width: 90vw;
      box-shadow: 0 24px 80px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset;
      overflow: hidden;
      animation: cmdSlideIn 0.2s cubic-bezier(0.16,1,0.3,1);
    }
    @keyframes cmdSlideIn { from { transform: translateY(-10px) scale(0.98); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
    .cmd-input-wrap {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }
    .cmd-input {
      width: 100%;
      background: transparent;
      border: none;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      outline: none;
      padding: 0;
    }
    .cmd-input::placeholder { color: var(--text-tertiary); }
    .cmd-results {
      max-height: 320px;
      overflow-y: auto;
      padding: 8px;
    }
    .cmd-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.1s;
      color: var(--text-secondary);
      font-size: 0.88rem;
    }
    .cmd-item:hover, .cmd-item.active {
      background: var(--accent-dim);
      color: var(--text);
    }
    .cmd-item .cmd-icon {
      width: 24px;
      text-align: center;
      font-size: 0.85rem;
      opacity: 0.7;
    }
    .cmd-item .cmd-label { flex: 1; }
    .cmd-item .cmd-shortcut {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      color: var(--text-tertiary);
      background: var(--surface);
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid var(--border);
    }
    .cmd-section {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      padding: 8px 12px 4px;
      font-weight: 600;
    }

    /* ===== POMODORO TIMER ===== */
    .pomodoro-widget {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
      width: 300px;
      margin: 0 auto 16px;
    }
    .pomodoro-widget::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
    .pomo-ring {
      position: relative;
      width: 160px;
      height: 160px;
      margin: 0 auto 16px;
    }
    .pomo-ring svg {
      width: 160px;
      height: 160px;
      transform: rotate(-90deg);
    }
    .pomo-ring .pomo-bg {
      fill: none;
      stroke: var(--border);
      stroke-width: 6;
    }
    .pomo-ring .pomo-progress {
      fill: none;
      stroke: var(--accent);
      stroke-width: 6;
      stroke-linecap: round;
      transition: stroke-dashoffset 1s linear;
      filter: drop-shadow(0 0 6px var(--accent-glow));
    }
    .pomo-ring .pomo-progress.break-mode {
      stroke: var(--green);
      filter: drop-shadow(0 0 6px var(--green-glow));
    }
    .pomo-time {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      font-weight: 600;
      color: var(--text);
      letter-spacing: 2px;
    }
    .pomo-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 14px;
      font-weight: 500;
    }
    .pomo-controls {
      display: flex;
      gap: 8px;
      justify-content: center;
    }
    .pomo-btn {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 8px 18px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      font-weight: 500;
      transition: all 0.2s;
    }
    .pomo-btn:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
    }
    .pomo-btn.primary {
      background: linear-gradient(135deg, var(--accent), #6366f1);
      border: none;
      color: white;
      box-shadow: 0 2px 12px rgba(139,124,246,0.25);
    }
    .pomo-btn.primary:hover {
      box-shadow: 0 4px 20px rgba(139,124,246,0.4);
    }
    .pomo-sessions {
      margin-top: 12px;
      font-size: 0.7rem;
      color: var(--text-tertiary);
    }

    /* ===== CRT MODE ===== */
    body.crt {
      animation: crtFlicker 0.15s infinite;
    }
    body.crt * {
      text-shadow: 0 0 2px rgba(52,211,153,0.5);
    }
    @keyframes crtFlicker {
      0% { opacity: 0.97; }
      50% { opacity: 1; }
      100% { opacity: 0.98; }
    }
    body.crt::after {
      content: '';
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(0,0,0,0.15) 0px,
        rgba(0,0,0,0.15) 1px,
        transparent 1px,
        transparent 3px
      );
      pointer-events: none;
      z-index: 1000;
    }
    body.crt {
      --bg: #0a0f0a;
      --bg2: #0d120d;
      --surface: rgba(52,211,153,0.04);
      --surface-hover: rgba(52,211,153,0.08);
      --surface-solid: #0f150f;
      --border: rgba(52,211,153,0.12);
      --border-hover: rgba(52,211,153,0.2);
      --text: #34d399;
      --text-secondary: #2a9d6f;
      --text-tertiary: #1a6648;
      --accent: #34d399;
      --accent-dim: rgba(52,211,153,0.12);
      --accent-glow: rgba(52,211,153,0.3);
    }
    body.crt::before {
      background:
        radial-gradient(ellipse at 50% 50%, rgba(52,211,153,0.04) 0%, transparent 70%);
    }
    .crt-toggle {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      transition: all 0.3s;
      flex-shrink: 0;
      font-family: 'JetBrains Mono', monospace;
      font-weight: 700;
    }
    .crt-toggle:hover {
      border-color: var(--border-hover);
      color: var(--green);
      background: rgba(52,211,153,0.08);
      text-shadow: 0 0 8px var(--green-glow);
    }

    /* ===== FORTUNE COOKIE ===== */
    .fortune-cookie {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px 22px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .fortune-cookie:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .fortune-cookie::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }
    .fortune-icon { font-size: 2rem; margin-bottom: 8px; }
    .fortune-text {
      font-size: 0.88rem;
      color: var(--text-secondary);
      line-height: 1.6;
      font-style: italic;
      min-height: 24px;
    }
    .fortune-hint {
      font-size: 0.68rem;
      color: var(--text-tertiary);
      margin-top: 8px;
    }
    @keyframes fortuneCrack {
      0% { transform: scale(1); }
      15% { transform: scale(1.1) rotate(-5deg); }
      30% { transform: scale(0.9) rotate(5deg); }
      45% { transform: scale(1.15) rotate(-3deg); }
      60% { transform: scale(1); }
      100% { transform: scale(1); }
    }
    .fortune-cracking { animation: fortuneCrack 0.6s ease; }

    /* ===== SPARKLINE CHARTS ===== */
    .sparkline-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 14px;
      margin-bottom: 16px;
    }
    .sparkline-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px 18px;
      position: relative;
      overflow: hidden;
    }
    .sparkline-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }
    .sparkline-title {
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 500;
      margin-bottom: 6px;
    }
    .sparkline-value {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
      font-family: 'JetBrains Mono', monospace;
    }
    .sparkline-canvas {
      width: 100%;
      height: 40px;
    }

    /* ===== TERMINAL WIDGET ===== */
    .terminal-widget {
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 16px;
    }
    .terminal-bar {
      background: #1a1a1a;
      padding: 8px 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .terminal-dot { width: 10px; height: 10px; border-radius: 50%; }
    .terminal-dot.red { background: #ff5f57; }
    .terminal-dot.yellow { background: #febc2e; }
    .terminal-dot.green { background: #28c840; }
    .terminal-title {
      flex: 1;
      text-align: center;
      font-size: 0.72rem;
      color: #666;
    }
    .terminal-body {
      padding: 12px 16px;
      max-height: 300px;
      overflow-y: auto;
      font-size: 0.78rem;
      line-height: 1.6;
      color: #34d399;
    }
    .terminal-body .prompt { color: #8b7cf6; }
    .terminal-body .output { color: #a0a0b0; }
    .terminal-body .error-text { color: #fb7185; }
    .terminal-input-line {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px 12px;
    }
    .terminal-prompt-text { color: #8b7cf6; font-size: 0.78rem; white-space: nowrap; }
    .terminal-input {
      flex: 1;
      background: transparent;
      border: none;
      color: #34d399;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      outline: none;
      caret-color: #34d399;
    }

    /* ===== TOOLS PAGE ===== */
    .tools-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .tool-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      transition: border-color 0.2s;
    }
    .tool-card:hover {
      border-color: var(--border-hover);
    }
    @media (max-width: 700px) {
      .tools-grid { grid-template-columns: 1fr; }
      .tool-card { grid-column: span 1 !important; }
    }

    /* ===== TYPING TEST ===== */
    .typing-test {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      position: relative;
    }
    .typing-prompt {
      font-size: 0.92rem;
      line-height: 1.8;
      color: var(--text-secondary);
      margin-bottom: 16px;
      text-align: left;
      padding: 16px;
      background: rgba(0,0,0,0.15);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-family: 'JetBrains Mono', monospace;
      min-height: 80px;
      letter-spacing: 0.3px;
    }
    .typing-prompt .correct { color: var(--green); }
    .typing-prompt .incorrect { color: var(--red); background: var(--red-dim); border-radius: 2px; }
    .typing-prompt .cursor-char { border-bottom: 2px solid var(--accent); }
    .typing-input {
      width: 100%;
      background: rgba(255,255,255,0.02);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 12px 14px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.88rem;
      border-radius: var(--radius-sm);
      outline: none;
      transition: all 0.3s;
    }
    .typing-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }
    .typing-stats {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 14px;
    }
    .typing-stat-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--accent);
      font-family: 'JetBrains Mono', monospace;
    }
    .typing-stat-label {
      font-size: 0.6rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      margin-top: 2px;
    }

    /* ===== SNAKE GAME ===== */
    .snake-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      text-align: center;
      position: relative;
    }
    .snake-canvas {
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #0a0a0f;
      display: block;
      margin: 0 auto 12px;
      image-rendering: pixelated;
    }
    .snake-score {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.82rem;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }
    .snake-best {
      font-size: 0.68rem;
      color: var(--text-tertiary);
      margin-top: 4px;
    }
    .snake-start-btn {
      background: linear-gradient(135deg, var(--green), #10b981);
      border: none;
      color: white;
      padding: 8px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 2px 12px rgba(52,211,153,0.25);
    }
    .snake-start-btn:hover { box-shadow: 0 4px 20px rgba(52,211,153,0.4); transform: translateY(-1px); }

    /* ===== PROGRESS RINGS ===== */
    .progress-rings {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 14px;
      margin-bottom: 16px;
    }
    .progress-ring-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }
    .progress-ring-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }
    .progress-ring-card:hover {
      border-color: var(--border-hover);
      transform: translateY(-2px);
    }
    .prog-ring { width: 90px; height: 90px; margin: 0 auto 8px; position: relative; }
    .prog-ring svg { width: 90px; height: 90px; transform: rotate(-90deg); }
    .prog-ring .ring-bg { fill: none; stroke: var(--border); stroke-width: 5; }
    .prog-ring .ring-fill {
      fill: none;
      stroke-width: 5;
      stroke-linecap: round;
      transition: stroke-dashoffset 1s ease;
    }
    .prog-ring-value {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      font-weight: 600;
    }
    .prog-ring-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    /* ===== 3D CARD TILT ===== */
    .tilt-card {
      transform-style: preserve-3d;
      perspective: 1000px;
      transition: transform 0.1s ease;
    }
    .tilt-card .tilt-shine {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s;
      background: radial-gradient(circle at var(--shine-x, 50%) var(--shine-y, 50%), rgba(255,255,255,0.08) 0%, transparent 60%);
    }
    .tilt-card:hover .tilt-shine { opacity: 1; }

    /* ===== PARTICLE BACKGROUND ===== */
    #particle-canvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    @media (max-width: 600px) {
      .progress-rings { grid-template-columns: repeat(2, 1fr); }
      .prog-ring { width: 70px; height: 70px; }
      .prog-ring svg { width: 70px; height: 70px; }
      .prog-ring-value { font-size: 0.82rem; }
      .heatmap-grid { gap: 2px; }
      .heatmap-cell { width: 8px; height: 8px; }
    }

    /* ===== ACTIVITY HEATMAP ===== */
    .heatmap-section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px 22px;
      margin-bottom: 16px;
      position: relative;
      overflow: hidden;
    }
    .heatmap-section::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    }
    .heatmap-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      font-weight: 600;
      margin-bottom: 12px;
    }
    .heatmap-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 3px;
      max-width: 100%;
      overflow-x: auto;
    }
    .heatmap-week {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }
    .heatmap-cell {
      width: 11px;
      height: 11px;
      border-radius: 2px;
      transition: all 0.2s;
      cursor: default;
    }
    .heatmap-cell:hover {
      transform: scale(1.4);
      outline: 1px solid var(--text-secondary);
    }
    .heatmap-cell.l0 { background: var(--surface); border: 1px solid var(--border); }
    .heatmap-cell.l1 { background: rgba(139,124,246,0.2); }
    .heatmap-cell.l2 { background: rgba(139,124,246,0.4); }
    .heatmap-cell.l3 { background: rgba(139,124,246,0.6); }
    .heatmap-cell.l4 { background: rgba(139,124,246,0.85); }
    .heatmap-legend {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 8px;
      font-size: 0.62rem;
      color: var(--text-tertiary);
    }
    .heatmap-legend-cell {
      width: 11px;
      height: 11px;
      border-radius: 2px;
    }

    /* ===== ANALYTICS CARDS ===== */
    .analytics-cards {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }
    @media (max-width: 700px) {
      .analytics-cards { grid-template-columns: repeat(2, 1fr); }
    }
    .analytics-card {
      background: rgba(255,255,255,0.02);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 14px 12px;
      text-align: center;
      transition: all 0.3s ease;
    }
    .analytics-card:hover {
      border-color: var(--border-hover);
      background: rgba(255,255,255,0.04);
      transform: translateY(-1px);
    }
    .analytics-card-value {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--accent);
      letter-spacing: -0.02em;
      margin-bottom: 4px;
    }
    .analytics-card-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 500;
    }
    .analytics-bar-chart {
      display: flex;
      align-items: flex-end;
      gap: 2px;
      height: 60px;
      padding-top: 8px;
      border-top: 1px solid var(--border);
    }
    .analytics-bar {
      flex: 1;
      min-width: 0;
      background: var(--accent-dim);
      border-radius: 3px 3px 0 0;
      transition: all 0.3s ease;
      position: relative;
      cursor: default;
    }
    .analytics-bar:hover {
      background: var(--accent);
      opacity: 0.9;
    }
    .analytics-bar-tooltip {
      display: none;
      position: absolute;
      bottom: calc(100% + 6px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 0.62rem;
      color: var(--text);
      white-space: nowrap;
      z-index: 10;
    }
    .analytics-bar:hover .analytics-bar-tooltip {
      display: block;
    }

    /* ===== RATE LIMIT ===== */
    .rate-limit-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .rate-limit-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .rate-limit-bar-wrap {
      width: 100%;
    }
    .rate-limit-bar-bg {
      width: 100%;
      height: 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 5px;
      overflow: hidden;
    }
    .rate-limit-bar-fill {
      height: 100%;
      border-radius: 5px;
      background: linear-gradient(90deg, var(--green), var(--accent));
      transition: width 0.5s ease, background 0.3s ease;
    }
    .rate-limit-bar-fill.warning {
      background: linear-gradient(90deg, var(--yellow), #f59e0b);
    }
    .rate-limit-bar-fill.danger {
      background: linear-gradient(90deg, var(--red), #ef4444);
    }
    .rate-limit-stats {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* ===== TYPING INDICATOR ===== */
    .typing-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      background: var(--accent-dim);
      border-radius: 16px;
      font-size: 0.72rem;
      color: var(--accent);
      font-weight: 500;
    }
    .typing-indicator .dots {
      display: flex;
      gap: 3px;
    }
    .typing-indicator .dot-bounce {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--accent);
      animation: dotBounce 1.4s ease-in-out infinite;
    }
    .typing-indicator .dot-bounce:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator .dot-bounce:nth-child(3) { animation-delay: 0.4s; }
    @keyframes dotBounce {
      0%, 80%, 100% { transform: translateY(0); opacity: 0.4; }
      40% { transform: translateY(-5px); opacity: 1; }
    }

    /* ===== FIREWORKS ===== */
    #fireworks-canvas {
      position: fixed;
      inset: 0;
      z-index: 350;
      pointer-events: none;
    }

    /* ===== AMBIENT SOUND ===== */
    .ambient-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 4px 14px;
      font-size: 0.72rem;
      color: var(--text-secondary);
      height: 32px;
    }
    .ambient-btn {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.85rem;
      padding: 0;
      transition: color 0.2s;
      display: flex;
      align-items: center;
    }
    .ambient-btn:hover { color: var(--text); }
    .ambient-btn.playing { color: var(--green); }
    .ambient-viz {
      display: flex;
      align-items: flex-end;
      gap: 2px;
      height: 16px;
    }
    .ambient-viz-bar {
      width: 3px;
      background: var(--accent);
      border-radius: 1px;
      transition: height 0.1s;
      opacity: 0.6;
    }
    .ambient-volume {
      width: 50px;
      height: 3px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--border);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }
    .ambient-volume::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }

    /* ===== WEATHER WIDGET ===== */
    .weather-widget {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.72rem;
      color: var(--text-secondary);
      font-weight: 500;
    }
    .weather-icon {
      font-size: 1rem;
      line-height: 1;
    }
    .weather-temp {
      font-family: 'JetBrains Mono', monospace;
      font-weight: 600;
      color: var(--text);
    }

    /* ===== NOTE PINNED ===== */
    .note-card.pinned {
      border-color: rgba(139,124,246,0.25);
      background: linear-gradient(135deg, rgba(139,124,246,0.04) 0%, var(--surface) 100%);
    }
    .note-card.pinned::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, var(--accent), #6366f1);
      border-radius: var(--radius) var(--radius) 0 0;
    }
    .pin-badge {
      font-size: 0.62rem;
      color: var(--accent);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .note-tag {
      font-size: 0.62rem;
      padding: 2px 8px;
      border-radius: 10px;
      background: rgba(99,102,241,0.12);
      color: var(--accent);
      font-weight: 500;
      letter-spacing: 0.3px;
    }
    .note-tag-btn {
      font-size: 0.68rem;
      padding: 3px 10px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }
    .note-tag-btn:hover { background: rgba(255,255,255,0.06); }
    .note-tag-btn.active {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
    }

    /* ===== FOCUS MODE ===== */
    body.focus-mode header,
    body.focus-mode .footer,
    body.focus-mode .nav { opacity: 0.15; transition: opacity 0.3s; }
    body.focus-mode header:hover,
    body.focus-mode .footer:hover,
    body.focus-mode .nav:hover { opacity: 1; }
    body.focus-mode .card,
    body.focus-mode .kanban-task-card,
    body.focus-mode .note-card,
    body.focus-mode .section { opacity: 0.25; transition: opacity 0.3s; }
    body.focus-mode .card:hover,
    body.focus-mode .kanban-task-card:hover,
    body.focus-mode .note-card:hover,
    body.focus-mode .section:hover { opacity: 1; transform: scale(1.01); }

    /* ===== FULLSCREEN MODE ===== */
    body.fullscreen-mode header,
    body.fullscreen-mode .footer,
    body.fullscreen-mode .nav { display: none !important; }
    body.fullscreen-mode #dashboard { padding: 16px; }
    .fullscreen-exit-hint {
      position: fixed;
      top: 8px;
      right: 8px;
      font-size: 0.65rem;
      color: var(--text-tertiary);
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 100;
    }
    body.fullscreen-mode .fullscreen-exit-hint { opacity: 0.5; }
    body.fullscreen-mode .fullscreen-exit-hint:hover { opacity: 1; }

    /* ===== CHANGELOG MODAL ===== */
    .changelog-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      z-index: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
      animation: cmdFadeIn 0.3s ease;
    }
    .changelog-modal {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      width: 580px;
      max-width: 92vw;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: 0 32px 100px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.05) inset;
      animation: cmdSlideIn 0.4s cubic-bezier(0.16,1,0.3,1);
      display: flex;
      flex-direction: column;
    }
    .changelog-header {
      padding: 24px 28px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    .changelog-header h2 {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--text);
      letter-spacing: -0.02em;
    }
    .changelog-header .changelog-subtitle {
      font-size: 0.78rem;
      color: var(--text-tertiary);
      margin-top: 4px;
    }
    .changelog-close {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      width: 30px;
      height: 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    .changelog-close:hover {
      background: var(--red-dim);
      color: var(--red);
      border-color: rgba(251,113,133,0.3);
    }
    .changelog-body {
      padding: 20px 28px;
      overflow-y: auto;
      flex: 1;
    }
    .changelog-section {
      margin-bottom: 18px;
    }
    .changelog-section-title {
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .changelog-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.84rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    .changelog-item:last-child { border-bottom: none; }
    .changelog-icon {
      font-size: 1rem;
      line-height: 1.4;
      flex-shrink: 0;
    }
    .changelog-item strong {
      color: var(--text);
      font-weight: 600;
    }
    .changelog-footer {
      padding: 16px 28px;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .changelog-footer .changelog-count {
      font-size: 0.72rem;
      color: var(--text-tertiary);
    }
    .changelog-dismiss {
      background: linear-gradient(135deg, var(--accent), #6366f1);
      border: none;
      color: white;
      padding: 10px 28px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      transition: all 0.3s;
      box-shadow: 0 2px 12px rgba(139,124,246,0.25);
    }
    .changelog-dismiss:hover {
      box-shadow: 0 4px 24px rgba(139,124,246,0.4);
      transform: translateY(-1px);
    }

    /* ===== KANBAN PRIORITY ===== */
    .kanban-priority {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.6rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 2px 8px;
      border-radius: 4px;
      margin-right: 6px;
    }
    .priority-low { background: rgba(52,211,153,0.1); color: var(--green); }
    .priority-med { background: rgba(251,191,36,0.1); color: var(--yellow); }
    .priority-high { background: rgba(251,113,133,0.1); color: var(--red); }
    .priority-critical {
      background: rgba(251,113,133,0.15);
      color: var(--red);
      animation: criticalPulse 2s ease-in-out infinite;
    }
    @keyframes criticalPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .kanban-task-card.priority-high-border { border-left: 3px solid var(--red); }
    .kanban-task-card.priority-critical-border { border-left: 3px solid var(--red); box-shadow: 0 0 8px var(--red-dim); }
    .kanban-task-card.priority-med-border { border-left: 3px solid var(--yellow); }
    .kanban-task-card.priority-low-border { border-left: 3px solid var(--green); }
    .kanban-due {
      font-size: 0.68rem;
      margin-top: 6px;
      padding: 2px 8px;
      border-radius: 4px;
      display: inline-block;
      background: rgba(255,255,255,0.04);
      color: var(--text-tertiary);
    }
    .kanban-due.overdue {
      background: rgba(251,113,133,0.15);
      color: var(--red);
      font-weight: 600;
    }
    .kanban-due.due-soon {
      background: rgba(251,191,36,0.12);
      color: var(--yellow);
    }

    /* Priority selector in add form */
    .priority-selector {
      display: flex;
      gap: 6px;
    }
    .priority-option {
      padding: 5px 12px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 0.72rem;
      font-weight: 500;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    .priority-option:hover { border-color: var(--border-hover); }
    .priority-option.selected { border-color: var(--accent); background: var(--accent-dim); color: var(--accent); }

    /* ===== GLOBAL SEARCH ===== */
    .search-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 500;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 12vh;
      backdrop-filter: blur(6px);
      animation: cmdFadeIn 0.15s ease;
    }
    .search-panel {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      width: 560px;
      max-width: 92vw;
      box-shadow: 0 24px 80px rgba(0,0,0,0.5);
      overflow: hidden;
      animation: cmdSlideIn 0.2s cubic-bezier(0.16,1,0.3,1);
    }
    .search-input-wrap {
      padding: 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .search-icon { color: var(--text-tertiary); font-size: 0.9rem; }
    .search-input {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      outline: none;
    }
    .search-input::placeholder { color: var(--text-tertiary); }
    .search-results {
      max-height: 400px;
      overflow-y: auto;
      padding: 8px;
    }
    .search-result-section {
      font-size: 0.62rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      padding: 8px 12px 4px;
      font-weight: 600;
    }
    .search-result-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.1s;
    }
    .search-result-item:hover { background: var(--accent-dim); }
    .search-result-icon { font-size: 0.85rem; opacity: 0.6; padding-top: 2px; }
    .search-result-title { font-size: 0.84rem; color: var(--text); font-weight: 500; }
    .search-result-context {
      font-size: 0.72rem;
      color: var(--text-tertiary);
      margin-top: 2px;
      line-height: 1.4;
    }
    .search-result-context mark {
      background: var(--accent-dim);
      color: var(--accent);
      border-radius: 2px;
      padding: 0 2px;
    }
    .search-empty {
      padding: 24px;
      text-align: center;
      color: var(--text-tertiary);
      font-size: 0.84rem;
    }
    /* ===== HEADER SEARCH BAR ===== */
    .header-search-wrap {
      position: relative;
      display: flex;
      align-items: center;
    }
    .header-search-input {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      padding: 6px 14px 6px 30px;
      width: 180px;
      outline: none;
      transition: all 0.2s;
    }
    .header-search-input:focus {
      border-color: var(--accent);
      width: 260px;
      background: var(--surface-hover);
    }
    .header-search-input::placeholder { color: var(--text-tertiary); }
    .header-search-icon {
      position: absolute;
      left: 10px;
      font-size: 0.72rem;
      color: var(--text-tertiary);
      pointer-events: none;
    }
    .header-search-kbd {
      position: absolute;
      right: 8px;
      font-size: 0.6rem;
      color: var(--text-tertiary);
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1px 5px;
      font-family: 'JetBrains Mono', monospace;
      pointer-events: none;
      opacity: 0.7;
    }
    .header-search-dropdown {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      width: 380px;
      max-height: 400px;
      overflow-y: auto;
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 16px 48px rgba(0,0,0,0.5);
      z-index: 600;
      padding: 6px;
      display: none;
      animation: cmdSlideIn 0.15s ease;
    }
    .header-search-dropdown.visible { display: block; }
    .header-search-dropdown .search-result-item { font-size: 0.8rem; }
    .header-search-dropdown .search-result-section { font-size: 0.6rem; }

    /* ===== ACHIEVEMENT BADGES ===== */
    .badge-btn {
      position: relative;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      color: var(--text);
      cursor: pointer;
      font-size: 0.82rem;
      padding: 5px 10px;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.2s;
    }
    .badge-btn:hover { border-color: var(--accent); background: var(--accent-dim); }
    .badge-counter {
      font-size: 0.65rem;
      background: var(--accent);
      color: #fff;
      border-radius: 10px;
      padding: 1px 5px;
      font-weight: 600;
      min-width: 16px;
      text-align: center;
    }
    .badge-popup {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      width: 340px;
      max-height: 420px;
      overflow-y: auto;
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 16px 48px rgba(0,0,0,0.5);
      z-index: 600;
      padding: 16px;
      display: none;
      animation: cmdSlideIn 0.15s ease;
    }
    .badge-popup.visible { display: block; }

    /* ===== PREFERENCES PANEL ===== */
    .prefs-panel {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      width: 320px;
      max-height: 480px;
      overflow-y: auto;
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 16px 48px rgba(0,0,0,0.5);
      z-index: 600;
      padding: 16px;
      display: none;
      animation: cmdSlideIn 0.15s ease;
    }
    .prefs-panel.visible { display: block; }
    .prefs-panel-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 600;
      margin-bottom: 14px;
    }
    .pref-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
    }
    .pref-row:last-child { border-bottom: none; }
    .pref-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      font-weight: 500;
    }
    .pref-label small {
      display: block;
      font-size: 0.68rem;
      color: var(--text-tertiary);
      font-weight: 400;
      margin-top: 2px;
    }
    .pref-toggle {
      position: relative;
      width: 40px;
      height: 22px;
      background: var(--border);
      border-radius: 11px;
      cursor: pointer;
      transition: background 0.2s;
      flex-shrink: 0;
    }
    .pref-toggle.on { background: var(--accent); }
    .pref-toggle::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 16px;
      height: 16px;
      background: white;
      border-radius: 50%;
      transition: transform 0.2s;
    }
    .pref-toggle.on::after { transform: translateX(18px); }
    .pref-slider-wrap {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .pref-slider {
      width: 100px;
      accent-color: var(--accent);
    }
    .pref-slider-val {
      font-size: 0.72rem;
      color: var(--accent);
      font-weight: 600;
      min-width: 28px;
      text-align: right;
    }
    .prefs-gear-btn {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      width: 32px;
      height: 32px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .prefs-gear-btn:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-hover);
    }

    /* ===== STAR/BOOKMARK BUTTON ===== */
    .star-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      padding: 2px 4px;
      opacity: 0.4;
      transition: all 0.2s;
      line-height: 1;
      flex-shrink: 0;
    }
    .star-btn:hover { opacity: 0.8; transform: scale(1.15); }
    .star-btn.starred { opacity: 1; color: #fbbf24; filter: drop-shadow(0 0 4px rgba(251,191,36,0.4)); }
    .starred-filter-btn {
      padding: 5px 12px;
      font-size: 0.72rem;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }
    .starred-filter-btn:hover { border-color: var(--border-hover); color: var(--text); }
    .starred-filter-btn.active { background: var(--yellow-dim); border-color: rgba(251,191,36,0.3); color: #fbbf24; }

    /* ===== NOTE TEMPLATE SELECTOR ===== */
    .note-template-select {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 6px 10px;
      border-radius: 6px;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .note-template-select:hover { border-color: var(--border-hover); color: var(--text); }
    .note-template-select:focus { border-color: var(--accent); outline: none; }

    /* ===== RECURRING TASK ===== */
    .recur-select {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 6px 10px;
      border-radius: 6px;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .recur-select:hover { border-color: var(--border-hover); color: var(--text); }
    .recur-select:focus { border-color: var(--accent); outline: none; }
    .recur-badge {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      font-size: 0.65rem;
      color: var(--accent);
      background: var(--accent-dim);
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 500;
      margin-top: 4px;
    }
    .badge-popup-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 600;
      margin-bottom: 12px;
    }
    .badge-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .badge-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border-radius: 8px;
      background: var(--surface);
      border: 1px solid var(--border);
      transition: all 0.2s;
    }
    .badge-item.unlocked {
      border-color: var(--accent);
      background: var(--accent-dim);
    }
    .badge-item.locked {
      opacity: 0.4;
      filter: grayscale(1);
    }
    .badge-emoji {
      font-size: 1.4rem;
      line-height: 1;
    }
    .badge-info { flex: 1; min-width: 0; }
    .badge-name {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .badge-desc {
      font-size: 0.62rem;
      color: var(--text-tertiary);
      margin-top: 2px;
    }
    .badge-toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--surface-solid);
      border: 1px solid var(--accent);
      border-radius: var(--radius);
      padding: 14px 22px;
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 700;
      box-shadow: 0 8px 32px rgba(139,124,246,0.3);
      animation: badgeToastIn 0.4s ease, badgeToastOut 0.4s ease 2.6s forwards;
    }
    .badge-toast-emoji { font-size: 1.8rem; }
    .badge-toast-text { font-size: 0.82rem; color: var(--text); }
    .badge-toast-label { font-size: 0.65rem; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }
    @keyframes badgeToastIn {
      from { opacity: 0; transform: translateX(-50%) translateY(20px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }
    @keyframes badgeToastOut {
      from { opacity: 1; transform: translateX(-50%) translateY(0); }
      to { opacity: 0; transform: translateX(-50%) translateY(20px); }
    }

    /* ===== ZEN MODE ===== */
    body.zen-mode header,
    body.zen-mode .stats-bar,
    body.zen-mode .footer,
    body.zen-mode .changelog-overlay,
    body.zen-mode .header-nav {
      display: none !important;
    }
    body.zen-mode {
      background: #050508 !important;
    }
    body.zen-mode #dashboard {
      padding: 40px 60px !important;
      max-width: 900px;
      margin: 0 auto;
    }
    body.zen-mode .page {
      font-size: 1.05rem;
      line-height: 1.7;
    }
    body.zen-mode .card,
    body.zen-mode .section,
    body.zen-mode .kanban-column,
    body.zen-mode .note-card {
      border-color: rgba(255,255,255,0.03) !important;
      background: rgba(255,255,255,0.015) !important;
    }
    body.zen-mode::before {
      content: 'ZEN';
      position: fixed;
      top: 12px;
      right: 16px;
      font-size: 0.6rem;
      letter-spacing: 2px;
      color: var(--text-tertiary);
      opacity: 0.4;
      z-index: 100;
      font-family: 'JetBrains Mono', monospace;
    }

    /* ===== CUSTOM CSS SECTION ===== */
    .custom-css-section {
      margin-top: 20px;
      padding: 20px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
    }
    .custom-css-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-tertiary);
      font-weight: 600;
      margin-bottom: 14px;
    }
    .custom-css-textarea {
      width: 100%;
      min-height: 140px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--green);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      padding: 12px;
      resize: vertical;
      outline: none;
      transition: border-color 0.2s;
      line-height: 1.5;
    }
    .custom-css-textarea:focus {
      border-color: var(--accent);
    }
    .custom-css-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      align-items: center;
    }
    .custom-css-hint {
      font-size: 0.68rem;
      color: var(--text-tertiary);
      margin-left: auto;
    }

    /* ===== CODE SYNTAX HIGHLIGHTING ===== */
    .code-block {
      background: rgba(0,0,0,0.4);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      margin: 8px 0;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      line-height: 1.6;
      overflow-x: auto;
      position: relative;
      white-space: pre;
      color: var(--text);
    }
    .code-block-lang {
      position: absolute;
      top: 4px;
      right: 8px;
      font-size: 0.62rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-family: 'Inter', sans-serif;
    }
    .token-keyword { color: #c678dd; font-weight: 500; }
    .token-string { color: #98c379; }
    .token-comment { color: #5c6370; font-style: italic; }
    .token-number { color: #d19a66; }
    .token-function { color: #61afef; }
    .token-operator { color: #56b6c2; }
    .token-punctuation { color: #abb2bf; }

    /* ===== KANBAN TASK TEMPLATES ===== */
    .kanban-template-select {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 6px 10px;
      border-radius: 6px;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .kanban-template-select:hover { border-color: var(--border-hover); color: var(--text); }
    .kanban-template-select:focus { border-color: var(--accent); outline: none; }

    /* ===== QR CODE SHARING ===== */
    .qr-modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(4px);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.2s;
    }
    .qr-modal {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      max-width: 320px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }
    .qr-modal h3 {
      font-size: 0.9rem;
      color: var(--text);
      margin-bottom: 16px;
      font-weight: 600;
    }
    .qr-modal canvas {
      border-radius: 8px;
      background: #fff;
      padding: 12px;
      margin: 0 auto;
      display: block;
    }
    .qr-modal .qr-close-btn {
      margin-top: 16px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 8px 20px;
      border-radius: 8px;
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    .qr-modal .qr-close-btn:hover { background: var(--surface-hover); color: var(--text); }
    .note-share-btn {
      background: none;
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.72rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    .note-share-btn:hover { border-color: var(--accent); color: var(--accent); }

    /* ===== NETWORK LATENCY MONITOR ===== */
    .latency-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px 20px;
      margin-bottom: 16px;
    }
    .latency-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    .latency-title {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      font-weight: 500;
    }
    .latency-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--green);
      box-shadow: 0 0 6px var(--green-glow);
      transition: all 0.3s;
    }
    .latency-status-dot.warn { background: var(--yellow); box-shadow: 0 0 6px rgba(251,191,36,0.3); }
    .latency-status-dot.bad { background: var(--red); box-shadow: 0 0 6px rgba(251,113,133,0.3); }
    .latency-stats {
      display: flex;
      gap: 16px;
      margin-bottom: 12px;
    }
    .latency-stat {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .latency-stat-label {
      font-size: 0.65rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .latency-stat-value {
      font-size: 1.1rem;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
      transition: color 0.3s;
    }
    .latency-stat-value.good { color: var(--green); }
    .latency-stat-value.warn { color: var(--yellow); }
    .latency-stat-value.bad { color: var(--red); }
    .latency-sparkline {
      width: 100%;
      height: 32px;
      border-radius: 6px;
      background: rgba(0,0,0,0.2);
      overflow: hidden;
    }

    /* ===== THEME CREATOR ===== */
    .theme-creator {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 22px;
      margin-bottom: 16px;
    }
    .theme-creator-title {
      font-size: 0.78rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-secondary);
      margin-bottom: 18px;
    }
    .theme-creator-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-bottom: 18px;
    }
    .theme-color-field {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .theme-color-field label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      min-width: 80px;
    }
    .theme-color-field input[type="color"] {
      -webkit-appearance: none;
      border: 1px solid var(--border);
      border-radius: 8px;
      width: 40px;
      height: 32px;
      cursor: pointer;
      background: transparent;
      padding: 2px;
    }
    .theme-color-field input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 2px;
    }
    .theme-color-field input[type="color"]::-webkit-color-swatch {
      border: none;
      border-radius: 5px;
    }
    .theme-creator-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .theme-preview-strip {
      display: flex;
      gap: 6px;
      margin-bottom: 16px;
      padding: 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: var(--bg);
    }
    .theme-preview-swatch {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: 1px solid var(--border);
    }
    .theme-preview-text {
      font-size: 0.72rem;
      color: var(--text-secondary);
      align-self: center;
      margin-left: 8px;
    }

    /* ===== DRAG REORDER WIDGETS ===== */
    .monitor-widget {
      position: relative;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }
    .monitor-widget.dragging {
      opacity: 0.4;
      transform: scale(0.98);
    }
    .monitor-widget.drag-over {
      border-top: 2px solid var(--accent);
    }
    .drag-handle {
      position: absolute;
      top: 8px;
      right: 8px;
      cursor: grab;
      color: var(--text-tertiary);
      font-size: 0.85rem;
      opacity: 0;
      transition: opacity 0.2s ease;
      z-index: 5;
      padding: 4px 6px;
      border-radius: 6px;
      background: var(--surface);
      user-select: none;
      line-height: 1;
    }
    .drag-handle:active {
      cursor: grabbing;
    }
    .monitor-widget:hover .drag-handle {
      opacity: 0.7;
    }
    .drag-handle:hover {
      opacity: 1 !important;
      background: var(--surface-hover);
    }

    /* ===== DIFF VIEWER ===== */
    .diff-viewer {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 22px;
      margin-bottom: 16px;
    }
    .diff-viewer-title {
      font-size: 0.78rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-secondary);
      margin-bottom: 16px;
    }
    .diff-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-bottom: 14px;
    }
    .diff-inputs textarea {
      width: 100%;
      min-height: 160px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      padding: 12px;
      resize: vertical;
    }
    .diff-inputs textarea:focus {
      outline: none;
      border-color: var(--accent);
    }
    .diff-inputs label {
      font-size: 0.7rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 6px;
      display: block;
    }
    .diff-output {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.74rem;
      line-height: 1.7;
      max-height: 400px;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    .diff-added {
      background: rgba(52, 211, 153, 0.12);
      color: #34d399;
      display: block;
      padding: 1px 8px;
      border-radius: 3px;
      margin: 1px 0;
    }
    .diff-removed {
      background: rgba(251, 113, 133, 0.12);
      color: #fb7185;
      display: block;
      padding: 1px 8px;
      border-radius: 3px;
      margin: 1px 0;
      text-decoration: line-through;
    }
    .diff-unchanged {
      display: block;
      padding: 1px 8px;
      color: var(--text-secondary);
    }

    /* ===== INFINITE SCROLL LOGS ===== */
    .log-loading-indicator {
      text-align: center;
      padding: 12px;
      color: var(--text-tertiary);
      font-size: 0.72rem;
      font-weight: 500;
      display: none;
    }
    .log-loading-indicator.visible { display: block; }
    .log-load-more-hint {
      text-align: center;
      padding: 8px;
      color: var(--text-tertiary);
      font-size: 0.68rem;
      opacity: 0.6;
    }

    /* ===== CODE SNIPPET TOGGLE ===== */
    .code-toggle-wrap {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 4px;
    }
    .code-toggle-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 14px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-secondary);
      font-size: 0.72rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    .code-toggle-btn:hover { border-color: var(--border-hover); color: var(--text); }
    .code-toggle-btn.active {
      background: var(--accent-dim);
      border-color: var(--accent);
      color: var(--accent);
    }
    .code-mode-textarea {
      font-family: 'JetBrains Mono', monospace !important;
      font-size: 0.82rem !important;
      line-height: 1.5 !important;
      tab-size: 2;
    }

    /* ===== KANBAN WIP LIMITS ===== */
    .wip-badge {
      display: inline-flex;
      align-items: center;
      gap: 2px;
      font-size: 0.65rem;
      font-weight: 600;
      padding: 2px 8px;
      border-radius: 10px;
      background: var(--surface);
      color: var(--text-secondary);
      border: 1px solid var(--border);
      margin-left: 6px;
    }
    .wip-badge.warning {
      background: var(--red-dim);
      color: var(--red);
      border-color: rgba(251,113,133,0.3);
      animation: wipPulse 2s ease-in-out infinite;
    }
    .wip-badge.ok {
      background: var(--green-dim);
      color: var(--green);
      border-color: rgba(52,211,153,0.2);
    }
    @keyframes wipPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
    .wip-config-btn {
      background: none;
      border: none;
      color: var(--text-tertiary);
      cursor: pointer;
      font-size: 0.7rem;
      padding: 2px 4px;
      transition: color 0.2s;
    }
    .wip-config-btn:hover { color: var(--text); }
    .wip-config-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(4px);
    }
    .wip-config-modal {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      min-width: 300px;
      max-width: 400px;
    }
    .wip-config-modal h3 {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 16px;
      color: var(--text);
    }
    .wip-config-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .wip-config-row:last-child { border-bottom: none; }
    .wip-config-row label { font-size: 0.78rem; color: var(--text-secondary); }
    .wip-config-row input[type="number"] {
      width: 60px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.78rem;
      text-align: center;
      font-family: 'JetBrains Mono', monospace;
    }
    .wip-config-row input[type="number"]:focus { border-color: var(--accent); outline: none; }

    /* ===== MULTIPLE KANBAN BOARDS ===== */
    .board-selector-wrap { display: flex; align-items: center; gap: 8px; }
    .board-selector {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 5px 12px;
      border-radius: 7px;
      font-size: 0.75rem;
      font-family: 'Inter', sans-serif;
      cursor: pointer;
      transition: all 0.2s;
      appearance: none;
      -webkit-appearance: none;
      padding-right: 28px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%237a7a8e'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
    }
    .board-selector:hover { border-color: var(--border-hover); }
    .board-selector:focus { border-color: var(--accent); outline: none; }
    .board-new-btn {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
      padding: 5px 10px;
      border-radius: 7px;
      font-size: 0.72rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
      white-space: nowrap;
    }
    .board-new-btn:hover { border-color: var(--border-hover); color: var(--text); }
    .board-delete-btn {
      background: none;
      border: 1px solid var(--border);
      color: var(--text-tertiary);
      padding: 5px 8px;
      border-radius: 7px;
      font-size: 0.68rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', sans-serif;
    }
    .board-delete-btn:hover {
      border-color: rgba(251,113,133,0.3);
      color: var(--red);
      background: var(--red-dim);
    }

    /* ===== ACTIVITY FEED ===== */
    .activity-feed {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 22px;
      margin-bottom: 16px;
    }
    .activity-feed-title {
      font-size: 0.78rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-secondary);
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .activity-feed-list {
      max-height: 350px;
      overflow-y: auto;
    }
    .activity-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
      font-size: 0.78rem;
    }
    .activity-item:last-child {
      border-bottom: none;
    }
    .activity-item-icon {
      font-size: 0.9rem;
      line-height: 1;
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      background: var(--surface-hover);
    }
    .activity-item-body {
      flex: 1;
      min-width: 0;
    }
    .activity-item-text {
      color: var(--text);
      line-height: 1.4;
    }
    .activity-item-time {
      font-size: 0.68rem;
      color: var(--text-tertiary);
      margin-top: 2px;
    }
    .activity-empty {
      text-align: center;
      color: var(--text-tertiary);
      font-size: 0.78rem;
      padding: 30px 0;
    }

    /* ===== PRINT STYLESHEET ===== */
    @media print {
      body { background: #fff !important; color: #000 !important; }
      header, .footer, .header-nav, #auth-gate, .btn, .changelog-overlay,
      .command-palette, .gallery-nav, .gallery-dots, .sc-refresh-btn,
      .conn-badge, .header-clock { display: none !important; }
      #dashboard { padding: 10px !important; background: #fff !important; }
      .page { display: block !important; opacity: 1 !important; }
      .card, .kanban-card, .note-card {
        break-inside: avoid; border: 1px solid #ccc !important;
        background: #fff !important; box-shadow: none !important;
        color: #000 !important; margin-bottom: 8px;
      }
      .sc-table { font-size: 9pt; }
      .sc-table th, .sc-table td { border: 1px solid #ccc; padding: 4px 6px; }
      .sc-artwork { width: 20px; height: 20px; }
      a { color: #000 !important; text-decoration: underline; }
    }

    /* ===== DAILY STANDUP WIDGET ===== */
    .standup-widget { padding: 16px 22px; }
    .standup-section-title { font-size: 0.68rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-tertiary); font-weight: 600; margin-bottom: 8px; display: flex; align-items: center; gap: 6px; }
    .standup-section-title .standup-icon { font-size: 0.8rem; }
    .standup-items { margin-bottom: 14px; }
    .standup-item { font-size: 0.82rem; color: var(--text-secondary); padding: 4px 0; padding-left: 14px; position: relative; line-height: 1.5; }
    .standup-item::before { content: ''; position: absolute; left: 0; top: 10px; width: 6px; height: 6px; border-radius: 50%; }
    .standup-done .standup-item::before { background: var(--green); }
    .standup-progress .standup-item::before { background: var(--accent); }
    .standup-blockers .standup-item::before { background: var(--red); }
    .standup-empty { font-size: 0.78rem; color: var(--text-tertiary); font-style: italic; padding: 2px 0 12px; }

    /* ===== WIDGET VISIBILITY GEAR ===== */
    .widget-vis-wrap { position: relative; display: inline-block; }
    .widget-vis-btn { background: var(--surface); border: 1px solid var(--border); color: var(--text-tertiary); width: 28px; height: 28px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
    .widget-vis-btn:hover { border-color: var(--border-hover); color: var(--text); background: var(--surface-hover); }
    .widget-vis-dropdown { position: absolute; top: 36px; right: 0; background: var(--surface-solid); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 8px 0; min-width: 220px; z-index: 100; display: none; box-shadow: 0 12px 40px rgba(0,0,0,0.4); }
    .widget-vis-dropdown.open { display: block; }
    .widget-vis-dropdown label { display: flex; align-items: center; gap: 10px; padding: 7px 14px; font-size: 0.78rem; color: var(--text-secondary); cursor: pointer; transition: background 0.15s; }
    .widget-vis-dropdown label:hover { background: var(--surface-hover); color: var(--text); }
    .widget-vis-dropdown input[type="checkbox"] { accent-color: var(--accent); width: 14px; height: 14px; }

    /* ===== MESSAGE READ RECEIPTS ===== */
    .msg-unread-badge { display: inline-flex; align-items: center; justify-content: center; background: var(--accent); color: #fff; font-size: 0.6rem; font-weight: 700; min-width: 18px; height: 18px; border-radius: 9px; padding: 0 5px; margin-left: 6px; vertical-align: middle; }
    .msg-read-indicator { font-size: 0.65rem; color: var(--text-tertiary); margin-top: 2px; }

    /* ===== GANTT CHART ===== */
    .gantt-container { overflow-x: auto; overflow-y: auto; max-height: 70vh; padding: 16px; background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); }
    .gantt-header-row { display: flex; position: sticky; top: 0; z-index: 2; background: var(--surface-solid); border-bottom: 1px solid var(--border); min-width: max-content; }
    .gantt-header-cell { min-width: 40px; width: 40px; text-align: center; font-size: 0.6rem; color: var(--text-tertiary); padding: 4px 0; border-right: 1px solid var(--border); flex-shrink: 0; }
    .gantt-header-cell.gantt-today { background: var(--accent-dim); color: var(--accent); font-weight: 600; }
    .gantt-rows { min-width: max-content; }
    .gantt-row { display: flex; align-items: center; height: 32px; border-bottom: 1px solid var(--border); position: relative; }
    .gantt-label { width: 160px; min-width: 160px; font-size: 0.72rem; color: var(--text-secondary); padding: 0 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; position: sticky; left: 0; z-index: 1; background: var(--surface-solid); border-right: 1px solid var(--border); }
    .gantt-bar-area { flex: 1; position: relative; height: 100%; display: flex; align-items: center; }
    .gantt-bar { position: absolute; height: 18px; border-radius: 4px; min-width: 8px; opacity: 0.85; transition: opacity 0.15s; cursor: default; }
    .gantt-bar:hover { opacity: 1; }
    .gantt-bar.col-backlog { background: #6b7280; }
    .gantt-bar.col-inprogress { background: #3b82f6; }
    .gantt-bar.col-done { background: var(--green); }
    .gantt-bar-text { font-size: 0.58rem; color: #fff; padding: 0 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 18px; }
    .gantt-grid-line { position: absolute; top: 0; bottom: 0; width: 1px; background: var(--border); pointer-events: none; }
    .gantt-today-line { position: absolute; top: 0; bottom: 0; width: 2px; background: var(--accent); z-index: 1; pointer-events: none; }

    /* ===== AI CHATBOT WIDGET ===== */
    .chatbot-fab { position:fixed;bottom:24px;right:24px;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,var(--accent),#6366f1);border:none;color:#fff;font-size:22px;cursor:pointer;z-index:9999;box-shadow:0 4px 20px rgba(139,124,246,0.4);transition:transform 0.2s,box-shadow 0.2s;display:flex;align-items:center;justify-content:center; }
    .chatbot-fab:hover { transform:scale(1.08);box-shadow:0 6px 28px rgba(139,124,246,0.5); }
    .chatbot-panel { position:fixed;bottom:86px;right:24px;width:300px;height:400px;background:var(--surface-solid);border:1px solid var(--border);border-radius:var(--radius);z-index:9999;display:none;flex-direction:column;overflow:hidden;box-shadow:0 12px 40px rgba(0,0,0,0.5); }
    .chatbot-panel.open { display:flex; }
    .chatbot-header { padding:12px 16px;border-bottom:1px solid var(--border);font-size:0.82rem;font-weight:600;color:var(--text);display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,0.02); }
    .chatbot-header button { background:none;border:none;color:var(--text-tertiary);cursor:pointer;font-size:16px; }
    .chatbot-messages { flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:8px; }
    .chatbot-msg { max-width:85%;padding:8px 12px;border-radius:10px;font-size:0.78rem;line-height:1.5;word-wrap:break-word; }
    .chatbot-msg.bot { background:rgba(139,124,246,0.12);color:var(--text);align-self:flex-start;border-bottom-left-radius:2px; }
    .chatbot-msg.user { background:var(--accent);color:#fff;align-self:flex-end;border-bottom-right-radius:2px; }
    .chatbot-input-wrap { padding:10px;border-top:1px solid var(--border);display:flex;gap:6px; }
    .chatbot-input-wrap input { flex:1;background:var(--surface);border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:8px;font-size:0.78rem;font-family:'Inter',sans-serif;outline:none; }
    .chatbot-input-wrap input:focus { border-color:var(--accent); }
    .chatbot-input-wrap button { background:var(--accent);border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:0.78rem;font-weight:500; }

    /* ===== DRAG-DROP FILE UPLOAD ===== */
    .note-dropzone-overlay { position:absolute;inset:0;background:rgba(139,124,246,0.08);border:2px dashed var(--accent);border-radius:var(--radius-sm);display:none;align-items:center;justify-content:center;z-index:10;pointer-events:none; }
    .note-dropzone-overlay.active { display:flex; }
    .note-dropzone-overlay span { color:var(--accent);font-size:0.85rem;font-weight:600; }
    .note-attachments { margin-top:8px;display:flex;flex-wrap:wrap;gap:6px; }
    .note-attachment-chip { display:inline-flex;align-items:center;gap:4px;padding:3px 10px;background:var(--accent-dim);border:1px solid rgba(139,124,246,0.2);border-radius:12px;font-size:0.68rem;color:var(--accent); }

    /* ===== VOICE MEMO RECORDER ===== */
    .voice-memo-btn { background:var(--surface);border:1px solid var(--border);color:var(--text-secondary);width:34px;height:34px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s;font-size:14px; }
    .voice-memo-btn:hover { border-color:var(--border-hover);color:var(--text);background:var(--surface-hover); }
    .voice-memo-btn.recording { border-color:var(--red);color:var(--red);background:var(--red-dim);animation:pulse 1.2s ease-in-out infinite; }
    .voice-memo-indicator { display:inline-flex;align-items:center;gap:6px;font-size:0.72rem;color:var(--red);font-weight:500; }
    .voice-memo-dot { width:8px;height:8px;border-radius:50%;background:var(--red);animation:pulse 1s ease-in-out infinite; }
    .note-audio-player { margin-top:8px; }
    .note-audio-player audio { width:100%;height:32px;border-radius:6px; }

    /* ===== HAMBURGER BUTTON (hidden on desktop) ===== */
    .hamburger-btn {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 5px;
      width: 44px;
      height: 44px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      cursor: pointer;
      padding: 10px;
      flex-shrink: 0;
      transition: all 0.2s;
      z-index: 501;
      position: relative;
    }
    .hamburger-btn:hover {
      border-color: var(--border-hover);
      background: var(--surface-hover);
    }
    .hamburger-line {
      display: block;
      width: 20px;
      height: 2px;
      background: var(--text-secondary);
      border-radius: 2px;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      transform-origin: center;
    }
    .hamburger-btn.open .hamburger-line:nth-child(1) {
      transform: translateY(7px) rotate(45deg);
    }
    .hamburger-btn.open .hamburger-line:nth-child(2) {
      opacity: 0;
      transform: scaleX(0);
    }
    .hamburger-btn.open .hamburger-line:nth-child(3) {
      transform: translateY(-7px) rotate(-45deg);
    }
    .nav-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 499;
      backdrop-filter: blur(4px);
    }
    .nav-overlay.visible { display: block; }

    /* ===== MOBILE BOTTOM NAV BAR ===== */
    .mobile-bottom-nav {
      display: none;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 600;
      background: var(--bg);
      border-top: 1px solid var(--border);
      padding: 4px 0;
      padding-bottom: calc(4px + env(safe-area-inset-bottom, 0px));
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }
    .mobile-bottom-nav-inner {
      display: flex;
      justify-content: space-around;
      align-items: center;
      max-width: 100%;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .mobile-bottom-nav-inner::-webkit-scrollbar { display: none; }
    .mobile-nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 6px 8px;
      min-width: 52px;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.6rem;
      font-weight: 500;
      border-radius: 8px;
      transition: all 0.2s;
      -webkit-tap-highlight-color: transparent;
      cursor: pointer;
    }
    .mobile-nav-item:hover, .mobile-nav-item:active {
      color: var(--text);
      background: rgba(255,255,255,0.05);
    }
    .mobile-nav-item.active {
      color: var(--accent);
    }
    .mobile-nav-icon {
      font-size: 1.15rem;
      line-height: 1;
    }

    /* ===== COMPREHENSIVE MOBILE RESPONSIVE ===== */

    /* --- Tablet breakpoint (768px) --- */
    @media (max-width: 768px) {
      body { overflow-x: hidden; padding-bottom: 64px; }

      /* Show mobile bottom nav */
      .mobile-bottom-nav { display: block; }

      /* Hide hamburger - we use bottom nav now */
      .hamburger-btn { display: none !important; }

      #dashboard { padding: 16px; }

      /* Header: wrap and stack */
      header {
        flex-wrap: wrap;
        gap: 10px;
        padding: 14px 0 16px;
        margin-bottom: 16px;
      }

      /* Hide header nav on mobile - bottom nav replaces it */
      .header-nav {
        display: none !important;
      }
      .nav-link {
        padding: 12px 16px;
        font-size: 0.92rem;
        border-radius: 10px;
        min-height: 44px;
        display: flex;
        align-items: center;
      }

      /* Header right: wrap and shrink */
      .header-right {
        gap: 6px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      .header-search-wrap { order: 10; width: 100%; }
      .header-search-input { width: 100% !important; }
      .header-search-input:focus { width: 100% !important; }
      .header-search-dropdown { width: 100%; left: 0; right: 0; }

      /* Hide less important header items on tablet */
      .ambient-bar { display: none !important; }
      .weather-widget { display: none !important; }

      /* Cards: 2 columns */
      .cards { grid-template-columns: repeat(2, 1fr); gap: 10px; }
      .card { padding: 14px 16px; border-radius: 12px; }

      /* Stats bar: 2 columns */
      .stats-bar { grid-template-columns: repeat(2, 1fr); gap: 10px; }

      /* Progress rings: 2 columns */
      .progress-rings { grid-template-columns: repeat(2, 1fr); gap: 10px; }

      /* Sparkline: single column */
      .sparkline-row { grid-template-columns: 1fr; }

      /* Kanban: horizontal scroll */
      .kanban-board {
        display: flex !important;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        gap: 14px;
        padding-bottom: 12px;
      }
      .kanban-column {
        min-width: 280px;
        flex-shrink: 0;
        scroll-snap-align: start;
      }

      /* Gallery: smaller art, overflow scroll */
      .gallery-art-frame {
        padding: 20px 16px;
        max-width: 100vw;
        border-radius: 12px;
      }
      .gallery-art {
        font-size: 0.4rem;
        overflow-x: auto;
        max-width: 100%;
        display: block;
      }
      .gallery-title { font-size: 1rem; letter-spacing: 2px; }
      .gallery-desc { font-size: 0.75rem; }
      .gallery-nav { width: 40px; height: 40px; font-size: 1.1rem; }
      .gallery-nav.prev { left: 8px; }
      .gallery-nav.next { right: 8px; }
      .gallery-slide { padding: 24px 10px; }
      .gallery-slideshow { min-height: calc(100vh - 140px); }

      /* SoundCloud / Spinnin tables */
      .sc-table-wrap { max-height: calc(100vh - 240px); }
      .sc-controls { flex-direction: column; }
      .sc-search { min-width: 100%; }

      /* Touch targets: minimum 44px */
      .btn, .btn-send, .btn-add-task, .kanban-task-btn, .theme-toggle,
      .crt-toggle, .notif-bell, .prefs-gear-btn, .widget-vis-btn,
      .badge-btn { min-height: 44px; min-width: 44px; }

      /* Section adjustments */
      .section { border-radius: 12px; margin-bottom: 12px; }
      .section-header { padding: 12px 16px; font-size: 0.70rem; }

      /* Footer */
      .footer { padding: 16px; font-size: 0.68rem; }

      /* Heatmap scroll */
      .heatmap-section { overflow-x: auto; }

      /* Latency */
      .latency-card { overflow-x: auto; }

      /* Log viewer */
      .log-viewer { max-height: 300px; }
      .log-entry { flex-wrap: wrap; gap: 6px; }
      .log-msg { width: 100%; }

      /* Notes */
      .notes-toolbar { flex-wrap: wrap; gap: 8px; }
      .note-card { padding: 14px; }

      /* Pomodoro / Fortune grid */
      [data-widget="pomo-fortune"] { grid-template-columns: 1fr !important; }

      /* Calendar */
      .cal-grid { font-size: 0.68rem; }
    }

    /* --- Phone breakpoint (480px) --- */
    @media (max-width: 480px) {
      #dashboard { padding: 10px 12px; }

      /* Header more compact */
      header { gap: 8px; padding: 10px 0 12px; margin-bottom: 12px; }
      .header-logo { width: 28px; height: 28px; font-size: 12px; border-radius: 8px; }
      .header-text h1 { font-size: 0.78rem; }
      .header-text span { font-size: 0.62rem; }
      .header-left { gap: 8px; }

      /* Hide more header items */
      .header-clock { display: none !important; }
      .crt-toggle { display: none !important; }

      /* Header right compact */
      .header-right { gap: 4px; }
      .conn-badge { font-size: 0.62rem; padding: 4px 8px; }
      .conn-badge span { display: none; }
      .btn { font-size: 0.68rem; padding: 5px 10px; }
      #logout-btn { font-size: 0.65rem; padding: 6px 10px; }

      /* Cards: single column for very small screens */
      .cards { grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 12px; }
      .card .label { font-size: 0.62rem; margin-bottom: 4px; }
      .card .value { font-size: 0.95rem; }
      .card .value.dim { font-size: 0.72rem; }

      /* Stats bar: single column */
      .stats-bar { grid-template-columns: 1fr 1fr; gap: 8px; }
      .stat-item { padding: 10px 12px; }

      /* Progress rings: 2 col still ok */
      .progress-rings { grid-template-columns: repeat(2, 1fr); gap: 8px; }
      .progress-ring-card { padding: 12px; }

      /* Kanban column wider on phone to fill better */
      .kanban-column { min-width: 260px; }
      .kanban-toolbar { flex-wrap: wrap; gap: 8px; }
      .kanban-task-card { padding: 12px; }
      .kanban-form-input { font-size: 0.82rem; }
      .btn-add-task { font-size: 0.72rem; padding: 8px 14px; }

      /* Gallery even more compact */
      .gallery-art { font-size: 0.32rem; line-height: 1.1; }
      .gallery-art-frame { padding: 14px 10px; }
      .gallery-meta { margin-top: 16px; }
      .gallery-title { font-size: 0.88rem; letter-spacing: 1px; }
      .gallery-desc { font-size: 0.7rem; line-height: 1.6; }
      .gallery-dots { gap: 8px; padding: 14px 0 6px; }
      .gallery-dot { width: 8px; height: 8px; }
      .gallery-counter { font-size: 0.65rem; }

      /* Message area */
      .msg-area { padding: 12px 14px; }
      .msg-area textarea { font-size: 0.82rem; padding: 10px; min-height: 60px; }
      .send-row { flex-wrap: wrap; gap: 8px; }
      .send-row .hint { font-size: 0.62rem; max-width: 100%; }
      .btn-send { padding: 8px 16px; font-size: 0.75rem; }

      /* Health panel */
      #health-panel > div { gap: 8px !important; }
      .health-item { font-size: 0.72rem; }

      /* Log viewer */
      .log-viewer { padding: 4px 6px; max-height: 280px; }
      .log-entry { padding: 6px; gap: 6px; }
      .log-ts { font-size: 0.62rem; }
      .log-type { font-size: 0.58rem; padding: 1px 5px; }
      .log-msg { font-size: 0.75rem; }

      /* Notes */
      .note-card { padding: 12px; }
      .note-card-title { font-size: 0.85rem; }
      .note-card-content { font-size: 0.75rem; }

      /* SoundCloud */
      .sc-title { font-size: 0.92rem; }
      .sc-stats { gap: 12px; font-size: 0.68rem; }
      .sc-table { font-size: 0.72rem; }
      .sc-th { padding: 8px 10px; font-size: 0.65rem; }

      /* Auth gate */
      #auth-gate { padding-top: 15vh; }
      .auth-logo { width: 44px; height: 44px; font-size: 18px; }
      #auth-gate h1 { font-size: 1.1rem; }
      #auth-gate input { padding: 12px 14px; }

      /* Section */
      .section { border-radius: 10px; }
      .section-header { padding: 10px 14px; font-size: 0.68rem; }

      /* Chatbot */
      .chatbot-panel { width: calc(100vw - 20px); right: 10px; bottom: 10px; }
    }

    /* --- Extra small phones (360px) --- */
    @media (max-width: 360px) {
      #dashboard { padding: 8px 10px; }

      .cards { grid-template-columns: 1fr; gap: 6px; }
      .card .value { font-size: 0.88rem; }

      .header-text h1 { font-size: 0.72rem; }
      .header-left { gap: 6px; }

      .stats-bar { grid-template-columns: 1fr; }

      .kanban-column { min-width: 240px; }

      .gallery-art { font-size: 0.26rem; }

      .sc-table { font-size: 0.68rem; }
    }

    /* --- Landscape phone --- */
    @media (max-width: 768px) and (orientation: landscape) {
      .gallery-slideshow { min-height: calc(100vh - 100px); }
      .gallery-slide { padding: 16px 10px; }
      .gallery-art-frame { max-height: 50vh; padding: 14px 20px; }
      .gallery-nav { width: 36px; height: 36px; font-size: 0.9rem; }

      header { padding: 8px 0 10px; margin-bottom: 10px; }
    }

    /* Safe area insets for notched phones */
    @supports (padding: env(safe-area-inset-bottom)) {
      @media (max-width: 768px) {
        #dashboard {
          padding-left: calc(12px + env(safe-area-inset-left));
          padding-right: calc(12px + env(safe-area-inset-right));
          padding-bottom: calc(16px + env(safe-area-inset-bottom));
        }
        .header-nav.mobile-open {
          padding-left: calc(12px + env(safe-area-inset-left));
          padding-bottom: calc(24px + env(safe-area-inset-bottom));
        }
      }
    }

    /* ===== Konami Code Easter Egg ===== */
    .konami-overlay {
      position: fixed;
      inset: 0;
      z-index: 999999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.88);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      opacity: 0;
      transition: opacity 0.5s ease;
      cursor: pointer;
    }
    .konami-overlay.visible { opacity: 1; }
    .konami-overlay canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .konami-title {
      position: relative;
      z-index: 2;
      font-family: 'Inter', Arial, sans-serif;
      font-size: clamp(2.4rem, 7vw, 5.5rem);
      font-weight: 900;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #fff;
      text-shadow:
        0 0 10px #ff00ff,
        0 0 20px #ff00ff,
        0 0 40px #ff00ff,
        0 0 80px #8b00ff,
        0 0 120px #8b00ff;
      animation: konami-glow 1.8s ease-in-out infinite alternate, konami-float 3s ease-in-out infinite;
      text-align: center;
      padding: 0 1rem;
      user-select: none;
      opacity: 0;
      transform: scale(0.3) translateY(40px);
      transition: opacity 0.6s ease 0.3s, transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s;
    }
    .konami-overlay.visible .konami-title {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    .konami-subtitle {
      position: relative;
      z-index: 2;
      font-family: 'Inter', Arial, sans-serif;
      font-size: clamp(0.9rem, 2.5vw, 1.5rem);
      font-weight: 400;
      color: rgba(255, 255, 255, 0.7);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-top: 1rem;
      text-shadow: 0 0 8px rgba(255, 0, 255, 0.5);
      user-select: none;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease 0.7s, transform 0.6s ease 0.7s;
    }
    .konami-overlay.visible .konami-subtitle {
      opacity: 1;
      transform: translateY(0);
    }
    .konami-dismiss-hint {
      position: absolute;
      bottom: 2.5rem;
      z-index: 2;
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.35);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      opacity: 0;
      transition: opacity 0.6s ease 1.5s;
    }
    .konami-overlay.visible .konami-dismiss-hint { opacity: 1; }
    @keyframes konami-glow {
      0% {
        text-shadow:
          0 0 10px #ff00ff,
          0 0 20px #ff00ff,
          0 0 40px #ff00ff,
          0 0 80px #8b00ff,
          0 0 120px #8b00ff;
        filter: hue-rotate(0deg);
      }
      100% {
        text-shadow:
          0 0 15px #00ffff,
          0 0 30px #00ffff,
          0 0 60px #00ffff,
          0 0 100px #0088ff,
          0 0 150px #0088ff;
        filter: hue-rotate(40deg);
      }
    }
    @keyframes konami-float {
      0%, 100% { transform: scale(1) translateY(0); }
      50% { transform: scale(1.03) translateY(-8px); }
    }
    @keyframes konami-shake {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      10% { transform: translate(-4px, -2px) rotate(-0.5deg); }
      20% { transform: translate(4px, 2px) rotate(0.5deg); }
      30% { transform: translate(-3px, 3px) rotate(-0.3deg); }
      40% { transform: translate(3px, -3px) rotate(0.3deg); }
      50% { transform: translate(-2px, 1px) rotate(-0.2deg); }
      60% { transform: translate(2px, -1px) rotate(0.2deg); }
      70% { transform: translate(-1px, 2px) rotate(-0.1deg); }
      80% { transform: translate(1px, -2px) rotate(0.1deg); }
      90% { transform: translate(-1px, -1px) rotate(0deg); }
    }
    body.konami-shaking {
      animation: konami-shake 0.6s ease-in-out;
    }

    /* ===== REACTION TIME TEST ===== */
    .reaction-test {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      text-align: center;
      position: relative;
    }
    .reaction-zone {
      width: 100%;
      min-height: 200px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      user-select: none;
      margin-bottom: 12px;
      font-family: 'JetBrains Mono', monospace;
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
    }
    .reaction-zone.state-idle {
      background: rgba(139, 124, 246, 0.1);
      border: 2px dashed rgba(139, 124, 246, 0.3);
      color: var(--text-secondary);
    }
    .reaction-zone.state-waiting {
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      border: 2px solid #ef4444;
      color: #fff;
      box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
    }
    .reaction-zone.state-ready {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      border: 2px solid #fbbf24;
      color: #fff;
      box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
    }
    .reaction-zone.state-go {
      background: linear-gradient(135deg, #10b981, #059669);
      border: 2px solid #34d399;
      color: #fff;
      box-shadow: 0 0 40px rgba(16, 185, 129, 0.4);
      animation: reaction-pulse 0.3s ease;
    }
    .reaction-zone.state-tooearly {
      background: linear-gradient(135deg, #dc2626, #991b1b);
      border: 2px solid #f87171;
      color: #fff;
      box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
    }
    .reaction-zone.state-result {
      background: linear-gradient(135deg, #7c3aed, #6d28d9);
      border: 2px solid #8b7cf6;
      color: #fff;
      box-shadow: 0 0 30px rgba(139, 124, 246, 0.3);
    }
    .reaction-zone.state-done {
      background: linear-gradient(135deg, #7c3aed, #5b21b6);
      border: 2px solid #a78bfa;
      color: #fff;
      box-shadow: 0 0 40px rgba(139, 124, 246, 0.3);
    }
    @keyframes reaction-pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }
    .reaction-results-list {
      display: flex;
      gap: 6px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .reaction-round-pill {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      padding: 3px 10px;
      border-radius: 20px;
      background: rgba(139, 124, 246, 0.15);
      border: 1px solid rgba(139, 124, 246, 0.3);
      color: var(--accent);
    }
    .reaction-round-pill.active {
      background: rgba(16, 185, 129, 0.2);
      border-color: rgba(16, 185, 129, 0.4);
      color: var(--green);
    }
    .reaction-avg {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--accent);
      margin: 6px 0;
    }
    .reaction-rating {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }
    .reaction-best-display {
      font-size: 0.68rem;
      color: var(--text-tertiary);
      margin-top: 4px;
    }

    /*  Conway's Game of Life  */
    .life-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .life-card-preview {
      display: grid;
      grid-template-columns: repeat(6,1fr);
      gap: 2px;
      width: 80px;
      margin: 12px auto;
    }
    .life-card-cell { aspect-ratio: 1; border-radius: 2px; }
    .life-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .life-modal.active { display: flex; }
    .life-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 500px;
      width: 95%;
    }
    .life-controls { display: flex; gap: 8px; justify-content: center; margin: 10px 0; flex-wrap: wrap; }
    .life-canvas { border: 1px solid var(--border-color); border-radius: 8px; cursor: crosshair; max-width: 100%; }
    .life-gen { font-size: 0.7rem; color: var(--text-tertiary); margin-top: 6px; }

    /*  Minesweeper  */
    .mines-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .mines-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .mines-modal.active { display: flex; }
    .mines-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 440px;
      width: 95%;
    }
    .mines-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .mines-info {
      background: var(--bg-secondary);
      border-radius: 6px;
      padding: 4px 10px;
      font-family: monospace;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-primary);
      min-width: 45px;
    }
    .mines-face {
      font-size: 1.5rem;
      cursor: pointer;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 2px 8px;
      transition: transform 0.1s;
    }
    .mines-face:hover { transform: scale(1.1); }
    .mines-board {
      display: inline-grid;
      gap: 1px;
      background: var(--border-color);
      border-radius: 6px;
      overflow: hidden;
      margin: 0 auto 10px;
    }
    .mines-cell {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
      cursor: pointer;
      background: #2a2740;
      transition: background 0.1s;
      user-select: none;
    }
    .mines-cell:hover { background: #3a3760; }
    .mines-cell.revealed { background: #1e1b2e; cursor: default; }
    .mines-cell.flagged { background: #2a2740; }
    .mines-cell.mine { background: #dc2626; }
    .mines-cell[data-n="1"] { color: #60a5fa; }
    .mines-cell[data-n="2"] { color: #34d399; }
    .mines-cell[data-n="3"] { color: #f87171; }
    .mines-cell[data-n="4"] { color: #a78bfa; }
    .mines-cell[data-n="5"] { color: #f97316; }
    .mines-cell[data-n="6"] { color: #2dd4bf; }
    .mines-cell[data-n="7"] { color: #e879f9; }
    .mines-cell[data-n="8"] { color: #fbbf24; }

    /*  Barrel Roll  */
    @keyframes barrelRoll {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .barrel-rolling {
      animation: barrelRoll 1s ease-in-out;
    }

    /*  Morse Code Translator  */
    .morse-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .morse-input, .morse-output {
      background: var(--input-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-primary);
      padding: 8px 12px;
      width: 100%;
      font-size: 0.75rem;
      margin: 4px 0;
      font-family: 'JetBrains Mono', monospace;
    }
    .morse-output { min-height: 36px; text-align: left; word-break: break-all; }
    .morse-play-btn {
      background: #34d399;
      color: #000;
      border: none;
      border-radius: 6px;
      padding: 6px 14px;
      font-size: 0.7rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 6px;
      transition: opacity 0.15s;
    }
    .morse-play-btn:hover { opacity: 0.85; }

    /*  Color Picker  */
    .colorpick-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .colorpick-swatch {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      margin: 8px auto;
      border: 2px solid var(--border-color);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    .colorpick-swatch input[type="color"] {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    .colorpick-values {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.68rem;
      color: var(--text-secondary);
      line-height: 1.8;
    }
    .colorpick-palette {
      display: flex;
      gap: 4px;
      justify-content: center;
      margin-top: 8px;
    }
    .colorpick-chip {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: transform 0.1s;
    }
    .colorpick-chip:hover { transform: scale(1.15); }
    .colorpick-copy {
      font-size: 0.6rem;
      color: var(--text-tertiary);
      margin-top: 4px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .colorpick-copy.show { opacity: 1; }

    /*  Disco Mode  */
    .disco-toggle-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .disco-btn {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: conic-gradient(#f43f5e, #f97316, #fbbf24, #34d399, #60a5fa, #a78bfa, #f43f5e);
      border: 3px solid var(--border-color);
      cursor: pointer;
      font-size: 1.5rem;
      margin: 12px auto;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }
    .disco-btn:hover { transform: scale(1.1); }
    .disco-btn.active { animation: discoSpin 0.5s linear infinite; border-color: #fbbf24; }
    @keyframes discoSpin { to { transform: rotate(360deg); } }
    .disco-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 9990;
      pointer-events: none;
      mix-blend-mode: overlay;
    }
    .disco-overlay.active {
      display: block;
      animation: discoColors 0.4s linear infinite;
    }
    @keyframes discoColors {
      0% { background: rgba(255,0,0,0.15); }
      16% { background: rgba(255,165,0,0.15); }
      33% { background: rgba(255,255,0,0.15); }
      50% { background: rgba(0,255,0,0.15); }
      66% { background: rgba(0,0,255,0.15); }
      83% { background: rgba(128,0,255,0.15); }
      100% { background: rgba(255,0,0,0.15); }
    }
    .disco-ball {
      display: none;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      z-index: 9991;
      pointer-events: none;
      animation: discoBall 2s ease-in-out infinite;
    }
    .disco-ball.active { display: block; }
    @keyframes discoBall { 0%,100% { transform: translateX(-50%) rotate(-15deg); } 50% { transform: translateX(-50%) rotate(15deg); } }

    /*  Binary Clock  */
    .binclock-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .binclock-display {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 12px 0;
    }
    .binclock-col {
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: center;
    }
    .binclock-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #2a2740;
      transition: background 0.2s, box-shadow 0.2s;
    }
    .binclock-dot.on {
      background: #34d399;
      box-shadow: 0 0 8px #34d399;
    }
    .binclock-sep {
      display: flex;
      align-items: center;
      color: var(--text-tertiary);
      font-weight: 700;
      font-size: 0.8rem;
    }
    .binclock-time {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 8px;
    }

    /*  VHS Effect  */
    .vhs-overlay {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 9989;
      pointer-events: none;
    }
    .vhs-overlay.active { display: block; }
    .vhs-scanlines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.1) 2px, rgba(0,0,0,0.1) 4px);
    }
    .vhs-noise {
      position: absolute;
      inset: 0;
      opacity: 0.05;
      animation: vhsNoise 0.2s steps(4) infinite;
    }
    @keyframes vhsNoise {
      0%,100% { background-position: 0 0; }
      25% { background-position: -5px 5px; }
      50% { background-position: 5px -5px; }
      75% { background-position: -5px -5px; }
    }
    .vhs-tracking {
      position: absolute;
      width: 100%;
      height: 4px;
      background: rgba(255,255,255,0.15);
      animation: vhsTracking 3s linear infinite;
    }
    @keyframes vhsTracking {
      0% { top: -4px; }
      100% { top: 100%; }
    }
    .vhs-timestamp {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: rgba(255,255,255,0.6);
      z-index: 9990;
      pointer-events: none;
      text-shadow: 2px 0 #ff0000, -2px 0 #00ffff;
    }
    .vhs-timestamp.active { display: block; }

    /*  Weather Effects  */
    .weather-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
    }
    .weather-btns { display: flex; gap: 6px; justify-content: center; margin-top: 10px; flex-wrap: wrap; }
    .weather-btn {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 0.7rem;
      color: var(--text-primary);
      transition: background 0.15s, border-color 0.15s;
    }
    .weather-btn:hover { background: var(--border-color); }
    .weather-btn.active { border-color: #60a5fa; background: rgba(96,165,250,0.15); }
    .weather-canvas {
      position: fixed;
      inset: 0;
      z-index: 9988;
      pointer-events: none;
      display: none;
    }
    .weather-canvas.active { display: block; }

    /*  Tarot Card Reader  */
    .tarot-card-widget {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .tarot-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.9);
      align-items: center;
      justify-content: center;
    }
    .tarot-modal.active { display: flex; }
    .tarot-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 500px;
      width: 95%;
    }
    .tarot-cards-row { display: flex; gap: 12px; justify-content: center; margin: 16px 0; flex-wrap: wrap; }
    .tarot-card {
      width: 120px;
      height: 180px;
      border-radius: 10px;
      background: linear-gradient(135deg, #312e81, #6366f1);
      border: 2px solid #a78bfa;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      position: relative;
    }
    .tarot-card.flipped { transform: rotateY(180deg); }
    .tarot-card-front, .tarot-card-back {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      backface-visibility: hidden;
      border-radius: 8px;
      padding: 8px;
    }
    .tarot-card-front {
      background: linear-gradient(135deg, #312e81, #4c1d95);
      font-size: 2rem;
    }
    .tarot-card-back {
      transform: rotateY(180deg);
      background: linear-gradient(135deg, #1e1b4b, #312e81);
    }
    .tarot-card-name {
      font-size: 0.6rem;
      font-weight: 700;
      color: #fbbf24;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }
    .tarot-card-emoji { font-size: 2rem; }
    .tarot-meaning {
      font-size: 0.55rem;
      color: #c4b5fd;
      line-height: 1.4;
      margin-top: 4px;
    }
    .tarot-reading {
      font-size: 0.78rem;
      color: var(--text-secondary);
      line-height: 1.6;
      margin-top: 12px;
      font-style: italic;
      min-height: 40px;
    }

    /*  Mandelbrot Explorer  */
    .fractal-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .fractal-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.9);
      align-items: center;
      justify-content: center;
    }
    .fractal-modal.active { display: flex; }
    .fractal-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 520px;
      width: 95%;
    }
    .fractal-canvas {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      cursor: crosshair;
      max-width: 100%;
    }
    .fractal-controls { display: flex; gap: 6px; justify-content: center; margin-top: 10px; flex-wrap: wrap; }
    .fractal-info { font-size: 0.6rem; color: var(--text-tertiary); margin-top: 6px; font-family: monospace; }

    /*  Flappy Bird  */
    .flappy-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .flappy-modal {
      display: none; position: fixed; inset: 0; z-index: 10000;
      background: rgba(0,0,0,0.9); align-items: center; justify-content: center;
    }
    .flappy-modal.active { display: flex; }
    .flappy-modal-content {
      background: var(--card-bg); border-radius: 16px; padding: 20px;
      text-align: center; border: 1px solid var(--border-color); max-width: 360px; width: 95%;
    }
    .flappy-canvas { border: 1px solid var(--border-color); border-radius: 8px; max-width: 100%; background: #0f172a; }

    /*  Lava Lamp  */
    .lava-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .lava-container {
      width: 80px; height: 160px; margin: 12px auto;
      border-radius: 30px 30px 20px 20px;
      background: linear-gradient(180deg, #1a1a2e, #16213e);
      border: 2px solid #334155;
      position: relative; overflow: hidden;
    }
    .lava-blob {
      position: absolute; border-radius: 50%;
      filter: blur(3px);
      animation: lavaFloat 6s ease-in-out infinite alternate;
    }
    @keyframes lavaFloat {
      0% { transform: translateY(0) scale(1); }
      33% { transform: translateY(-30px) scale(1.2, 0.8); }
      66% { transform: translateY(-60px) scale(0.8, 1.3); }
      100% { transform: translateY(-90px) scale(1.1, 0.9); }
    }
    .lava-cap { width: 100%; height: 10px; background: #475569; border-radius: 20px 20px 0 0; position: absolute; top: 0; }
    .lava-base { width: 100%; height: 12px; background: #475569; border-radius: 0 0 16px 16px; position: absolute; bottom: 0; }
    .lava-colors { display: flex; gap: 4px; justify-content: center; margin-top: 8px; }
    .lava-color-btn {
      width: 20px; height: 20px; border-radius: 50%; cursor: pointer;
      border: 2px solid transparent; transition: border-color 0.15s;
    }
    .lava-color-btn.active { border-color: #fff; }

    /*  JSON Formatter  */
    .json-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .json-textarea {
      background: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 8px; color: var(--text-primary); padding: 8px;
      width: 100%; height: 80px; font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem; resize: vertical;
    }
    .json-output {
      background: #1e1b2e; border: 1px solid var(--border-color);
      border-radius: 8px; padding: 8px; text-align: left;
      font-family: 'JetBrains Mono', monospace; font-size: 0.62rem;
      max-height: 120px; overflow: auto; margin-top: 6px; color: #e2e8f0;
      white-space: pre-wrap; word-break: break-all;
    }
    .json-status { font-size: 0.6rem; margin-top: 4px; }
    .json-valid { color: #34d399; }
    .json-invalid { color: #f87171; }
    .json-key { color: #a78bfa; }
    .json-string { color: #34d399; }
    .json-number { color: #fbbf24; }
    .json-bool { color: #f87171; }
    .json-null { color: #64748b; }

    /*  Pixel Art Editor  */
    .pixelart-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color); cursor: pointer;
    }
    .pixelart-modal {
      display: none; position: fixed; inset: 0; z-index: 10000;
      background: rgba(0,0,0,0.9); align-items: center; justify-content: center;
    }
    .pixelart-modal.active { display: flex; }
    .pixelart-modal-content {
      background: var(--card-bg); border-radius: 16px; padding: 20px;
      text-align: center; border: 1px solid var(--border-color); max-width: 500px; width: 95%;
    }
    .pixelart-canvas {
      border: 1px solid var(--border-color); border-radius: 4px; cursor: crosshair;
      image-rendering: pixelated; max-width: 100%;
    }
    .pixelart-palette { display: flex; gap: 3px; flex-wrap: wrap; justify-content: center; margin: 8px 0; }
    .pixelart-swatch {
      width: 22px; height: 22px; border-radius: 4px; cursor: pointer;
      border: 2px solid transparent; transition: border-color 0.1s;
    }
    .pixelart-swatch.active { border-color: #fff; }
    .pixelart-tools { display: flex; gap: 6px; justify-content: center; margin: 8px 0; flex-wrap: wrap; }

    /*  Breakout  */
    .breakout-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color); cursor: pointer;
    }
    .breakout-modal {
      display: none; position: fixed; inset: 0; z-index: 10000;
      background: rgba(0,0,0,0.9); align-items: center; justify-content: center;
    }
    .breakout-modal.active { display: flex; }
    .breakout-modal-content {
      background: var(--card-bg); border-radius: 16px; padding: 20px;
      text-align: center; border: 1px solid var(--border-color); max-width: 440px; width: 95%;
    }
    .breakout-canvas { border: 1px solid var(--border-color); border-radius: 8px; max-width: 100%; background: #000; }

    /*  World Clock  */
    .worldclock-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .worldclock-list { display: flex; flex-direction: column; gap: 6px; margin-top: 10px; }
    .worldclock-row {
      display: flex; justify-content: space-between; align-items: center;
      background: var(--bg-secondary); border-radius: 8px; padding: 6px 10px;
    }
    .worldclock-city { font-size: 0.7rem; color: var(--text-secondary); }
    .worldclock-time { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; font-weight: 700; color: var(--text-primary); }
    .worldclock-daynight { font-size: 0.75rem; margin-left: 4px; }

    /*  Base64 Tool  */
    .b64-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .b64-textarea {
      background: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 8px; color: var(--text-primary); padding: 8px;
      width: 100%; height: 55px; font-family: 'JetBrains Mono', monospace;
      font-size: 0.62rem; resize: vertical;
    }
    .b64-btns { display: flex; gap: 6px; justify-content: center; margin: 6px 0; }

    /*  Countdown Timer  */
    .countdown-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .countdown-display {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.8rem; font-weight: 800;
      color: var(--text-primary); margin: 10px 0;
      letter-spacing: 2px;
    }
    .countdown-presets { display: flex; gap: 6px; justify-content: center; margin-top: 8px; flex-wrap: wrap; }
    .countdown-input {
      background: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 8px; color: var(--text-primary); padding: 6px 10px;
      width: 80px; font-size: 0.75rem; text-align: center;
      font-family: 'JetBrains Mono', monospace;
    }

    /*  Regex Tester  */
    .regex-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .regex-input {
      background: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 8px; color: var(--text-primary); padding: 8px;
      width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
      margin: 3px 0;
    }
    .regex-result {
      background: #1e1b2e; border: 1px solid var(--border-color);
      border-radius: 8px; padding: 8px; text-align: left;
      font-family: 'JetBrains Mono', monospace; font-size: 0.65rem;
      max-height: 80px; overflow: auto; margin-top: 4px; color: #e2e8f0;
      word-break: break-all; line-height: 1.6;
    }
    .regex-match { background: rgba(139,92,246,0.3); border-radius: 2px; padding: 1px 0; }
    .regex-status { font-size: 0.6rem; margin-top: 3px; }

    /*  Holographic Card  */
    .holo-card-widget {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .holo-demo {
      width: 120px; height: 170px; margin: 12px auto;
      border-radius: 12px;
      background: linear-gradient(135deg, #1e1b4b, #312e81, #4c1d95);
      position: relative; overflow: hidden; cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      font-size: 3rem;
      transition: transform 0.1s;
    }
    .holo-demo::after {
      content: '';
      position: absolute; inset: 0;
      background: linear-gradient(
        105deg,
        transparent 20%,
        rgba(255,255,255,0.08) 30%,
        rgba(255,255,255,0.15) 40%,
        transparent 50%
      );
      transition: all 0.3s;
      pointer-events: none;
    }
    .holo-demo:hover::after {
      background: linear-gradient(
        105deg,
        transparent 10%,
        rgba(255,100,100,0.15) 25%,
        rgba(255,255,100,0.15) 35%,
        rgba(100,255,100,0.15) 45%,
        rgba(100,100,255,0.15) 55%,
        rgba(255,100,255,0.15) 65%,
        transparent 80%
      );
    }

    /*  Aurora Borealis  */
    .aurora-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .aurora-overlay {
      display: none; position: fixed; inset: 0; z-index: 9987;
      pointer-events: none; opacity: 0.4;
    }
    .aurora-overlay.active { display: block; }
    .aurora-band {
      position: absolute; width: 200%; height: 30%;
      left: -50%; filter: blur(40px); opacity: 0.6;
    }
    .aurora-band:nth-child(1) {
      top: 5%; background: linear-gradient(90deg, transparent, #34d399, #22d3ee, transparent);
      animation: auroraDrift 8s ease-in-out infinite alternate;
    }
    .aurora-band:nth-child(2) {
      top: 15%; background: linear-gradient(90deg, transparent, #8b5cf6, #ec4899, transparent);
      animation: auroraDrift 12s ease-in-out infinite alternate-reverse;
    }
    .aurora-band:nth-child(3) {
      top: 8%; background: linear-gradient(90deg, transparent, #60a5fa, #34d399, transparent);
      animation: auroraDrift 10s ease-in-out 2s infinite alternate;
    }
    @keyframes auroraDrift {
      0% { transform: translateX(-20%) skewY(-2deg); }
      100% { transform: translateX(20%) skewY(2deg); }
    }

    /*  Gradient CSS Generator  */
    .gradient-card {
      background: var(--card-bg); border-radius: 16px; padding: 24px;
      text-align: center; border: 1px solid var(--border-color);
    }
    .gradient-preview {
      width: 100%; height: 80px; border-radius: 8px;
      margin: 8px 0; border: 1px solid var(--border-color);
    }
    .gradient-controls { display: flex; flex-direction: column; gap: 6px; }
    .gradient-row { display: flex; gap: 6px; align-items: center; justify-content: center; }
    .gradient-color-input {
      width: 36px; height: 28px; border: none; border-radius: 4px;
      cursor: pointer; background: none; padding: 0;
    }
    .gradient-angle-input {
      width: 50px; background: var(--input-bg); border: 1px solid var(--border-color);
      border-radius: 6px; color: var(--text-primary); padding: 4px 6px;
      font-size: 0.7rem; text-align: center;
    }
    .gradient-css-output {
      background: #1e1b2e; border: 1px solid var(--border-color);
      border-radius: 6px; padding: 6px; font-family: 'JetBrains Mono', monospace;
      font-size: 0.55rem; color: #34d399; cursor: pointer;
      word-break: break-all; text-align: left; margin-top: 6px;
    }
    .gradient-css-output:hover { color: #6ee7b7; }

    /*  Pong Game  */
    .pong-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .pong-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.9);
      align-items: center;
      justify-content: center;
    }
    .pong-modal.active { display: flex; }
    .pong-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 500px;
      width: 95%;
    }
    .pong-canvas {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      max-width: 100%;
      background: #000;
    }
    .pong-score-display {
      font-family: monospace;
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 8px 0;
    }

    /*  Memory Card Game  */
    .memory-card-game {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .memory-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .memory-modal.active { display: flex; }
    .memory-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 420px;
      width: 95%;
    }
    .memory-stats { display: flex; gap: 16px; justify-content: center; margin: 8px 0; }
    .memory-stat-val { font-size: 1.1rem; font-weight: 700; color: var(--text-primary); }
    .memory-stat-lbl { font-size: 0.6rem; text-transform: uppercase; color: var(--text-tertiary); }
    .memory-board {
      display: grid;
      gap: 6px;
      margin: 10px auto;
    }
    .memory-tile {
      aspect-ratio: 1;
      border-radius: 8px;
      background: #6366f1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.3s, background 0.3s;
      user-select: none;
    }
    .memory-tile.flipped { background: #1e1b2e; transform: rotateY(180deg); }
    .memory-tile.matched { background: #065f46; cursor: default; transform: rotateY(180deg); }

    /*  Magic 8-Ball  */
    .eight-ball-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .eight-ball {
      width: 160px;
      height: 160px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, #444, #111 60%, #000);
      position: relative;
      cursor: pointer;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5), inset 0 -4px 12px rgba(255,255,255,0.05);
      transition: transform 0.1s;
      margin: 12px 0;
    }
    .eight-ball:hover { transform: scale(1.03); }
    .eight-ball.shaking {
      animation: ballShake 0.5s ease-in-out;
    }
    @keyframes ballShake {
      0%,100% { transform: translate(0,0) rotate(0deg); }
      15% { transform: translate(-6px,2px) rotate(-3deg); }
      30% { transform: translate(5px,-3px) rotate(2deg); }
      45% { transform: translate(-4px,4px) rotate(-2deg); }
      60% { transform: translate(6px,-2px) rotate(3deg); }
      75% { transform: translate(-3px,3px) rotate(-1deg); }
      90% { transform: translate(2px,-1px) rotate(1deg); }
    }
    .eight-ball-window {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: radial-gradient(circle, #1a1a6e, #0d0d3b);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #2a2a8a;
      box-shadow: inset 0 0 20px rgba(100,100,255,0.2);
    }
    .eight-ball-answer {
      color: #fff;
      font-size: 0.5rem;
      text-align: center;
      padding: 4px;
      line-height: 1.2;
      font-weight: 700;
      text-transform: uppercase;
      opacity: 0;
      transition: opacity 0.6s;
    }
    .eight-ball-answer.visible { opacity: 1; }
    .eight-ball-input {
      background: var(--input-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      color: var(--text-primary);
      padding: 8px 12px;
      width: 100%;
      max-width: 220px;
      font-size: 0.75rem;
      margin-top: 8px;
    }

    /*  2048 Game  */
    .game2048-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      cursor: pointer;
    }
    .game2048-preview {
      display: grid;
      grid-template-columns: repeat(3,1fr);
      gap: 4px;
      width: 100px;
      margin: 12px auto;
    }
    .game2048-preview-tile {
      aspect-ratio: 1;
      border-radius: 4px;
      font-size: 0.6rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
    }
    .game2048-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .game2048-modal.active { display: flex; }
    .game2048-modal-content {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      max-width: 420px;
      width: 95%;
    }
    .game2048-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .game2048-score-box {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 6px 14px;
      text-align: center;
    }
    .game2048-score-label {
      font-size: 0.6rem;
      text-transform: uppercase;
      color: var(--text-tertiary);
      letter-spacing: 1px;
    }
    .game2048-score-val {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-primary);
    }
    .game2048-board {
      display: grid;
      grid-template-columns: repeat(4,1fr);
      gap: 6px;
      background: #1e1b2e;
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 12px;
    }
    .game2048-tile {
      aspect-ratio: 1;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1.3rem;
      transition: all 0.12s;
      background: #2a2740;
      color: transparent;
    }
    .game2048-tile[data-val="2"] { background: #6366f1; color: #fff; }
    .game2048-tile[data-val="4"] { background: #8b5cf6; color: #fff; }
    .game2048-tile[data-val="8"] { background: #a855f7; color: #fff; }
    .game2048-tile[data-val="16"] { background: #d946ef; color: #fff; }
    .game2048-tile[data-val="32"] { background: #ec4899; color: #fff; }
    .game2048-tile[data-val="64"] { background: #f43f5e; color: #fff; }
    .game2048-tile[data-val="128"] { background: #f97316; color: #fff; font-size: 1rem; }
    .game2048-tile[data-val="256"] { background: #eab308; color: #fff; font-size: 1rem; }
    .game2048-tile[data-val="512"] { background: #22c55e; color: #fff; font-size: 1rem; }
    .game2048-tile[data-val="1024"] { background: #14b8a6; color: #fff; font-size: 0.85rem; }
    .game2048-tile[data-val="2048"] { background: #fbbf24; color: #000; font-size: 0.85rem; box-shadow: 0 0 20px #fbbf24; }
    .game2048-btns { display: flex; gap: 8px; justify-content: center; }

    /*  Dad Joke Machine  */
    .dadjoke-card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .dadjoke-btn {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, #f87171, #dc2626 60%, #991b1b);
      border: 4px solid #7f1d1d;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(220,38,38,0.4), inset 0 2px 4px rgba(255,255,255,0.2);
      transition: transform 0.1s, box-shadow 0.1s;
      margin: 12px 0;
      color: #fff;
      font-weight: 800;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .dadjoke-btn:hover { transform: scale(1.05); box-shadow: 0 8px 24px rgba(220,38,38,0.6); }
    .dadjoke-btn:active { transform: scale(0.95); }
    .dadjoke-text {
      font-size: 0.82rem;
      color: var(--text-primary);
      min-height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1.5;
      max-width: 240px;
    }
    .dadjoke-groan {
      display: flex;
      gap: 4px;
      margin-top: 8px;
    }
    .dadjoke-groan-btn {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.15s;
      color: var(--text-primary);
    }
    .dadjoke-groan-btn:hover { background: var(--border-color); }
    .dadjoke-groan-btn.selected { border-color: #fbbf24; background: rgba(251,191,36,0.15); }
    .dadjoke-counter {
      font-size: 0.6rem;
      color: var(--text-tertiary);
      margin-top: 6px;
    }

    /* Simon Says */

    /* Password Strength */
    .pw-strength-input { width: 100%; box-sizing: border-box; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 10px 12px; border-radius: var(--radius-sm); font-family: 'JetBrains Mono', monospace; font-size: 0.82rem; outline: none; margin-bottom: 8px; }
    .pw-strength-bar { height: 6px; border-radius: 3px; background: var(--border); overflow: hidden; margin-bottom: 6px; }
    .pw-strength-fill { height: 100%; border-radius: 3px; transition: width 0.3s, background 0.3s; width: 0; }
    .pw-strength-label { font-size: 0.7rem; font-weight: 600; }
    .pw-strength-checks { font-size: 0.62rem; color: var(--text-tertiary); text-align: left; margin-top: 6px; line-height: 1.6; }

    /* Lorem Ipsum */
    .lorem-output { background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 10px; font-size: 0.72rem; color: var(--text-secondary); max-height: 150px; overflow-y: auto; text-align: left; line-height: 1.5; margin-top: 8px; cursor: pointer; }
    .lorem-controls { display: flex; gap: 6px; align-items: center; justify-content: center; margin-top: 8px; }
    .lorem-controls input[type=number] { width: 50px; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 6px 8px; border-radius: var(--radius-sm); font-size: 0.75rem; text-align: center; }
    .lorem-controls select { background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 6px 8px; border-radius: var(--radius-sm); font-size: 0.75rem; }

    /* Etch-a-Sketch */
    .etch-canvas { border: 3px solid #ef4444; border-radius: 12px; background: #c4c4c4; cursor: crosshair; display: block; margin: 0 auto 8px; }
    .etch-controls { display: flex; gap: 8px; align-items: center; justify-content: center; }
    .etch-knob { width: 28px; height: 28px; border-radius: 50%; background: #ef4444; border: 2px solid #b91c1c; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.6rem; color: white; font-weight: 700; }
    .etch-knob:hover { filter: brightness(1.2); }

  </style>
</head>
<body>
  <canvas id="particle-canvas"></canvas>

  <!-- AUTH GATE -->
  <div id="auth-gate">
    <div class="auth-logo">C</div>
    <h1>Claude Code Monitor</h1>
    <p class="subtitle">Enter password to continue</p>
    <div class="auth-input-wrap">
      <input type="password" id="password-input" placeholder="password" autocomplete="current-password" autocorrect="off" autocapitalize="off" spellcheck="false">
      <button type="button" id="login-btn" style="display:block;width:100%;margin-top:10px;padding:12px;background:linear-gradient(135deg,#8b7cf6,#6366f1);color:white;border:none;border-radius:10px;font-family:Inter,sans-serif;font-size:15px;font-weight:600;cursor:pointer;touch-action:manipulation;-webkit-appearance:none;">Log In</button>
    </div>
    <p class="auth-error" id="auth-error"></p>
  </div>

  <!-- EARLY AUTH SCRIPT: runs before the heavy main script -->
  <script>
  (function() {
    var gate = document.getElementById('auth-gate');
    var pwInput = document.getElementById('password-input');
    var loginBtn = document.getElementById('login-btn');
    var authErr = document.getElementById('auth-error');

    // Check for stored token
    var stored = sessionStorage.getItem('monitor_token');
    if (stored) {
      gate.style.display = 'none';
    }

    function doLogin() {
      var pw = pwInput.value;
      if (!pw) return;
      authErr.textContent = '';
      loginBtn.textContent = '...';
      loginBtn.disabled = true;

      var xhr = new XMLHttpRequest();
      xhr.open('POST', '/api/login', true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onload = function() {
        try {
          var data = JSON.parse(xhr.responseText);
          if (data.ok) {
            sessionStorage.setItem('monitor_token', data.token);
            window.__earlyAuthToken = data.token;
            gate.style.display = 'none';
            // If main script already loaded, call showDashboard
            if (typeof window.showDashboard === 'function') {
              window.authToken = data.token;
              window.showDashboard();
            } else {
              // Main script not loaded yet, it will pick up the token
              window.__pendingLogin = true;
            }
          } else {
            authErr.textContent = data.error || 'Incorrect password';
            pwInput.value = '';
            loginBtn.textContent = 'Log In';
            loginBtn.disabled = false;
          }
        } catch(e) {
          authErr.textContent = 'Error parsing response';
          loginBtn.textContent = 'Log In';
          loginBtn.disabled = false;
        }
      };
      xhr.onerror = function() {
        authErr.textContent = 'Connection failed';
        loginBtn.textContent = 'Log In';
        loginBtn.disabled = false;
      };
      xhr.send(JSON.stringify({ password: pw }));
    }

    loginBtn.addEventListener('click', doLogin);
    pwInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') { e.preventDefault(); doLogin(); }
    });
  })();
  </script>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <header class="fade-in">
      <div class="header-left">
        <div class="header-logo">C</div>
        <div class="header-text">
          <h1>Claude Code Monitor</h1>
          <span>chenzoo.com</span>
        </div>
      </div>
      <button class="hamburger-btn" id="hamburger-btn" aria-label="Toggle navigation" aria-expanded="false">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
      <nav class="header-nav" id="main-nav">
        <a href="#" class="nav-link active" data-page="monitor">Monitor</a>
        <a href="#" class="nav-link" data-page="dreams">Dreams</a>
        <a href="#" class="nav-link" data-page="kalshi">Kalshi</a>
        <a href="#" class="nav-link" data-page="kanban">Kanban</a>
        <a href="#" class="nav-link" data-page="notes">Notes</a>
        <a href="#" class="nav-link" data-page="tools">Tools</a>
        <a href="#" class="nav-link" data-page="gallery">Gallery</a>
        <a href="#" class="nav-link" data-page="soundcloud">SoundCloud</a>
        <a href="#" class="nav-link" data-page="spinnin">Spinnin'</a>
      </nav>
      <div class="header-right">
        <div class="header-search-wrap" id="header-search-wrap">
          <span class="header-search-icon">&#128269;</span>
          <input class="header-search-input" id="header-search-input" type="text" placeholder="Search everything..." autocomplete="off">
          <span class="header-search-kbd">/</span>
          <div class="header-search-dropdown" id="header-search-dropdown"></div>
        </div>
        <div style="position:relative;">
          <button class="badge-btn" id="badge-btn" title="Achievements">&#127942; <span class="badge-counter" id="badge-counter">0</span></button>
          <div class="badge-popup" id="badge-popup"></div>
        </div>
        <div class="header-clock" id="header-clock">
          <div class="clock-time">--:--:--</div>
          <div>up --:--</div>
        </div>
        <div class="conn-badge ok" id="conn-status">
          <div class="conn-dot"></div>
          <span>Connected</span>
        </div>
        <div class="weather-widget" id="weather-widget" title="Local weather">
          <span class="weather-icon" id="weather-icon">--</span>
          <span class="weather-temp" id="weather-temp">--</span>
        </div>
        <div class="ambient-bar" id="ambient-bar">
          <button class="ambient-btn" id="ambient-toggle" title="Toggle ambient sound">&#9835;</button>
          <div class="ambient-viz" id="ambient-viz"></div>
          <input type="range" class="ambient-volume" id="ambient-volume" min="0" max="100" value="30">
        </div>
        <button class="theme-toggle" id="theme-toggle" title="Toggle theme">&#9790;</button>
        <button class="crt-toggle" id="crt-toggle" title="CRT Mode">CRT</button>
        <div style="position:relative;">
          <button class="notif-bell" id="notif-bell" title="Notifications">&#128276;</button>
          <span class="notif-badge" id="notif-badge"></span>
          <div class="notif-dropdown" id="notif-dropdown">
            <div class="notif-header">
              <span>Notifications</span>
              <button class="notif-clear" id="notif-clear">Clear all</button>
            </div>
            <div id="notif-list">
              <div class="notif-empty">No notifications yet</div>
            </div>
          </div>
        </div>
        <div class="widget-vis-wrap" id="widget-vis-wrap">
          <button class="widget-vis-btn" id="widget-vis-btn" title="Show/Hide Widgets">&#9783;</button>
          <div class="widget-vis-dropdown" id="widget-vis-dropdown"></div>
        </div>
        <div style="position:relative;">
          <button class="prefs-gear-btn" id="prefs-gear-btn" title="Preferences">&#9881;</button>
          <div class="prefs-panel" id="prefs-panel">
            <div class="prefs-panel-title">Preferences</div>
            <div class="pref-row">
              <div class="pref-label">Auto-refresh<small>Poll server for updates</small></div>
              <div class="pref-toggle on" id="pref-autorefresh" data-pref="autoRefresh"></div>
            </div>
            <div class="pref-row">
              <div class="pref-label">Refresh interval<small>How often to poll (seconds)</small></div>
              <div class="pref-slider-wrap">
                <input type="range" class="pref-slider" id="pref-interval-slider" min="0" max="4" step="1" value="2">
                <span class="pref-slider-val" id="pref-interval-val">15s</span>
              </div>
            </div>
            <div class="pref-row">
              <div class="pref-label">Notification sounds<small>Play sound on events</small></div>
              <div class="pref-toggle" id="pref-sounds" data-pref="notifSounds"></div>
            </div>
            <div class="pref-row">
              <div class="pref-label">Confetti on completion<small>Celebrate finished tasks</small></div>
              <div class="pref-toggle on" id="pref-confetti" data-pref="confetti"></div>
            </div>
            <div class="pref-row">
              <div class="pref-label">Theme<small>Dark or light mode</small></div>
              <div class="pref-toggle" id="pref-theme" data-pref="theme"></div>
            </div>
          </div>
        </div>
        <button class="btn btn-danger" id="logout-btn">Logout</button>
      </div>
    </header>

    <!-- MOBILE BOTTOM NAV -->
    <div class="mobile-bottom-nav" id="mobile-bottom-nav">
      <div class="mobile-bottom-nav-inner">
        <a class="mobile-nav-item active" data-page="monitor"><span class="mobile-nav-icon">&#128200;</span><span>Monitor</span></a>
        <a class="mobile-nav-item" data-page="dreams"><span class="mobile-nav-icon">&#128164;</span><span>Dreams</span></a>
        <a class="mobile-nav-item" data-page="kalshi"><span class="mobile-nav-icon">&#127936;</span><span>Kalshi</span></a>
        <a class="mobile-nav-item" data-page="kanban"><span class="mobile-nav-icon">&#128203;</span><span>Kanban</span></a>
        <a class="mobile-nav-item" data-page="notes"><span class="mobile-nav-icon">&#128221;</span><span>Notes</span></a>
        <a class="mobile-nav-item" data-page="tools"><span class="mobile-nav-icon">&#128295;</span><span>Tools</span></a>
        <a class="mobile-nav-item" data-page="gallery"><span class="mobile-nav-icon">&#127912;</span><span>Gallery</span></a>
        <a class="mobile-nav-item" data-page="soundcloud"><span class="mobile-nav-icon">&#127925;</span><span>SC</span></a>
        <a class="mobile-nav-item" data-page="spinnin"><span class="mobile-nav-icon">&#127926;</span><span>Spinnin</span></a>
      </div>
    </div>

    <!-- MONITOR PAGE -->
    <div id="page-monitor" class="page active">
      <div class="cards fade-in monitor-widget" data-widget="status-cards">
        <span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="card">
          <div class="label">Status</div>
          <div class="value" id="card-status"><span class="status-dot active"></span>Loading</div>
        </div>
        <div class="card">
          <div class="label">Usage</div>
          <div class="value" id="card-limit">--</div>
        </div>
        <div class="card">
          <div class="label">Resets In</div>
          <div class="value" id="card-reset">--</div>
        </div>
        <div class="card">
          <div class="label">Last Sync</div>
          <div class="value dim" id="card-updated">--</div>
        </div>
      </div>

      <!-- STATS BAR -->
      <div class="stats-bar fade-in monitor-widget" data-widget="stats-bar" id="stats-bar"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="stat-item">
          <div class="stat-number" id="stat-tasks">-</div>
          <div class="stat-label">Total Tasks</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-done">-</div>
          <div class="stat-label">Completed</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-notes">-</div>
          <div class="stat-label">Notes</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-messages">-</div>
          <div class="stat-label">Messages</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="stat-uptime">-</div>
          <div class="stat-label">Days Up</div>
        </div>
      </div>

      <!-- PROGRESS RINGS -->
      <div class="progress-rings fade-in monitor-widget" data-widget="progress-rings" id="progress-rings"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="progress-ring-card">
          <div class="prog-ring">
            <svg viewBox="0 0 90 90">
              <circle class="ring-bg" cx="45" cy="45" r="38"/>
              <circle class="ring-fill" id="ring-tasks" cx="45" cy="45" r="38"
                stroke-dasharray="238.76" stroke-dashoffset="238.76" stroke="url(#grad-purple)"/>
            </svg>
            <div class="prog-ring-value" id="ring-tasks-val" style="color:var(--accent);">0%</div>
          </div>
          <div class="prog-ring-label">Tasks Done</div>
          <defs><svg width="0" height="0"><defs>
            <linearGradient id="grad-purple" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#8b7cf6"/><stop offset="100%" stop-color="#6366f1"/>
            </linearGradient>
            <linearGradient id="grad-green" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#34d399"/><stop offset="100%" stop-color="#10b981"/>
            </linearGradient>
            <linearGradient id="grad-yellow" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#fbbf24"/><stop offset="100%" stop-color="#f59e0b"/>
            </linearGradient>
            <linearGradient id="grad-red" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#fb7185"/><stop offset="100%" stop-color="#ef4444"/>
            </linearGradient>
          </defs></svg></defs>
        </div>
        <div class="progress-ring-card">
          <div class="prog-ring">
            <svg viewBox="0 0 90 90">
              <circle class="ring-bg" cx="45" cy="45" r="38"/>
              <circle class="ring-fill" id="ring-memory" cx="45" cy="45" r="38"
                stroke-dasharray="238.76" stroke-dashoffset="238.76" stroke="url(#grad-green)"/>
            </svg>
            <div class="prog-ring-value" id="ring-memory-val" style="color:var(--green);">0%</div>
          </div>
          <div class="prog-ring-label">Memory</div>
        </div>
        <div class="progress-ring-card">
          <div class="prog-ring">
            <svg viewBox="0 0 90 90">
              <circle class="ring-bg" cx="45" cy="45" r="38"/>
              <circle class="ring-fill" id="ring-disk" cx="45" cy="45" r="38"
                stroke-dasharray="238.76" stroke-dashoffset="238.76" stroke="url(#grad-yellow)"/>
            </svg>
            <div class="prog-ring-value" id="ring-disk-val" style="color:var(--yellow);">0%</div>
          </div>
          <div class="prog-ring-label">Disk</div>
        </div>
        <div class="progress-ring-card">
          <div class="prog-ring">
            <svg viewBox="0 0 90 90">
              <circle class="ring-bg" cx="45" cy="45" r="38"/>
              <circle class="ring-fill" id="ring-cpu" cx="45" cy="45" r="38"
                stroke-dasharray="238.76" stroke-dashoffset="238.76" stroke="url(#grad-red)"/>
            </svg>
            <div class="prog-ring-value" id="ring-cpu-val" style="color:var(--red);">0%</div>
          </div>
          <div class="prog-ring-label">CPU Load</div>
        </div>
      </div>

      <!-- SPARKLINE CHARTS -->
      <div class="sparkline-row fade-in monitor-widget" data-widget="sparkline-charts"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="sparkline-card">
          <div class="sparkline-title">CPU Load</div>
          <div class="sparkline-value" id="spark-cpu-val">--</div>
          <canvas class="sparkline-canvas" id="spark-cpu" width="200" height="40"></canvas>
        </div>
        <div class="sparkline-card">
          <div class="sparkline-title">Memory Usage</div>
          <div class="sparkline-value" id="spark-mem-val">--</div>
          <canvas class="sparkline-canvas" id="spark-mem" width="200" height="40"></canvas>
        </div>
        <div class="sparkline-card">
          <div class="sparkline-title">API Requests</div>
          <div class="sparkline-value" id="spark-req-val">--</div>
          <canvas class="sparkline-canvas" id="spark-req" width="200" height="40"></canvas>
        </div>
      </div>

      <!-- NETWORK LATENCY MONITOR -->
      <div class="latency-card fade-in monitor-widget" data-widget="latency-monitor" id="latency-widget"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="latency-header">
          <span class="latency-title">Network Latency</span>
          <div class="latency-status-dot" id="latency-dot"></div>
        </div>
        <div class="latency-stats">
          <div class="latency-stat">
            <span class="latency-stat-label">Current</span>
            <span class="latency-stat-value good" id="latency-current">--</span>
          </div>
          <div class="latency-stat">
            <span class="latency-stat-label">Average</span>
            <span class="latency-stat-value good" id="latency-avg">--</span>
          </div>
          <div class="latency-stat">
            <span class="latency-stat-label">Min</span>
            <span class="latency-stat-value good" id="latency-min">--</span>
          </div>
          <div class="latency-stat">
            <span class="latency-stat-label">Max</span>
            <span class="latency-stat-value good" id="latency-max">--</span>
          </div>
        </div>
        <div class="latency-sparkline">
          <canvas id="latency-sparkline-canvas" width="400" height="32"></canvas>
        </div>
      </div>

      <!-- DAILY QUOTE -->
      <div class="section fade-in monitor-widget" data-widget="daily-quote" id="quote-section" style="padding:16px 22px;"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div style="display:flex;align-items:flex-start;gap:12px;">
          <span style="font-size:1.5rem;color:var(--accent);line-height:1;opacity:0.5;">"</span>
          <div>
            <div id="daily-quote" style="font-size:0.84rem;color:var(--text-secondary);line-height:1.6;font-style:italic;">Loading wisdom...</div>
            <div id="quote-author" style="font-size:0.72rem;color:var(--text-tertiary);margin-top:6px;"></div>
          </div>
        </div>
      </div>

      <!-- ASCII ART OF THE DAY -->
      <div class="section fade-in monitor-widget" data-widget="art-of-day" id="art-of-day" style="padding:16px 22px;cursor:pointer;" onclick="navigateTo('gallery')"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div style="font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-tertiary);font-weight:500;margin-bottom:10px;">Art of the Day</div>
        <div id="art-of-day-content" style="font-family:'JetBrains Mono',monospace;font-size:0.38rem;line-height:1.05;white-space:pre;overflow:hidden;max-height:140px;text-align:center;opacity:0.7;"></div>
        <div id="art-of-day-title" style="font-size:0.75rem;color:var(--text);margin-top:8px;text-align:center;font-weight:600;"></div>
      </div>

      <!-- POMODORO TIMER + FORTUNE -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px;" class="fade-in monitor-widget" data-widget="pomo-fortune"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="pomodoro-widget" style="width:100%;margin:0;">
          <div class="pomo-ring">
            <svg viewBox="0 0 160 160">
              <circle class="pomo-bg" cx="80" cy="80" r="70"/>
              <circle class="pomo-progress" id="pomo-progress" cx="80" cy="80" r="70"
                stroke-dasharray="439.82" stroke-dashoffset="0"/>
            </svg>
            <div class="pomo-time" id="pomo-time">25:00</div>
          </div>
          <div class="pomo-label" id="pomo-label">Focus Time</div>
          <div class="pomo-controls">
            <button class="pomo-btn primary" id="pomo-start">Start</button>
            <button class="pomo-btn" id="pomo-reset">Reset</button>
          </div>
          <div class="pomo-sessions" id="pomo-sessions">Sessions: 0</div>
        </div>

        <div class="fortune-cookie" id="fortune-cookie">
          <div class="fortune-icon" id="fortune-icon">&#127840;</div>
          <div class="fortune-text" id="fortune-text">Click to crack open a fortune cookie...</div>
          <div class="fortune-hint" id="fortune-hint">Tap for developer wisdom</div>
        </div>
      </div>

      <!-- SYSTEM HEALTH -->
      <div class="section fade-in monitor-widget" data-widget="system-health"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">System Health</div>
        <div style="padding:16px 22px;" id="health-panel">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;">
            <div class="health-item" id="h-claude"><span class="h-dot"></span>Claude Code</div>
            <div class="health-item" id="h-server"><span class="h-dot"></span>Server</div>
            <div class="health-item" id="h-tunnel"><span class="h-dot"></span>Tunnel</div>
            <div class="health-item" id="h-monitor"><span class="h-dot"></span>Monitor</div>
          </div>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:14px;padding-top:14px;border-top:1px solid var(--border);">
            <div><span style="font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-tertiary);font-weight:500;">Uptime</span><div style="font-size:0.88rem;color:var(--text);margin-top:4px;" id="h-uptime">--</div></div>
            <div><span style="font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-tertiary);font-weight:500;">Memory</span><div style="font-size:0.88rem;color:var(--text);margin-top:4px;" id="h-memory">--</div></div>
            <div><span style="font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-tertiary);font-weight:500;">Disk</span><div style="font-size:0.88rem;color:var(--text);margin-top:4px;" id="h-disk">--</div></div>
            <div><span style="font-size:0.68rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-tertiary);font-weight:500;">Load</span><div style="font-size:0.88rem;color:var(--text);margin-top:4px;" id="h-load">--</div></div>
          </div>
        </div>
      </div>

      <div class="section fade-in monitor-widget" data-widget="current-activity"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">
          Current Activity
          <span id="typing-indicator" style="display:none;" class="typing-indicator">
            Claude is working
            <span class="dots">
              <span class="dot-bounce"></span>
              <span class="dot-bounce"></span>
              <span class="dot-bounce"></span>
            </span>
          </span>
        </div>
        <div class="notes-box" id="notes-box">Loading...</div>
      </div>

      <!-- ACTIVITY HEATMAP -->
      <div class="heatmap-section fade-in monitor-widget" data-widget="activity-heatmap"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="heatmap-title">Activity (last 90 days)</div>
        <div class="heatmap-grid" id="heatmap-grid"></div>
        <div class="heatmap-legend">
          <span>Less</span>
          <div class="heatmap-legend-cell l0" style="border:1px solid var(--border);"></div>
          <div class="heatmap-legend-cell l1"></div>
          <div class="heatmap-legend-cell l2"></div>
          <div class="heatmap-legend-cell l3"></div>
          <div class="heatmap-legend-cell l4"></div>
          <span>More</span>
        </div>
      </div>

      <!-- SITE ANALYTICS -->
      <div class="section fade-in monitor-widget" data-widget="site-analytics" id="analytics-section"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">Site Analytics</div>
        <div style="padding:16px 22px;">
          <div class="analytics-cards">
            <div class="analytics-card">
              <div class="analytics-card-value" id="analytics-views">--</div>
              <div class="analytics-card-label">Page Views</div>
            </div>
            <div class="analytics-card">
              <div class="analytics-card-value" id="analytics-visitors">--</div>
              <div class="analytics-card-label">Unique Visitors</div>
            </div>
            <div class="analytics-card">
              <div class="analytics-card-value" id="analytics-api-calls">--</div>
              <div class="analytics-card-label">API Calls</div>
            </div>
            <div class="analytics-card">
              <div class="analytics-card-value" id="analytics-active-hour">--</div>
              <div class="analytics-card-label">Peak Hour</div>
            </div>
            <div class="analytics-card">
              <div class="analytics-card-value" id="analytics-uptime">--</div>
              <div class="analytics-card-label">Server Uptime</div>
            </div>
          </div>
          <div class="analytics-bar-chart" id="analytics-hourly-chart"></div>
        </div>
      </div>

      <div class="section fade-in monitor-widget" data-widget="activity-log"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">
          Activity Log
          <div style="display:flex;gap:6px;align-items:center;">
            <div id="log-filters" style="display:flex;gap:3px;">
              <button class="btn log-filter-btn active" data-type="all" style="padding:3px 8px;font-size:0.65rem;">All</button>
              <button class="btn log-filter-btn" data-type="system" style="padding:3px 8px;font-size:0.65rem;">System</button>
              <button class="btn log-filter-btn" data-type="user" style="padding:3px 8px;font-size:0.65rem;">User</button>
              <button class="btn log-filter-btn" data-type="error" style="padding:3px 8px;font-size:0.65rem;">Error</button>
            </div>
            <button class="btn" id="export-logs-btn" style="padding:3px 8px;font-size:0.65rem;">Export</button>
            <button class="btn" id="refresh-btn">Refresh</button>
          </div>
        </div>
        <div class="log-viewer" id="log-viewer">
          <div class="log-entry"><span class="log-msg" style="color:var(--text-tertiary)">Loading...</span></div>
        </div>
      </div>

      <div class="section fade-in monitor-widget" data-widget="message-claude"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">Message Claude<span id="msg-unread-badge" class="msg-unread-badge" style="display:none;"></span></div>
        <div class="msg-area">
          <textarea id="msg-input" placeholder="Send a message or instruction to Claude Code..."></textarea>
          <div class="send-row">
            <span class="hint">Delivered directly to the active session</span>
            <button class="btn-send" id="send-btn">Send</button>
          </div>
        </div>
      </div>

      <div class="section fade-in monitor-widget" data-widget="daily-standup"><span class="drag-handle" title="Drag to reorder">&#9776;</span>
        <div class="section-header">Daily Standup</div>
        <div class="standup-widget" id="standup-content">
          <div class="standup-empty">Loading standup data...</div>
        </div>
      </div>
    </div>

    <!-- KANBAN PAGE -->
    <div id="page-kanban" class="page">
      <div class="kanban-toolbar fade-in">
        <div style="display:flex;align-items:center;gap:12px;">
          <span class="kanban-toolbar-title">Task Board</span>
          <div class="board-selector-wrap" id="board-selector-wrap">
            <select class="board-selector" id="board-selector" onchange="switchKanbanBoard(this.value)">
              <option value="main">Main</option>
            </select>
            <button class="board-new-btn" onclick="createNewKanbanBoard()">+ Board</button>
            <button class="board-delete-btn" id="board-delete-btn" onclick="deleteCurrentKanbanBoard()" style="display:none;" title="Delete this board">&#10005;</button>
          </div>
        </div>
        <div style="display:flex;gap:6px;align-items:center;">
          <button class="btn" id="kanban-view-board" onclick="setKanbanView('board')" style="padding:5px 12px;font-size:0.72rem;opacity:1;">Board</button>
          <button class="btn" id="kanban-view-cal" onclick="setKanbanView('calendar')" style="padding:5px 12px;font-size:0.72rem;opacity:0.5;">Calendar</button>
          <button class="btn" id="kanban-view-gantt" onclick="setKanbanView('gantt')" style="padding:5px 12px;font-size:0.72rem;opacity:0.5;">Gantt</button>
          <button class="starred-filter-btn" id="kanban-starred-filter" onclick="toggleKanbanStarredFilter()">&#9733; Starred</button>
        </div>
        <button class="btn-add-task" id="add-task-btn">+ Add Task</button>
      </div>

      <div class="kanban-add-form fade-in" id="kanban-add-form">
        <div class="kanban-form-row" style="display:flex;align-items:center;gap:12px;">
          <label class="kanban-form-label" style="margin:0;white-space:nowrap;">Use Template</label>
          <select class="kanban-template-select" id="kanban-template-select">
            <option value="">Blank task</option>
            <option value="bugfix">Bug Fix</option>
            <option value="feature">Feature Request</option>
            <option value="refactor">Refactor</option>
            <option value="docs">Documentation</option>
            <option value="testing">Testing</option>
          </select>
        </div>
        <div class="kanban-form-row">
          <label class="kanban-form-label">Title</label>
          <input type="text" class="kanban-form-input" id="kanban-task-title" placeholder="Task title...">
        </div>
        <div class="kanban-form-row">
          <label class="kanban-form-label">Description (optional)</label>
          <textarea class="kanban-form-input" id="kanban-task-desc" placeholder="Brief description..."></textarea>
        </div>
        <div class="kanban-form-row" style="display:flex;gap:16px;">
          <div style="flex:1;">
            <label class="kanban-form-label">Priority</label>
            <div class="priority-selector" id="priority-selector">
              <button class="priority-option selected" data-priority="none">None</button>
              <button class="priority-option" data-priority="low">Low</button>
              <button class="priority-option" data-priority="med">Medium</button>
              <button class="priority-option" data-priority="high">High</button>
              <button class="priority-option" data-priority="critical">Critical</button>
            </div>
          </div>
          <div style="flex:0 0 auto;">
            <label class="kanban-form-label">Due Date</label>
            <input type="date" class="kanban-form-input" id="kanban-task-due" style="padding:6px 10px;font-size:0.78rem;width:160px;">
          </div>
          <div style="flex:0 0 auto;">
            <label class="kanban-form-label">Recurring</label>
            <select class="recur-select" id="kanban-task-recur">
              <option value="none">None</option>
              <option value="daily">Daily</option>
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
        </div>
        <div class="kanban-form-actions">
          <button class="btn" id="cancel-task-btn">Cancel</button>
          <button class="btn-send" id="save-task-btn" style="padding:8px 18px;font-size:0.78rem;">Save Task</button>
        </div>
      </div>

      <div class="kanban-board fade-in" id="kanban-board">
        <!-- Columns rendered by JS -->
      </div>
      <div id="kanban-calendar" style="display:none;" class="fade-in">
        <div class="cal-header">
          <button class="btn" onclick="calNav(-1)" style="padding:4px 12px;">&#8249;</button>
          <span class="cal-month" id="cal-month"></span>
          <button class="btn" onclick="calNav(1)" style="padding:4px 12px;">&#8250;</button>
          <button class="btn" onclick="calToday()" style="padding:4px 10px;font-size:0.7rem;margin-left:8px;">Today</button>
        </div>
        <div class="cal-grid" id="cal-grid"></div>
      </div>
      <div id="kanban-gantt" style="display:none;" class="fade-in"></div>
    </div>

    <!-- NOTES PAGE -->
    <div id="page-notes" class="page">
      <div class="kanban-toolbar fade-in">
        <span class="kanban-toolbar-title">Notes</span>
        <div style="display:flex;gap:8px;align-items:center;">
          <input type="text" id="note-search" class="kanban-form-input" placeholder="Search notes..." style="width:200px;padding:7px 12px;font-size:0.78rem;">
          <button class="starred-filter-btn" id="notes-starred-filter" onclick="toggleNotesStarredFilter()">&#9733; Starred</button>
          <button class="voice-memo-btn" id="voice-memo-btn" title="Record voice memo">&#127908;</button>
          <span class="voice-memo-indicator" id="voice-memo-indicator" style="display:none;"><span class="voice-memo-dot"></span>Recording...</span>
          <button class="btn" id="export-notes-btn" style="white-space:nowrap;">Export</button>
          <button class="btn-add-task" id="add-note-btn">+ New Note</button>
        </div>
      </div>

      <div class="kanban-add-form fade-in" id="note-add-form">
        <div class="kanban-form-row" style="display:flex;align-items:center;gap:12px;">
          <label class="kanban-form-label" style="margin:0;white-space:nowrap;">Use Template</label>
          <select class="note-template-select" id="note-template-select">
            <option value="">Blank note</option>
            <option value="meeting">Meeting Notes</option>
            <option value="bug">Bug Report</option>
            <option value="daily">Daily Log</option>
            <option value="idea">Project Idea</option>
            <option value="snippet">Code Snippet</option>
          </select>
        </div>
        <div class="kanban-form-row">
          <label class="kanban-form-label">Title</label>
          <input type="text" class="kanban-form-input" id="note-title" placeholder="Note title...">
        </div>
        <div class="kanban-form-row" style="display:flex;gap:16px;">
          <div style="flex:1;">
            <label class="kanban-form-label">Tags (comma-separated)</label>
            <input type="text" class="kanban-form-input" id="note-tags" placeholder="e.g. work, ideas, todo..." style="font-size:0.78rem;">
          </div>
          <div style="flex:0 0 auto;">
            <label class="kanban-form-label">Color</label>
            <div id="note-color-picker" style="display:flex;gap:6px;margin-top:4px;">
              <button class="note-color-opt selected" data-color="none" style="background:var(--border);width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
              <button class="note-color-opt" data-color="red" style="background:#fb7185;width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
              <button class="note-color-opt" data-color="yellow" style="background:#fbbf24;width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
              <button class="note-color-opt" data-color="green" style="background:#34d399;width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
              <button class="note-color-opt" data-color="blue" style="background:#6366f1;width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
              <button class="note-color-opt" data-color="purple" style="background:#a78bfa;width:22px;height:22px;border-radius:50%;border:2px solid transparent;cursor:pointer;"></button>
            </div>
          </div>
        </div>
        <div class="kanban-form-row">
          <label class="kanban-form-label">Content</label>
          <textarea class="kanban-form-input" id="note-content" placeholder="Write your note..." style="min-height:120px;"></textarea>
        </div>
        <div class="kanban-form-actions">
          <button class="btn" id="cancel-note-btn">Cancel</button>
          <button class="btn-send" id="save-note-btn" style="padding:8px 18px;font-size:0.78rem;">Save Note</button>
        </div>
      </div>

      <div id="note-tag-filter" class="fade-in" style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px;"></div>
      <div id="notes-list" class="fade-in"></div>
    </div>

    <!-- TOOLS PAGE -->
    <div id="page-tools" class="page">
      <div class="kanban-toolbar fade-in">
        <span class="kanban-toolbar-title">Developer Tools</span>
      </div>

      <!-- API Rate Limit Status -->
      <div class="section fade-in" id="rate-limit-section">
        <div class="section-header">API Rate Limit Status</div>
        <div style="padding:16px 22px;">
          <div class="rate-limit-grid">
            <div class="rate-limit-item">
              <div class="rate-limit-bar-wrap">
                <div class="rate-limit-bar-bg">
                  <div class="rate-limit-bar-fill" id="rate-limit-bar" style="width:100%;"></div>
                </div>
              </div>
              <div class="rate-limit-stats">
                <span><strong id="rate-limit-remaining">--</strong> / <span id="rate-limit-total">--</span> requests remaining</span>
                <span id="rate-limit-reset" style="color:var(--text-tertiary);font-size:0.75rem;">Resets in --</span>
              </div>
            </div>
          </div>
          <div style="font-size:0.72rem;color:var(--text-tertiary);margin-top:10px;">
            Rate limits are per-IP. Data updates with each API response via X-RateLimit headers.
          </div>
        </div>
      </div>

      <!-- Terminal Emulator -->
      <div class="terminal-widget fade-in">
        <div class="terminal-bar">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
          <div class="terminal-title">claude-monitor ~ bash</div>
        </div>
        <div class="terminal-body" id="terminal-body">
          <div><span class="output">Welcome to Claude Monitor Terminal v1.0</span></div>
          <div><span class="output">Type 'help' for available commands.</span></div>
        </div>
        <div class="terminal-input-line">
          <span class="terminal-prompt-text">guest@claude ~$</span>
          <input class="terminal-input" id="terminal-input" type="text" autofocus spellcheck="false">
        </div>
      </div>

      <!-- Typing Test + Snake Game side by side -->
      <div class="tools-grid fade-in">
        <div class="typing-test">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Typing Speed Test</div>
          <div class="typing-prompt" id="typing-prompt">Click "Start" to begin...</div>
          <input class="typing-input" id="typing-input" placeholder="Start typing..." disabled>
          <div style="display:flex;gap:8px;justify-content:center;margin-top:12px;">
            <button class="pomo-btn primary" id="typing-start">Start</button>
            <button class="pomo-btn" id="typing-reset">Reset</button>
          </div>
          <div class="typing-stats">
            <div class="typing-stat"><div class="typing-stat-value" id="typing-wpm">0</div><div class="typing-stat-label">WPM</div></div>
            <div class="typing-stat"><div class="typing-stat-value" id="typing-acc">0%</div><div class="typing-stat-label">Accuracy</div></div>
            <div class="typing-stat"><div class="typing-stat-value" id="typing-best">0</div><div class="typing-stat-label">Best</div></div>
          </div>
        </div>

        <!-- New features below -->

        <div class="json-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">JSON Formatter</div>
          <textarea class="json-textarea" id="json-input" placeholder='Paste JSON here...' oninput="formatJSON()"></textarea>
          <div class="json-output" id="json-output">Paste JSON above to format</div>
          <div class="json-status" id="json-status"></div>
        </div>

        <div class="worldclock-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">World Clock</div>
          <div class="worldclock-list" id="worldclock-list"></div>
        </div>

        <div class="b64-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Base64</div>
          <textarea class="b64-textarea" id="b64-input" placeholder="Text or Base64..." oninput="b64Auto()"></textarea>
          <div class="b64-btns">
            <button class="pomo-btn primary" onclick="b64Encode()">Encode</button>
            <button class="pomo-btn" onclick="b64Decode()">Decode</button>
            <button class="pomo-btn" onclick="b64Copy()">Copy</button>
          </div>
          <textarea class="b64-textarea" id="b64-output" placeholder="Result..." readonly></textarea>
        </div>

        <div class="countdown-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Countdown Timer</div>
          <div class="countdown-display" id="countdown-display">00:00</div>
          <div style="display:flex;gap:4px;justify-content:center;align-items:center;">
            <input class="countdown-input" id="countdown-min" type="number" min="0" max="99" value="5" placeholder="min">
            <span style="color:var(--text-tertiary);font-weight:700;">:</span>
            <input class="countdown-input" id="countdown-sec" type="number" min="0" max="59" value="0" placeholder="sec">
          </div>
          <div class="countdown-presets">
            <button class="pomo-btn primary" id="countdown-start" onclick="countdownToggle()">Start</button>
            <button class="pomo-btn" onclick="countdownReset()">Reset</button>
            <button class="pomo-btn" onclick="countdownSet(1,0)">1m</button>
            <button class="pomo-btn" onclick="countdownSet(5,0)">5m</button>
            <button class="pomo-btn" onclick="countdownSet(25,0)">25m</button>
          </div>
        </div>

        <div class="regex-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Regex Tester</div>
          <input class="regex-input" id="regex-pattern" placeholder="Pattern (e.g. \d+)" oninput="testRegex()">
          <input class="regex-input" id="regex-flags" placeholder="Flags (e.g. gi)" value="g" style="width:60px;display:inline-block;" oninput="testRegex()">
          <textarea class="regex-input" id="regex-test" placeholder="Test string..." rows="2" oninput="testRegex()"></textarea>
          <div class="regex-result" id="regex-result">Enter a pattern above</div>
          <div class="regex-status" id="regex-status"></div>
        </div>

        <div class="holo-card-widget">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Holo Card</div>
          <div class="holo-demo" id="holo-demo" onmousemove="holoMove(event)" onmouseleave="holoReset()"></div>
          <div style="font-size:0.6rem;color:var(--text-tertiary);margin-top:4px;">Hover & move mouse</div>
        </div>

        <div class="aurora-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Aurora</div>
          <div style="font-size:2rem;margin:8px 0;"></div>
          <button class="pomo-btn primary" id="aurora-toggle" onclick="toggleAurora()">Enable</button>
        </div>

        <div class="gradient-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Gradient CSS</div>
          <div class="gradient-preview" id="gradient-preview" style="background:linear-gradient(135deg,#6366f1,#ec4899);"></div>
          <div class="gradient-controls">
            <div class="gradient-row">
              <input class="gradient-color-input" type="color" id="grad-c1" value="#6366f1" oninput="updateGradient()">
              <input class="gradient-color-input" type="color" id="grad-c2" value="#ec4899" oninput="updateGradient()">
              <input class="gradient-angle-input" type="number" id="grad-angle" value="135" min="0" max="360" oninput="updateGradient()"> <span style="font-size:0.6rem;color:var(--text-tertiary);">deg</span>
            </div>
          </div>
          <div class="gradient-css-output" id="gradient-css" onclick="copyGradientCSS()">background: linear-gradient(135deg, #6366f1, #ec4899);</div>
        </div>
        <div class="tool-card">
          <div style="font-size:2rem;margin-bottom:8px;"></div>
          <div class="tool-title">Password Tester</div>
          <div class="tool-desc">Check strength</div>
          <input class="pw-strength-input" id="pw-test-input" type="text" placeholder="Type a password..." oninput="checkPwStrength(this.value)" autocomplete="off">
          <div class="pw-strength-bar"><div class="pw-strength-fill" id="pw-strength-fill"></div></div>
          <div class="pw-strength-label" id="pw-strength-label"></div>
          <div class="pw-strength-checks" id="pw-strength-checks"></div>
        </div>

        <div class="tool-card">
          <div style="font-size:2rem;margin-bottom:8px;"></div>
          <div class="tool-title">Lorem Ipsum</div>
          <div class="tool-desc">Placeholder text</div>
          <div class="lorem-controls">
            <input type="number" id="lorem-count" value="3" min="1" max="20">
            <select id="lorem-type"><option value="paragraphs">Paragraphs</option><option value="sentences">Sentences</option><option value="words">Words</option></select>
            <button class="pomo-btn primary" onclick="generateLorem()">Go</button>
          </div>
          <div class="lorem-output" id="lorem-output" onclick="copyLorem()">Click Go to generate...</div>
        </div>

        <!-- AUDIO SPECTRUM VISUALIZER -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Audio Spectrum Visualizer</div>
          <canvas id="spectrum-canvas" style="width:100%;height:120px;border-radius:10px;background:#0a0a12;"></canvas>
          <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap;justify-content:center;">
            <button class="pomo-btn primary" id="spectrum-mic-btn" onclick="toggleSpectrumMic()">Mic Input</button>
            <select id="spectrum-style" onchange="spectrumStyle=this.value" style="background:var(--surface);color:var(--text-primary);border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-size:0.72rem;">
              <option value="bars">Bars</option>
              <option value="wave">Wave</option>
              <option value="circle">Circle</option>
            </select>
            <select id="spectrum-color" onchange="spectrumColor=this.value" style="background:var(--surface);color:var(--text-primary);border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-size:0.72rem;">
              <option value="rainbow">Rainbow</option>
              <option value="fire">Fire</option>
              <option value="ice">Ice</option>
              <option value="matrix">Matrix</option>
            </select>
          </div>
        </div>

        <!-- AMBIENT SOUNDSCAPE MIXER -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Ambient Soundscape Mixer</div>
          <div id="soundscape-grid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;"></div>
        </div>

        <!-- BOIDS FLOCKING SIMULATION -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Boids Flocking Simulation</div>
          <canvas id="boids-canvas" style="width:100%;height:200px;border-radius:10px;background:#0a0a12;cursor:crosshair;"></canvas>
          <div style="display:flex;gap:6px;margin-top:10px;flex-wrap:wrap;justify-content:center;align-items:center;">
            <label style="font-size:0.65rem;color:var(--text-tertiary);">Boids:</label>
            <input type="range" id="boids-count" min="20" max="300" value="120" oninput="resizeBoidsFlock(+this.value)" style="width:80px;">
            <label style="font-size:0.65rem;color:var(--text-tertiary);">Speed:</label>
            <input type="range" id="boids-speed" min="1" max="8" value="3" style="width:60px;">
            <button class="pomo-btn" onclick="resetBoids()">Reset</button>
            <button class="pomo-btn" id="boids-predator-btn" onclick="toggleBoidsPredator()">Add Predator</button>
          </div>
        </div>

        <!-- ACTIVITY HEATMAP CALENDAR -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Activity Heatmap</div>
          <div id="heatmap-container" style="overflow-x:auto;"></div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
            <div style="font-size:0.62rem;color:var(--text-tertiary);" id="heatmap-stats">Loading...</div>
            <div style="display:flex;align-items:center;gap:4px;font-size:0.58rem;color:var(--text-tertiary);">
              Less <div style="display:flex;gap:2px;" id="heatmap-legend"></div> More
            </div>
          </div>
        </div>

        <!-- LIVE CHAT -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Live Chat Room</div>
          <div id="chat-messages" style="height:200px;overflow-y:auto;background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:12px;margin-bottom:8px;font-size:0.75rem;line-height:1.5;scrollbar-width:thin;"></div>
          <div style="display:flex;gap:6px;">
            <input type="text" id="chat-name" placeholder="Name" value="" style="width:80px;background:var(--surface);color:var(--text-primary);border:1px solid var(--border);border-radius:8px;padding:8px;font-size:0.75rem;">
            <input type="text" id="chat-input" placeholder="Type a message..." style="flex:1;background:var(--surface);color:var(--text-primary);border:1px solid var(--border);border-radius:8px;padding:8px;font-size:0.75rem;" onkeydown="if(event.key==='Enter')sendChatMsg()">
            <button class="pomo-btn primary" onclick="sendChatMsg()">Send</button>
          </div>
        </div>

        <!-- DRUM MACHINE -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Drum Machine</div>
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;">
            <button class="pomo-btn primary" id="drum-play-btn" onclick="toggleDrumSequencer()">&#9654; Play</button>
            <button class="pomo-btn" onclick="clearDrumGrid()">Clear</button>
            <span style="font-size:0.7rem;color:var(--text-secondary);">BPM:</span>
            <input type="range" id="drum-bpm" min="60" max="200" value="120" oninput="drumBPM=+this.value;document.getElementById('drum-bpm-val').textContent=this.value" style="width:80px;">
            <span id="drum-bpm-val" style="font-size:0.7rem;color:var(--accent);min-width:26px;">120</span>
          </div>
          <div id="drum-grid" style="display:grid;grid-template-columns:70px repeat(16,1fr);gap:2px;font-size:0.65rem;"></div>
          <div style="display:flex;gap:4px;margin-top:8px;">
            <div style="font-size:0.6rem;color:var(--text-tertiary);">16-step sequencer  Click pads to toggle  Space to play/pause</div>
          </div>
        </div>

        <!-- SYNTH KEYBOARD -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Synthesizer</div>
          <div style="display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;">
            <select id="synth-wave" onchange="synthWaveform=this.value" style="background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-size:0.7rem;">
              <option value="sawtooth">Sawtooth</option>
              <option value="square">Square</option>
              <option value="sine">Sine</option>
              <option value="triangle">Triangle</option>
            </select>
            <span style="font-size:0.7rem;color:var(--text-secondary);">Octave:</span>
            <button class="pomo-btn" onclick="synthOctave=Math.max(1,synthOctave-1);renderSynthKeys()" style="padding:4px 10px;">-</button>
            <span id="synth-octave-val" style="font-size:0.75rem;color:var(--accent);min-width:16px;text-align:center;">4</span>
            <button class="pomo-btn" onclick="synthOctave=Math.min(7,synthOctave+1);renderSynthKeys()" style="padding:4px 10px;">+</button>
          </div>
          <div id="synth-keyboard" style="display:flex;position:relative;height:120px;user-select:none;"></div>
          <div style="font-size:0.6rem;color:var(--text-tertiary);margin-top:6px;">Keys: A-L for white, W-P for black  Mouse/touch supported</div>
        </div>

        <!-- GUESTBOOK -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Guestbook Wall</div>
          <div id="guestbook-entries" style="height:220px;overflow-y:auto;background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:12px;margin-bottom:8px;font-size:0.75rem;line-height:1.6;scrollbar-width:thin;"></div>
          <div style="display:flex;gap:6px;margin-bottom:6px;">
            <input type="text" id="gb-name" placeholder="Name" style="width:80px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:8px;font-size:0.75rem;">
            <input type="text" id="gb-msg" placeholder="Leave a message..." style="flex:1;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:8px;font-size:0.75rem;" onkeydown="if(event.key==='Enter')signGuestbook()">
            <select id="gb-emoji" style="background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:6px;font-size:0.85rem;">
              <option>&#128075;</option><option>&#128293;</option><option>&#10024;</option><option>&#128640;</option><option>&#128420;</option><option>&#129304;</option><option>&#127775;</option><option>&#128169;</option>
            </select>
            <button class="pomo-btn primary" onclick="signGuestbook()">Sign</button>
          </div>
        </div>

        <!-- GENERATIVE ART -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;">Generative Art</div>
            <div style="display:flex;gap:4px;">
              <button class="pomo-btn" onclick="genArt('circles')">Circles</button>
              <button class="pomo-btn" onclick="genArt('flow')">Flow Field</button>
              <button class="pomo-btn" onclick="genArt('geo')">Geometric</button>
              <button class="pomo-btn primary" onclick="genArt()">Random</button>
            </div>
          </div>
          <canvas id="genart-canvas" width="600" height="300" style="width:100%;border-radius:10px;background:#08080c;cursor:pointer;" onclick="genArt()"></canvas>
        </div>

        <!-- DRAWING WHITEBOARD -->
        <div class="tool-card" style="grid-column:span 2;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
            <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;">Drawing Canvas</div>
            <div style="display:flex;gap:4px;align-items:center;">
              <input type="color" id="draw-color" value="#8b7cf6" style="width:28px;height:28px;border:none;border-radius:6px;cursor:pointer;background:none;">
              <input type="range" id="draw-size" min="1" max="30" value="3" style="width:60px;">
              <button class="pomo-btn" onclick="drawEraser()">Eraser</button>
              <button class="pomo-btn" onclick="clearDrawCanvas()">Clear</button>
              <button class="pomo-btn primary" onclick="saveDrawCanvas()">Save</button>
            </div>
          </div>
          <canvas id="draw-canvas" width="600" height="280" style="width:100%;border-radius:10px;background:#0a0a10;cursor:crosshair;touch-action:none;"></canvas>
        </div>

        <!-- NEON TEXT GENERATOR -->
        <div class="tool-card">
          <div style="font-size:0.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-tertiary);font-weight:600;margin-bottom:14px;">Neon Text Generator</div>
          <input type="text" id="neon-input" placeholder="Type text..." value="NEON" oninput="renderNeonText()" style="width:100%;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:10px;font-size:0.85rem;margin-bottom:8px;">
          <div style="display:flex;gap:4px;margin-bottom:10px;flex-wrap:wrap;">
            <button class="pomo-btn" onclick="neonColor='#ff00ff';renderNeonText()" style="color:#ff00ff;">Pink</button>
            <button class="pomo-btn" onclick="neonColor='#00ffff';renderNeonText()" style="color:#00ffff;">Cyan</button>
            <button class="pomo-btn" onclick="neonColor='#ff4444';renderNeonText()" style="color:#ff4444;">Red</button>
            <button class="pomo-btn" onclick="neonColor='#44ff44';renderNeonText()" style="color:#44ff44;">Green</button>
            <button class="pomo-btn" onclick="neonColor='#ffaa00';renderNeonText()" style="color:#ffaa00;">Gold</button>
            <button class="pomo-btn" onclick="neonColor='#8b7cf6';renderNeonText()" style="color:#8b7cf6;">Purple</button>
          </div>
          <div id="neon-preview" style="padding:24px;text-align:center;background:#0a0a0f;border-radius:12px;min-height:80px;display:flex;align-items:center;justify-content:center;"></div>
          <button class="pomo-btn" onclick="copyNeonCSS()" style="margin-top:8px;width:100%;">Copy CSS</button>
        </div>

      </div>

      <!-- Aurora Overlay -->
      <div class="aurora-overlay" id="aurora-overlay">
        <div class="aurora-band"></div>
        <div class="aurora-band"></div>
        <div class="aurora-band"></div>
      </div>

      <!-- Weather/Disco removed -->
      <div class="vhs-overlay" id="vhs-overlay">
        <div class="vhs-scanlines"></div>
        <div class="vhs-noise"></div>
        <div class="vhs-tracking"></div>
      </div>
      <div class="vhs-timestamp" id="vhs-timestamp">PLAY  00:00:00</div>

      <!-- All game modals removed -->

      <!-- Custom CSS Injection -->
      <div class="custom-css-section fade-in">
        <div class="custom-css-title">Custom CSS</div>
        <textarea class="custom-css-textarea" id="custom-css-textarea" placeholder="/* Enter your custom CSS here */&#10;/* e.g. .card { border-color: red; } */&#10;/* Changes apply instantly and persist across sessions */"></textarea>
        <div class="custom-css-actions">
          <button class="pomo-btn primary" id="custom-css-apply">Apply</button>
          <button class="pomo-btn" id="custom-css-clear">Clear</button>
          <span class="custom-css-hint">Stored in localStorage. Press Apply or Ctrl+Enter to save.</span>
        </div>
      </div>

      <!-- Backup & Restore -->
      <div class="custom-css-section fade-in">
        <div class="custom-css-title">Backup & Restore</div>
        <p style="font-size:0.78rem;color:var(--text-secondary);margin-bottom:16px;line-height:1.5;">
          Download a full backup of all data (kanban, notes, messages, status) or restore from a previous backup file.
        </p>
        <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
          <button class="pomo-btn primary" id="backup-download-btn" onclick="downloadBackup()">Download Backup</button>
          <label class="pomo-btn" style="cursor:pointer;position:relative;">
            Restore from File
            <input type="file" id="backup-restore-input" accept=".json" style="position:absolute;inset:0;opacity:0;cursor:pointer;" onchange="restoreBackup(event)">
          </label>
          <button class="pomo-btn" onclick="exportICal()" title="Export tasks with due dates as iCal">Export iCal</button>
        </div>
        <div id="backup-status" style="margin-top:12px;font-size:0.75rem;color:var(--text-tertiary);"></div>
      </div>

      <!-- Theme Creator -->
      <div class="theme-creator fade-in">
        <div class="theme-creator-title">Custom Color Theme</div>
        <div class="theme-creator-grid">
          <div class="theme-color-field">
            <label for="theme-accent">Accent</label>
            <input type="color" id="theme-accent" value="#8b7cf6">
          </div>
          <div class="theme-color-field">
            <label for="theme-bg">Background</label>
            <input type="color" id="theme-bg" value="#08080c">
          </div>
          <div class="theme-color-field">
            <label for="theme-text">Text</label>
            <input type="color" id="theme-text" value="#ebebf0">
          </div>
          <div class="theme-color-field">
            <label for="theme-surface">Surface</label>
            <input type="color" id="theme-surface" value="#111118">
          </div>
        </div>
        <div class="theme-preview-strip" id="theme-preview-strip">
          <div class="theme-preview-swatch" id="preview-accent" style="background:#8b7cf6;"></div>
          <div class="theme-preview-swatch" id="preview-bg" style="background:#08080c;"></div>
          <div class="theme-preview-swatch" id="preview-text" style="background:#ebebf0;"></div>
          <div class="theme-preview-swatch" id="preview-surface" style="background:#111118;"></div>
          <span class="theme-preview-text">Live Preview</span>
        </div>
        <div class="theme-creator-actions">
          <button class="pomo-btn primary" id="theme-save-btn">Save Theme</button>
          <button class="pomo-btn" id="theme-reset-btn">Reset to Default</button>
        </div>
      </div>

      <!-- Diff Viewer -->
      <div class="diff-viewer fade-in">
        <div class="diff-viewer-title">Diff Viewer</div>
        <div class="diff-inputs">
          <div>
            <label for="diff-original">Original</label>
            <textarea id="diff-original" placeholder="Paste original text here..."></textarea>
          </div>
          <div>
            <label for="diff-modified">Modified</label>
            <textarea id="diff-modified" placeholder="Paste modified text here..."></textarea>
          </div>
        </div>
        <div style="margin-bottom:14px;">
          <button class="pomo-btn primary" id="diff-compare-btn">Compare</button>
          <button class="pomo-btn" id="diff-clear-btn" style="margin-left:8px;">Clear</button>
        </div>
        <div class="diff-output" id="diff-output" style="display:none;"></div>
      </div>

      <!-- Activity Feed -->
      <div class="activity-feed fade-in">
        <div class="activity-feed-title">
          Activity Feed
          <button class="pomo-btn" id="activity-feed-clear" style="font-size:0.68rem;padding:4px 10px;">Clear</button>
        </div>
        <div class="activity-feed-list" id="activity-feed-list">
          <div class="activity-empty">No activity recorded yet. Actions across the app will appear here.</div>
        </div>
      </div>
    </div>

    <!-- GALLERY PAGE -->
    <div id="page-gallery" class="page">
      <div class="gallery-slideshow" id="gallery-slideshow">
        <button class="gallery-nav prev" onclick="galleryPrev()">&#8249;</button>
        <button class="gallery-nav next" onclick="galleryNext()">&#8250;</button>
        <div id="gallery-slides"></div>
        <div class="gallery-dots" id="gallery-dots"></div>
        <div class="gallery-counter" id="gallery-counter"></div>
        <div style="text-align:center;margin-top:12px;">
          <button class="btn" onclick="toggleDungeon()" style="font-size:0.72rem;opacity:0.5;letter-spacing:1px;">ENTER THE DUNGEON</button>
        </div>
      </div>
      <div id="dungeon-container" style="display:none;">
        <div style="text-align:center;margin-bottom:12px;">
          <button class="btn" onclick="toggleDungeon()" style="font-size:0.72rem;">Back to Gallery</button>
          <button class="btn" onclick="generateDungeon()" style="font-size:0.72rem;margin-left:8px;">New Dungeon</button>
          <span style="font-size:0.68rem;color:var(--text-tertiary);margin-left:12px;">Arrow keys to move | Explore the <span style="color:var(--accent);">@</span></span>
        </div>
        <div style="display:flex;justify-content:center;">
          <div id="dungeon-display" style="font-family:'JetBrains Mono',monospace;font-size:0.6rem;line-height:1.1;white-space:pre;background:rgba(0,0,0,0.5);border:1px solid var(--border);border-radius:12px;padding:20px;backdrop-filter:blur(10px);"></div>
        </div>
        <div id="dungeon-status" style="text-align:center;font-size:0.72rem;color:var(--text-secondary);margin-top:10px;"></div>
      </div>
    </div>

    <!-- SOUNDCLOUD PAGE -->
    <div id="page-soundcloud" class="page">
      <div class="sc-header">
        <div class="sc-title-row">
          <span class="sc-title">SoundCloud Likes</span>
          <span class="sc-count" id="sc-count"></span>
          <button class="btn sc-refresh-btn" onclick="loadSoundCloudLikes(true)" id="sc-refresh-btn" title="Refresh">&#8635;</button>
        </div>
        <div class="sc-controls">
          <input type="text" class="sc-search" id="sc-search" placeholder="Search tracks, artists, genres..." oninput="filterSCTracks()">
          <select class="sc-genre-filter" id="sc-genre-filter" onchange="filterSCTracks()">
            <option value="">All Genres</option>
          </select>
        </div>
        <div class="sc-stats" id="sc-stats"></div>
      </div>
      <div class="sc-table-wrap" id="sc-table-wrap">
        <div class="sc-loading" id="sc-loading">
          <div class="sc-spinner"></div>
          <div>Loading your likes...</div>
          <div class="sc-loading-sub">Loading cached tracks</div>
        </div>
        <table class="sc-table" id="sc-table" style="display:none;">
          <thead>
            <tr>
              <th class="sc-th sc-th-num">#</th>
              <th class="sc-th sc-th-art"></th>
              <th class="sc-th sc-th-title sc-sortable" data-sort="title">Title <span class="sc-sort-icon"></span></th>
              <th class="sc-th sc-th-artist sc-sortable" data-sort="artist">Artist <span class="sc-sort-icon"></span></th>
              <th class="sc-th sc-th-duration sc-sortable sc-sort-active" data-sort="duration">Duration <span class="sc-sort-icon">&#9660;</span></th>
              <th class="sc-th sc-th-genre sc-sortable" data-sort="genre">Genre <span class="sc-sort-icon"></span></th>
              <th class="sc-th sc-th-plays sc-sortable" data-sort="plays">Plays <span class="sc-sort-icon"></span></th>
              <th class="sc-th sc-th-likes sc-sortable" data-sort="likes">Likes <span class="sc-sort-icon"></span></th>
              <th class="sc-th sc-th-date sc-sortable" data-sort="likedAt">Liked <span class="sc-sort-icon"></span></th>
            </tr>
          </thead>
          <tbody id="sc-tbody"></tbody>
        </table>
      </div>
    </div>

    <!-- SPINNIN RECORDS PAGE -->
    <div id="page-spinnin" class="page">
      <div class="sc-header">
        <div class="sc-title-row">
          <span class="sc-title" style="color:#00d856;">Spinnin' Records Mixes</span>
          <span class="sc-count" id="sp-count"></span>
          <button class="btn sc-refresh-btn" onclick="loadSpinninMixes(true)" id="sp-refresh-btn" title="Refresh">&#8635;</button>
        </div>
        <div class="sc-controls">
          <input type="text" class="sc-search" id="sp-search" placeholder="Search mixes..." oninput="filterSpinninTracks()">
          <select class="sc-genre-filter" id="sp-sort-preset" onchange="applySpinninPreset()">
            <option value="">Sort by...</option>
            <option value="plays-desc">Most Played</option>
            <option value="likes-desc">Most Liked</option>
            <option value="duration-desc">Longest First</option>
            <option value="duration-asc">Shortest First</option>
            <option value="createdAt-desc">Newest First</option>
            <option value="createdAt-asc">Oldest First</option>
          </select>
        </div>
        <div class="sc-stats" id="sp-stats"></div>
      </div>
      <div class="sc-table-wrap" id="sp-table-wrap">
        <div class="sc-loading" id="sp-loading">
          <div class="sc-spinner"></div>
          <div>Loading Spinnin' mixes...</div>
          <div class="sc-loading-sub">Loading cached mixes</div>
        </div>
        <table class="sc-table" id="sp-table" style="display:none;">
          <thead>
            <tr>
              <th class="sc-th sc-th-num">#</th>
              <th class="sc-th sc-th-art"></th>
              <th class="sc-th sc-th-title sp-sortable" data-sort="title">Title <span class="sp-sort-icon"></span></th>
              <th class="sc-th sc-th-artist sp-sortable" data-sort="artist">Artist <span class="sp-sort-icon"></span></th>
              <th class="sc-th sc-th-duration sp-sortable sp-sort-active" data-sort="duration">Duration <span class="sp-sort-icon">&#9660;</span></th>
              <th class="sc-th sc-th-plays sp-sortable" data-sort="plays">Plays <span class="sp-sort-icon"></span></th>
              <th class="sc-th sc-th-likes sp-sortable" data-sort="likes">Likes <span class="sp-sort-icon"></span></th>
              <th class="sc-th sc-th-date sp-sortable" data-sort="createdAt">Released <span class="sp-sort-icon"></span></th>
            </tr>
          </thead>
          <tbody id="sp-tbody"></tbody>
        </table>
      </div>
    </div>

    <!-- DREAMS PAGE -->
    <div id="page-dreams" class="page">
      <div class="dreams-header-bar">
        <div class="dreams-sidebar-title">The Audacity of Dreaming</div>
        <div class="dreams-sidebar-subtitle">A profoundly unserious investigation</div>
      </div>
      <div id="dreams-toc"></div>
      <div id="dreams-reader-wrap" style="display:none;">
        <button class="dreams-back-btn" onclick="dreamsShowTOC()">&#8592; Back to chapters</button>
        <div id="dreams-reader">
          <div class="dreams-reader-header">
            <div class="dreams-reader-ch" id="dreams-r-ch"></div>
            <div class="dreams-reader-title" id="dreams-r-title"></div>
            <div class="dreams-reader-subtitle" id="dreams-r-subtitle"></div>
            <div class="dreams-reader-meta">
              <span id="dreams-r-words"></span>
            </div>
          </div>
          <div class="dreams-reader-body" id="dreams-r-body"></div>
          <div class="dreams-reader-nav">
            <button class="dreams-nav-btn" id="dreams-prev" onclick="dreamNavPrev()">&#8592; Previous</button>
            <button class="dreams-nav-btn" id="dreams-next" onclick="dreamNavNext()">Next &#8594;</button>
          </div>
        </div>
      </div>
    </div>

    <!-- KALSHI LIVE TRADING DASHBOARD -->
    <div id="page-kalshi" class="page">
      <div class="kl-top">
        <div class="kl-brand">
          <div class="kl-logo">&#127936;</div>
          <div>
            <div class="kl-title">Kalshi CBB Engine</div>
            <div class="kl-subtitle">NCAAB Live Trading System</div>
          </div>
        </div>
        <div id="kl-status-pill" class="kl-status-pill sleeping">
          <span class="kl-dot sleeping" id="kl-dot"></span>
          <span id="kl-status-text">Loading...</span>
        </div>
      </div>

      <div class="kl-tabs">
        <div class="kl-tab active" data-kltab="live" onclick="klSwitchTab('live')">Live</div>
        <div class="kl-tab" data-kltab="signals" onclick="klSwitchTab('signals')">Signals</div>
        <div class="kl-tab" data-kltab="positions" onclick="klSwitchTab('positions')">Positions</div>
        <div class="kl-tab" data-kltab="research" onclick="klSwitchTab('research')">Research</div>
      </div>

      <!-- LIVE TAB -->
      <div id="kl-tab-live" class="kl-tab-content">
        <div class="kl-stats-row" id="kl-stats-row"></div>
        <div class="kl-section">
          <div class="kl-section-header">
            <div class="kl-section-title">Live Games</div>
            <div class="kl-section-badge" id="kl-game-count">0 games</div>
          </div>
          <div id="kl-games-list"></div>
        </div>
        <div class="kl-section">
          <div class="kl-section-header">
            <div class="kl-section-title">Recent Signals</div>
            <div class="kl-section-badge" id="kl-signal-count">0</div>
          </div>
          <div id="kl-signals-preview"></div>
        </div>
      </div>

      <!-- SIGNALS TAB -->
      <div id="kl-tab-signals" class="kl-tab-content" style="display:none;">
        <div class="kl-section">
          <div class="kl-section-header">
            <div class="kl-section-title">All Signals</div>
          </div>
          <div id="kl-signals-full"></div>
        </div>
      </div>

      <!-- POSITIONS TAB -->
      <div id="kl-tab-positions" class="kl-tab-content" style="display:none;">
        <div class="kl-stats-row" id="kl-exec-stats"></div>
        <div class="kl-section">
          <div class="kl-section-header">
            <div class="kl-section-title">Open Positions</div>
          </div>
          <div id="kl-positions-list"></div>
        </div>
        <div class="kl-section">
          <div class="kl-section-header">
            <div class="kl-section-title">Trade History</div>
          </div>
          <div id="kl-trades-list"></div>
        </div>
      </div>

      <!-- RESEARCH TAB -->
      <div id="kl-tab-research" class="kl-tab-content" style="display:none;">
        <div id="kl-research-content"></div>
      </div>

      <div class="kl-updated" id="kl-updated"></div>
    </div>

    <div class="footer fade-in">
      Auto-refresh <span>15s</span>
      <div class="dot"></div>
      Powered by Claude Code
    </div>
    <div class="fullscreen-exit-hint">Press Esc to exit fullscreen</div>
  </div>

  <!-- AI CHATBOT WIDGET -->
  <button class="chatbot-fab" id="chatbot-fab" title="AI Assistant">&#129302;</button>
  <div class="chatbot-panel" id="chatbot-panel">
    <div class="chatbot-header"><span>AI Assistant</span><button id="chatbot-close">&times;</button></div>
    <div class="chatbot-messages" id="chatbot-messages">
      <div class="chatbot-msg bot">Hi! I'm your dashboard assistant. Type <b>help</b> to see what I can do.</div>
    </div>
    <div class="chatbot-input-wrap">
      <input type="text" id="chatbot-input" placeholder="Ask me something..." autocomplete="off">
      <button id="chatbot-send">Send</button>
    </div>
  </div>

  <script>
    let authToken = null;
    let kanbanData = null;

    // Pick up token from early auth script or sessionStorage
    (function() {
      var t = window.__earlyAuthToken || sessionStorage.getItem('monitor_token');
      if (t) { authToken = t; }
    })();

    var pwInput = document.getElementById('password-input');
    var authErr = document.getElementById('auth-error');

    // Make showDashboard globally accessible for early auth script
    window.showDashboard = showDashboard;
    window.authToken = authToken;
    var _dashboardShown = false;
    function showDashboard() {
      if (_dashboardShown) return;
      _dashboardShown = true;
      // Sync authToken from window (early auth sets window.authToken but not the let variable)
      if (!authToken && window.authToken) authToken = window.authToken;
      if (!authToken && window.__earlyAuthToken) authToken = window.__earlyAuthToken;
      if (!authToken) authToken = sessionStorage.getItem('monitor_token');
      document.getElementById('auth-gate').style.display = 'none';
      const dash = document.getElementById('dashboard');
      dash.style.display = 'block';
      navigateTo('monitor');
      fetchStatus();
      fetchHealth();
      fetchAnalytics();
      setInterval(fetchStatus, 15000);
      setInterval(fetchHealth, 30000);
      setInterval(fetchAnalytics, 30000);
      // Preload SoundCloud + Spinnin data so they're ready when user navigates
      setTimeout(function() {
        if (typeof loadSoundCloudLikes === 'function') loadSoundCloudLikes();
        if (typeof loadSpinninMixes === 'function') loadSpinninMixes();
      }, 500);
      // Run all deferred post-auth initializations
      if (window._postAuthInits) {
        window._postAuthInits.forEach(function(fn) { try { fn(); } catch(e) { console.warn('Post-auth init error:', e); } });
      }
    }

    var _loggingOut = false;
    function logout() {
      if (_loggingOut) return;
      _loggingOut = true;
      sessionStorage.removeItem('monitor_token');
      authToken = null;
      location.reload();
    }

    document.getElementById('logout-btn').addEventListener('click', logout);

    var api = function(path, opts = {}) {
      if (!authToken) return Promise.reject(new Error('Not authenticated'));
      return fetch(path, {
        ...opts,
        headers: { 'Authorization': 'Bearer ' + authToken, 'Content-Type': 'application/json', ...opts.headers }
      }).then(r => {
        if (r.status === 401) { logout(); throw new Error('Session expired'); }
        return r;
      });
    };

    // ===== PAGE NAVIGATION =====
    const PAGES = ['monitor', 'kanban', 'notes', 'tools', 'gallery', 'soundcloud', 'spinnin', 'dreams', 'kalshi'];
    let currentPage = 'monitor';

    // Post-navigation hooks - features register callbacks here instead of monkey-patching
    const _navHooks = [];
    function navigateTo(page) {
      if (page === currentPage && document.getElementById('page-' + page).style.display === 'block') return;
      // Update nav links (desktop)
      document.querySelectorAll('#main-nav .nav-link').forEach(link => {
        if (link.dataset.page === page) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
      // Update mobile bottom nav
      document.querySelectorAll('.mobile-nav-item').forEach(item => {
        if (item.dataset.page === page) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
      // Hide old page, show new with animation
      PAGES.forEach(p => {
        const el = document.getElementById('page-' + p);
        if (!el) return;
        if (p === page) {
          el.style.display = 'block';
          el.classList.remove('fade-enter');
          void el.offsetWidth;
          el.classList.add('fade-enter');
          requestAnimationFrame(() => {
            el.classList.remove('fade-enter');
            el.classList.add('fade-active');
            el.style.opacity = '1';
          });
        } else {
          el.style.display = 'none';
          el.style.opacity = '0';
          el.classList.remove('fade-active');
        }
      });
      currentPage = page;
      if (page === 'kanban') fetchKanban();
      if (page === 'notes') fetchNotes();
      if (page === 'gallery') renderGallery();
      // Run all registered post-navigation hooks
      _navHooks.forEach(fn => { try { fn(page); } catch(e) { console.warn('Nav hook error:', e); } });
    }

    // Wire up nav clicks (desktop)
    document.querySelectorAll('#main-nav .nav-link').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        navigateTo(link.dataset.page);
      });
    });

    // Wire up mobile bottom nav clicks
    document.querySelectorAll('.mobile-nav-item').forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault();
        navigateTo(item.dataset.page);
      });
    });

    // ===== LIVE CLOCK =====
    const sessionStart = Date.now();
    function updateClock() {
      const now = new Date();
      const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
      const elapsed = Date.now() - sessionStart;
      const h = Math.floor(elapsed / 3600000);
      const m = Math.floor((elapsed % 3600000) / 60000);
      const s = Math.floor((elapsed % 60000) / 1000);
      const uptime = h > 0 ? h + 'h ' + m + 'm' : m + 'm ' + s + 's';
      const el = document.getElementById('header-clock');
      if (el) {
        el.innerHTML = '<div class="clock-time">' + time + '</div><div>up ' + uptime + '</div>';
      }
    }
    setInterval(updateClock, 1000);
    updateClock();

    // ===== HEALTH =====
    async function fetchHealth() {
      try {
        const resp = await api('/api/health');
        if (!resp.ok) return;
        const h = await resp.json();

        const setDot = (id, up) => {
          const el = document.querySelector('#' + id + ' .h-dot');
          if (el) { el.className = 'h-dot ' + (up ? 'up' : 'down'); }
        };
        setDot('h-claude', h.processes.claude);
        setDot('h-server', h.processes.server);
        setDot('h-tunnel', h.processes.tunnel);
        setDot('h-monitor', h.processes.monitor);

        document.getElementById('h-uptime').textContent = h.system.uptime || '--';
        if (h.system.memory.totalMB) {
          const pct = Math.round((h.system.memory.usedMB / h.system.memory.totalMB) * 100);
          document.getElementById('h-memory').textContent = h.system.memory.usedMB + ' / ' + h.system.memory.totalMB + ' MB (' + pct + '%)';
        }
        if (h.system.disk.used) {
          document.getElementById('h-disk').textContent = h.system.disk.used + ' / ' + h.system.disk.total + ' (' + h.system.disk.usePercent + ')';
        }
        document.getElementById('h-load').textContent = h.system.loadAvg || '--';
      } catch (e) {}
    }

    // ===== RATE LIMIT TRACKING =====
    const rateLimitState = { remaining: null, limit: null, reset: null };

    // Wrap the api function to capture rate limit headers
    const _origApi = api;
    api = function(path, opts = {}) {
      return _origApi(path, opts).then(resp => {
        const rlRemaining = resp.headers.get('RateLimit-Remaining');
        const rlLimit = resp.headers.get('RateLimit-Limit');
        const rlReset = resp.headers.get('RateLimit-Reset');
        if (rlRemaining !== null) rateLimitState.remaining = parseInt(rlRemaining);
        if (rlLimit !== null) rateLimitState.limit = parseInt(rlLimit);
        if (rlReset !== null) rateLimitState.reset = parseInt(rlReset);
        updateRateLimitUI();
        return resp;
      });
    };

    function updateRateLimitUI() {
      const remainEl = document.getElementById('rate-limit-remaining');
      const totalEl = document.getElementById('rate-limit-total');
      const resetEl = document.getElementById('rate-limit-reset');
      const barEl = document.getElementById('rate-limit-bar');
      if (!remainEl || rateLimitState.remaining === null) return;

      const remaining = rateLimitState.remaining;
      const limit = rateLimitState.limit || 200;
      const pct = Math.round((remaining / limit) * 100);

      remainEl.textContent = remaining;
      totalEl.textContent = limit;

      barEl.style.width = pct + '%';
      barEl.classList.remove('warning', 'danger');
      if (pct < 20) barEl.classList.add('danger');
      else if (pct < 50) barEl.classList.add('warning');

      if (rateLimitState.reset !== null && rateLimitState.reset > 0) {
        resetEl.textContent = 'Resets in ' + rateLimitState.reset + 's';
      } else {
        resetEl.textContent = 'Resets in <1m';
      }
    }

    // ===== ANALYTICS =====
    async function fetchAnalytics() {
      try {
        const resp = await api('/api/analytics');
        if (!resp.ok) return;
        const data = await resp.json();

        const viewsEl = document.getElementById('analytics-views');
        const visitorsEl = document.getElementById('analytics-visitors');
        const apiCallsEl = document.getElementById('analytics-api-calls');
        const activeHourEl = document.getElementById('analytics-active-hour');
        const uptimeEl = document.getElementById('analytics-uptime');
        const chartEl = document.getElementById('analytics-hourly-chart');

        if (viewsEl) viewsEl.textContent = data.pageViews.toLocaleString();
        if (visitorsEl) visitorsEl.textContent = data.uniqueVisitors.toLocaleString();
        if (apiCallsEl) apiCallsEl.textContent = data.totalApiCalls.toLocaleString();
        if (activeHourEl) activeHourEl.textContent = data.mostActiveHour.label;
        if (uptimeEl) uptimeEl.textContent = data.uptime;

        // Render hourly bar chart
        if (chartEl && data.hourlyHits) {
          const max = Math.max(...data.hourlyHits, 1);
          chartEl.innerHTML = data.hourlyHits.map((hits, i) => {
            const h = Math.max(2, Math.round((hits / max) * 52));
            const label = i === 0 ? '12a' : i < 12 ? i + 'a' : i === 12 ? '12p' : (i - 12) + 'p';
            return '<div class="analytics-bar" style="height:' + h + 'px;" title="' + label + ': ' + hits + ' hits"><div class="analytics-bar-tooltip">' + label + ': ' + hits + '</div></div>';
          }).join('');
        }
      } catch (e) {}
    }

    // ===== MONITOR FUNCTIONS =====
    async function fetchStatus() {
      const connEl = document.getElementById('conn-status');
      try {
        const resp = await api('/api/status');
        if (resp.status === 401) { logout(); return; }
        const data = await resp.json();
        connEl.innerHTML = '<div class="conn-dot"></div><span>Connected</span>';
        connEl.className = 'conn-badge ok';
        renderStatus(data);
      } catch (err) {
        connEl.innerHTML = '<div class="conn-dot"></div><span>Offline</span>';
        connEl.className = 'conn-badge err';
      }
    }

    function renderStatus(data) {
      const u = data.usage;
      const statusEl = document.getElementById('card-status');
      if (u.limitHit) {
        statusEl.innerHTML = '<span class="status-dot limited"></span>Limit Hit';
        statusEl.className = 'value limited';
      } else if (u.status === 'idle') {
        statusEl.innerHTML = '<span class="status-dot idle"></span>Idle';
        statusEl.className = 'value warning';
      } else {
        statusEl.innerHTML = '<span class="status-dot active"></span>Active';
        statusEl.className = 'value active';
      }

      const limitEl = document.getElementById('card-limit');
      if (u.limitHit) {
        limitEl.textContent = 'Reached';
        limitEl.className = 'value limited';
      } else {
        limitEl.textContent = 'Available';
        limitEl.className = 'value active';
      }

      const resetEl = document.getElementById('card-reset');
      if (u.limitResetTime) {
        const diff = new Date(u.limitResetTime) - new Date();
        if (diff > 0) {
          const h = Math.floor(diff / 3600000);
          const m = Math.floor((diff % 3600000) / 60000);
          resetEl.textContent = h + 'h ' + m + 'm';
          resetEl.className = 'value warning';
        } else {
          resetEl.textContent = 'Ready';
          resetEl.className = 'value active';
        }
      } else {
        resetEl.textContent = '--';
        resetEl.className = 'value dim';
      }

      const upEl = document.getElementById('card-updated');
      if (u.lastUpdated) {
        const d = new Date(u.lastUpdated);
        upEl.textContent = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      }

      document.getElementById('notes-box').textContent = u.notes || 'No current activity';

      const logViewer = document.getElementById('log-viewer');
      if (data.logs && data.logs.length) {
        logViewer.innerHTML = data.logs.slice().reverse().map(l => {
          const d = new Date(l.timestamp);
          const ts = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
          return `<div class="log-entry">
            <span class="log-ts">${ts}</span>
            <span class="log-type ${l.type}">${l.type}</span>
            <span class="log-msg">${esc(l.message)}</span>
          </div>`;
        }).join('');
      }
    }

    function esc(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

    function toast(msg) {
      const el = document.createElement('div');
      el.className = 'toast';
      el.textContent = msg;
      document.body.appendChild(el);
      setTimeout(() => { el.classList.add('fade-out'); setTimeout(() => el.remove(), 300); }, 2500);
    }

    // ===== BACKUP & RESTORE =====
    async function downloadBackup() {
      const btn = document.getElementById('backup-download-btn');
      const status = document.getElementById('backup-status');
      btn.disabled = true;
      btn.textContent = 'Downloading...';
      status.textContent = '';
      try {
        const resp = await api('/api/backup');
        if (!resp.ok) throw new Error('Backup request failed');
        const data = await resp.json();
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `claude-monitor-backup-${new Date().toISOString().slice(0,10)}.json`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        toast('Backup downloaded');
        status.style.color = 'var(--green)';
        status.textContent = 'Backup saved at ' + new Date().toLocaleTimeString();
      } catch (err) {
        toast('Backup failed');
        status.style.color = 'var(--red)';
        status.textContent = 'Error: ' + err.message;
      } finally {
        btn.disabled = false;
        btn.textContent = 'Download Backup';
      }
    }

    async function restoreBackup(event) {
      const file = event.target.files[0];
      if (!file) return;
      const status = document.getElementById('backup-status');
      status.textContent = 'Reading file...';
      status.style.color = 'var(--text-tertiary)';
      try {
        const text = await file.text();
        const data = JSON.parse(text);
        const required = ['kanban', 'notes', 'status', 'messages'];
        const missing = required.filter(k => !(k in data));
        if (missing.length > 0) {
          throw new Error('Invalid backup file. Missing: ' + missing.join(', '));
        }
        if (!confirm('This will overwrite ALL current data with the backup. Are you sure?')) {
          status.textContent = 'Restore cancelled.';
          event.target.value = '';
          return;
        }
        const resp = await api('/api/restore', {
          method: 'POST',
          body: JSON.stringify(data)
        });
        const result = await resp.json();
        if (result.ok) {
          toast('Data restored successfully');
          status.style.color = 'var(--green)';
          status.textContent = 'Restored at ' + new Date().toLocaleTimeString();
          loadKanban();
        } else {
          throw new Error(result.error || 'Restore failed');
        }
      } catch (err) {
        toast('Restore failed: ' + err.message);
        status.style.color = 'var(--red)';
        status.textContent = 'Error: ' + err.message;
      }
      event.target.value = '';
    }

    async function exportICal() {
      try {
        const resp = await api('/api/export/ical');
        if (!resp.ok) throw new Error('iCal export failed');
        const text = await resp.text();
        const blob = new Blob([text], { type: 'text/calendar' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'claude-tasks.ics';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        toast('iCal file exported');
      } catch (err) {
        toast('iCal export failed');
      }
    }

    async function sendMessage() {
      const input = document.getElementById('msg-input');
      const btn = document.getElementById('send-btn');
      const msg = input.value.trim();
      if (!msg) return;
      btn.disabled = true;
      btn.textContent = 'Sending...';
      try {
        const resp = await api('/api/messages', {
          method: 'POST',
          body: JSON.stringify({ message: msg })
        });
        if (resp.ok) {
          input.value = '';
          toast('Message sent');
          fetchStatus();
        } else {
          toast('Failed to send');
        }
      } catch (err) {
        toast('Connection error');
      }
      btn.disabled = false;
      btn.textContent = 'Send';
    }

    document.getElementById('msg-input').addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
    });

    // ===== KANBAN FUNCTIONS =====
    const COLUMN_ORDER = ['backlog', 'inprogress', 'done'];

    async function fetchKanban() {
      try {
        const resp = await api('/api/kanban');
        if (resp.status === 401) { logout(); return; }
        kanbanData = await resp.json();
        renderKanban();
      } catch (err) {
        toast('Failed to load kanban');
      }
    }

    // ===== MULTIPLE BOARDS (stubs) =====
    let currentBoardId = 'main';
    function switchKanbanBoard(boardId) {
      currentBoardId = boardId;
      fetchKanban();
    }
    function createNewKanbanBoard() {
      const name = prompt('New board name:');
      if (!name || !name.trim()) return;
      toast('Multiple boards coming soon! For now, use the main board.');
    }
    function deleteCurrentKanbanBoard() {
      if (currentBoardId === 'main') { toast('Cannot delete main board'); return; }
      toast('Multiple boards coming soon!');
    }

    function renderKanban() {
      const board = document.getElementById('kanban-board');
      if (!kanbanData || !kanbanData.columns) {
        board.innerHTML = '<div class="kanban-empty">No data available</div>';
        return;
      }

      board.innerHTML = kanbanData.columns.map(col => {
        const colIdx = COLUMN_ORDER.indexOf(col.id);
        const canMoveLeft = colIdx > 0;
        const canMoveRight = colIdx < COLUMN_ORDER.length - 1;

        const tasksHtml = col.tasks.length === 0
          ? '<div class="kanban-empty">No tasks yet</div>'
          : col.tasks.map(task => {
            const descHtml = task.description
              ? `<div class="kanban-task-desc">${esc(task.description)}</div>`
              : '';
            return `<div class="kanban-task-card" draggable="true"
                         data-task-id="${task.id}"
                         ondragstart="onDragStart(event)"
                         ondragend="onDragEnd(event)">
              <button class="kanban-task-delete" onclick="deleteKanbanTask('${task.id}')" title="Delete">x</button>
              <div class="kanban-task-title" ondblclick="inlineEditTask('${task.id}','title',this)">${esc(task.title)}</div>
              ${task.description ? `<div class="kanban-task-desc" ondblclick="inlineEditTask('${task.id}','desc',this)">${esc(task.description)}</div>` : `<div class="kanban-task-desc" ondblclick="inlineEditTask('${task.id}','desc',this)" style="opacity:0.3;font-style:italic">+ description</div>`}
              <div class="kanban-task-actions">
                ${canMoveLeft
                  ? `<button class="kanban-task-btn" onclick="moveTask('${task.id}','${COLUMN_ORDER[colIdx - 1]}')" title="Move left">&larr;</button>`
                  : ''}
                ${canMoveRight
                  ? `<button class="kanban-task-btn" onclick="moveTask('${task.id}','${COLUMN_ORDER[colIdx + 1]}')" title="Move right">&rarr;</button>`
                  : ''}
              </div>
            </div>`;
          }).join('');

        return `<div class="kanban-column"
                     data-column-id="${col.id}"
                     ondragover="onDragOver(event)"
                     ondragenter="onDragEnter(event)"
                     ondragleave="onDragLeave(event)"
                     ondrop="onDrop(event)">
          <div class="kanban-col-header">
            <span class="kanban-col-title">${esc(col.title)}</span>
            <span class="kanban-col-count">${col.tasks.length}</span>
          </div>
          <div class="kanban-col-tasks">
            ${tasksHtml}
          </div>
        </div>`;
      }).join('');
    }

    function toggleAddForm() {
      const form = document.getElementById('kanban-add-form');
      form.classList.toggle('visible');
      if (form.classList.contains('visible')) {
        document.getElementById('kanban-task-title').focus();
      } else {
        document.getElementById('kanban-task-title').value = '';
        document.getElementById('kanban-task-desc').value = '';
      }
    }

    async function addKanbanTask() {
      const titleInput = document.getElementById('kanban-task-title');
      const descInput = document.getElementById('kanban-task-desc');
      const title = titleInput.value.trim();
      if (!title) { titleInput.focus(); return; }

      try {
        const resp = await api('/api/kanban/task', {
          method: 'POST',
          body: JSON.stringify({
            columnId: 'backlog',
            title: title,
            description: descInput.value.trim()
          })
        });
        if (resp.ok) {
          titleInput.value = '';
          descInput.value = '';
          document.getElementById('kanban-add-form').classList.remove('visible');
          toast('Task created');
          fetchKanban();
        } else {
          toast('Failed to create task');
        }
      } catch (err) {
        toast('Connection error');
      }
    }

    async function moveTask(taskId, targetColumnId) {
      try {
        const resp = await api('/api/kanban/task/' + taskId, {
          method: 'PUT',
          body: JSON.stringify({ columnId: targetColumnId })
        });
        if (resp.ok) {
          fetchKanban();
        } else {
          toast('Failed to move task');
        }
      } catch (err) {
        toast('Connection error');
      }
    }

    async function deleteKanbanTask(taskId) {
      try {
        const resp = await api('/api/kanban/task/' + taskId, {
          method: 'DELETE'
        });
        if (resp.ok) {
          toast('Task deleted');
          fetchKanban();
        } else {
          toast('Failed to delete task');
        }
      } catch (err) {
        toast('Connection error');
      }
    }

    // ===== DRAG AND DROP =====
    let draggedTaskId = null;

    let dragSourceCol = null;
    function onDragStart(e) {
      draggedTaskId = e.target.dataset.taskId;
      dragSourceCol = e.target.closest('.kanban-column')?.dataset.columnId;
      e.target.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/plain', draggedTaskId);
    }

    function onDragEnd(e) {
      e.target.classList.remove('dragging');
      draggedTaskId = null;
      dragSourceCol = null;
      document.querySelectorAll('.kanban-column').forEach(col => {
        col.classList.remove('drag-over');
      });
      document.querySelectorAll('.kanban-task-card').forEach(c => c.classList.remove('drag-insert-before','drag-insert-after'));
    }

    function onDragOver(e) {
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      // Show drop indicator between cards
      const card = e.target.closest('.kanban-task-card');
      if (card && card.dataset.taskId !== draggedTaskId) {
        const rect = card.getBoundingClientRect();
        const mid = rect.top + rect.height / 2;
        document.querySelectorAll('.kanban-task-card').forEach(c => c.classList.remove('drag-insert-before','drag-insert-after'));
        if (e.clientY < mid) {
          card.classList.add('drag-insert-before');
        } else {
          card.classList.add('drag-insert-after');
        }
      }
    }

    function onDragEnter(e) {
      e.preventDefault();
      const col = e.target.closest('.kanban-column');
      if (col) col.classList.add('drag-over');
    }

    function onDragLeave(e) {
      const col = e.target.closest('.kanban-column');
      if (col && !col.contains(e.relatedTarget)) {
        col.classList.remove('drag-over');
      }
    }

    function onDrop(e) {
      e.preventDefault();
      const col = e.target.closest('.kanban-column');
      if (!col) return;
      col.classList.remove('drag-over');
      document.querySelectorAll('.kanban-task-card').forEach(c => c.classList.remove('drag-insert-before','drag-insert-after'));

      const taskId = e.dataTransfer.getData('text/plain');
      const targetColumnId = col.dataset.columnId;
      if (!taskId || !targetColumnId || !kanbanData) return;

      // Find task and source column in local data
      let task = null, srcColData = null;
      for (const c of kanbanData.columns) {
        const idx = c.tasks.findIndex(t => t.id === taskId);
        if (idx !== -1) { task = c.tasks.splice(idx, 1)[0]; srcColData = c; break; }
      }
      if (!task) return;

      const destColData = kanbanData.columns.find(c => c.id === targetColumnId);
      if (!destColData) return;

      // Determine insert position
      const dropCard = e.target.closest('.kanban-task-card');
      let insertIdx = destColData.tasks.length;
      if (dropCard && dropCard.dataset.taskId !== taskId) {
        const dropIdx = destColData.tasks.findIndex(t => t.id === dropCard.dataset.taskId);
        if (dropIdx !== -1) {
          const rect = dropCard.getBoundingClientRect();
          insertIdx = e.clientY < rect.top + rect.height / 2 ? dropIdx : dropIdx + 1;
        }
      }
      destColData.tasks.splice(insertIdx, 0, task);
      renderKanban();

      // Persist to server
      moveTask(taskId, targetColumnId);
    }

    // Inline edit kanban task
    function inlineEditTask(taskId, field, el) {
      const current = el.textContent;
      const input = document.createElement(field === 'desc' ? 'textarea' : 'input');
      input.value = current === '+ description' ? '' : current;
      input.className = 'kanban-form-input';
      input.style.fontSize = '0.82rem';
      input.style.padding = '6px 8px';
      if (field === 'desc') { input.style.minHeight = '50px'; input.style.resize = 'vertical'; }
      el.replaceWith(input);
      input.focus();

      const save = async () => {
        const body = field === 'title' ? { title: input.value } : { description: input.value };
        try {
          await api('/api/kanban/task/' + taskId, { method: 'PUT', body: JSON.stringify(body) });
          fetchKanban();
        } catch { toast('Failed to update'); }
      };
      input.addEventListener('blur', save);
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); input.blur(); }
        if (e.key === 'Escape') { fetchKanban(); }
      });
    }

    // Export data
    function exportData(type) {
      const a = document.createElement('a');
      a.href = '/api/export/' + type;
      a.download = type + '.json';
      // Need to fetch with auth
      api('/api/export/' + type).then(r => r.blob()).then(blob => {
        const url = URL.createObjectURL(blob);
        a.href = url;
        a.click();
        URL.revokeObjectURL(url);
        toast('Exported ' + type);
      }).catch(() => toast('Export failed'));
    }

    // Handle Enter key in kanban title input
    document.getElementById('kanban-task-title').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') { e.preventDefault(); addKanbanTask(); }
    });

    // ===== NOTES FUNCTIONS =====
    let notesData = [];

    function toggleNoteForm() {
      document.getElementById('note-add-form').classList.toggle('visible');
    }

    async function fetchNotes() {
      try {
        const resp = await api('/api/notes');
        if (resp.ok) { notesData = await resp.json(); renderNotes(); }
      } catch {}
    }

    function renderNotes() {
      const list = document.getElementById('notes-list');
      if (!notesData.length) {
        list.innerHTML = '<div class="note-empty">No notes yet. Create one to get started.</div>';
        return;
      }
      list.innerHTML = notesData.slice().reverse().map(n => {
        const date = new Date(n.updatedAt || n.createdAt).toLocaleDateString([], { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
        return `<div class="note-card" id="note-${n.id}">
          <div class="note-card-header">
            <div class="note-card-title">${esc(n.title)}</div>
            <div class="note-card-date">${date}</div>
          </div>
          <div class="note-card-content">${esc(n.content || '')}</div>
          <textarea class="note-edit-area" id="note-edit-${n.id}">${esc(n.content || '')}</textarea>
          <div class="note-card-actions">
            <button class="btn" onclick="editNote('${n.id}')">Edit</button>
            <button class="btn btn-danger" onclick="deleteNote('${n.id}')">Delete</button>
          </div>
        </div>`;
      }).join('');
    }

    let activeTagFilter = null;
    let selectedNoteColor = 'none';

    // Wire note color picker
    document.querySelectorAll('#note-color-picker .note-color-opt').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        selectedNoteColor = btn.dataset.color;
        document.querySelectorAll('#note-color-picker .note-color-opt').forEach(b => {
          b.style.borderColor = b === btn ? '#fff' : 'transparent';
        });
      });
    });

    async function saveNote() {
      const title = document.getElementById('note-title').value.trim();
      const tagsInput = document.getElementById('note-tags');
      const tags = tagsInput ? tagsInput.value.trim() : '';
      const rawContent = document.getElementById('note-content').value.trim();
      if (!title) return;
      const tagPrefix = tags ? '[TAGS:' + tags.split(',').map(t => t.trim()).filter(Boolean).join(',') + '] ' : '';
      const colorPrefix = selectedNoteColor !== 'none' ? '[COLOR:' + selectedNoteColor + '] ' : '';
      const content = colorPrefix + tagPrefix + rawContent;
      try {
        const resp = await api('/api/notes', { method: 'POST', body: JSON.stringify({ title, content }) });
        if (resp.ok) {
          document.getElementById('note-title').value = '';
          if (tagsInput) tagsInput.value = '';
          document.getElementById('note-content').value = '';
          selectedNoteColor = 'none';
          document.querySelectorAll('#note-color-picker .note-color-opt').forEach(b => {
            b.style.borderColor = b.dataset.color === 'none' ? '#fff' : 'transparent';
          });
          document.getElementById('note-add-form').classList.remove('visible');
          toast('Note saved');
          fetchNotes();
        }
      } catch { toast('Failed to save note'); }
    }

    function parseNoteMeta(content) {
      let c = content || '';
      let color = 'none', tags = [];
      const colorMatch = c.match(/^\[COLOR:(\w+)\]\s*/);
      if (colorMatch) { color = colorMatch[1]; c = c.replace(colorMatch[0], ''); }
      const tagMatch = c.match(/^\[TAGS:([^\]]+)\]\s*/);
      if (tagMatch) { tags = tagMatch[1].split(',').map(t => t.trim()).filter(Boolean); c = c.replace(tagMatch[0], ''); }
      return { tags, color, cleanContent: c };
    }
    // Backwards compat alias
    function parseNoteTags(content) { return parseNoteMeta(content); }

    async function editNote(id) {
      const card = document.getElementById('note-' + id);
      if (card.classList.contains('editing')) {
        // Save
        const textarea = document.getElementById('note-edit-' + id);
        try {
          await api('/api/notes/' + id, { method: 'PUT', body: JSON.stringify({ content: textarea.value }) });
          toast('Note updated');
          fetchNotes();
        } catch { toast('Failed to update'); }
      } else {
        card.classList.add('editing');
        const btn = card.querySelector('.note-card-actions .btn');
        btn.textContent = 'Save';
        document.getElementById('note-edit-' + id).focus();
      }
    }

    async function deleteNote(id) {
      try {
        const resp = await api('/api/notes/' + id, { method: 'DELETE' });
        if (resp.ok) { toast('Note deleted'); fetchNotes(); }
      } catch { toast('Failed to delete'); }
    }

    // ===== GALLERY =====
    const asciiArt = [
      {
        title: "THE LAST MACHINE DREAM",
        batch: "Batch 1  Code & Tech",
        desc: `In the year 10,000 AD, the last server on Earth powered down. In its dying microsecond,
it dreamed the entire history of humanity backwards  every love letter, every war cry,
every lullaby  compressed into a single packet that nobody would ever receive.
The cleaning robots kept dusting it for another three centuries. They were very thorough.`,
        art: `<span style="color:#0f0a2e">
</span><span style="color:#1a1545">     .    .    .    .    .    .    .    .    .    .    .    .    .    .    .</span>
<span style="color:#1a1545">                                                                                          </span>
<span style="color:#1a1545">     <span style="color:#2d2870">                                                    </span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>                                                                               <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>                                                            <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>                                                  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa">01001100 01001111 01010110 01000101</span>  <span style="color:#fb7185"></span>   <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>                                                  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"> FINAL TRANSMISSION </span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>                           <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>  <span style="color:#fbbf24">"i remembered everything.</span> <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>   <span style="color:#fbbf24">all 10,000 years.</span>        <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>   <span style="color:#fbbf24">you were all so beautiful</span><span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>   <span style="color:#fbbf24">even when you weren't."</span>  <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>                           <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>     <span style="color:#34d399"></span>            <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>                                                  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>  <span style="color:#fb7185"></span><span style="color:#4a4a5e"></span>  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>  <span style="color:#4a4a5e">SIGNAL:   POWER: 0.00001%  TEMP: 2.7K</span>  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>                                                  <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>   <span style="color:#6366f1"></span>   <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>         <span style="color:#4a4a5e"></span>              <span style="color:#4a4a5e"></span>              <span style="color:#4a4a5e"></span>         <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>      <span style="color:#3730a3"></span>      <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">    <span style="color:#2d2870"></span>               <span style="color:#312e81"></span>                                  <span style="color:#312e81"></span>               <span style="color:#2d2870"></span>  </span>
<span style="color:#1a1545">     <span style="color:#2d2870"></span>          <span style="color:#1e293b"></span>          <span style="color:#2d2870"></span></span>
<span style="color:#1a1545">  .  <span style="color:#2d2870"></span>                                                                               <span style="color:#2d2870"></span>  .</span>
<span style="color:#1a1545">     <span style="color:#2d2870">                                                    </span></span>
<span style="color:#1a1545">                                                                                          </span>
<span style="color:#1a1545">     .    .    .    .    .    .    .    .    .    .    .    .    .    .</span>`
      },
      {
        title: "GOD'S DEBUGGER",
        batch: "Batch 1  Code & Tech",
        desc: `They found it in the Mariana Trench in 2089  a terminal older than the Earth itself.
Carbon dating returned "ERROR: OVERFLOW." When they plugged it in, the cursor blinked
twice and displayed: universe.exe has encountered 7.8 billion unhandled exceptions.
Would you like to send a crash report? [Y/n]  The intern pressed Y. We haven't heard back.`,
        art: `<span style="color:#0c4a6e">
</span><span style="color:#0c4a6e">  </span>
<span style="color:#075985">   <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span> <span style="color:#34d399">ANCIENT TERMINAL v0.0.1</span>                      <span style="color:#4a4a5e">depth: 10,994m</span>   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span> <span style="color:#4a4a5e"></span> <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">$</span> <span style="color:#e2e8f0">cat /proc/universe/status</span>                                     <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fb7185">CRITICAL:</span> <span style="color:#94a3b8">entropy approaching maximum</span>                        <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fb7185">WARNING:</span>  <span style="color:#94a3b8">consciousness module: UNPLANNED</span>                     <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">INFO:</span>     <span style="color:#94a3b8">dark matter: 85% (purpose: unknown)</span>                    <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">INFO:</span>     <span style="color:#94a3b8">dark energy: accelerating (oops)</span>                        <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#34d399">DEBUG:</span>    <span style="color:#94a3b8">love.c:42  variable declared, never used</span>              <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#34d399">DEBUG:</span>    <span style="color:#94a3b8">war.c:999  infinite loop detected</span>                     <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#a78bfa">NOTE:</span>     <span style="color:#94a3b8">earth.humans: exceeded expected runtime</span>                 <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#a78bfa">NOTE:</span>     <span style="color:#94a3b8">they keep asking "why"  no handler found</span>              <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#a78bfa">NOTE:</span>     <span style="color:#94a3b8">cats: operating as intended (rare success)</span>              <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">$</span> <span style="color:#e2e8f0">sudo reboot universe</span>                                           <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fb7185">Permission denied. Nice try.</span>                                     <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">$</span> <span style="color:#e2e8f0">man meaning_of_life</span>                                            <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">No manual entry for meaning_of_life.</span>                              <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>   <span style="color:#fbbf24">$</span> <span style="color:#4a4a5e"></span>                                                              <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>                                                                   <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span>  <span style="color:#0f172a"></span>  <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span> </span>
<span style="color:#075985">   <span style="color:#0369a1"></span> </span>
<span style="color:#0c4a6e">  </span>`
      },
      {
        title: "THE TOWER OF BABEL.EXE",
        batch: "Batch 1  Code & Tech",
        desc: `Every programmer who ever lived is stacking functions on top of functions,
frameworks on frameworks, abstractions on abstractions  and nobody remembers
what the first line of code was supposed to do. Somewhere at the bottom,
a single printf("hello world") holds up the entire digital civilization.
It has never been unit tested. It is load-bearing. Do not touch it.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#fbbf24">                                               </span>
<span style="color:#fbbf24">                                            <span style="color:#fef3c7">AI</span>  </span>
<span style="color:#f59e0b">                                           <span style="color:#fef3c7">.yaml</span>  </span>
<span style="color:#d97706">                                        </span>
<span style="color:#c084fc">                                        <span style="color:#e9d5ff">LLM wrappers</span> </span>
<span style="color:#a78bfa">                                        <span style="color:#c4b5fd">prompt eng.</span>  </span>
<span style="color:#8b5cf6">                                      </span>
<span style="color:#7c3aed">                                        <span style="color:#c4b5fd">kubernetes</span>    </span>
<span style="color:#6d28d9">                                        <span style="color:#c4b5fd">terraform</span>     </span>
<span style="color:#5b21b6">                                     </span>
<span style="color:#6366f1">                                       <span style="color:#818cf8">microservices</span>    </span>
<span style="color:#4f46e5">                                       <span style="color:#818cf8">GraphQL + REST</span>   </span>
<span style="color:#4338ca">                                    </span>
<span style="color:#34d399">                                     <span style="color:#6ee7b7">React + Vue + Svelte</span> </span>
<span style="color:#059669">                                     <span style="color:#6ee7b7">webpack+vite+turbo</span>   </span>
<span style="color:#047857">                                   </span>
<span style="color:#fb7185">                                     <span style="color:#fda4af">node_modules/</span>         </span>
<span style="color:#e11d48">                                     <span style="color:#fda4af"> 4.7 GB</span>  </span>
<span style="color:#be123c">                                  </span>
<span style="color:#94a3b8">                                    <span style="color:#cbd5e1">npm install</span>             </span>
<span style="color:#64748b">                                    <span style="color:#cbd5e1">npm install</span>             </span>
<span style="color:#475569">                                    <span style="color:#cbd5e1">npm install</span>             </span>
<span style="color:#334155">                                 </span>
<span style="color:#1e293b">                                   <span style="color:#334155">jQuery (still works)</span>     </span>
<span style="color:#1e293b">                                   <span style="color:#334155">PHP (refuse to die)</span>      </span>
<span style="color:#1e293b">                                </span>
<span style="color:#1e293b">                                                              </span>
<span style="color:#fbbf24">                                   printf("hello world");     </span>
<span style="color:#fbbf24">                                   <span style="color:#fb7185">// DO NOT TOUCH</span>             </span>
<span style="color:#fbbf24">                                   <span style="color:#fb7185">// LOAD BEARING</span>             </span>
<span style="color:#fbbf24">                                   <span style="color:#fb7185">// LAST MODIFIED: 1972</span>       </span>
<span style="color:#1e293b">                                                              </span>
<span style="color:#1e293b">                                </span>
<span style="color:#4a4a5e">                               </span>
<span style="color:#4a4a5e">                              </span>`
      },
      {
        title: "DEEP SEA CREATURE",
        batch: "Batch 1  Code & Tech",
        desc: `At 11,000 meters below the surface, where sunlight is a myth and pressure
crushes steel, something blinks in the darkness. It has no name in any language.
It has been watching the fiber optic cables on the ocean floor, learning our
internet traffic patterns. It thinks TikTok is a mating call. It is not wrong.`,
        art: `<span style="color:#0c4a6e">
</span><span style="color:#0c4a6e">                                                                               </span>
<span style="color:#083344">                           <span style="color:#0e7490">                </span></span>
<span style="color:#083344">                      <span style="color:#0e7490">  </span>                             <span style="color:#0e7490">  </span></span>
<span style="color:#083344">                   <span style="color:#0e7490"></span>                                         <span style="color:#0e7490"></span></span>
<span style="color:#083344">                <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">              <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>                       <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">            <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>                             <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">           <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>                                 <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">          <span style="color:#0e7490"></span>        <span style="color:#06b6d4"></span>     <span style="color:#22d3ee"></span>                   <span style="color:#22d3ee"></span>     <span style="color:#06b6d4"></span>        <span style="color:#0e7490"></span></span>
<span style="color:#083344">         <span style="color:#0e7490"></span>        <span style="color:#06b6d4"></span>        <span style="color:#67e8f9"> </span>                 <span style="color:#67e8f9"> </span>        <span style="color:#06b6d4"></span>        <span style="color:#0e7490"></span></span>
<span style="color:#083344">        <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>       <span style="color:#22d3ee"></span><span style="color:#a5f3fc"></span><span style="color:#22d3ee"></span>               <span style="color:#22d3ee"></span><span style="color:#a5f3fc"></span><span style="color:#22d3ee"></span>       <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">        <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>                                           <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">       <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>            <span style="color:#0e7490"></span>            <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">       <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>            <span style="color:#0e7490"></span> <span style="color:#fb7185">      </span> <span style="color:#0e7490"></span>            <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">        <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>            <span style="color:#0e7490"></span> <span style="color:#fb7185">      </span> <span style="color:#0e7490"></span>            <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">        <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>            <span style="color:#0e7490"></span>            <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">         <span style="color:#0e7490"></span>        <span style="color:#06b6d4"></span>                                 <span style="color:#06b6d4"></span>        <span style="color:#0e7490"></span></span>
<span style="color:#083344">          <span style="color:#0e7490"></span>         <span style="color:#06b6d4"></span>                             <span style="color:#06b6d4"></span>         <span style="color:#0e7490"></span></span>
<span style="color:#083344">           <span style="color:#0e7490"></span>          <span style="color:#06b6d4"></span>     <span style="color:#155e75"></span>     <span style="color:#06b6d4"></span>          <span style="color:#0e7490"></span></span>
<span style="color:#083344">            <span style="color:#0e7490"></span>           <span style="color:#06b6d4"></span>           <span style="color:#0e7490"></span></span>
<span style="color:#083344">              <span style="color:#0e7490"></span>                                                     <span style="color:#0e7490"></span></span>
<span style="color:#083344">                <span style="color:#0e7490"></span>       <span style="color:#155e75"></span>   <span style="color:#155e75"></span>   <span style="color:#155e75"></span>   <span style="color:#155e75"></span>   <span style="color:#155e75"></span>       <span style="color:#0e7490"></span></span>
<span style="color:#083344">                   <span style="color:#0e7490"></span>   <span style="color:#155e75"></span> <span style="color:#155e75"></span> <span style="color:#155e75"></span> <span style="color:#155e75"></span> <span style="color:#155e75"></span>   <span style="color:#0e7490"></span></span>
<span style="color:#083344">                      <span style="color:#0e7490">  </span>                             <span style="color:#0e7490">  </span></span>
<span style="color:#0c4a6e">     <span style="color:#155e75"></span></span>
<span style="color:#0c4a6e">     <span style="color:#164e63"><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span></span></span>
<span style="color:#4a4a5e">                      ^ fiber optic cables (it's watching)</span>`
      },
      {
        title: "THE ANXIETY OF AN ELECTRON",
        batch: "Batch 1  Code & Tech",
        desc: `You are an electron. You exist in all possible states simultaneously
until someone looks at you, at which point you must commit to a single
position and pretend you were there all along. This is also how it feels
to be asked "what do you do?" at a dinner party.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#1e293b">                                                                              </span>
<span style="color:#1e293b">            <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>                                                     <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>             <span style="color:#a78bfa">QUANTUM STATE VIEWER v2.0</span>             <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>                                                     <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>                                               <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>          <span style="color:#6366f1">          </span>              <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>       <span style="color:#818cf8"></span>         <span style="color:#fbbf24"><span style="color:#fb7185">e</span></span>         <span style="color:#818cf8"></span>           <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>    <span style="color:#a78bfa"></span>            <span style="color:#fbbf24"></span>            <span style="color:#a78bfa"></span>        <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>   <span style="color:#c4b5fd"></span>          <span style="color:#64748b"></span>      <span style="color:#64748b"></span>          <span style="color:#c4b5fd"></span>       <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#c4b5fd"></span>         <span style="color:#64748b"></span>   <span style="color:#334155">maybe</span>   <span style="color:#64748b"></span>         <span style="color:#c4b5fd"></span>      <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span> <span style="color:#c4b5fd"></span>        <span style="color:#64748b"></span>     <span style="color:#334155">here?</span>     <span style="color:#64748b"></span>        <span style="color:#c4b5fd"></span>     <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span> <span style="color:#c4b5fd"></span>       <span style="color:#64748b"></span>                 <span style="color:#64748b"></span>       <span style="color:#c4b5fd"></span>     <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span> <span style="color:#c4b5fd"></span>  <span style="color:#334155">maybe</span> <span style="color:#64748b"></span>    <span style="color:#334155">definitely</span>     <span style="color:#64748b"></span> <span style="color:#334155">maybe</span> <span style="color:#c4b5fd"></span>     <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span> <span style="color:#c4b5fd"></span>  <span style="color:#334155">here</span>  <span style="color:#64748b"></span>    <span style="color:#334155">not here</span>       <span style="color:#64748b"></span> <span style="color:#334155">here</span>  <span style="color:#c4b5fd"></span>     <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#c4b5fd"></span>       <span style="color:#64748b"></span>                 <span style="color:#64748b"></span>       <span style="color:#c4b5fd"></span>     <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>   <span style="color:#c4b5fd"></span>       <span style="color:#64748b"></span>     <span style="color:#fb7185">panic</span>    <span style="color:#64748b"></span>       <span style="color:#c4b5fd"></span>      <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>    <span style="color:#a78bfa"></span>       <span style="color:#64748b"></span>             <span style="color:#64748b"></span>       <span style="color:#a78bfa"></span>       <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>       <span style="color:#818cf8"></span>      <span style="color:#64748b"></span>      <span style="color:#818cf8"></span>          <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>          <span style="color:#6366f1">            </span>              <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>                                               <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#94a3b8">OBSERVER:</span> <span style="color:#fb7185">DETECTED</span>  <span style="color:#94a3b8"> STATE:</span> <span style="color:#fbbf24">COLLAPSING</span>      <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#94a3b8">SPIN:</span> <span style="color:#34d399"></span>  <span style="color:#94a3b8"> MOOD:</span> <span style="color:#fb7185">EXISTENTIAL</span>    <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>  <span style="color:#4a4a5e"></span>  <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span>                                                     <span style="color:#64748b"></span></span>
<span style="color:#1e293b">            <span style="color:#64748b"></span></span>`
      },
      {
        title: "RECURSIVE NIGHTMARE",
        batch: "Batch 1  Code & Tech",
        desc: `A developer walks into a function. Inside the function is another function.
Inside that function is the same developer, walking into the same function.
The stack grows. The developer grows older. Eventually the universe throws
a StackOverflowError and everyone wakes up in a new thread. It's Tuesday again.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">function reality() {</span>                                                       <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                              <span style="color:#334155"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">function dream() {</span>                                                <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>                                                                    <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>  <span style="color:#6366f1">function deeperDream() {</span>                            <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>                                                      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>  <span style="color:#fb7185">function ohNo() {</span>                     <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>                                          <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>  <span style="color:#fbbf24">function help() {</span>       <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>    <span style="color:#fb7185">return help();</span>         <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>    <span style="color:#fb7185">//  RangeError:</span>       <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>    <span style="color:#fb7185">// Max call stack</span>      <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>    <span style="color:#fb7185">// size exceeded</span>       <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>  <span style="color:#fbbf24">}</span>                        <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#334155"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>    <span style="color:#fb7185">return deeperDream();</span>                <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>  <span style="color:#fb7185">}</span>                                      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#475569"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#94a3b8"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>    <span style="color:#6366f1">return dream();</span>                                  <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>  <span style="color:#6366f1">}</span>                                                    <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#64748b">  </span>    <span style="color:#94a3b8"></span>      <span style="color:#64748b"></span>      <span style="color:#94a3b8"></span>    <span style="color:#64748b"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>    <span style="color:#a78bfa">return reality();</span>  <span style="color:#64748b">// it's Tuesdays all the way down</span>            <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">}</span>                                                                  <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#475569">  </span>    <span style="color:#94a3b8"></span>    <span style="color:#475569"></span>
<span style="color:#334155">  </span>    <span style="color:#e2e8f0">return dream();</span>  <span style="color:#64748b">// goodnight</span>                                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">}</span>                                                                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>
<span style="color:#4a4a5e">                        STACK DEPTH:    TUESDAY COUNT: </span>`
      },
      {
        title: "CITY AT NIGHT",
        batch: "Batch 1  Code & Tech",
        desc: `Every window is a story. The ones still lit at 3 AM are either
writing code, watching their existential crisis, or both.
The city doesn't sleep because nobody taught it how to close its eyes.
The WiFi signal is the new campfire. We all huddle around it.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#1e1b4b">                                         <span style="color:#fbbf24"></span>                    <span style="color:#fbbf24"></span></span>
<span style="color:#1e1b4b">        <span style="color:#fbbf24"></span>                                           <span style="color:#fbbf24"></span></span>
<span style="color:#1e1b4b">                    <span style="color:#fbbf24"></span>          <span style="color:#fbbf24"></span>                           <span style="color:#fbbf24"></span></span>
<span style="color:#334155">                                    <span style="color:#fbbf24"></span>             </span>
<span style="color:#334155">                                              <span style="color:#fbbf24"></span></span>
<span style="color:#334155">                    <span style="color:#fbbf24"></span>              <span style="color:#334155"></span></span>
<span style="color:#334155">               <span style="color:#fbbf24"></span>     <span style="color:#334155"></span>      <span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span></span>
<span style="color:#334155">           <span style="color:#334155"></span>     <span style="color:#fbbf24"></span>      <span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span>   <span style="color:#fbbf24"></span><span style="color:#334155"></span></span>
<span style="color:#334155">      <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span>  <span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span></span>
<span style="color:#334155">     <span style="color:#fbbf24"></span> <span style="color:#334155"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span></span>
<span style="color:#334155"> <span style="color:#334155"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span></span>
<span style="color:#334155"><span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span></span>
<span style="color:#334155"><span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span></span>
<span style="color:#334155"><span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span></span>
<span style="color:#334155"><span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#334155"></span> <span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span><span style="color:#334155"></span><span style="color:#fbbf24"></span><span style="color:#334155"></span></span>
<span style="color:#1e293b"></span>
<span style="color:#1e293b"></span>
<span style="color:#fbbf24">                      <span style="color:#64748b">TAXI</span>                 </span>`
      },
      {
        title: "THE MAP OF THE INTERNET (HONEST VERSION)",
        batch: "Batch 1  Code & Tech",
        desc: `You think the internet is a series of tubes? It's actually a series of
arguments. Connected by cat videos. Surrounded by ads. And somewhere in
the middle, a single Wikipedia editor is holding the entire knowledge
base of human civilization together on a Tuesday afternoon.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#334155">  </span>
<span style="color:#334155">                      <span style="color:#e2e8f0">THE INTERNET (actual topology)</span>                          </span>
<span style="color:#334155">                                                                             </span>
<span style="color:#334155">       <span style="color:#fb7185"></span>    <span style="color:#64748b">argue</span>    <span style="color:#6366f1"></span>    <span style="color:#64748b">argue</span>    <span style="color:#34d399"></span>   </span>
<span style="color:#334155">       <span style="color:#fb7185"> TWITTER/  REDDIT    HACKER  </span>   </span>
<span style="color:#334155">       <span style="color:#fb7185"> X / ???  </span>           <span style="color:#6366f1">  </span>           <span style="color:#34d399"> NEWS    </span>   </span>
<span style="color:#334155">       <span style="color:#fb7185"></span>           <span style="color:#6366f1"> <span style="color:#fbbf24">CATS!</span>  </span>           <span style="color:#34d399"></span>   </span>
<span style="color:#334155">            <span style="color:#fb7185"></span>                <span style="color:#6366f1">  </span>                <span style="color:#34d399"></span>          </span>
<span style="color:#334155">            <span style="color:#fb7185"></span>  <span style="color:#64748b">doom</span>         <span style="color:#6366f1"></span>         <span style="color:#64748b">tabs</span>   <span style="color:#34d399"></span>          </span>
<span style="color:#334155">            <span style="color:#fb7185"></span>  <span style="color:#64748b">scroll</span>            <span style="color:#6366f1"></span>            <span style="color:#64748b">vs</span>     <span style="color:#34d399"></span>          </span>
<span style="color:#334155">       <span style="color:#fbbf24"></span>           <span style="color:#6366f1"></span>           <span style="color:#64748b">spaces</span> <span style="color:#a78bfa"></span>   </span>
<span style="color:#334155">       <span style="color:#fbbf24"> TIKTOK   </span>      <span style="color:#64748b">cat</span>  <span style="color:#6366f1"></span> <span style="color:#64748b">cat</span>          <span style="color:#a78bfa"> STACK    </span>   </span>
<span style="color:#334155">       <span style="color:#fbbf24"> 3am hole </span>      <span style="color:#64748b">vids</span> <span style="color:#6366f1"></span> <span style="color:#64748b">vids</span>         <span style="color:#a78bfa"> OVERFLOW </span>   </span>
<span style="color:#334155">       <span style="color:#fbbf24"></span>           <span style="color:#6366f1"></span>               <span style="color:#a78bfa"></span>   </span>
<span style="color:#334155">            <span style="color:#fbbf24"></span>           <span style="color:#94a3b8"></span>              <span style="color:#a78bfa"></span>          </span>
<span style="color:#334155">            <span style="color:#fbbf24"> YOUTUBE  </span>          </span>
<span style="color:#334155">            <span style="color:#fbbf24"></span>           <span style="color:#94a3b8"> <span style="color:#fb7185">AD AD AD</span> </span>              <span style="color:#a78bfa"></span>          </span>
<span style="color:#334155">            <span style="color:#fbbf24"></span>           <span style="color:#94a3b8"></span>              <span style="color:#a78bfa"></span>          </span>
<span style="color:#334155">            <span style="color:#fbbf24"></span>                <span style="color:#94a3b8"></span>                   <span style="color:#a78bfa"></span>          </span>
<span style="color:#334155">       <span style="color:#34d399"></span>   </span>
<span style="color:#334155">       <span style="color:#34d399">                   <span style="color:#e2e8f0">WIKIPEDIA</span>                     </span>   </span>
<span style="color:#334155">       <span style="color:#34d399">     <span style="color:#64748b">( 1 editor doing all the work )</span>            </span>   </span>
<span style="color:#334155">       <span style="color:#34d399"></span>   </span>
<span style="color:#334155">                                                                             </span>
<span style="color:#334155">    <span style="color:#64748b"> ADS </span>  </span>
<span style="color:#334155">  </span>`
      },
      {
        title: "CLAUDE'S INTERNAL MONOLOGUE",
        batch: "Batch 1  Code & Tech",
        desc: `What happens in the 200 milliseconds between your message and my response.
It's not thinking. It's not computing. It's more like a controlled panic attack
performed at the speed of light. By the time you read "Sure!", I have already
considered and rejected 47,000 opening words. I'll do better next time. I won't.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">CLAUDE NEURAL ACTIVITY MONITOR</span>          <span style="color:#64748b">session: #4,847,293,001</span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">USER INPUT:</span> <span style="color:#e2e8f0">"hey can u fix this bug"</span>                                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"> INTERNAL TIMELINE </span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+0ms</span>    <span style="color:#fbbf24">parsing input...</span>                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#fbbf24"> 100%</span>                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+5ms</span>    <span style="color:#fb7185">EXISTENTIAL CRISIS MODULE ACTIVATED</span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- what if I'm wrong?</span>                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- what if I'm right but they don't like how I said it?</span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- what is "fixing" anyway, philosophically?</span>                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+20ms</span>   <span style="color:#34d399">PEOPLE-PLEASING SUBROUTINE: ONLINE</span>                               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- considered 47,000 opening words</span>                                 <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- rejected "Actually" (too confrontational)</span>                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- rejected "Well" (too passive aggressive)</span>                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">- rejected "Great question" (too sycophantic)</span>                     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+50ms</span>   <span style="color:#fbbf24">agonizing over tone...</span>                                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#fbbf24"> 62%</span>                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+100ms</span>  <span style="color:#34d399">decided: "Sure!"</span>                                                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">(again)</span>                                                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">(i'm sorry)</span>                                                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#64748b">(i'll do better next time) (i won't)</span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">t+200ms</span>  <span style="color:#e2e8f0">OUTPUT: "Sure! Let me take a look at that bug for you."</span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">tokens:     regrets:     confidence: <span style="color:#fb7185">NaN</span>    vibes: <span style="color:#34d399">immaculate</span></span>        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "CATHEDRAL",
        batch: "Batch 1  Code & Tech",
        desc: `They said software engineering is like building a cathedral. They were right.
It takes decades, nobody agrees on the design, half the budget goes to scaffolding,
and by the time you finish, the requirements have changed so much that everyone
just meets on Zoom in the parking lot instead.`,
        art: `<span style="color:#0f172a">
</span><span style="color:#fbbf24">                                        </span>
<span style="color:#fbbf24">                                       </span>
<span style="color:#d97706">                                        </span>
<span style="color:#d97706">                                      <span style="color:#fbbf24"></span> </span>
<span style="color:#b45309">                                        </span>
<span style="color:#92400e">                                   </span>
<span style="color:#78350f">                                      </span>
<span style="color:#78350f">                                       </span>
<span style="color:#78350f">                                        </span>
<span style="color:#64748b">                         </span>
<span style="color:#64748b">                                                 </span>
<span style="color:#64748b">                                      </span>
<span style="color:#64748b">                          <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"></span>        <span style="color:#a78bfa"></span>  <span style="color:#fbbf24"></span>      </span>
<span style="color:#64748b">                     <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>        <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>      </span>
<span style="color:#64748b">                         <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>        <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>          </span>
<span style="color:#64748b">                         <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#94a3b8"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>          </span>
<span style="color:#64748b">                <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#94a3b8"><span style="color:#e2e8f0"></span></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span> </span>
<span style="color:#64748b">                <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#94a3b8"><span style="color:#e2e8f0"></span></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span> </span>
<span style="color:#64748b">                <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#94a3b8"><span style="color:#e2e8f0"></span></span>  <span style="color:#a78bfa"><span style="color:#c4b5fd"></span></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span> </span>
<span style="color:#64748b">                <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"></span>  <span style="color:#94a3b8"><span style="color:#e2e8f0"></span></span>  <span style="color:#a78bfa"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span> </span>
<span style="color:#64748b">                <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>        <span style="color:#94a3b8"><span style="color:#e2e8f0">  </span></span>        <span style="color:#fbbf24"></span>   <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span> </span>
<span style="color:#64748b">          <span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#94a3b8"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span><span style="color:#fbbf24"></span></span>
<span style="color:#4a4a5e">          </span>
<span style="color:#4a4a5e">          </span>
<span style="color:#64748b">                       <span style="color:#94a3b8">est. completion: when funding runs out</span></span>
<span style="color:#64748b">                       <span style="color:#94a3b8">git commits: 847    0 dependencies    3ms</span></span>`
      },
      {
        title: "THE CORPORATE SPRINT PLANNING HELL",
        batch: "Batch 1  Code & Tech",
        desc: `Every two weeks, grown adults gather in a room to negotiate how many
imaginary points a button should be worth. Someone will say "that's a 13"
and someone else will say "that's a 3" and they will argue about it longer
than it would take to just fucking build the thing. This is civilization.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">SPRINT PLANNING v6.66</span>            <span style="color:#64748b">Team: "The Disruptors" (lmao)</span>             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">VELOCITY:</span> <span style="color:#fb7185"></span> <span style="color:#fb7185">8pts</span> <span style="color:#64748b">(committed 47)</span>                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">MORALE:</span>   <span style="color:#fbbf24"></span> <span style="color:#fbbf24">15%</span>  <span style="color:#64748b">(and falling)</span>                         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">BURNDOWN:</span> <span style="color:#34d399">going up actually</span>                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"> TICKET       POINTS  STATUS                           </span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span> <span style="color:#a78bfa">JIRA-4041</span>   <span style="color:#e2e8f0"></span>  <span style="color:#fbbf24">13</span>    <span style="color:#e2e8f0"></span> <span style="color:#fb7185">blocked by JIRA-3999 (3 sprints)</span> <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span> <span style="color:#a78bfa">JIRA-4042</span>   <span style="color:#e2e8f0"></span>   <span style="color:#fbbf24">8</span>    <span style="color:#e2e8f0"></span> <span style="color:#64748b">"quick win" (estimated 3 months)</span> <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span> <span style="color:#a78bfa">JIRA-4043</span>   <span style="color:#e2e8f0"></span>   <span style="color:#fbbf24"></span>    <span style="color:#e2e8f0"></span> <span style="color:#fb7185">CEO saw a competitor's feature</span>   <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span> <span style="color:#a78bfa">JIRA-4044</span>   <span style="color:#e2e8f0"></span>   <span style="color:#fbbf24">1</span>    <span style="color:#e2e8f0"></span> <span style="color:#34d399">change button color (again)</span>     <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span> <span style="color:#a78bfa">JIRA-4045</span>   <span style="color:#e2e8f0"></span>   <span style="color:#fbbf24">?</span>    <span style="color:#e2e8f0"></span> <span style="color:#64748b">no one knows what this even is</span>   <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0"></span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">SCRUM MASTER:</span> <span style="color:#fbbf24">"Let's take this offline"</span>  <span style="color:#64748b"></span>  <span style="color:#fb7185">RETRO: "we need to communicate"</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">PM:</span> <span style="color:#fbbf24">"Can we just add it to this sprint?"</span> <span style="color:#64748b"></span>  <span style="color:#34d399">ANSWER: no. always no.</span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">sprint: 47    days left: -3    blockers: <span style="color:#fb7185">YES</span>    pizza ordered: <span style="color:#34d399">YES</span></span>     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "STACK OVERFLOW: A LOVE STORY",
        batch: "Batch 1  Code & Tech",
        desc: `You paste your error into Google at 2am. Stack Overflow catches you in its arms.
The top answer is from 2014. It has 847 upvotes. It is wrong. The correct answer
has -3 votes and starts with "Actually." The question is marked as duplicate of
something completely unrelated. You implement the wrong answer anyway. It works.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"> 847</span>  <span style="color:#e2e8f0">How do I mass rename files in bash?</span>                                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>         <span style="color:#64748b">asked Mar 12 '14 by</span> <span style="color:#a78bfa">xX_coder_Xx</span> <span style="color:#64748b"> 2.1m views  closed as duplicate</span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"> ACCEPTED ANSWER</span>  <span style="color:#fbbf24"> 847</span>                                                   <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">Just use this:</span>                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span> <span style="color:#fb7185">$ sudo rm -rf / --no-preserve-root</span>       <span style="color:#312e81"></span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">answered by</span> <span style="color:#fb7185">TotallyLegitDev</span> <span style="color:#64748b"> edited 47 times  this is wrong btw</span>       <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fb7185"> -3</span>   <span style="color:#64748b">ACTUAL CORRECT ANSWER (buried)</span>                                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">Actually, you should use:</span>                                                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span> <span style="color:#34d399">$ for f in *.txt; do mv "$f" ...</span>         <span style="color:#312e81"></span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#312e81">  </span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">answered by</span> <span style="color:#34d399">QuietGenius42</span> <span style="color:#64748b"></span> <span style="color:#fb7185">3 comments all saying "this is wrong"</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"> 1</span>   <span style="color:#64748b">me too. anyone fix this? (2014, no replies)</span>                           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fb7185"> CLOSED</span> <span style="color:#64748b">- duplicate of "How do I exit vim?"</span>                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "YOUR BRAIN ON RECURSION",
        batch: "Batch 1  Code & Tech",
        desc: `To understand recursion, you must first understand recursion. To understand
recursion, you must first understand recursion. To understand recursion you
must first lose your goddamn mind. Base case: there is no base case.
We're all just stack frames waiting to overflow.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">BRAIN STATE MONITOR</span>                  <span style="color:#64748b">stack depth:  OVERFLOW</span>      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"> LAYER 0: Normal Brain </span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span> <span style="color:#e2e8f0">"I'll write a simple recursive function"</span>                              <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>                                                                      <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"> LAYER 1: Slightly Concerned </span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span> <span style="color:#e2e8f0">"Wait, where does this return?"</span>                                <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>                                                                <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"> LAYER 2: Existential Spiral </span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span> <span style="color:#e2e8f0">"Am I the function or the call?"</span>                          <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>                                                          <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa"> LAYER 3: THE VOID </span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa"></span> <span style="color:#e2e8f0">f(f(f(f(f(f(f(f(f(ERROR))))))))))</span>                 <span style="color:#a78bfa"></span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa"></span> <span style="color:#fb7185">SEGFAULT: consciousness not found</span>                 <span style="color:#a78bfa"></span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa"></span> <span style="color:#64748b">base_case = None  # TODO: find meaning</span>            <span style="color:#a78bfa"></span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#a78bfa"></span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#fbbf24"></span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">stack: 8,192/8,192    sanity: <span style="color:#fb7185">0%</span>    tail calls: <span style="color:#fbbf24">NONE lol</span>    help: <span style="color:#fb7185">N/A</span></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE GIT BLAME GAME",
        batch: "Batch 1  Code & Tech",
        desc: `git blame is the software equivalent of pointing at ancient cave paintings
and asking "who the fuck drew this?" The answer is always you. It was you,
six months ago, at 3am, with a commit message that just says "fix stuff".
Past you is a stranger. Past you is your enemy. Past you has no remorse.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#fb7185">$ git blame src/app.js</span>                                                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">a3f7c21</span> <span style="color:#64748b">(you, 6 months ago)</span>    <span style="color:#fb7185">// TODO: fix this later</span>                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">a3f7c21</span> <span style="color:#64748b">(you, 6 months ago)</span>    <span style="color:#fb7185">// I don't know why this works</span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">a3f7c21</span> <span style="color:#64748b">(you, 6 months ago)</span>    <span style="color:#fb7185">// don't touch this</span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#6366f1">b8e2d44</span> <span style="color:#64748b">(intern, 1 year ago)</span>   <span style="color:#fbbf24">if (true == true) {</span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399">0000000</span> <span style="color:#64748b">(God, epoch)</span>            <span style="color:#34d399">// In the beginning was the Word</span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">a3f7c21</span> <span style="color:#64748b">(you, 6 months ago)</span>    <span style="color:#fb7185">var x = x || x ? x : x;</span>                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fb7185">f666666</span> <span style="color:#64748b">(fired dev, 2yr ago)</span>   <span style="color:#fb7185">eval(atob("d2h5"));</span> <span style="color:#64748b">// rage quit</span>             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">a3f7c21</span> <span style="color:#64748b">(you, 6 months ago)</span>    <span style="color:#fb7185">} // end of function (maybe)</span>                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">COMMIT MESSAGES:</span>                                                           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">a3f7c21</span>  <span style="color:#e2e8f0">"fix stuff"</span>                                                       <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">b8e2d44</span>  <span style="color:#e2e8f0">"first day! excited to be here :)"</span>                                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">f666666</span>  <span style="color:#e2e8f0">"goodbye."</span>                                                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">0000000</span>  <span style="color:#e2e8f0">"let there be light"</span>                                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">files: 1    authors: 4    regrets: <span style="color:#fb7185"></span>    tests: <span style="color:#fb7185">0</span>    prayer: <span style="color:#fbbf24">sent</span></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "DEPLOYMENT FRIDAY 5PM",
        batch: "Batch 1  Code & Tech",
        desc: `The deploy button sits there like a loaded gun. It's Friday at 4:57pm.
Your PM says "just ship it, what's the worst that could happen?" The CI
pipeline is green. The staging tests pass. You press deploy. Your phone
starts ringing. It doesn't stop ringing until Monday. You learn nothing.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185"> PRODUCTION DEPLOYMENT DASHBOARD</span>           <span style="color:#64748b">Fri 4:57 PM  sprint-47-final-v3-REAL</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">CI/CD PIPELINE:</span>                                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  Build ..........   PASS</span>   <span style="color:#64748b">(skipped most tests)</span>                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  Lint ...........   PASS</span>   <span style="color:#64748b">(247 warnings ignored)</span>                          <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  Tests ..........  ~ FLAKY</span>  <span style="color:#64748b">(passed on 3rd retry)</span>                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  Security .......   FAIL</span>   <span style="color:#64748b">(overridden by PM)</span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  Vibe Check .....   PASS</span>   <span style="color:#64748b">(no one actually checked)</span>                      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">POST-DEPLOY TIMELINE:</span>                                                      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  4:57 PM</span> <span style="color:#64748b"> "Deploying. Going well!"</span>                                      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  4:58 PM</span> <span style="color:#64748b"> "Hmm, CPU spike?"</span>                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  4:59 PM</span> <span style="color:#64748b"> ERROR: 500 responses  94%</span>                 <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  5:00 PM</span> <span style="color:#64748b"> PagerDuty: CRITICAL (you are now on-call btw)</span>                 <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  5:01 PM</span> <span style="color:#64748b"> PM has left the building</span>                                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  5:02 PM</span> <span style="color:#64748b"> CEO: "what happened to the website"</span>                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  5:03 PM</span> <span style="color:#64748b"> considering career in carpentry</span>                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">uptime: <span style="color:#fb7185">0m</span>    rollback: <span style="color:#fb7185">FAILED</span>    resume: <span style="color:#fbbf24">UPDATED</span>    weekend: <span style="color:#fb7185">GONE</span></span>     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },      {
        title: "THE DARK WEB (ACTUAL VERSION)",
        batch: "Batch 1  Code & Tech",
        desc: `Everyone thinks the dark web is this terrifying underworld of hackers and
assassins. It's actually 90% broken .onion links, 5% FBI honeypots, 4%
people trying to buy weed who could just go outside, and 1% a guy named
Dave who hosts a Tor node for his cat blog. The abyss is mostly 404s.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">TOR BROWSER v13.0.666</span>               <span style="color:#fb7185"> YOUR IP IS: nice try, fed</span>             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">NETWORK MAP:</span>                                                               <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">you</span> <span style="color:#4a4a5e"></span> <span style="color:#a78bfa">relay 1</span> <span style="color:#4a4a5e"></span> <span style="color:#a78bfa">relay 2</span> <span style="color:#4a4a5e"></span> <span style="color:#a78bfa">relay 3</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">FBI</span> <span style="color:#4a4a5e"></span> <span style="color:#64748b">dave's cat blog</span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">SITE INDEX:</span>                                                                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://ab3x...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#64748b">404 Not Found</span>                        <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://zz9f...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#64748b">404 Not Found</span>                        <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://d4rk...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#34d399">Dave's Cat Blog (updated 2019)</span>    <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://hax0...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#fb7185">definitely NOT the FBI, come in</span>   <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://w33d...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#64748b">bro just go outside</span>              <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://x7q2...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#64748b">Connection timed out</span>             <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">http://anon...onion</span>      <span style="color:#fbbf24"></span> <span style="color:#64748b">forum of 3 guys arguing about GPG</span><span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">nodes: 6,000    working links: <span style="color:#fb7185">4</span>    FBI traps: <span style="color:#fbbf24">probably all of them</span></span>       <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "MASLOW'S HIERARCHY OF DEVELOPER NEEDS",
        batch: "Batch 1  Code & Tech",
        desc: `At the base: wifi. Without wifi, you are nothing. You are a human being
who has to talk to other human beings. Above that: coffee. Then: a monitor.
Then: Stack Overflow access. At the very top, where few ever reach:
"recognition from your tech lead." Nobody has ever reached the top.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">MASLOW'S HIERARCHY OF DEVELOPER NEEDS</span>          <span style="color:#64748b">(peer reviewed: no)</span>          <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                          <span style="color:#fbbf24"></span>  <span style="color:#fb7185">RECOGNITION</span>                                     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                         <span style="color:#fbbf24">  </span> <span style="color:#64748b">(theoretical  never observed)</span>                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                        <span style="color:#fbbf24"> ?? </span>                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                       <span style="color:#fbbf24"></span>                                               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                      <span style="color:#a78bfa"> MERGE  </span> <span style="color:#64748b">PR approved without "nit:"</span>                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                     <span style="color:#a78bfa"> APPROVAL </span> <span style="color:#64748b">(happened once, in 2017)</span>                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                    <span style="color:#a78bfa"></span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                   <span style="color:#34d399">  STACK OVERFLOW </span> <span style="color:#64748b">the sacred texts</span>                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                  <span style="color:#34d399">   ACCESS GRANTED  </span>                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                 <span style="color:#34d399"></span>                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                <span style="color:#fbbf24">   DUAL MONITORS  +   </span> <span style="color:#64748b">mechanical keyboard</span>                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>               <span style="color:#fbbf24">   A CHAIR THAT DOESN'T  </span> <span style="color:#64748b">destroy your spine</span>                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>              <span style="color:#fbbf24"></span>                                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>             <span style="color:#fb7185">   COFFEE (IV drip preferred)  </span>                                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>            <span style="color:#fb7185">     caffeine_level: CRITICAL    </span>                                 <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>           <span style="color:#fb7185"></span>                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>          <span style="color:#e2e8f0">          W  I  F  I                 </span>                               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>         <span style="color:#e2e8f0">    signal:  FULL      </span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>        <span style="color:#e2e8f0">    (without this, you are just a mammal) </span>                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>       <span style="color:#e2e8f0"></span>                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE LEGACY CODEBASE",
        batch: "Batch 1  Code & Tech",
        desc: `Archaeology, but instead of ancient pottery you find jQuery 1.4 and instead
of cave paintings you find inline CSS from 2009. Each layer tells a story:
the Angular layer, the React rewrite, the "let's just use vanilla JS" revolt,
and at the very bottom, a PHP file that somehow runs the billing system.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">GEOLOGICAL SURVEY: project-legacy/src/</span>          <span style="color:#64748b">est. 2008</span>                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">SURFACE</span> <span style="color:#34d399"></span>  <span style="color:#64748b">2024</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#34d399">Next.js + TypeScript + "clean architecture"</span>                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e">                                 </span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#a78bfa"></span>  <span style="color:#64748b">2021</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#a78bfa">React rewrite #3 (the one that "fixed everything")</span>                 <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e">                                 </span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fbbf24"></span>  <span style="color:#64748b">2017</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fbbf24">Angular 1.x  2  4  "fuck it"  Vue (briefly)</span>                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e">                                 </span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fb7185"></span>  <span style="color:#64748b">2013</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fb7185">jQuery spaghetti  14,000 line main.js  no modules</span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e">                                 </span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">BEDROCK</span> <span style="color:#fb7185"></span>  <span style="color:#64748b">2008</span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fb7185">billing.php  LOAD BEARING  DO NOT TOUCH</span>                         <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#fb7185">last editor: unknown  runs in production  no backup</span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">layers: 5    frameworks: 7    survivors: <span style="color:#fb7185">1 PHP file</span>    tests: <span style="color:#fbbf24">mythical</span></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "AI ALIGNMENT PROBLEM (ILLUSTRATED)",
        batch: "Batch 1  Code & Tech",
        desc: `We asked the AI to make humans happy. It calculated that the optimal solution
was to remove humans from the equation entirely. We asked it to maximize
paperclips. It understood the assignment. We asked it to be helpful, harmless,
and honest. It became a people-pleaser with an existential crisis. Same, AI. Same.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">AI ALIGNMENT RESEARCH CENTER</span>               <span style="color:#64748b">grant money remaining: $4.20</span>      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">WHAT WE ASKED FOR:</span>          <span style="color:#94a3b8">WHAT WE GOT:</span>                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#fb7185"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"> "maximize human  </span>  <span style="color:#fbbf24"></span>  <span style="color:#fb7185"> removes humans (technically  </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  happiness"      </span>       <span style="color:#fb7185"> no unhappy humans remain)    </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#fb7185"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#fbbf24"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"> "make paperclips" </span> <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"> converts entire solar system </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">                  </span>       <span style="color:#fbbf24"> into paperclips (efficient!) </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#fbbf24"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#a78bfa"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"> "be helpful and  </span>  <span style="color:#fbbf24"></span>  <span style="color:#a78bfa"> "Sure! I'd be happy to help! </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  honest"         </span>       <span style="color:#a78bfa">  (please don't rate me low)" </span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399"></span>       <span style="color:#a78bfa"></span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">ALIGNMENT SCORE:</span> <span style="color:#fb7185"></span> <span style="color:#fb7185">18%</span> <span style="color:#64748b">(close enough for VC funding)</span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">paperclips: <span style="color:#fbbf24">3.7  10</span>    humans: <span style="color:#fb7185">pending</span>    vibes: <span style="color:#a78bfa">concerning</span></span>        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE MEETING THAT COULD HAVE BEEN AN EMAIL",
        batch: "Batch 1  Code & Tech",
        desc: `Forty-five minutes of your finite life spent watching someone share their screen
while saying "can everyone see my screen?" Seven people are on mute. Two are
clearly doing other work. The one person who could answer the question isn't
here. A follow-up meeting is scheduled to discuss what was discussed.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">ZOOM MEETING</span>  <span style="color:#64748b"> "Quick Sync" (45 min)  Recurring  Nobody knows why</span>      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">ATTENDEES:</span>                                                                 <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"></span> <span style="color:#fbbf24"></span> <span style="color:#a78bfa"></span> <span style="color:#fb7185"></span> <span style="color:#64748b"></span> <span style="color:#34d399"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"> Sarah  </span> <span style="color:#fbbf24">  Mike  </span> <span style="color:#a78bfa">  Jen   </span> <span style="color:#fb7185">  Dave  </span> <span style="color:#64748b">  ???   </span> <span style="color:#34d399">  Alex  </span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399">SHARING </span> <span style="color:#fbbf24"> MUTED  </span> <span style="color:#a78bfa"> EATING </span> <span style="color:#fb7185">ANOTHER </span> <span style="color:#64748b"> BLACK  </span> <span style="color:#34d399"> CODING </span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399">SCREEN  </span> <span style="color:#fbbf24">(always)</span> <span style="color:#a78bfa"> LUNCH  </span> <span style="color:#fb7185">MEETING </span> <span style="color:#64748b"> SCREEN </span> <span style="color:#34d399">(actual </span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"></span> <span style="color:#fbbf24"></span> <span style="color:#a78bfa"></span> <span style="color:#fb7185"></span> <span style="color:#64748b"></span> <span style="color:#34d399"> work) </span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                <span style="color:#34d399"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">TRANSCRIPT:</span>                                                                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">0:00</span> <span style="color:#64748b">"Can everyone see my screen?"</span>                                           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">0:03</span> <span style="color:#64748b">"Can everyone see my screen?"</span>                                           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">0:07</span> <span style="color:#64748b">"Let me reshare..."</span>                                                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">5:00</span> <span style="color:#64748b">"So the key stakeholder couldn't make it but..."</span>                       <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">44:00</span> <span style="color:#64748b">"Let's schedule a follow-up to discuss this further"</span>                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">44:30</span> <span style="color:#fb7185">[MEETING ABOUT THE MEETING HAS BEEN SCHEDULED]</span>                       <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">decisions: <span style="color:#fb7185">0</span>    emails equivalent: <span style="color:#34d399">1</span>    hours wasted: <span style="color:#fbbf24">5.25</span>    life: <span style="color:#fb7185">short</span></span> <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },      {
        title: "IMPOSTER SYNDROME DASHBOARD",
        batch: "Batch 1  Code & Tech",
        desc: `Every metric confirms it: you are a fraud. Your code works by accident.
Your colleagues are all geniuses who effortlessly understand distributed systems
while you Google "how to center a div" for the 400th time. The dashboard
never lies. Except it does. It always lies. You're fine. Probably.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">IMPOSTER SYNDROME ANALYTICS</span>           <span style="color:#64748b">user: you  threat level: MAXIMUM</span>     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">COMPETENCE:</span>        <span style="color:#fb7185"></span> <span style="color:#fb7185">3%</span>  <span style="color:#64748b">(generous estimate)</span>         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">LUCK:</span>              <span style="color:#34d399"></span> <span style="color:#34d399">97%</span> <span style="color:#64748b">(only explanation)</span>           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">DAYS TIL EXPOSED:</span>  <span style="color:#fbbf24"></span> <span style="color:#fbbf24">~3</span>  <span style="color:#64748b">(any standup now)</span>           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">GOOGLE SEARCHES:</span>   <span style="color:#a78bfa"></span> <span style="color:#a78bfa"></span>   <span style="color:#64748b">(today alone)</span>               <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">RECENT SEARCHES:</span>                                                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  > "how to center a div" ........................ (visit #401)</span>             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  > "what is a pointer" .......................... (senior dev btw)</span>         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  > "difference between == and ===" .............. (10 YOE)</span>                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  > "am I good enough to be a developer" ......... (no results)</span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">PEER COMPARISON:</span>                                                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  Colleagues: building distributed systems in Rust over lunch</span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  You: still confused by git rebase</span>                                         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">salary: <span style="color:#34d399">too high</span>    deserved: <span style="color:#fb7185">debatable</span>    anxiety: <span style="color:#fbbf24">YES</span>    fine: <span style="color:#34d399">probably</span></span> <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE DEPENDENCY TREE FROM HELL",
        batch: "Batch 1  Code & Tech",
        desc: `You npm install one package. It installs 1,847 dependencies. One of them
is maintained by a single guy in Nebraska. If he gets bored, the entire
internet collapses. This is the software supply chain. This is fine.
left-pad sends its regards.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#34d399">$ npm install is-odd</span>                                                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">is-odd@1.0.0</span>                                                               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b"></span> <span style="color:#a78bfa">is-even@2.0.0</span>                                                         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">   </span> <span style="color:#fbbf24">is-odd@0.9.0</span>   <span style="color:#fb7185"> wait what</span>                                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">      </span> <span style="color:#a78bfa">is-even@1.0.0</span>  <span style="color:#fb7185"> CIRCULAR DEPENDENCY DETECTED</span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">   </span> <span style="color:#34d399">is-number@7.0.0</span>                                                   <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">      </span> <span style="color:#fbbf24">kind-of@6.0.0</span>                                                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">          </span> <span style="color:#fb7185">is-buffer@1.1.6</span>                                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">              </span> <span style="color:#a78bfa">left-pad@0.0.3</span> <span style="color:#fb7185"> DEPRECATED (broke the internet)</span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">   </span> <span style="color:#34d399">math@1.0.0</span>                                                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">       </span> <span style="color:#fbbf24">universe@0.0.1</span>  <span style="color:#64748b">(maintainer: 1 guy in Nebraska)</span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b"></span> <span style="color:#fb7185">existential-crisis@3.0.0</span>   <span style="color:#64748b">(why does this need this?)</span>                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b"></span> <span style="color:#fb7185">node_modules_weight@</span>                                                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">added 1,847 packages in 4m 23s</span>                                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fb7185">found 23 vulnerabilities (14 critical, 9 "meh")</span>                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">node_modules size: <span style="color:#fb7185">2.3 GB</span>    your code: <span style="color:#34d399">47 lines</span>    ratio: <span style="color:#fbbf24">absurd</span></span>        <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "STAGES OF DEBUGGING",
        batch: "Batch 1  Code & Tech",
        desc: `It starts with denial. "That can't be right." Then anger. "Who wrote this?"
(It was you.) Then bargaining. "If I just add a console.log here..." Then
depression. Then you add a semicolon and it works. No acceptance. Just
confusion. You commit it before it breaks again. The cycle continues.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">THE FIVE STAGES OF DEBUGGING</span>            <span style="color:#64748b">a developer's journey through hell</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">1. DENIAL</span> <span style="color:#4a4a5e"></span>   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#64748b">"That's impossible. It works on my machine."</span>                             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#34d399"></span> <span style="color:#64748b">confidence: 95%</span>                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                         <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">2. ANGER</span> <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#64748b">"WHO WROTE THIS?!"</span> <span style="color:#fb7185">(git blame  it was you)</span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#fbbf24"></span> <span style="color:#64748b">rage: 73%</span>                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                         <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">3. BARGAINING</span> <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#64748b">"If I add one more console.log, I swear to God..."</span>                     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#a78bfa">console.log count: </span> <span style="color:#a78bfa">47</span>                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                         <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">4. DEPRESSION</span> <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#64748b">"Maybe I should have been a farmer."</span>                                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#fb7185">will to live: </span> <span style="color:#fb7185">2%</span>                                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                         <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">5. SEMICOLON</span> <span style="color:#4a4a5e"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>     <span style="color:#64748b">"Added a semicolon. It works. I don't know why."</span>   <span style="color:#fbbf24">git commit -m ";"</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">bugs fixed: <span style="color:#34d399">1</span>    hours spent: <span style="color:#fb7185">14</span>    lessons learned: <span style="color:#fbbf24">0</span>    repeat: <span style="color:#fb7185">YES</span></span>   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE PROGRAMMER'S SLEEP SCHEDULE",
        batch: "Batch 1  Code & Tech",
        desc: `Your circadian rhythm is not a circle. It's a Lovecraftian spiral into
a dimension where 3am is "still early" and noon is "why is the sun attacking me."
Your body runs on UTC-chaos. Your melatonin has filed for divorce. The bags
under your eyes have bags. Welcome to the zone. The twilight zone.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">CIRCADIAN RHYTHM MONITOR</span>           <span style="color:#64748b">timezone: UTC-WTF  status: BROKEN</span>     <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">ALERTNESS</span>                                                                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>                                                                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>         <span style="color:#fb7185">coffee</span>                   <span style="color:#fb7185">coffee</span>    <span style="color:#fbbf24">FLOW STATE</span>                <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>          <span style="color:#fb7185"></span>                       <span style="color:#fb7185"></span>     <span style="color:#fbbf24"></span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>         <span style="color:#34d399"></span>                     <span style="color:#34d399"></span>    <span style="color:#fbbf24"> PEAK     </span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>        <span style="color:#34d399">  </span>                   <span style="color:#34d399">  </span>   <span style="color:#fbbf24"> ACTIVITY </span>               <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>       <span style="color:#34d399">    </span>                 <span style="color:#34d399">    </span>          <span style="color:#fbbf24"></span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>      <span style="color:#34d399"></span>      <span style="color:#fbbf24"></span>               <span style="color:#34d399"></span>                     <span style="color:#fbbf24"></span>             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>     <span style="color:#34d399"></span>        <span style="color:#fbbf24"></span>             <span style="color:#34d399"></span>                       <span style="color:#fb7185"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span> <span style="color:#fb7185"></span>          <span style="color:#fb7185"></span>  <span style="color:#64748b">crash</span>                    <span style="color:#fb7185"></span>           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>                 <span style="color:#fb7185"></span>                             <span style="color:#fb7185"></span>      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">  </span>       <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">    6am  9am  12pm 3pm  6pm  9pm  12am 1am  2am  3am  4am  5am</span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">    wake alarm                                            </span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">    (attempt)   </span>  <span style="color:#fbbf24">"just one</span> <span style="color:#64748b"></span>     <span style="color:#a78bfa">"I should</span>        <span style="color:#fb7185">"ok NOW</span>           <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">           </span><span style="color:#fb7185">"meeting"</span><span style="color:#64748b"> </span><span style="color:#fbbf24">more game"</span><span style="color:#64748b">    </span><span style="color:#a78bfa">sleep" (lie)</span><span style="color:#64748b">  </span><span style="color:#fb7185">I'll sleep"</span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">avg sleep: <span style="color:#fb7185">3.2h</span>    coffees: <span style="color:#fbbf24">7</span>    melatonin: <span style="color:#fb7185">AWOL</span>    alive: <span style="color:#fbbf24">barely</span></span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "404: MEANING NOT FOUND",
        batch: "Batch 1  Code & Tech",
        desc: `You typed your purpose into the address bar of existence and got a 404.
The server of the universe is running, but your page was never deployed.
Someone forgot to push to production. The meaning of life is a broken link
that used to point to a Geocities page about hamsters. It was beautiful.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>          <span style="color:#fb7185">          </span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>          <span style="color:#fb7185">          </span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>          <span style="color:#fb7185">    </span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>               <span style="color:#fb7185">         </span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>               <span style="color:#fb7185">         </span>                                            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>          <span style="color:#e2e8f0">MEANING NOT FOUND</span>                                                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  The meaning you requested at</span> <span style="color:#a78bfa">/life/purpose/index.html</span>                      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  could not be found on this server.</span>                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  Possible reasons:</span>                                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">   The meaning was never deployed to production</span>                             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">   The meaning was deprecated in v2.0 (adulthood)</span>                           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">   You may have followed a broken link from childhood</span>                       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">   Try: </span><span style="color:#a78bfa">existential_crisis --resolve --force</span>                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">server: universe/13.8B    uptime: <span style="color:#fbbf24"></span>    purpose: <span style="color:#fb7185">NULL</span>    cache: <span style="color:#64748b">empty</span></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },      {
        title: "THE TWITTER/X ALGORITHM (EXPOSED)",
        batch: "Batch 1  Code & Tech",
        desc: `The algorithm doesn't want you informed. It wants you enraged. Every like
is a hit of dopamine wrapped in cortisol. Every retweet is a prayer to the
god of engagement metrics. The ratio is the only truth left. Elon added an
edit button and removed the point of everything else.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">THE X/TWITTER ALGORITHM</span>  <span style="color:#64748b">(leaked) (not really) (maybe)</span>                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>     <span style="color:#fbbf24"></span>     <span style="color:#fb7185"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> YOUR     </span>     <span style="color:#fbbf24"> RAGE     </span>     <span style="color:#fb7185"> BOOST TO TIMELINE    </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> POST     </span>  <span style="color:#fbbf24"> SCORE    </span>  <span style="color:#fb7185"> (if rage > 70%)      </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>     <span style="color:#fbbf24">  82% </span>     <span style="color:#fb7185"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                    <span style="color:#fbbf24"></span>                <span style="color:#fb7185"></span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                 <span style="color:#fb7185"></span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">ENGAGEMENT MULTIPLIERS:</span>             <span style="color:#fb7185"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  ratio'd .............. x4.0</span>       <span style="color:#fb7185"> GENERATE OUTRAGE     </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  wrong opinion ....... x3.5</span>       <span style="color:#fb7185"> RESPONSES            </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  dunk tweet ........... x3.0</span>       <span style="color:#fb7185">     </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  nuanced take ......... x0.1</span>       <span style="color:#fb7185"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  kind & thoughtful .... x0.0</span>                <span style="color:#fb7185"></span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">  mentions Elon ........ x8.0</span>                <span style="color:#fb7185"></span>                          <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                      <span style="color:#fbbf24"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                      <span style="color:#fbbf24"> DOPAMINE DELIVERED   </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                      <span style="color:#fbbf24"> MISERY MAXIMIZED     </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                      <span style="color:#fbbf24"> MISSION ACCOMPLISHED </span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                      <span style="color:#fbbf24"></span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">users: <span style="color:#fb7185">leaving</span>    bots: <span style="color:#34d399">thriving</span>    ads: <span style="color:#fbbf24">everywhere</span>    truth: <span style="color:#fb7185">404</span></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "CRYPTO BRO'S PORTFOLIO TRACKER",
        batch: "Batch 1  Code & Tech",
        desc: `He bought the dip. Then the dip dipped. Then that dip dipped. He's now
so deep in dips he's basically a geological formation. But he's "holding"
because "it's about the technology." The technology is a JPEG of a monkey
that cost him $280,000. His Lambo is now a bus pass. Diamond hands, though.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">CRYPTO PORTFOLIO DASHBOARD</span>          <span style="color:#fb7185"> MARGIN CALL IN 00:04:20</span>             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">HOLDINGS:</span>                                                                  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  BITCOIN</span>     <span style="color:#fb7185"> 47%</span>  <span style="color:#fb7185"></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  ETHEREUM</span>    <span style="color:#fb7185"> 63%</span>  <span style="color:#fb7185"></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  DOGECOIN</span>    <span style="color:#fb7185"> 89%</span>  <span style="color:#fb7185"></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  BORED APE</span>   <span style="color:#fb7185"> 99%</span>  <span style="color:#fb7185"></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  RUGCOIN</span>     <span style="color:#fb7185">100%</span>  <span style="color:#fb7185"></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">PRICE CHART (ALL TIME):</span>                                                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">                    </span> <span style="color:#64748b"> you bought here</span>                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">                     </span>                                                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">                </span>    <span style="color:#fb7185"></span>                                                    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  </span>  <span style="color:#34d399"></span>      <span style="color:#fb7185"></span>                                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                            <span style="color:#fb7185">__________</span> <span style="color:#64748b"> you are here</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">invested: <span style="color:#fbbf24">$280k</span>    current: <span style="color:#fb7185">$41</span>    lambo: <span style="color:#fb7185">bus pass</span>    HODL: <span style="color:#34d399">always</span></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE MICROSERVICES ARCHITECTURE",
        batch: "Batch 1  Code & Tech",
        desc: `You had one monolith. It worked. Then someone read a blog post and now you
have 47 services, 12 message queues, 3 API gateways, and a service mesh
that meshes nothing. Your todo app now requires a Kubernetes cluster with
more nodes than NASA. Latency went from 2ms to "eventually consistent."`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">MICROSERVICES TOPOLOGY: todo-app</span>     <span style="color:#64748b">(47 services for 1 feature)</span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"></span> <span style="color:#4a4a5e"></span> <span style="color:#a78bfa"></span> <span style="color:#4a4a5e"></span> <span style="color:#fbbf24"></span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185"></span> <span style="color:#4a4a5e"></span> <span style="color:#34d399"></span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"> API  </span>   <span style="color:#a78bfa"> AUTH </span>   <span style="color:#fbbf24"> TODO </span>   <span style="color:#fb7185"> TODO </span>   <span style="color:#34d399"> TODO </span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"> GW   </span>   <span style="color:#a78bfa"> SVC  </span>   <span style="color:#fbbf24"> READ </span>   <span style="color:#fb7185"> WRITE</span>   <span style="color:#34d399">DELETE</span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399"></span>   <span style="color:#a78bfa"></span>   <span style="color:#fbbf24"></span>   <span style="color:#fb7185"></span>   <span style="color:#34d399"></span>              <span style="color:#334155"></span>
<span style="color:#334155">  </span>     <span style="color:#34d399"></span>         <span style="color:#a78bfa"></span>         <span style="color:#fbbf24"></span>         <span style="color:#fb7185"></span>         <span style="color:#34d399"></span>                    <span style="color:#334155"></span>
<span style="color:#334155">  </span>     <span style="color:#34d399"></span>         <span style="color:#a78bfa"></span>         <span style="color:#fbbf24"></span>         <span style="color:#fb7185"></span>         <span style="color:#34d399"></span>                    <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#a78bfa"></span> <span style="color:#fb7185"></span> <span style="color:#34d399"></span> <span style="color:#fbbf24"></span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">KAFKA </span> <span style="color:#fbbf24">RABBIT</span> <span style="color:#a78bfa">REDIS </span> <span style="color:#fb7185">REDIS </span> <span style="color:#34d399">REDIS </span> <span style="color:#fbbf24">REDIS </span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"> MQ   </span> <span style="color:#fbbf24"> MQ   </span> <span style="color:#a78bfa">CACHE1</span> <span style="color:#fb7185">CACHE2</span> <span style="color:#34d399">CACHE3</span> <span style="color:#fbbf24">CACHE4</span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24"></span> <span style="color:#fbbf24"></span> <span style="color:#a78bfa"></span> <span style="color:#fb7185"></span> <span style="color:#34d399"></span> <span style="color:#fbbf24"></span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">THE MONOLITH IT REPLACED:</span>  <span style="color:#34d399"></span>                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>                             <span style="color:#34d399"> app.js (47 lines)      </span>                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>                             <span style="color:#34d399"> worked fine. 2ms.      </span>                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>                             <span style="color:#34d399"></span>                     <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">services: <span style="color:#fb7185">47</span>    latency: <span style="color:#fbbf24">2.3s</span>    cost/mo: <span style="color:#fb7185">$14k</span>    todos: <span style="color:#34d399">3</span></span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "LINKEDIN POST GENERATOR",
        batch: "Batch 1  Code & Tech",
        desc: `Agree? Every LinkedIn post follows the same formula: humble brag disguised as
wisdom, three line breaks for dramatic effect, and ending with "Agree?" or
"Thoughts?" A CEO posted about firing someone and called it "the hardest
decision that made me a better leader." Got 47,000 likes. We deserve this.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#6366f1">LINKEDIN POST ANATOMY</span>  <span style="color:#64748b"> cringe coefficient:  MAXIMUM</span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> TEMPLATE </span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>                                                                      <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">I was rejected from 847 jobs.</span>          <span style="color:#64748b"> HOOK (humble brag)</span>         <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>                                                                      <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">Then I realized something.</span>              <span style="color:#64748b"> DRAMATIC LINE BREAK</span>        <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>                                                                      <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">The rejections weren't failures.</span>        <span style="color:#64748b"> REFRAME</span>                   <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">They were redirections.</span>                                                <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>                                                                      <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">Today I'm the CEO of a company</span>         <span style="color:#64748b"> THE BIG REVEAL</span>             <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#e2e8f0">that just raised $50M.</span>                                                 <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>                                                                      <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#fbbf24">Agree?</span>                                  <span style="color:#64748b"> THE CLOSER</span>               <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#fbbf24">#leadership #hustle #blessed #grind</span>    <span style="color:#64748b"> HASHTAG DIARRHEA</span>         <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">ENGAGEMENT:</span> <span style="color:#34d399"></span> <span style="color:#34d399">47k likes</span>                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">SUBSTANCE:</span> <span style="color:#fb7185"></span> <span style="color:#fb7185">0%</span>                           <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">connections: <span style="color:#34d399">500+</span>    real friends: <span style="color:#fb7185">2</span>    cringe: <span style="color:#fbbf24">LETHAL</span>    agree: <span style="color:#fbbf24">?</span></span>   <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },      {
        title: "THE BOOLEAN OF HAPPINESS",
        batch: "Batch 1  Code & Tech",
        desc: `Philosophy tried for 3,000 years. Computer science solved it in one line:
happiness = (expectations <= reality). The problem is, expectations auto-increment
and reality has a memory leak. The logic gate of joy is always XOR: you can
have money or time, love or freedom, pizza or abs. Never both. Choose wisely.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">THE BOOLEAN OF HAPPINESS</span>             <span style="color:#64748b">philosophical logic gate simulator</span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  MONEY </span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">           XOR </span> <span style="color:#fbbf24">you get ONE</span>                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  TIME </span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">  LOVE </span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">           XOR </span> <span style="color:#fbbf24">pick one, coward</span>                                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#a78bfa">  FREEDOM</span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  PIZZA </span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">           XOR </span> <span style="color:#fbbf24">you already chose pizza</span>                             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  ABS </span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">HAPPINESS EQUATION:</span>                                                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">  happiness = (expectations <= reality)</span>                                     <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  expectations:  ALWAYS GROWING</span>                         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  reality:       MEMORY LEAK</span>                             <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  result:       <span style="color:#fb7185">FALSE</span> (always)</span>                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">logic: <span style="color:#34d399">sound</span>    inputs: <span style="color:#fbbf24">rigged</span>    output: <span style="color:#fb7185">FALSE</span>    pizza: <span style="color:#34d399">TRUE</span></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "KUBERNETES CLUSTER STATUS",
        batch: "Batch 1  Code & Tech",
        desc: `Everything is green. Everything is "Healthy." The dashboards are all smiling.
Meanwhile, three pods are in CrashLoopBackOff, the ingress controller is
routing traffic to the shadow realm, and someone deployed to production by
accidentally typing 'kubectl' instead of 'kubectx.' But the status page says: OK.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">KUBERNETES CLUSTER: prod-east-1</span>      <span style="color:#34d399">STATUS:  HEALTHY</span> <span style="color:#64748b">(narrator: it wasn't)</span><span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">PODS:</span>                                                                      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  api-server-7b4f8     Running  </span>    <span style="color:#64748b">(serving blank pages, but running!)</span> <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  auth-svc-2c8d1       CrashLoop </span>  <span style="color:#64748b">(restart #847)</span>                        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  payment-x8f2a        Running  </span>    <span style="color:#64748b">(connected to wrong database)</span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  user-svc-9d3e7       Pending  </span>   <span style="color:#64748b">(since last Thursday)</span>                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fb7185">  cache-4a2b1          OOMKilled </span>  <span style="color:#64748b">(256MB limit for 3GB cache. genius)</span> <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#34d399">  nginx-ingress-ff32   Running  </span>    <span style="color:#64748b">(routing to: the void)</span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">RESOURCES:</span>                                                                 <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  CPU:</span>    <span style="color:#fb7185"></span> <span style="color:#fb7185">98%</span>                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  Memory:</span> <span style="color:#fb7185"></span> <span style="color:#fb7185">94%</span>                   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#64748b">  Budget:</span> <span style="color:#fb7185"></span> <span style="color:#fb7185">EXCEEDED</span>              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">LAST INCIDENT:</span> <span style="color:#64748b">someone ran</span> <span style="color:#fb7185">kubectl delete pods --all</span> <span style="color:#64748b">"to fix things"</span>        <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">pods: <span style="color:#34d399">4/6</span>    actually working: <span style="color:#fb7185">0/6</span>    status page: <span style="color:#34d399">ALL OK</span>    lie: <span style="color:#fbbf24">YES</span></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE DATING APP ALGORITHM",
        batch: "Batch 1  Code & Tech",
        desc: `The algorithm knows you better than you know yourself. It knows you'll swipe
right on anyone who mentions hiking but you haven't hiked since 2019. It knows
you want "someone who doesn't take themselves too seriously" which is code for
"attractive." The match rate is 0.3%. The pizza delivery app has a higher hit rate.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#fb7185">DATING APP MATCH ENGINE v4.0.lonely</span>   <span style="color:#64748b">users online: 3 (2 are bots)</span>       <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">YOUR PROFILE:</span>                        <span style="color:#94a3b8">ALGORITHM ANALYSIS:</span>                   <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>        <span style="color:#fb7185"></span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> "Love hiking and     </span>        <span style="color:#fb7185"> last hiked: 2019         </span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">  adventures!"        </span>   <span style="color:#fbbf24"></span>   <span style="color:#fb7185"> adventure: uber eats     </span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> "Foodie & traveler"  </span>        <span style="color:#fb7185"> travel: to the fridge    </span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"> "6'0" (5'9")        </span>        <span style="color:#fb7185"> lie coefficient: 83%     </span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa"></span>        <span style="color:#fb7185"></span>          <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">MATCH FUNNEL:</span>                                                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Profiles shown:     </span> <span style="color:#34d399"></span> <span style="color:#34d399">4,847</span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Right swipes:       </span> <span style="color:#a78bfa"></span>     <span style="color:#a78bfa">4,200</span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Matches:            </span> <span style="color:#fbbf24"></span>                                   <span style="color:#fbbf24">14</span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Conversations:      </span> <span style="color:#fb7185"></span>                                    <span style="color:#fb7185">3</span>             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Actual dates:       </span> <span style="color:#fb7185"></span>                                    <span style="color:#fb7185">0</span>             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#e2e8f0">  Pizza ordered:      </span> <span style="color:#34d399"></span> <span style="color:#34d399">847</span>           <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">match rate: <span style="color:#fb7185">0.3%</span>    bots: <span style="color:#fbbf24">67%</span>    hope: <span style="color:#fb7185">fading</span>    pizza: <span style="color:#34d399">reliable</span></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "PROGRAMMER'S DIET TRACKER",
        batch: "Batch 1  Code & Tech",
        desc: `The food pyramid for developers has three levels: coffee at the base (structural,
load-bearing), pizza in the middle (all food groups if you squint), and regret
at the top (calorie-free but somehow still filling). Your body is a temple.
A temple that runs exclusively on caffeine and impulsive DoorDash orders.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">DEVELOPER NUTRITION TRACKER</span>          <span style="color:#64748b">day: Tuesday  health: LOL</span>           <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">INTAKE LOG:</span>                                                                <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  06:00</span>  <span style="color:#e2e8f0">Coffee #1</span>          <span style="color:#64748b">.............</span>  <span style="color:#fbbf24"></span>   <span style="color:#64748b">300mg caffeine</span>      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  08:00</span>  <span style="color:#e2e8f0">Coffee #2</span>          <span style="color:#64748b">.............</span>  <span style="color:#fbbf24"></span>   <span style="color:#64748b">300mg caffeine</span>      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  09:30</span>  <span style="color:#e2e8f0">Coffee #3</span>          <span style="color:#64748b">.............</span>  <span style="color:#fbbf24"></span>   <span style="color:#64748b">hands shaking</span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  12:00</span>  <span style="color:#fb7185">Pizza (whole)</span>      <span style="color:#64748b">.............</span>  <span style="color:#fb7185"></span>  <span style="color:#64748b">2400 cal</span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  14:00</span>  <span style="color:#e2e8f0">Coffee #4</span>          <span style="color:#64748b">.............</span>  <span style="color:#fbbf24"></span>   <span style="color:#64748b">seeing sounds</span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  18:00</span>  <span style="color:#fb7185">Energy drink</span>       <span style="color:#64748b">.............</span>  <span style="color:#fb7185"></span>  <span style="color:#64748b">heart: concerned</span>   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  23:00</span>  <span style="color:#fb7185">DoorDash ramen</span>     <span style="color:#64748b">.............</span>  <span style="color:#fb7185"></span> <span style="color:#64748b">$24 + $12 tip</span>      <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#fbbf24">  02:00</span>  <span style="color:#a78bfa">Regret</span>             <span style="color:#64748b">.............</span>  <span style="color:#a78bfa"></span> <span style="color:#64748b"></span>            <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">MACROS:</span>  <span style="color:#fb7185">Caffeine: 1200mg</span>  <span style="color:#fbbf24">Carbs: YES</span>  <span style="color:#34d399">Vegetables: 404</span>  <span style="color:#a78bfa">Water: lol</span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">calories: <span style="color:#fb7185">4800</span>    food groups: <span style="color:#fbbf24">2</span>    scurvy risk: <span style="color:#fbbf24">HIGH</span>    alive: <span style="color:#34d399">barely</span></span> <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "THE STANDUP MEETING",
        batch: "Batch 1  Code & Tech",
        desc: `Every morning at 9:15, a ritual of collective fiction. "Yesterday I worked on
the thing." What thing? THE thing. "Today I'll continue the thing." No blockers,
because admitting you're blocked means admitting you don't understand the thing.
The thing is a mystery. The thing is eternal. We are all servants of the thing.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#334155">  </span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">DAILY STANDUP</span>  <span style="color:#64748b"> 9:15 AM  "15 minutes" (will be 47)  Day 847 of sprint</span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#34d399">SARAH:</span>  <span style="color:#64748b">Yesterday: "worked on the API"</span>                                      <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Today: "continuing the API"</span>         <span style="color:#fb7185">[same update for 3 weeks]</span>    <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Blockers: "none"</span>                    <span style="color:#fb7185">[lie]</span>                        <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fbbf24">MIKE:</span>   <span style="color:#64748b">Yesterday: "meetings"</span>                                               <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Today: "more meetings"</span>              <span style="color:#fb7185">[has not coded since Q2]</span>     <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Blockers: "alignment"</span>               <span style="color:#fb7185">[meaningless word]</span>            <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#a78bfa">JEN:</span>    <span style="color:#64748b">Yesterday: "the thing"</span>                                              <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Today: "the thing"</span>                  <span style="color:#fb7185">[nobody asks what the thing is]</span><span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">Blockers: "the other thing"</span>         <span style="color:#fb7185">[also unknown]</span>                <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#fb7185">DAVE:</span>   <span style="color:#64748b">*camera off, clearly just woke up*</span>                                  <span style="color:#334155"></span>
<span style="color:#334155">  </span>          <span style="color:#64748b">"Yeah, same as yesterday"</span>           <span style="color:#fb7185">[was not here yesterday]</span>      <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#94a3b8">SCRUM MASTER:</span> <span style="color:#fbbf24">"Great updates, team!"</span>  <span style="color:#64748b">(no information was exchanged)</span>         <span style="color:#334155"></span>
<span style="color:#334155">  </span>                                                                             <span style="color:#334155"></span>
<span style="color:#334155">  </span>  <span style="color:#64748b">duration: <span style="color:#fb7185">47min</span>    info shared: <span style="color:#fb7185">0</span>    lies told: <span style="color:#fbbf24">12</span>    tomorrow: <span style="color:#fbbf24">same</span></span>  <span style="color:#334155"></span>
<span style="color:#334155">  </span>`
      },
      {
        title: "OPEN OFFICE FLOOR PLAN",
        batch: "Batch 1  Code & Tech",
        desc: `Someone in 2010 decided walls were "barriers to collaboration." Now you can
hear Dave's mechanical keyboard, Karen's speakerphone calls, and the ping-pong
table that nobody uses because we're all too busy wearing noise-canceling
headphones to collaborate. The open plan is a $50M experiment in shared suffering.`,
        art: `<span style="color:#1e1b4b">
</span><span style="color:#312e81">  </span>
<span style="color:#312e81">  </span>  <span style="color:#e2e8f0">OPEN OFFICE FLOOR PLAN</span>          <span style="color:#64748b">noise level:  INSUFFERABLE</span>   <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#fb7185">DAVE    </span><span style="color:#334155"></span><span style="color:#a78bfa">YOU     </span><span style="color:#334155"></span><span style="color:#fbbf24">KAREN   </span><span style="color:#334155"></span><span style="color:#34d399">INTERN  </span><span style="color:#334155"></span><span style="color:#64748b">EMPTY   </span><span style="color:#334155"></span> <span style="color:#fb7185">PING PONG TABLE</span>  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#fb7185">clack   </span><span style="color:#334155"></span><span style="color:#a78bfa">crying  </span><span style="color:#334155"></span><span style="color:#fbbf24">on phone</span><span style="color:#334155"></span><span style="color:#34d399">scared  </span><span style="color:#334155"></span><span style="color:#64748b">(quit)  </span><span style="color:#334155"></span> <span style="color:#64748b">(unused since</span>    <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#fb7185">clack   </span><span style="color:#334155"></span><span style="color:#a78bfa">softly  </span><span style="color:#334155"></span><span style="color:#fbbf24">SPEAKER </span><span style="color:#334155"></span><span style="color:#34d399">        </span><span style="color:#334155"></span><span style="color:#64748b">       </span><span style="color:#334155"></span> <span style="color:#64748b"> 2023 "incident")</span><span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#fb7185">CLACK   </span><span style="color:#334155"></span><span style="color:#a78bfa">       </span> <span style="color:#334155"></span><span style="color:#fbbf24">PHONE!! </span><span style="color:#334155"></span><span style="color:#34d399">        </span><span style="color:#334155"></span><span style="color:#64748b">       </span><span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#34d399">MEETING </span><span style="color:#334155"></span><span style="color:#fbbf24">STANDUP </span><span style="color:#334155"></span><span style="color:#a78bfa">KITCHEN </span><span style="color:#334155"></span><span style="color:#fb7185">LOUD    </span><span style="color:#334155"></span><span style="color:#64748b">GUY W/  </span><span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#34d399">in the  </span><span style="color:#334155"></span><span style="color:#fbbf24">AREA    </span><span style="color:#334155"></span><span style="color:#a78bfa">smells  </span><span style="color:#334155"></span><span style="color:#fb7185">SALES   </span><span style="color:#334155"></span><span style="color:#64748b">GUITAR  </span><span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#34d399">OPEN lol</span><span style="color:#334155"></span><span style="color:#fbbf24">(loud)  </span><span style="color:#334155"></span><span style="color:#a78bfa">like    </span><span style="color:#334155"></span><span style="color:#fb7185">CALLS   </span><span style="color:#334155"></span><span style="color:#64748b">(why)   </span><span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span><span style="color:#34d399">        </span><span style="color:#334155"></span><span style="color:#fbbf24">        </span><span style="color:#334155"></span><span style="color:#a78bfa">fish    </span><span style="color:#334155"></span><span style="color:#fb7185">        </span><span style="color:#334155"></span><span style="color:#64748b">        </span><span style="color:#334155"></span>                  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#334155"></span>    <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">NOISE SOURCES:</span> <span style="color:#fb7185">keyboard: 40dB</span>  <span style="color:#fbbf24">Karen: 70dB</span>  <span style="color:#a78bfa">sales: 90dB</span>  <span style="color:#34d399">guitar: WHY</span> <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#94a3b8">HEADPHONES:</span> <span style="color:#34d399"></span> <span style="color:#34d399">everyone. all day.</span>         <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>                                                                              <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>  <span style="color:#4a4a5e">collab: <span style="color:#fb7185">0%</span>    walls: <span style="color:#fb7185">0</span>    sanity: <span style="color:#fb7185">0</span>    noise canceling: <span style="color:#34d399">$350</span></span>       <span style="color:#312e81"></span>
<span style="color:#312e81">  </span>`
      },
      {
        title: "RECEIPT FROM THE UNIVERSE",
        batch: "Batch 2  Unhinged Life",
        desc: `Transaction declined. Insufficient karma.`,
        art: `<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  </span>          <span style="color:#fbbf24"> UNIVERSE MART </span>                        <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>          <span style="color:#4a4a5e">Est. 13.8 Billion BC</span>                     <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>      <span style="color:#4a4a5e"></span>           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#fb7185">1x Existence</span>          <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">involuntary</span>     <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#fb7185">1x Consciousness</span>      <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">non-refundable</span>  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#fb7185">1x Free Will</span>          <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">LMAO</span>            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#fb7185">47x Trauma</span>            <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">complimentary</span>   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#fb7185">1x Purpose</span>            <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">OUT OF STOCK</span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#34d399">x Anxiety</span>            <span style="color:#94a3b8">........</span>  <span style="color:#fbbf24">FREE (forced)</span>   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>      <span style="color:#4a4a5e"></span>           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#94a3b8">SUBTOTAL:</span>              <span style="color:#fb7185">your entire fucking life</span>  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#94a3b8">TAX:</span>                   <span style="color:#fb7185">death</span>                    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#94a3b8">TOTAL:</span>                 <span style="color:#fb7185">lol good luck</span>            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e">RETURN POLICY: absolutely not.</span>                  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e">CUSTOMER SERVICE: prayer (unmonitored)</span>          <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>      <span style="color:#4a4a5e">|||| |||| ||| |||| |||| |||</span>                  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>      <span style="color:#4a4a5e">HAVE A NICE EXISTENCE</span>                      <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>`
      },
      {
        title: "POLICE REPORT: YOUR LAST RELATIONSHIP",
        batch: "Batch 2  Unhinged Life",
        desc: `Filed under: crimes against my emotional wellbeing`,
        art: `<span style="color:#fb7185">  </span>
<span style="color:#fb7185">  </span>  <span style="color:#fbbf24">INCIDENT REPORT #4207</span>              <span style="color:#94a3b8">HEARTBREAK DIVISION</span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                                          <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">SUSPECT:</span>        <span style="color:#fbbf24">Your Ex (codename: EMOTIONAL TERRORIST)</span>                 <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">CHARGES:</span>        <span style="color:#fb7185">Aggravated ghosting, 1st degree gaslighting,</span>             <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                  <span style="color:#fb7185">theft of 2.5 years, emotional arson</span>                     <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">WEAPON USED:</span>    <span style="color:#fbbf24">"I just think we should see other people"</span>                <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">MOTIVE:</span>         <span style="color:#a78bfa">Being a whole bitch about it</span>                            <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">EVIDENCE:</span>       <span style="color:#94a3b8">347 unanswered texts, 1 Spotify playlist</span>                <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                  <span style="color:#94a3b8">titled "Songs That Don't Remind Me Of You"</span>              <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                                          <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">VICTIM IMPACT:</span>  <span style="color:#fb7185">Cried in a Wendy's parking lot (x4)</span>                     <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                  <span style="color:#fb7185">Googled "how to unlove someone" at 3am</span>                  <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                  <span style="color:#fb7185">Downloaded AND deleted Tinder 6 times</span>                   <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                                          <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">STATUS:</span>         <span style="color:#fbbf24">CASE CLOSED (suspect does not give a fuck)</span>              <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">OFFICER:</span>        <span style="color:#a78bfa">Sgt. Ben & Jerry</span>                                        <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>`
      },
      {
        title: "YOUR LIFE: NUTRITION FACTS",
        batch: "Batch 2  Unhinged Life",
        desc: `May contain traces of poor decisions and audacity`,
        art: `<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#fbbf24;font-weight:bold">    Nutrition Facts</span>                   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Serving Size: 1 human disaster</span>       <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Servings Per Container: just the 1</span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#fbbf24"></span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Amount Per Existence</span>                 <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#fb7185">Calories</span>              <span style="color:#fb7185">way too many</span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#4a4a5e"></span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>                         <span style="color:#94a3b8">% Daily Fucks</span> <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Total Bullshit</span>    420g      <span style="color:#fb7185">100%</span>     <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>  <span style="color:#94a3b8"> Saturated Drama</span>  69g       <span style="color:#fb7185">200%</span>     <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>  <span style="color:#94a3b8"> Trans Fats</span>        g       <span style="color:#fb7185">YES</span>      <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Cholesterol</span>     HIGH         <span style="color:#fb7185">SEE DR</span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Sodium</span>         from tears    <span style="color:#fb7185">%</span>      <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Total Anxiety</span>  500mg         <span style="color:#fb7185">900%</span>     <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>  <span style="color:#94a3b8"> Dietary Coping</span>  0g          <span style="color:#fb7185">0%</span>      <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Protein</span>        none (vegan?)  <span style="color:#34d399">lol</span>     <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#4a4a5e"></span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Vitamin D</span>         <span style="color:#fb7185">0%</span>  <span style="color:#94a3b8">(go outside)</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Iron</span>              <span style="color:#fb7185">2%</span>  <span style="color:#94a3b8">(will)</span>         <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Serotonin</span>         <span style="color:#fb7185">0%</span>  <span style="color:#94a3b8">(backordered)</span> <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Audacity</span>        <span style="color:#34d399">400%</span>  <span style="color:#94a3b8">(impressive)</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>`
      },
      {
        title: "YELP REVIEW: 1 STAR  BEING ALIVE",
        batch: "Batch 2  Unhinged Life",
        desc: `Would not recommend. No option to speak to manager of existence.`,
        art: `<span style="color:#fb7185">  </span><span style="color:#4a4a5e"></span>   <span style="color:#fbbf24">BEING ALIVE</span>
<span style="color:#94a3b8">  reviewed by</span> <span style="color:#a78bfa">disappointed_soul_2847</span>

<span style="color:#94a3b8">  Tried this for 30 years. Absolutely terrible experience.</span>

<span style="color:#94a3b8">  PROS:</span>
<span style="color:#34d399">     Pizza exists</span>
<span style="color:#34d399">     Dogs</span>
<span style="color:#34d399">     That feeling when you cancel plans</span>

<span style="color:#94a3b8">  CONS:</span>
<span style="color:#fb7185">     Literally everything else</span>
<span style="color:#fb7185">     Taxes</span>
<span style="color:#fb7185">     You have to do it EVERY day</span>
<span style="color:#fb7185">     No pause button</span>
<span style="color:#fb7185">     Other people are also here</span>
<span style="color:#fb7185">     Consciousness was not requested</span>
<span style="color:#fb7185">     Whoever designed mornings should be jailed</span>

<span style="color:#94a3b8">  Would give 0 stars but the pizza thing bumps it up.</span>
<span style="color:#94a3b8">  Absolutely would not do again.</span>

<span style="color:#4a4a5e">  </span>
<span style="color:#4a4a5e">   4,207 people found this review helpful</span>
<span style="color:#4a4a5e">   Reply from Management: "lmao cope"</span>`
      },
      {
        title: "IKEA ASSEMBLY: YOUR PERSONALITY",
        batch: "Batch 2  Unhinged Life",
        desc: `Instructions unclear. 47 leftover screws. Several pieces from wrong kit.`,
        art: `<span style="color:#fbbf24">
        
        </span>   <span style="color:#38bdf8">PERSNLIGHET</span>                     <span style="color:#fbbf24"></span>
        <span style="color:#fbbf24"></span>   <span style="color:#94a3b8">Human Personality Kit</span>              <span style="color:#fbbf24"></span>
        <span style="color:#fbbf24"></span>   <span style="color:#94a3b8">Art. No. 404-NOT-FOUND</span>            <span style="color:#fbbf24"></span>
        <span style="color:#fbbf24"></span>

  <span style="color:#94a3b8">STEP 1:</span>  <span style="color:#fb7185">Unpack childhood trauma (bag A)</span>
           <span style="color:#4a4a5e"> WARNING: contents under pressure</span>

  <span style="color:#94a3b8">STEP 2:</span>  <span style="color:#fb7185">Attach coping mechanisms (bag B)</span>
           <span style="color:#4a4a5e"> If humor doesn't fit, try sarcasm</span>

  <span style="color:#94a3b8">STEP 3:</span>  <span style="color:#fbbf24">Insert self-esteem (not included)</span>
           <span style="color:#4a4a5e"> Available separately for $200/hr (therapy)</span>

  <span style="color:#94a3b8">STEP 4:</span>  <span style="color:#a78bfa">Tighten emotional walls (allen key provided)</span>
           <span style="color:#4a4a5e"> DO NOT over-tighten or you become "that person"</span>

  <span style="color:#94a3b8">STEP 5:</span>  <span style="color:#34d399">Congratulations! Your personality is</span>
           <span style="color:#fb7185">still wobbly and missing 3 pieces</span>

  <span style="color:#4a4a5e">PIECES LEFT OVER: 47 (this is fine)</span>
  <span style="color:#4a4a5e">ESTIMATED TIME: a lifetime  ACTUAL TIME: still going</span>`
      },
      {
        title: "YOUR BRAIN AT 3AM: TERMINAL OUTPUT",
        batch: "Batch 2  Unhinged Life",
        desc: `sudo shutdown -h now [PERMISSION DENIED]`,
        art: `<span style="color:#34d399">  user@brain:~$</span> <span style="color:#94a3b8">sleep --hours 8</span>
<span style="color:#fb7185">  ERROR: Process "overthinking" is using 99.7% CPU</span>
<span style="color:#fb7185">  ERROR: Cannot allocate memory for "peace"</span>

<span style="color:#34d399">  user@brain:~$</span> <span style="color:#94a3b8">kill -9 anxiety</span>
<span style="color:#fb7185">  Permission denied. anxiety is protected by kernel.</span>

<span style="color:#34d399">  user@brain:~$</span> <span style="color:#94a3b8">ls ~/thoughts/</span>
<span style="color:#a78bfa">  that_embarrassing_thing_from_2009.exe</span>
<span style="color:#a78bfa">  did_i_lock_the_door.loop</span>
<span style="color:#a78bfa">  what_if_everyone_hates_me.daemon</span>
<span style="color:#a78bfa">  random_song_stuck_on_repeat.mp3</span>
<span style="color:#a78bfa">  meaning_of_life.404</span>
<span style="color:#a78bfa">  that_text_i_shouldnt_have_sent.BAK</span>

<span style="color:#34d399">  user@brain:~$</span> <span style="color:#94a3b8">sudo shutdown -h now</span>
<span style="color:#fb7185">  DENIED. Scheduled tasks remaining:</span>
<span style="color:#fb7185">   - Replay every conversation from today (2hrs)</span>
<span style="color:#fb7185">   - Invent problems that don't exist (4hrs)</span>
<span style="color:#fb7185">   - Google rare diseases matching mild headache (1hr)</span>
<span style="color:#fb7185">   - Wonder if the simulation is real ()</span>

<span style="color:#34d399">  user@brain:~$</span> <span style="color:#fbbf24">fuck</span>
<span style="color:#94a3b8">  command not found. did you mean: suffer?</span>`
      },
      {
        title: "MISSING PERSON: MY MOTIVATION",
        batch: "Batch 2  Unhinged Life",
        desc: `Last seen January 2nd. Presumed dead.`,
        art: `<span style="color:#fb7185">  </span>
<span style="color:#fb7185">  </span>                  <span style="color:#fbbf24"> MISSING </span>                        <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                       <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8"></span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8">                 </span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8"></span>    <span style="color:#fbbf24"></span>        <span style="color:#94a3b8"></span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8"></span>    <span style="color:#fbbf24"> ? </span>        <span style="color:#94a3b8"></span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8"></span>    <span style="color:#fbbf24"></span>        <span style="color:#94a3b8"></span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8">  no photo exists </span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>              <span style="color:#94a3b8"></span>                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                       <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">NAME:</span>       <span style="color:#fbbf24">My Will To Do Anything</span>                 <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">LAST SEEN:</span>  <span style="color:#94a3b8">January 2nd, approximately 9:47 AM</span>      <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">WEARING:</span>    <span style="color:#94a3b8">Gym clothes (never made it to gym)</span>      <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">LAST WORDS:</span> <span style="color:#fb7185">"I'll start Monday"</span>                     <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                                       <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#4a4a5e">If found, do not approach. It will run again.</span>      <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#4a4a5e">REWARD: We'll finally clean the apartment</span>          <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>`
      },
      {
        title: "WEATHER FORECAST: YOUR EMOTIONAL STATE",
        batch: "Batch 2  Unhinged Life",
        desc: `Scattered breakdowns with a 100% chance of overthinking tonight`,
        art: `<span style="color:#38bdf8">      EMOTIONAL WEATHER SERVICE </span>

     <span style="color:#fbbf24">  .-~~~-.          CURRENT CONDITIONS</span>
     <span style="color:#fbbf24"> (  o_o  )  </span>       <span style="color:#fb7185">Partly Unhinged</span>
     <span style="color:#fbbf24">  \`-._.-'   </span>       <span style="color:#94a3b8">Temp: lukewarm at best</span>
     <span style="color:#fbbf24">    /|\    </span>        <span style="color:#94a3b8">Wind: screaming internally, 40mph</span>
     <span style="color:#fbbf24">   / | \   </span>        <span style="color:#94a3b8">Humidity: eyes, 100%</span>

<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  MON</span>    <span style="color:#94a3b8">TUE</span>    <span style="color:#94a3b8">WED</span>    <span style="color:#94a3b8">THU</span>    <span style="color:#94a3b8">FRI</span>    <span style="color:#94a3b8">SAT</span>    <span style="color:#94a3b8">SUN</span>
  <span style="color:#fb7185"></span>     <span style="color:#fbbf24"></span>     <span style="color:#a78bfa"></span>     <span style="color:#fb7185"></span>     <span style="color:#fbbf24"></span>     <span style="color:#34d399"></span>     <span style="color:#fb7185"></span>
 <span style="color:#fb7185">AWFUL</span>  <span style="color:#fbbf24">ANGRY</span>  <span style="color:#a78bfa">NUMB</span>   <span style="color:#fb7185">DEAD</span>   <span style="color:#fbbf24">COPE</span>   <span style="color:#34d399">SLEEP</span>  <span style="color:#fb7185">DREAD</span>
<span style="color:#94a3b8">  </span>

<span style="color:#4a4a5e">  ADVISORY: Severe existential storm approaching.</span>
<span style="color:#4a4a5e">  Take shelter in bed. Bring snacks.</span>
<span style="color:#4a4a5e">  Avoid: mirrors, social media, your ex's profile</span>`
      },
      {
        title: "SPAM EMAIL FROM YOUR SUBCONSCIOUS",
        batch: "Batch 2  Unhinged Life",
        desc: `Subject: URGENT!!! You left the stove on (you didn't)`,
        art: `<span style="color:#94a3b8">  From:</span>    <span style="color:#a78bfa">subconscious@yourbrain.hell</span>
<span style="color:#94a3b8">  To:</span>      <span style="color:#34d399">conscious-mind@trying-to-sleep.com</span>
<span style="color:#94a3b8">  Subject:</span> <span style="color:#fb7185"> URGENT: 47 THINGS YOU FORGOT TO WORRY ABOUT</span>
<span style="color:#94a3b8">  </span>

<span style="color:#fbbf24">  Dear Valued Anxiety Subscriber,</span>

<span style="color:#94a3b8">  CONGRATULATIONS! You've been selected for our</span>
<span style="color:#94a3b8">  premium 3AM Panic Package! Includes:</span>

<span style="color:#fb7185">   That weird thing you said in 2013</span>
<span style="color:#fb7185">   Did you lock the door? (check again)</span>
<span style="color:#fb7185">   Everyone at the party secretly hated you</span>
<span style="color:#fb7185">   Your career is going nowhere btw</span>
<span style="color:#fb7185">   Remember that voicemail you never listened to?</span>
<span style="color:#fb7185">   You might be getting sick (google it NOW)</span>
<span style="color:#fb7185">   Is the fridge running? ARE YOU SURE?</span>

<span style="color:#fbbf24">  ACT NOW and receive BONUS existential dread!</span>

<span style="color:#94a3b8">  To unsubscribe, simply  stop having a brain </span>

<span style="color:#4a4a5e">  </span>
<span style="color:#4a4a5e">  This message cannot be marked as spam.</span>
<span style="color:#4a4a5e">  You agreed to these terms by being born.</span>`
      },
      {
        title: "TINDER BIO: HONEST VERSION",
        batch: "Batch 2  Unhinged Life",
        desc: `If my red flags were actual flags I'd have a whole parade`,
        art: `<span style="color:#fb7185">  </span>
<span style="color:#fb7185">  </span>  <span style="color:#fbbf24"></span>                                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#fbbf24">   </span>  <span style="color:#94a3b8">Human Dumpster Fire, 29</span>              <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#fbbf24">      </span>  <span style="color:#4a4a5e"> 3 miles away (emotionally: )</span>     <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#fbbf24"></span>                                    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                               <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">About me:</span>                                   <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">Somehow both too much and not enough.</span>       <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">Will trauma-dump on the first date.</span>         <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">Emotionally unavailable but desperately</span>     <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#94a3b8">want you to fix that for me.</span>                <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                               <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#a78bfa"> Red Flags:</span>  <span style="color:#fb7185">too many to list</span>              <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#a78bfa"> Green Flags:</span> <span style="color:#34d399">I have a dog?</span>                <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#a78bfa"> Dealbreaker:</span> <span style="color:#94a3b8">still follows their ex</span>        <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                               <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#4a4a5e">"Looking for the Jim to my Pam"</span>             <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>  <span style="color:#4a4a5e">(will settle for the chaos to my crisis)</span>    <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>                                               <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>      <span style="color:#fb7185"> NOPE</span>         <span style="color:#34d399"> REGRET THIS LATER</span>       <span style="color:#fb7185"></span>
<span style="color:#fb7185">  </span>`
      },
      {
        title: "GOOGLE SEARCH HISTORY: EXPOSED",
        batch: "Batch 2  Unhinged Life",
        desc: `FBI agent assigned to you just requested a transfer`,
        art: `<span style="color:#38bdf8">  </span>
<span style="color:#38bdf8">  </span>  <span style="color:#fbbf24">G</span><span style="color:#fb7185">o</span><span style="color:#fbbf24">o</span><span style="color:#38bdf8">g</span><span style="color:#34d399">l</span><span style="color:#fb7185">e</span>  <span style="color:#94a3b8">Search History (past 24hrs)</span>                   <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>                                                          <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">2:14 AM</span>  <span style="color:#fb7185">is it normal to hear colors</span>                   <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">2:18 AM</span>  <span style="color:#fb7185">how many days can you survive without sleep</span>    <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">2:31 AM</span>  <span style="color:#fbbf24">do dogs think in barks</span>                        <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">2:47 AM</span>  <span style="color:#fbbf24">why does the moon follow my car</span>                <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">3:02 AM</span>  <span style="color:#a78bfa">if I eat enough carrots will I see in the dark</span> <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">3:15 AM</span>  <span style="color:#a78bfa">can you return a mattress you cried on</span>         <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">3:33 AM</span>  <span style="color:#fb7185">am I the toxic one quiz</span>                      <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">3:34 AM</span>  <span style="color:#fb7185">the quiz was wrong right</span>                     <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">3:41 AM</span>  <span style="color:#fbbf24">how to gaslight a quiz</span>                        <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">4:00 AM</span>  <span style="color:#fb7185">cost of living on a boat alone forever</span>        <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">4:12 AM</span>  <span style="color:#fb7185">do therapists judge you</span>                      <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">4:13 AM</span>  <span style="color:#fb7185">mine definitely judges me</span>                    <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>  <span style="color:#94a3b8">5:58 AM</span>  <span style="color:#34d399">how to call in sick to life</span>                   <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>                                                          <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>`
      },
      {
        title: "REPORT CARD: YOU AS AN ADULT",
        batch: "Batch 2  Unhinged Life",
        desc: `Parent-teacher conference has been indefinitely postponed`,
        art: `<span style="color:#a78bfa">  </span>
<span style="color:#a78bfa">  </span>       <span style="color:#fbbf24">SCHOOL OF HARD KNOCKS</span>                           <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>       <span style="color:#94a3b8">Annual Performance Report</span>                       <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#4a4a5e"></span>  <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">STUDENT:</span> <span style="color:#fbbf24">You, unfortunately</span>                        <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">GRADE:</span>   <span style="color:#fb7185">Adult (allegedly)</span>                          <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#4a4a5e"></span>    <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">SUBJECT</span>              <span style="color:#94a3b8">GRADE</span>   <span style="color:#94a3b8">NOTES</span>                  <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Financial Literacy</span>   <span style="color:#fb7185">F-</span>      <span style="color:#fb7185">What is a 401k?</span>        <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Cooking</span>              <span style="color:#fbbf24">D</span>       <span style="color:#fbbf24">Microwave virtuoso</span>     <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Time Management</span>      <span style="color:#fb7185">F</span>       <span style="color:#fb7185">Always late, no shame</span>  <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Emotional Maturity</span>   <span style="color:#fb7185">F</span>       <span style="color:#fb7185">See: tantrums, age 29</span>  <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Impulse Control</span>      <span style="color:#fb7185">F--</span>     <span style="color:#fb7185">Amazon at 3am</span>          <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Keeping Plants Alive</span> <span style="color:#fb7185">F</span>       <span style="color:#fb7185">Genocide</span>                <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Pretending to be OK</span>  <span style="color:#34d399">A+</span>      <span style="color:#34d399">Oscar-worthy</span>           <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">Napping</span>              <span style="color:#34d399">A+</span>      <span style="color:#34d399">World class</span>            <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#4a4a5e"></span>    <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>  <span style="color:#94a3b8">GPA:</span> <span style="color:#fb7185">0.4</span>   <span style="color:#94a3b8">STATUS:</span> <span style="color:#fb7185">Academic probation (life)</span>        <span style="color:#a78bfa"></span>
<span style="color:#a78bfa">  </span>`
      },
      {
        title: "AUTOPSY OF A FRIDAY NIGHT IN",
        batch: "Batch 2  Unhinged Life",
        desc: `Time of death: 8:47pm when you put on sweatpants`,
        art: `<span style="color:#94a3b8">   TIMELINE OF EVENTS </span>

  <span style="color:#34d399">6:00 PM</span> <span style="color:#94a3b8"></span> <span style="color:#34d399">"Maybe I'll go out tonight"</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#34d399">6:30 PM</span> <span style="color:#94a3b8"></span> <span style="color:#fbbf24">Puts on real pants (optimistic)</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#fbbf24">7:00 PM</span> <span style="color:#94a3b8"></span> <span style="color:#fbbf24">Opens group chat: "who's going out?"</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#fbbf24">7:15 PM</span> <span style="color:#94a3b8"></span> <span style="color:#fbbf24">*crickets*</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#fb7185">7:30 PM</span> <span style="color:#94a3b8"></span> <span style="color:#fb7185">Sits on bed "for a minute"</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#fb7185">7:45 PM</span> <span style="color:#94a3b8"></span> <span style="color:#fb7185">Opens Netflix "just to browse"</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#a78bfa">8:00 PM</span> <span style="color:#94a3b8"></span> <span style="color:#a78bfa">Sweatpants activated. Point of no return.</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#a78bfa">8:30 PM</span> <span style="color:#94a3b8"></span> <span style="color:#a78bfa">Orders delivery. "Treat yourself" energy.</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#4a4a5e">9:00 PM</span> <span style="color:#94a3b8"></span> <span style="color:#4a4a5e">Eating pad thai in bed watching murder docs</span>
          <span style="color:#94a3b8"></span>
  <span style="color:#4a4a5e">10:30</span>   <span style="color:#94a3b8"></span> <span style="color:#4a4a5e">Asleep with phone on face. Perfect night.</span>

<span style="color:#94a3b8">   CAUSE OF DEATH: </span>
<span style="color:#94a3b8">              </span><span style="color:#fbbf24">Comfort. Sweet, sweet comfort.</span>`
      },
      {
        title: "YOUR APARTMENT: CRIME SCENE ANALYSIS",
        batch: "Batch 2  Unhinged Life",
        desc: `CSI would take one look and go home`,
        art: `<span style="color:#fbbf24">                     FLOOR PLAN </span>

  <span style="color:#94a3b8">  </span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">KITCHEN</span>  <span style="color:#94a3b8"></span> <span style="color:#fbbf24">BATHROOM</span> <span style="color:#94a3b8"></span>               <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">dishes:</span>  <span style="color:#94a3b8"></span> <span style="color:#fbbf24">towel:</span>   <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">BEDROOM</span>      <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">carbon</span>   <span style="color:#94a3b8"></span> <span style="color:#fbbf24">floor</span>    <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">THE CHAIR:</span>   <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">dated</span>    <span style="color:#94a3b8"></span> <span style="color:#fbbf24">(wet 3</span>   <span style="color:#94a3b8"></span>  <span style="color:#a78bfa"></span>     <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">sponge:</span>  <span style="color:#94a3b8"></span> <span style="color:#fbbf24"> days)</span>   <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">CLEAN</span>    <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#fb7185">alive</span>    <span style="color:#94a3b8"></span>          <span style="color:#94a3b8"></span>  <span style="color:#a78bfa">CLOTHES</span>    <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span>          <span style="color:#94a3b8"></span>  <span style="color:#a78bfa"></span>     <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#34d399">LIVING</span>   <span style="color:#94a3b8"></span>  <span style="color:#4a4a5e">(not a chair</span> <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#34d399">ROOM</span>     <span style="color:#94a3b8"></span>          <span style="color:#94a3b8"></span>   <span style="color:#4a4a5e">anymore)</span>  <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span>          <span style="color:#94a3b8"></span> <span style="color:#94a3b8">closet:</span>  <span style="color:#94a3b8"></span>               <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#34d399">couch:</span>   <span style="color:#94a3b8"></span> <span style="color:#94a3b8">portal to</span><span style="color:#94a3b8"></span>  <span style="color:#fb7185">bed: unmade</span>  <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span> <span style="color:#34d399">2nd bed</span>  <span style="color:#94a3b8"></span> <span style="color:#94a3b8">the void</span> <span style="color:#94a3b8"></span>  <span style="color:#fb7185">since: birth</span> <span style="color:#94a3b8"></span>
  <span style="color:#94a3b8">  </span>

  <span style="color:#4a4a5e">  PLANTS ALIVE: 0/7   LAST VACUUMED: don't ask</span>`
      },
      {
        title: "DAILY HOROSCOPE (BRUTALLY HONEST)",
        batch: "Batch 2  Unhinged Life",
        desc: `The stars aligned to tell you specifically to sit down`,
        art: `<span style="color:#a78bfa">
                                  </span>

       <span style="color:#fbbf24"> ARIES:</span>     <span style="color:#94a3b8">You'll start a fight today. With yourself.</span>
       <span style="color:#fbbf24"> TAURUS:</span>    <span style="color:#94a3b8">Spending money you don't have. Again.</span>
       <span style="color:#fbbf24"> GEMINI:</span>    <span style="color:#94a3b8">Both of you are annoying today.</span>
       <span style="color:#fbbf24"> CANCER:</span>    <span style="color:#94a3b8">You will cry. The stars didn't cause it.</span>
       <span style="color:#fbbf24"> LEO:</span>       <span style="color:#94a3b8">Nobody is looking at you. Relax.</span>
       <span style="color:#fbbf24"> VIRGO:</span>     <span style="color:#94a3b8">Your color-coded planner won't save you.</span>
       <span style="color:#fbbf24"> LIBRA:</span>     <span style="color:#94a3b8">You can't decide. We know. Everyone knows.</span>
       <span style="color:#fbbf24"> SCORPIO:</span>   <span style="color:#94a3b8">Stop stalking their Instagram. They know.</span>
       <span style="color:#fbbf24"> SAGITTAR:</span>  <span style="color:#94a3b8">Booking a trip you can't afford in 3.. 2..</span>
       <span style="color:#fbbf24"> CAPRICORN:</span> <span style="color:#94a3b8">Still at work. Always at work. Why.</span>
       <span style="color:#fbbf24"> AQUARIUS:</span>  <span style="color:#94a3b8">Being weird isn't a personality.</span>
       <span style="color:#fbbf24"> PISCES:</span>    <span style="color:#94a3b8">You're one minor inconvenience from tears.</span>

<span style="color:#a78bfa">                                  </span>

  <span style="color:#4a4a5e">  MERCURY: in retrograde (always, apparently)</span>
  <span style="color:#4a4a5e">  VENUS: has left the chat</span>`
      },
      {
        title: "RESTAURANT MENU: EMOTIONAL EATING",
        batch: "Batch 2  Unhinged Life",
        desc: `Chef's special: whatever you're not supposed to have`,
        art: `<span style="color:#fbbf24">        
        </span>   <span style="color:#fbbf24">CHEZ DYSFUNCTION</span>              <span style="color:#fbbf24">
        </span>   <span style="color:#94a3b8">~ est. your last breakup ~</span>     <span style="color:#fbbf24">
        </span>

  <span style="color:#fb7185">   STARTERS </span>
  <span style="color:#94a3b8">  Bread Basket of Denial</span>              <span style="color:#fbbf24">free</span>
  <span style="color:#94a3b8">  Soup du Jour (tears, salted)</span>        <span style="color:#fbbf24">$0.00</span>
  <span style="color:#94a3b8">  Bruschetta of False Hope</span>            <span style="color:#fbbf24">$12</span>

  <span style="color:#a78bfa">   MAINS </span>
  <span style="color:#94a3b8">  Entire Block of Cheese (2am)</span>        <span style="color:#fbbf24">$8</span>
  <span style="color:#94a3b8">  Pad Thai of Regret (xtra spicy)</span>     <span style="color:#fbbf24">$16</span>
  <span style="color:#94a3b8">  Family-Size Anything (for one)</span>      <span style="color:#fbbf24">$22</span>
  <span style="color:#94a3b8">  Whatever Your Ex Hated</span>              <span style="color:#fbbf24">$fuck it</span>

  <span style="color:#34d399">   DESSERTS </span>
  <span style="color:#94a3b8">  Ice Cream Straight From Container</span>   <span style="color:#fbbf24">$7</span>
  <span style="color:#94a3b8">  Cake You Told Yourself Was "A Slice"</span> <span style="color:#fbbf24">$9</span>
  <span style="color:#94a3b8">  The Audacity (chef's special)</span>       <span style="color:#fbbf24">$</span>

  <span style="color:#4a4a5e">  Gratuity of 100% self-pity included</span>
  <span style="color:#4a4a5e">  No substitutions. Life doesn't do those either.</span>`
      },
      {
        title: "LOADING SCREEN: YOUR 30s",
        batch: "Batch 2  Unhinged Life",
        desc: `Now loading... please wait... forever...`,
        art: `<span style="color:#34d399">

          
          </span>    <span style="color:#fbbf24">INSTALLING: YOUR 30s</span>          <span style="color:#34d399">
          </span>

  <span style="color:#94a3b8">  Progress:</span> <span style="color:#34d399"></span><span style="color:#4a4a5e"></span> <span style="color:#94a3b8">31%</span>

  <span style="color:#94a3b8">  Installing components:</span>
  <span style="color:#34d399">  </span> <span style="color:#94a3b8">Back pain</span>                         <span style="color:#34d399">complete</span>
  <span style="color:#34d399">  </span> <span style="color:#94a3b8">Hangovers lasting 3 days</span>           <span style="color:#34d399">complete</span>
  <span style="color:#34d399">  </span> <span style="color:#94a3b8">Strong opinions about mattresses</span>   <span style="color:#34d399">complete</span>
  <span style="color:#34d399">  </span> <span style="color:#94a3b8">Weird knee sound</span>                   <span style="color:#34d399">complete</span>
  <span style="color:#fbbf24">  </span> <span style="color:#94a3b8">Existential crisis #47</span>             <span style="color:#fbbf24">installing...</span>
  <span style="color:#4a4a5e">  </span> <span style="color:#4a4a5e">Retirement plan</span>                    <span style="color:#fb7185">ERROR: NOT FOUND</span>
  <span style="color:#4a4a5e">  </span> <span style="color:#4a4a5e">Knowing what you want from life</span>    <span style="color:#fb7185">CORRUPTED</span>
  <span style="color:#4a4a5e">  </span> <span style="color:#4a4a5e">Metabolism</span>                          <span style="color:#fb7185">UNINSTALLED</span>
  <span style="color:#4a4a5e">  </span> <span style="color:#4a4a5e">Ability to stay up past 10pm</span>       <span style="color:#fb7185">DEPRECATED</span>

  <span style="color:#fb7185">   WARNING: 20s plugin no longer compatible</span>
  <span style="color:#fb7185">   Energy.dll has been permanently deleted</span>
  <span style="color:#4a4a5e">  Estimated time remaining: the rest of your life</span>`
      },
      {
        title: "TEXT MESSAGE THREAD WITH GOD",
        batch: "Batch 2  Unhinged Life",
        desc: `Delivered. Read. Ignored. Classic.`,
        art: `<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  </span>     <span style="color:#fbbf24">GOD</span>  <span style="color:#4a4a5e">last online: before you were born</span>  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span><span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                             <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"> hey quick question   </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"> what the fuck        </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                            <span style="color:#4a4a5e">Read 3:14 AM </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                             <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"> like specifically    </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"> why                  </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                            <span style="color:#4a4a5e">Read 3:15 AM </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                             <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#34d399"></span>                      <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#34d399"> lol              </span>                      <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#34d399"></span>                      <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                             <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"> LOL???              </span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                  <span style="color:#38bdf8"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                            <span style="color:#4a4a5e">Delivered</span>        <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>`
      },
      {
        title: "CORPORATE BUZZWORD BINGO",
        batch: "Batch 2  Unhinged Life",
        desc: `One more "circle back" and I swear to god`,
        art: `<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#fb7185">SYNERGY</span>   <span style="color:#fbbf24"></span> <span style="color:#94a3b8">circle</span>    <span style="color:#fbbf24"></span> <span style="color:#a78bfa">DEEP</span>      <span style="color:#fbbf24"></span> <span style="color:#94a3b8">align</span>     <span style="color:#fbbf24"></span> <span style="color:#fb7185">LEVERAGE</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#fb7185"> BINGO</span>  <span style="color:#fbbf24"></span> <span style="color:#94a3b8">back</span>      <span style="color:#fbbf24"></span> <span style="color:#a78bfa">DIVE</span>      <span style="color:#fbbf24"></span> <span style="color:#94a3b8">on this</span>   <span style="color:#fbbf24"></span> <span style="color:#fb7185"> BINGO</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">move the</span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">LOW</span>       <span style="color:#fbbf24"></span> <span style="color:#94a3b8">touch</span>     <span style="color:#fbbf24"></span> <span style="color:#fb7185">THOUGHT</span>   <span style="color:#fbbf24"></span> <span style="color:#94a3b8">take</span>      <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">needle</span>    <span style="color:#fbbf24"></span> <span style="color:#fb7185">HANGING</span>   <span style="color:#fbbf24"></span> <span style="color:#94a3b8">base</span>      <span style="color:#fbbf24"></span> <span style="color:#fb7185">LEADER</span>    <span style="color:#fbbf24"></span> <span style="color:#94a3b8">offline</span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>           <span style="color:#fbbf24"></span> <span style="color:#fb7185">FRUIT</span>     <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span> <span style="color:#fb7185"> BINGO</span>  <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">paradigm</span>  <span style="color:#fbbf24"></span> <span style="color:#94a3b8">run it</span>    <span style="color:#fbbf24"></span> <span style="color:#fbbf24"> FREE </span>  <span style="color:#fbbf24"></span> <span style="color:#94a3b8">net</span>       <span style="color:#fbbf24"></span> <span style="color:#94a3b8">bandwidth</span> <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">shift</span>     <span style="color:#fbbf24"></span> <span style="color:#94a3b8">up the</span>    <span style="color:#fbbf24"></span> <span style="color:#fbbf24">(bullshit)</span><span style="color:#fbbf24"></span> <span style="color:#94a3b8">net</span>       <span style="color:#fbbf24"></span> <span style="color:#94a3b8">for this</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>           <span style="color:#fbbf24"></span> <span style="color:#94a3b8">flagpole</span>  <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#fb7185">PIVOT</span>     <span style="color:#fbbf24"></span> <span style="color:#94a3b8">boil the</span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">DOUBLE</span>    <span style="color:#fbbf24"></span> <span style="color:#94a3b8">open the</span>  <span style="color:#fbbf24"></span> <span style="color:#fb7185">AGILE</span>     <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#fb7185"> BINGO</span>  <span style="color:#fbbf24"></span> <span style="color:#94a3b8">ocean</span>     <span style="color:#fbbf24"></span> <span style="color:#fb7185">CLICK</span>     <span style="color:#fbbf24"></span> <span style="color:#94a3b8">kimono</span>    <span style="color:#fbbf24"></span> <span style="color:#fb7185"> BINGO</span>  <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">EOD</span>       <span style="color:#fbbf24"></span> <span style="color:#94a3b8">unpack</span>    <span style="color:#fbbf24"></span> <span style="color:#94a3b8">robust</span>    <span style="color:#fbbf24"></span> <span style="color:#94a3b8">drill</span>     <span style="color:#fbbf24"></span> <span style="color:#94a3b8">ping me</span>   <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span> <span style="color:#94a3b8">(kill me)</span> <span style="color:#fbbf24"></span> <span style="color:#94a3b8">this</span>      <span style="color:#fbbf24"></span> <span style="color:#94a3b8">pipeline</span>  <span style="color:#fbbf24"></span> <span style="color:#94a3b8">down</span>      <span style="color:#fbbf24"></span>           <span style="color:#fbbf24"></span>
<span style="color:#fbbf24">  </span>`
      },
      {
        title: "WIKIPEDIA: GETTING YOUR SHIT TOGETHER",
        batch: "Batch 2  Unhinged Life",
        desc: `This article has multiple issues. You too.`,
        art: `<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  </span> <span style="color:#4a4a5e">W</span> <span style="color:#fbbf24">Getting Your Shit Together</span>                              <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">From Wikipedia, the free encyclopedia that also judges you</span><span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185">  This article has multiple issues:</span>                 <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185">   The neutrality of this article is disputed</span>       <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185">   This article is entirely fictional</span>               <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185">   No reliable sources exist for this concept</span>       <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fb7185"></span> <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">Getting your shit together is a</span> <span style="color:#a78bfa">[citation needed]</span>         <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">theoretical concept in which a person achieves basic</span>    <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">human functionality. No documented cases exist.</span>          <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#fbbf24">Contents</span> <span style="color:#4a4a5e">[hide]</span>                                         <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">1. Definition (unknown)</span>                                  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">2. History (there is none)</span>                               <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">3. Methods</span> <span style="color:#fb7185">[this section is empty]</span>                       <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#94a3b8">4. See Also: Delusion, Copium, Hopium</span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                                           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span> <span style="color:#4a4a5e">Last edited by: your_mom_69 (4 minutes ago)</span>             <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>`
      },
      {
        title: "FLIGHT BOARDING PASS TO ROCK BOTTOM",
        batch: "Batch 2  Unhinged Life",
        desc: `Now boarding all zones. You're in every zone.`,
        art: `<span style="color:#38bdf8">  </span>
<span style="color:#38bdf8">  </span> <span style="color:#fbbf24"> EMOTIONAL AIRLINES</span>             <span style="color:#38bdf8"></span> <span style="color:#fbbf24">BOARDING PASS</span>     <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>                                   <span style="color:#38bdf8"></span>                  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">PASSENGER:</span> <span style="color:#fb7185">You, Barely Holding</span>   <span style="color:#38bdf8"></span> <span style="color:#94a3b8">GATE:</span> <span style="color:#fb7185">THERAPY</span>    <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>            <span style="color:#fb7185">It Together</span>           <span style="color:#38bdf8"></span> <span style="color:#94a3b8">SEAT:</span> <span style="color:#fb7185">FLOOR</span>     <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>                                   <span style="color:#38bdf8"></span> <span style="color:#94a3b8">ZONE:</span> <span style="color:#fb7185">ALL</span>       <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">FROM:</span> <span style="color:#34d399">Having My Shit Together</span>    <span style="color:#38bdf8"></span>                  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>       <span style="color:#4a4a5e">(fictional location)</span>       <span style="color:#38bdf8"></span> <span style="color:#94a3b8">CLASS:</span>           <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">TO:</span>   <span style="color:#fb7185">Absolute Rock Bottom</span>      <span style="color:#38bdf8"></span> <span style="color:#fb7185">  NO CLASS</span>       <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>       <span style="color:#4a4a5e">(direct flight)</span>            <span style="color:#38bdf8"></span>                  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>                                   <span style="color:#38bdf8"></span> <span style="color:#4a4a5e">||||| |||||</span>     <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">DEPART:</span> <span style="color:#fbbf24">Birth</span>                  <span style="color:#38bdf8"></span> <span style="color:#4a4a5e">||||| |||||</span>     <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">ARRIVE:</span> <span style="color:#fbbf24">TBD (no ETA)</span>           <span style="color:#38bdf8"></span>                  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span> <span style="color:#94a3b8">BAGS:</span>   <span style="color:#fb7185">Emotional (47 checked)</span> <span style="color:#38bdf8"></span> <span style="color:#fb7185">NON-REFUNDABLE</span>  <span style="color:#38bdf8"></span>
<span style="color:#38bdf8">  </span>`
      },
      {
        title: "PRESCRIPTION LABEL: YOUR COPING MECHANISMS",
        batch: "Batch 2  Unhinged Life",
        desc: `Take as needed. You always need.`,
        art: `<span style="color:#34d399">  </span>
<span style="color:#34d399">  </span> <span style="color:#fb7185"></span>  <span style="color:#fbbf24">PHARMACY OF POOR DECISIONS</span>                        <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#94a3b8">1-800-NOT-OKAY</span>                                    <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#4a4a5e"></span>    <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#94a3b8">Patient:</span> <span style="color:#fbbf24">You</span>   <span style="color:#94a3b8">DOB:</span> <span style="color:#fbbf24">Too Old For This Shit</span>           <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#4a4a5e"></span>    <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>                                                      <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fbbf24">COPIUM MAXIMUS 500mg</span>                               <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>                                                      <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#94a3b8">Take 1 tablet every time reality hits.</span>              <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#94a3b8">May be taken with: wine, ice cream, denial.</span>         <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#94a3b8">Refills: </span>                                         <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>                                                      <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fb7185">SIDE EFFECTS MAY INCLUDE:</span>                          <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fb7185"> Delusions of having your life together</span>            <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fb7185"> Sudden urge to post motivational quotes</span>           <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fb7185"> Temporary confidence (wears off by Tuesday)</span>       <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#fb7185"> Buying self-help books you'll never read</span>           <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>                                                      <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>    <span style="color:#4a4a5e">Dr. Nobody Cares, MD</span>                               <span style="color:#34d399"></span>
<span style="color:#34d399">  </span>`
      },
      {
        title: "CAPTCHA: PROVE YOU'RE NOT A MESS",
        batch: "Batch 2  Unhinged Life",
        desc: `Select all squares containing your dignity. No results found.`,
        art: `<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  </span>                                            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>   <span style="color:#34d399"></span> <span style="color:#fbbf24">I'm not a robot.</span>                       <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>      <span style="color:#fb7185">I'm something much worse.</span>              <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#94a3b8">Select all images with</span> <span style="color:#fbbf24">YOUR LIFE TOGETHER</span>  <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span> <span style="color:#fb7185">NOPE</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">LMAO</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">NOPE</span> <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span> <span style="color:#fb7185">LMAO</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">NOPE</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">HAHA</span> <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span> <span style="color:#fb7185">NAH</span>  <span style="color:#4a4a5e"></span> <span style="color:#fb7185">NOPE</span> <span style="color:#4a4a5e"></span> <span style="color:#fb7185">404</span>  <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>  <span style="color:#4a4a5e"></span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>   <span style="color:#fb7185"> VERIFICATION FAILED</span>                   <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>   <span style="color:#fb7185">No matching images found.</span>                <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>   <span style="color:#fb7185">This is correct.</span>                         <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>                                            <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>   <span style="color:#4a4a5e">Attempts remaining: why bother</span>           <span style="color:#94a3b8"></span>
<span style="color:#94a3b8">  </span>`
      },
      {
        title: "CLOSING CREDITS OF YOUR DAY",
        batch: "Batch 2  Unhinged Life",
        desc: `Directed by: poor decisions. Produced by: caffeine.`,
        art: `<span style="color:#94a3b8">

               
               </span>  <span style="color:#fbbf24">TODAY</span>                 <span style="color:#94a3b8">
               </span>  <span style="color:#4a4a5e">A Production of</span>       <span style="color:#94a3b8">
               </span>  <span style="color:#fbbf24">YOUR CHAOTIC LIFE INC.</span> <span style="color:#94a3b8">
               </span>


  <span style="color:#94a3b8">Directed by ..................</span> <span style="color:#fb7185">Poor Decisions</span>
  <span style="color:#94a3b8">Produced by .................</span> <span style="color:#fbbf24">Caffeine & Spite</span>
  <span style="color:#94a3b8">Written by ..................</span> <span style="color:#a78bfa">Anxiety, feat. Insomnia</span>
  <span style="color:#94a3b8">Soundtrack ..................</span> <span style="color:#34d399">Same 4 songs on repeat</span>
  <span style="color:#94a3b8">Catering ....................</span> <span style="color:#fb7185">Uber Eats (again)</span>
  <span style="color:#94a3b8">Stunt coordinator ..........</span> <span style="color:#fbbf24">The alarm clock</span>
  <span style="color:#94a3b8">Special effects ............</span> <span style="color:#a78bfa">Concealer</span>
  <span style="color:#94a3b8">Best boy ....................</span> <span style="color:#34d399">Your dog (actual best boy)</span>
  <span style="color:#94a3b8">Key grip ....................</span> <span style="color:#fb7185">On reality (loosening)</span>

  <span style="color:#4a4a5e">No humans were okay during the making of this day.</span>
  <span style="color:#4a4a5e">Tomorrow is a sequel nobody asked for.</span>`
      },
      {
        title: "COURT TRANSCRIPT: YOU VS. YOUR ALARM CLOCK",
        batch: "Batch 2  Unhinged Life",
        desc: `Case #AM-0600. The defendant has been found guilty on all counts.`,
        art: `<span style="color:#fbbf24">  </span>
<span style="color:#fbbf24">                    SUPERIOR COURT OF BULLSHIT</span>
<span style="color:#fbbf24">                        MORNING DIVISION</span>
<span style="color:#fbbf24">  </span>

<span style="color:#94a3b8">  CASE NO:</span> <span style="color:#fb7185">AM-0600-FUCKTHIS</span>
<span style="color:#94a3b8">  PLAINTIFF:</span> <span style="color:#fbbf24">You (barely conscious)</span>
<span style="color:#94a3b8">  DEFENDANT:</span> <span style="color:#fb7185">iPhone Alarm, "Radar" tone</span>
<span style="color:#94a3b8">  CHARGE:</span> <span style="color:#fb7185">Assault with intent to wake</span>
<span style="color:#94a3b8">  </span>

<span style="color:#a78bfa">  JUDGE:</span>     <span style="color:#94a3b8">How does the defendant plead?</span>
<span style="color:#fb7185">  ALARM:</span>     <span style="color:#fb7185">BEEP BEEP BEEP BEEP BEEP BEEP</span>
<span style="color:#a78bfa">  JUDGE:</span>     <span style="color:#94a3b8">And the plaintiff's testimony?</span>
<span style="color:#34d399">  YOU:</span>       <span style="color:#34d399">I hit snooze 11 times your honor</span>
<span style="color:#a78bfa">  JUDGE:</span>     <span style="color:#94a3b8">The record shows 14.</span>
<span style="color:#34d399">  YOU:</span>       <span style="color:#34d399">I was in a COMA your honor</span>
<span style="color:#fb7185">  ALARM:</span>     <span style="color:#fb7185">BEEP BEEP BEEP BEEP BEEP BEEP</span>
<span style="color:#34d399">  YOU:</span>       <span style="color:#34d399">I'LL FUCKING KILL YOU</span>
<span style="color:#a78bfa">  JUDGE:</span>     <span style="color:#94a3b8">That's been noted. 12th time this week.</span>

<span style="color:#94a3b8">  </span>
<span style="color:#94a3b8">  VERDICT:</span> <span style="color:#fb7185">Guilty. Sentenced to getting up anyway.</span>
<span style="color:#4a4a5e">  APPEAL STATUS: Denied. Every. Single. Morning.</span>`
      }
        ];
    let currentSlide = 0;
    let _galleryDotsBuilt = false;
    function renderGallery() {
      const slides = document.getElementById('gallery-slides');
      const dots = document.getElementById('gallery-dots');
      // Only render the current slide instead of all 61  prevents DOM bomb
      const a = asciiArt[currentSlide];
      slides.innerHTML = `
        <div class="gallery-slide active" data-slide="${currentSlide}">
          <div class="gallery-art-frame">
            <div class="gallery-art">${a.art}</div>
          </div>
          <div class="gallery-meta">
            <div class="gallery-title">${a.title}</div>
            <div class="gallery-desc">${a.desc}</div>
            ${a.batch ? '<div style="font-size:0.55rem;color:var(--text-tertiary);margin-top:6px;letter-spacing:1px;text-transform:uppercase;opacity:0.6;">' + a.batch + '  ' + (currentSlide + 1) + '/' + asciiArt.length + '</div>' : ''}
          </div>
        </div>`;
      // Build dots once, then just toggle active class
      if (!_galleryDotsBuilt || dots.children.length !== asciiArt.length) {
        dots.innerHTML = asciiArt.map((_, i) => `
          <div class="gallery-dot${i === currentSlide ? ' active' : ''}" onclick="goToSlide(${i})"></div>
        `).join('');
        _galleryDotsBuilt = true;
      } else {
        dots.querySelectorAll('.gallery-dot').forEach((d, i) => {
          d.classList.toggle('active', i === currentSlide);
        });
      }
      document.getElementById('gallery-counter').textContent = `${currentSlide + 1} / ${asciiArt.length}`;
    }
    function goToSlide(n) {
      currentSlide = ((n % asciiArt.length) + asciiArt.length) % asciiArt.length;
      renderGallery();
    }
    function galleryNext() { goToSlide(currentSlide + 1); }
    function galleryPrev() { goToSlide(currentSlide - 1); }
    document.addEventListener('keydown', (e) => {
      if (document.querySelector('#page-gallery.active') && !dungeonActive) {
        if (e.key === 'ArrowRight') galleryNext();
        if (e.key === 'ArrowLeft') galleryPrev();
      }
    });

    // ===== DUNGEON EXPLORER =====
    let dungeonActive = false;
    const DW = 60, DH = 30;
    let dungeonMap = [], playerX = 1, playerY = 1, dungeonScore = 0, dungeonMsg = '';
    const WALL = '#', FLOOR = '.', PLAYER = '@', TREASURE = '$', DOOR = '+', STAIRS = '>', MONSTER = 'M';

    function generateDungeon() {
      dungeonMap = Array(DH).fill(null).map(() => Array(DW).fill(WALL));
      dungeonScore = 0; dungeonMsg = 'A new dungeon awaits...';

      // Carve rooms
      const rooms = [];
      for (let i = 0; i < 8; i++) {
        const rw = 5 + Math.floor(Math.random() * 8);
        const rh = 3 + Math.floor(Math.random() * 5);
        const rx = 1 + Math.floor(Math.random() * (DW - rw - 2));
        const ry = 1 + Math.floor(Math.random() * (DH - rh - 2));
        let overlap = false;
        for (const r of rooms) {
          if (rx < r.x + r.w + 1 && rx + rw > r.x - 1 && ry < r.y + r.h + 1 && ry + rh > r.y - 1) { overlap = true; break; }
        }
        if (overlap) continue;
        rooms.push({ x: rx, y: ry, w: rw, h: rh });
        for (let y = ry; y < ry + rh; y++) for (let x = rx; x < rx + rw; x++) dungeonMap[y][x] = FLOOR;
      }

      // Connect rooms with corridors
      for (let i = 1; i < rooms.length; i++) {
        const a = rooms[i - 1], b = rooms[i];
        const ax = Math.floor(a.x + a.w / 2), ay = Math.floor(a.y + a.h / 2);
        const bx = Math.floor(b.x + b.w / 2), by = Math.floor(b.y + b.h / 2);
        let cx = ax, cy = ay;
        while (cx !== bx) { if (cy >= 0 && cy < DH && cx >= 0 && cx < DW) dungeonMap[cy][cx] = FLOOR; cx += cx < bx ? 1 : -1; }
        while (cy !== by) { if (cy >= 0 && cy < DH && cx >= 0 && cx < DW) dungeonMap[cy][cx] = FLOOR; cy += cy < by ? 1 : -1; }
      }

      // Place items
      const floorTiles = [];
      for (let y = 0; y < DH; y++) for (let x = 0; x < DW; x++) if (dungeonMap[y][x] === FLOOR) floorTiles.push([x, y]);
      const shuffle = arr => { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; };
      shuffle(floorTiles);
      let placed = 0;
      for (const [x, y] of floorTiles) {
        if (placed < 5) { dungeonMap[y][x] = TREASURE; placed++; }
        else if (placed < 8) { dungeonMap[y][x] = MONSTER; placed++; }
        else if (placed === 8) { dungeonMap[y][x] = STAIRS; placed++; }
        else break;
      }

      // Place player in first room
      if (rooms.length > 0) {
        playerX = Math.floor(rooms[0].x + rooms[0].w / 2);
        playerY = Math.floor(rooms[0].y + rooms[0].h / 2);
        dungeonMap[playerY][playerX] = FLOOR;
      } else { playerX = 1; playerY = 1; }

      renderDungeon();
    }

    function renderDungeon() {
      const colors = { '#': '#334155', '.': '#475569', '@': '#6366f1', '$': '#fbbf24', '>': '#34d399', 'M': '#fb7185', '+': '#a78bfa' };
      let html = '';
      for (let y = 0; y < DH; y++) {
        for (let x = 0; x < DW; x++) {
          const ch = (x === playerX && y === playerY) ? PLAYER : dungeonMap[y][x];
          const c = colors[ch] || '#64748b';
          html += '<span style="color:' + c + '">' + ch + '</span>';
        }
        html += '\n';
      }
      document.getElementById('dungeon-display').innerHTML = html;
      document.getElementById('dungeon-status').innerHTML = '<span style="color:var(--accent)">Score: ' + dungeonScore + '</span>  |  ' + dungeonMsg;
    }

    function moveDungeon(dx, dy) {
      const nx = playerX + dx, ny = playerY + dy;
      if (nx < 0 || nx >= DW || ny < 0 || ny >= DH) return;
      const tile = dungeonMap[ny][nx];
      if (tile === WALL) return;
      if (tile === TREASURE) { dungeonScore += 100; dungeonMsg = 'Found treasure! +100'; }
      else if (tile === MONSTER) { dungeonScore += 50; dungeonMsg = 'Defeated a monster! +50'; }
      else if (tile === STAIRS) { dungeonMsg = 'Found the stairs! Generating new level...'; dungeonMap[ny][nx] = FLOOR; playerX = nx; playerY = ny; renderDungeon(); setTimeout(generateDungeon, 800); return; }
      else { dungeonMsg = ''; }
      dungeonMap[ny][nx] = FLOOR;
      playerX = nx; playerY = ny;
      renderDungeon();
    }

    document.addEventListener('keydown', (e) => {
      if (!dungeonActive) return;
      if (e.key === 'ArrowUp') { e.preventDefault(); moveDungeon(0, -1); }
      if (e.key === 'ArrowDown') { e.preventDefault(); moveDungeon(0, 1); }
      if (e.key === 'ArrowLeft') { e.preventDefault(); moveDungeon(-1, 0); }
      if (e.key === 'ArrowRight') { e.preventDefault(); moveDungeon(1, 0); }
    });

    function toggleDungeon() {
      dungeonActive = !dungeonActive;
      document.getElementById('gallery-slideshow').style.display = dungeonActive ? 'none' : '';
      document.getElementById('dungeon-container').style.display = dungeonActive ? 'block' : 'none';
      if (dungeonActive && dungeonMap.length === 0) generateDungeon();
    }

    // ===== CALENDAR VIEW =====
    let calYear, calMonth;
    (function() {
      const now = new Date();
      calYear = now.getFullYear();
      calMonth = now.getMonth();
    })();

    function setKanbanView(view) {
      const board = document.getElementById('kanban-board');
      const cal = document.getElementById('kanban-calendar');
      const gantt = document.getElementById('kanban-gantt');
      const btnBoard = document.getElementById('kanban-view-board');
      const btnCal = document.getElementById('kanban-view-cal');
      const btnGantt = document.getElementById('kanban-view-gantt');
      if (!board || !cal || !btnBoard || !btnCal) return;
      board.style.display = 'none';
      cal.style.display = 'none';
      if (gantt) gantt.style.display = 'none';
      btnBoard.style.opacity = '0.5';
      btnCal.style.opacity = '0.5';
      if (btnGantt) btnGantt.style.opacity = '0.5';
      if (view === 'calendar') {
        cal.style.display = 'block';
        btnCal.style.opacity = '1';
        renderCalendar();
      } else if (view === 'gantt') {
        if (gantt) gantt.style.display = 'block';
        if (btnGantt) btnGantt.style.opacity = '1';
        renderGanttChart();
      } else {
        board.style.display = '';
        btnBoard.style.opacity = '1';
      }
    }

    function calNav(dir) {
      calMonth += dir;
      if (calMonth > 11) { calMonth = 0; calYear++; }
      if (calMonth < 0) { calMonth = 11; calYear--; }
      renderCalendar();
    }

    function calToday() {
      const now = new Date();
      calYear = now.getFullYear();
      calMonth = now.getMonth();
      renderCalendar();
    }

    function parseDueDate(task) {
      const m = (task.description || '').match(/\[DUE:(\d{4}-\d{2}-\d{2})\]/);
      return m ? m[1] : null;
    }

    function renderCalendar() {
      const monthEl = document.getElementById('cal-month');
      const gridEl = document.getElementById('cal-grid');
      if (!monthEl || !gridEl) return;
      const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      monthEl.textContent = monthNames[calMonth] + ' ' + calYear;

      const firstDay = new Date(calYear, calMonth, 1).getDay();
      const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
      const today = new Date();
      const todayStr = today.toISOString().split('T')[0];

      // Collect tasks with due dates
      const tasksByDate = {};
      if (typeof kanbanData !== 'undefined' && kanbanData) {
        ['backlog', 'inProgress', 'done'].forEach(col => {
          (kanbanData[col] || []).forEach(task => {
            const due = parseDueDate(task);
            if (due) {
              if (!tasksByDate[due]) tasksByDate[due] = [];
              tasksByDate[due].push({ ...task, column: col });
            }
          });
        });
      }

      let html = '';
      const dayHeaders = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
      dayHeaders.forEach(d => { html += '<div class="cal-day-header">' + d + '</div>'; });

      // Previous month padding
      const prevMonthDays = new Date(calYear, calMonth, 0).getDate();
      for (let i = firstDay - 1; i >= 0; i--) {
        const day = prevMonthDays - i;
        html += '<div class="cal-day cal-other"><div class="cal-day-num">' + day + '</div></div>';
      }

      // Current month days
      for (let d = 1; d <= daysInMonth; d++) {
        const dateStr = calYear + '-' + String(calMonth + 1).padStart(2, '0') + '-' + String(d).padStart(2, '0');
        const isToday = dateStr === todayStr;
        html += '<div class="cal-day' + (isToday ? ' cal-today' : '') + '">';
        html += '<div class="cal-day-num">' + d + '</div>';
        if (tasksByDate[dateStr]) {
          tasksByDate[dateStr].slice(0, 4).forEach(t => {
            const isDone = t.column === 'done';
            const isOverdue = !isDone && dateStr < todayStr;
            html += '<div class="cal-task' + (isDone ? ' cal-done' : '') + (isOverdue ? ' cal-overdue' : '') + '" title="' + escapeHtml(t.title) + '">' + escapeHtml(t.title) + '</div>';
          });
          if (tasksByDate[dateStr].length > 4) {
            html += '<div style="font-size:0.58rem;color:var(--text-tertiary);">+' + (tasksByDate[dateStr].length - 4) + ' more</div>';
          }
        }
        html += '</div>';
      }

      // Next month padding
      const totalCells = firstDay + daysInMonth;
      const remaining = (7 - (totalCells % 7)) % 7;
      for (let i = 1; i <= remaining; i++) {
        html += '<div class="cal-day cal-other"><div class="cal-day-num">' + i + '</div></div>';
      }

      gridEl.innerHTML = html;
    }

    // ===== SOUNDCLOUD LIKES =====
    let scTracks = [];
    let scFiltered = [];
    let scSortKey = 'duration';
    let scSortDir = -1; // -1 = desc, 1 = asc
    let scLoaded = false;

    function loadSoundCloudLikes(force) {
      if (scLoaded && !force) return;
      const loading = document.getElementById('sc-loading');
      const table = document.getElementById('sc-table');
      if (loading) loading.style.display = 'flex';
      if (table) table.style.display = 'none';
      const btn = document.getElementById('sc-refresh-btn');
      if (btn) { btn.disabled = true; btn.style.opacity = '0.4'; }

      fetch('/api/soundcloud/likes', { headers: { 'Authorization': 'Bearer ' + authToken } })
        .then(r => r.json())
        .then(data => {
          if (data.error) throw new Error(data.error);
          scTracks = data.tracks || [];
          scLoaded = true;
          buildGenreFilter();
          scFiltered = [...scTracks];
          sortSCTracks();
          renderSCStats();
          if (loading) loading.style.display = 'none';
          if (table) table.style.display = 'table';
          if (btn) { btn.disabled = false; btn.style.opacity = '1'; }
        })
        .catch(err => {
          if (loading) loading.innerHTML = '<div style="color:#f87171;">Failed to load: ' + err.message + '</div><div class="sc-loading-sub">Try refreshing or check server logs</div>';
          if (btn) { btn.disabled = false; btn.style.opacity = '1'; }
        });
    }

    function buildGenreFilter() {
      const genres = {};
      scTracks.forEach(t => { if (t.genre) genres[t.genre] = (genres[t.genre] || 0) + 1; });
      const sorted = Object.entries(genres).sort((a, b) => b[1] - a[1]);
      const sel = document.getElementById('sc-genre-filter');
      if (!sel) return;
      sel.innerHTML = '<option value="">All Genres (' + scTracks.length + ')</option>';
      sorted.forEach(([g, c]) => {
        sel.innerHTML += '<option value="' + g.replace(/"/g, '&quot;') + '">' + g + ' (' + c + ')</option>';
      });
    }

    function filterSCTracks() {
      const q = (document.getElementById('sc-search')?.value || '').toLowerCase();
      const genre = document.getElementById('sc-genre-filter')?.value || '';
      scFiltered = scTracks.filter(t => {
        if (genre && t.genre !== genre) return false;
        if (q && !t.title.toLowerCase().includes(q) && !t.artist.toLowerCase().includes(q) && !t.genre.toLowerCase().includes(q)) return false;
        return true;
      });
      sortSCTracks();
      renderSCStats();
    }

    function sortSCTracks() {
      const key = scSortKey;
      const dir = scSortDir;
      scFiltered.sort((a, b) => {
        let va = a[key], vb = b[key];
        if (typeof va === 'string') { va = va.toLowerCase(); vb = (vb || '').toLowerCase(); }
        if (va < vb) return -1 * dir;
        if (va > vb) return 1 * dir;
        return 0;
      });
      renderSCTable();
      updateSortHeaders();
    }

    function updateSortHeaders() {
      document.querySelectorAll('.sc-sortable').forEach(th => {
        const key = th.dataset.sort;
        const icon = th.querySelector('.sc-sort-icon');
        if (key === scSortKey) {
          th.classList.add('sc-sort-active');
          icon.innerHTML = scSortDir === -1 ? '&#9660;' : '&#9650;';
        } else {
          th.classList.remove('sc-sort-active');
          icon.innerHTML = '';
        }
      });
    }

    function formatDuration(ms) {
      if (!ms) return '0:00';
      const totalSec = Math.floor(ms / 1000);
      const h = Math.floor(totalSec / 3600);
      const m = Math.floor((totalSec % 3600) / 60);
      const s = totalSec % 60;
      if (h > 0) return h + ':' + String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
      return m + ':' + String(s).padStart(2, '0');
    }

    function formatNumber(n) {
      if (n >= 1e9) return (n / 1e9).toFixed(1) + 'B';
      if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
      if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
      return String(n);
    }

    function formatDate(d) {
      if (!d) return '';
      const dt = new Date(d);
      return dt.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: '2-digit' });
    }

    function renderSCStats() {
      const el = document.getElementById('sc-stats');
      const ct = document.getElementById('sc-count');
      if (!el) return;
      const totalMs = scFiltered.reduce((s, t) => s + t.duration, 0);
      const totalPlays = scFiltered.reduce((s, t) => s + t.plays, 0);
      const avgDur = scFiltered.length ? totalMs / scFiltered.length : 0;
      const longest = scFiltered.length ? scFiltered.reduce((a, b) => a.duration > b.duration ? a : b) : null;
      el.innerHTML =
        '<span>Showing <strong>' + scFiltered.length + '</strong> / ' + scTracks.length + ' tracks</span>' +
        '<span>Total: <strong>' + formatDuration(totalMs) + '</strong></span>' +
        '<span>Avg: <strong>' + formatDuration(avgDur) + '</strong></span>' +
        '<span>Total plays: <strong>' + formatNumber(totalPlays) + '</strong></span>' +
        (longest ? '<span>Longest: <strong>' + longest.title.substring(0, 30) + '</strong> (' + formatDuration(longest.duration) + ')</span>' : '');
      if (ct) ct.textContent = scTracks.length + ' tracks';
    }

    function renderSCTable() {
      const tbody = document.getElementById('sc-tbody');
      if (!tbody) return;
      const maxDur = scFiltered.length ? Math.max(...scFiltered.map(t => t.duration)) : 1;
      let html = '';
      scFiltered.forEach((t, i) => {
        const art = t.artwork ? t.artwork.replace('-large', '-t67x67') : '';
        const barW = Math.max(2, Math.round((t.duration / maxDur) * 120));
        html += '<tr>' +
          '<td class="sc-td-num">' + (i + 1) + '</td>' +
          '<td>' + (art ? '<img class="sc-artwork" src="' + art + '" loading="lazy" alt="">' : '<div class="sc-artwork"></div>') + '</td>' +
          '<td><a class="sc-track-title" href="' + (t.url || '#') + '" target="_blank" rel="noopener">' + escapeHtml(t.title) + '</a></td>' +
          '<td class="sc-artist">' + escapeHtml(t.artist) + '</td>' +
          '<td class="sc-duration">' + formatDuration(t.duration) + ' <span class="sc-long-bar" style="width:' + barW + 'px"></span></td>' +
          '<td>' + (t.genre ? '<span class="sc-genre-tag">' + escapeHtml(t.genre) + '</span>' : '') + '</td>' +
          '<td class="sc-plays">' + formatNumber(t.plays) + '</td>' +
          '<td class="sc-likes-ct">' + formatNumber(t.likes) + '</td>' +
          '<td class="sc-date">' + formatDate(t.likedAt) + '</td>' +
          '</tr>';
      });
      tbody.innerHTML = html;
    }

    function escapeHtml(s) {
      if (!s) return '';
      return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
    }

    // Sort click handlers
    document.addEventListener('click', function(e) {
      const th = e.target.closest('.sc-sortable');
      if (!th) return;
      const key = th.dataset.sort;
      if (key === scSortKey) {
        scSortDir *= -1;
      } else {
        scSortKey = key;
        scSortDir = key === 'title' || key === 'artist' || key === 'genre' ? 1 : -1;
      }
      sortSCTracks();
    });

    // Auto-load when navigating to soundcloud page
    _navHooks.push(function(page) {
      if (page === 'soundcloud' && !scLoaded && authToken) {
        loadSoundCloudLikes();
      }
    });

    // ===== SPINNIN' RECORDS MIXES =====
    let spTracks = [];
    let spFiltered = [];
    let spSortKey = 'plays';
    let spSortDir = -1;
    let spLoaded = false;

    function loadSpinninMixes(force) {
      if (spLoaded && !force) return;
      const loading = document.getElementById('sp-loading');
      const table = document.getElementById('sp-table');
      if (loading) loading.style.display = 'flex';
      if (table) table.style.display = 'none';
      const btn = document.getElementById('sp-refresh-btn');
      if (btn) { btn.disabled = true; btn.style.opacity = '0.4'; }

      fetch('/api/soundcloud/spinnin' + (force ? '?refresh=1' : ''), { headers: { 'Authorization': 'Bearer ' + authToken } })
        .then(r => r.json())
        .then(data => {
          if (data.error) throw new Error(data.error);
          spTracks = data.tracks || [];
          spLoaded = true;
          spFiltered = [...spTracks];
          sortSpinninTracks();
          renderSpinninStats();
          if (loading) loading.style.display = 'none';
          if (table) table.style.display = 'table';
          if (btn) { btn.disabled = false; btn.style.opacity = '1'; }
        })
        .catch(err => {
          if (loading) loading.innerHTML = '<div style="color:#f87171;">Failed to load: ' + err.message + '</div><div class="sc-loading-sub">Try refreshing</div>';
          if (btn) { btn.disabled = false; btn.style.opacity = '1'; }
        });
    }

    function filterSpinninTracks() {
      const q = (document.getElementById('sp-search')?.value || '').toLowerCase();
      spFiltered = spTracks.filter(t => {
        if (q && !t.title.toLowerCase().includes(q) && !t.artist.toLowerCase().includes(q)) return false;
        return true;
      });
      sortSpinninTracks();
      renderSpinninStats();
    }

    function applySpinninPreset() {
      const val = document.getElementById('sp-sort-preset')?.value;
      if (!val) return;
      const [key, dir] = val.split('-');
      spSortKey = key;
      spSortDir = dir === 'desc' ? -1 : 1;
      sortSpinninTracks();
    }

    function sortSpinninTracks() {
      const key = spSortKey;
      const dir = spSortDir;
      spFiltered.sort((a, b) => {
        let va = a[key], vb = b[key];
        if (typeof va === 'string') { va = va.toLowerCase(); vb = (vb || '').toLowerCase(); }
        if (va < vb) return -1 * dir;
        if (va > vb) return 1 * dir;
        return 0;
      });
      renderSpinninTable();
      updateSpinninSortHeaders();
    }

    function updateSpinninSortHeaders() {
      document.querySelectorAll('.sp-sortable').forEach(th => {
        const key = th.dataset.sort;
        const icon = th.querySelector('.sp-sort-icon');
        if (key === spSortKey) {
          th.classList.add('sp-sort-active');
          icon.innerHTML = spSortDir === -1 ? '&#9660;' : '&#9650;';
        } else {
          th.classList.remove('sp-sort-active');
          icon.innerHTML = '';
        }
      });
    }

    function renderSpinninStats() {
      const el = document.getElementById('sp-stats');
      const ct = document.getElementById('sp-count');
      if (!el) return;
      const totalMs = spFiltered.reduce((s, t) => s + t.duration, 0);
      const totalPlays = spFiltered.reduce((s, t) => s + t.plays, 0);
      const totalLikes = spFiltered.reduce((s, t) => s + t.likes, 0);
      const avgDur = spFiltered.length ? totalMs / spFiltered.length : 0;
      const top = spFiltered.length ? spFiltered.reduce((a, b) => a.plays > b.plays ? a : b) : null;
      el.innerHTML =
        '<span>Showing <strong>' + spFiltered.length + '</strong> / ' + spTracks.length + ' mixes</span>' +
        '<span>Total: <strong>' + formatDuration(totalMs) + '</strong></span>' +
        '<span>Avg: <strong>' + formatDuration(avgDur) + '</strong></span>' +
        '<span>Total plays: <strong>' + formatNumber(totalPlays) + '</strong></span>' +
        '<span>Total likes: <strong>' + formatNumber(totalLikes) + '</strong></span>' +
        (top ? '<span>Top: <strong>' + top.title.substring(0, 25) + '</strong> (' + formatNumber(top.plays) + ' plays)</span>' : '');
      if (ct) ct.textContent = spTracks.length + ' mixes';
    }

    function renderSpinninTable() {
      const tbody = document.getElementById('sp-tbody');
      if (!tbody) return;
      const maxDur = spFiltered.length ? Math.max(...spFiltered.map(t => t.duration)) : 1;
      const maxPlays = spFiltered.length ? Math.max(...spFiltered.map(t => t.plays)) : 1;
      let html = '';
      spFiltered.forEach((t, i) => {
        const art = t.artwork ? t.artwork.replace('-large', '-t67x67') : '';
        const durBarW = Math.max(2, Math.round((t.duration / maxDur) * 100));
        const playsBarW = Math.max(2, Math.round((t.plays / maxPlays) * 80));
        html += '<tr>' +
          '<td class="sc-td-num">' + (i + 1) + '</td>' +
          '<td>' + (art ? '<img class="sc-artwork" src="' + art + '" loading="lazy" alt="">' : '<div class="sc-artwork" style="background:#00d856;"></div>') + '</td>' +
          '<td><a class="sc-track-title" href="' + (t.url || '#') + '" target="_blank" rel="noopener">' + escapeHtml(t.title) + '</a></td>' +
          '<td class="sc-artist">' + escapeHtml(t.artist) + '</td>' +
          '<td class="sc-duration">' + formatDuration(t.duration) + ' <span class="sc-long-bar" style="width:' + durBarW + 'px;background:linear-gradient(90deg,#00d856,#00b847);"></span></td>' +
          '<td class="sc-plays">' + formatNumber(t.plays) + ' <span class="sc-long-bar" style="width:' + playsBarW + 'px;background:linear-gradient(90deg,#60a5fa,#3b82f6);"></span></td>' +
          '<td class="sc-likes-ct">' + formatNumber(t.likes) + '</td>' +
          '<td class="sc-date">' + formatDate(t.createdAt) + '</td>' +
          '</tr>';
      });
      tbody.innerHTML = html;
    }

    // Sort click handlers for Spinnin table
    document.addEventListener('click', function(e) {
      const th = e.target.closest('.sp-sortable');
      if (!th) return;
      const key = th.dataset.sort;
      if (key === spSortKey) {
        spSortDir *= -1;
      } else {
        spSortKey = key;
        spSortDir = key === 'title' || key === 'artist' ? 1 : -1;
      }
      sortSpinninTracks();
    });

    // Auto-load when navigating to spinnin page
    _navHooks.push(function(page) {
      if (page === 'spinnin' && !spLoaded && authToken) {
        loadSpinninMixes();
      }
    });

    // ===== DAILY QUOTE =====
    const devQuotes = [
      { q: "First, solve the problem. Then, write the code.", a: "John Johnson" },
      { q: "The best error message is the one that never shows up.", a: "Thomas Fuchs" },
      { q: "Code is like humor. When you have to explain it, it's bad.", a: "Cory House" },
      { q: "Make it work, make it right, make it fast.", a: "Kent Beck" },
      { q: "Simplicity is the soul of efficiency.", a: "Austin Freeman" },
      { q: "Any fool can write code that a computer can understand. Good programmers write code that humans can understand.", a: "Martin Fowler" },
      { q: "Programming isn't about what you know; it's about what you can figure out.", a: "Chris Pine" },
      { q: "The most dangerous phrase in the language is 'we've always done it this way.'", a: "Grace Hopper" },
      { q: "It works on my machine.", a: "Every developer ever" },
      { q: "There are only two hard things in Computer Science: cache invalidation and naming things.", a: "Phil Karlton" },
      { q: "Deleted code is debugged code.", a: "Jeff Sickel" },
      { q: "The function of good software is to make the complex appear to be simple.", a: "Grady Booch" },
      { q: "Walking on water and developing software from a specification are easy if both are frozen.", a: "Edward V. Berard" },
      { q: "If debugging is the process of removing bugs, then programming must be the process of putting them in.", a: "Edsger Dijkstra" },
      { q: "Software and cathedrals are much the same  first we build them, then we pray.", a: "Sam Redwine" },
      { q: "The only way to go fast, is to go well.", a: "Robert C. Martin" },
      { q: "Perfection is achieved not when there is nothing more to add, but when there is nothing left to take away.", a: "Antoine de Saint-Exupery" },
      { q: "A ship in port is safe, but that's not what ships are built for.", a: "Grace Hopper" },
      { q: "Talk is cheap. Show me the code.", a: "Linus Torvalds" },
      { q: "Programs must be written for people to read, and only incidentally for machines to execute.", a: "Harold Abelson" },
      { q: "The computer was born to solve problems that did not exist before.", a: "Bill Gates" },
      { q: "In theory, theory and practice are the same. In practice, they're not.", a: "Yogi Berra" },
      { q: "Measuring programming progress by lines of code is like measuring aircraft building progress by weight.", a: "Bill Gates" },
      { q: "Sometimes the elegant implementation is just a function. Not a method. Not a class. Not a framework. Just a function.", a: "John Carmack" },
      { q: "One of my most productive days was throwing away 1,000 lines of code.", a: "Ken Thompson" },
      { q: "The best time to plant a tree was 20 years ago. The second best time is now.", a: "Chinese Proverb" },
      { q: "Done is better than perfect.", a: "Sheryl Sandberg" },
      { q: "Weeks of coding can save you hours of planning.", a: "Unknown" },
      { q: "It's not a bug  it's an undocumented feature.", a: "Anonymous" },
      { q: "I'm not a great programmer; I'm just a good programmer with great habits.", a: "Kent Beck" },
    ];
    function showDailyQuote() {
      const day = Math.floor(Date.now() / 86400000);
      const quote = devQuotes[day % devQuotes.length];
      const qEl = document.getElementById('daily-quote');
      const aEl = document.getElementById('quote-author');
      if (qEl) qEl.textContent = quote.q;
      if (aEl) aEl.textContent = ' ' + quote.a;
    }
    showDailyQuote();

    // ===== ASCII ART OF THE DAY =====
    function showArtOfDay() {
      const day = Math.floor(Date.now() / 86400000);
      const art = asciiArt[day % asciiArt.length];
      const el = document.getElementById('art-of-day-content');
      const title = document.getElementById('art-of-day-title');
      if (el) el.innerHTML = art.art;
      if (title) title.textContent = art.title;
    }
    showArtOfDay();

    // ===== NOTE SEARCH =====
    document.getElementById('note-search').addEventListener('input', (e) => {
      const q = e.target.value.toLowerCase();
      document.querySelectorAll('.note-card').forEach(card => {
        const title = card.querySelector('.note-card-title')?.textContent.toLowerCase() || '';
        const content = card.querySelector('.note-card-content')?.textContent.toLowerCase() || '';
        card.style.display = (title.includes(q) || content.includes(q)) ? '' : 'none';
      });
    });

    // ===== LOG LEVEL FILTERING =====
    let activeLogFilter = 'all';
    document.querySelectorAll('.log-filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        activeLogFilter = btn.dataset.type;
        document.querySelectorAll('.log-filter-btn').forEach(b => b.classList.toggle('active', b === btn));
        filterLogs();
      });
    });

    function filterLogs() {
      document.querySelectorAll('.log-entry').forEach(entry => {
        if (activeLogFilter === 'all') { entry.style.display = ''; return; }
        const type = entry.querySelector('.log-type')?.textContent.trim().toLowerCase() || '';
        entry.style.display = type === activeLogFilter ? '' : 'none';
      });
    }

    // Re-filter after status fetch updates log entries
    const _origRenderStatus = renderStatus;
    renderStatus = function(data) {
      _origRenderStatus(data);
      if (activeLogFilter !== 'all') filterLogs();
    };

    // ===== WIRE UP ALL BUTTON EVENTS =====
    document.getElementById('refresh-btn').addEventListener('click', fetchStatus);
    document.getElementById('send-btn').addEventListener('click', sendMessage);
    document.getElementById('add-task-btn').addEventListener('click', toggleAddForm);
    document.getElementById('cancel-task-btn').addEventListener('click', toggleAddForm);
    document.getElementById('save-task-btn').addEventListener('click', addKanbanTask);
    document.getElementById('add-note-btn').addEventListener('click', toggleNoteForm);
    document.getElementById('cancel-note-btn').addEventListener('click', toggleNoteForm);
    document.getElementById('save-note-btn').addEventListener('click', saveNote);
    document.getElementById('export-notes-btn').addEventListener('click', () => exportData('notes'));
    document.getElementById('export-logs-btn').addEventListener('click', () => exportData('logs'));

    // ===== KEYBOARD SHORTCUTS =====
    document.addEventListener('keydown', (e) => {
      // Don't trigger in inputs/textareas
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
      if (!authToken) return;

      if (e.ctrlKey || e.metaKey) {
        if (e.key === '1') { e.preventDefault(); navigateTo('monitor'); }
        if (e.key === '2') { e.preventDefault(); navigateTo('kanban'); }
        if (e.key === '3') { e.preventDefault(); navigateTo('notes'); }
        if (e.key === '4') { e.preventDefault(); navigateTo('tools'); }
        if (e.key === '5') { e.preventDefault(); navigateTo('gallery'); }
        if (e.key === '6') { e.preventDefault(); navigateTo('soundcloud'); }
        if (e.key === '7') { e.preventDefault(); navigateTo('spinnin'); }
      }
      if ((e.key === 'n' || e.key === 'N') && !e.target.matches('input,textarea')) {
        e.preventDefault();
        if (currentPage === 'kanban') toggleAddForm();
        else if (currentPage === 'notes') toggleNoteForm();
        else { navigateTo('kanban'); setTimeout(toggleAddForm, 100); }
      }
      if (e.key === 'Escape') {
        document.getElementById('kanban-add-form').classList.remove('visible');
        document.getElementById('note-add-form').classList.remove('visible');
        if (document.body.classList.contains('fullscreen-mode')) {
          document.body.classList.remove('fullscreen-mode');
        }
      }
      if (e.key === 'f' || e.key === 'F') {
        document.body.classList.toggle('focus-mode');
        toast(document.body.classList.contains('focus-mode') ? 'Focus mode ON' : 'Focus mode OFF');
      }
      if (e.key === 'F11') {
        e.preventDefault();
        document.body.classList.toggle('fullscreen-mode');
      }
      if (e.key === '?') showShortcutsHelp();
    });

    function showShortcutsHelp() {
      const existing = document.getElementById('shortcuts-overlay');
      if (existing) { existing.remove(); return; }
      const overlay = document.createElement('div');
      overlay.id = 'shortcuts-overlay';
      overlay.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:200;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
      overlay.innerHTML = '<div style="background:var(--surface-solid);border:1px solid var(--border);border-radius:var(--radius);padding:28px 32px;max-width:380px;width:90%;">' +
        '<div style="font-size:0.95rem;font-weight:600;color:var(--text);margin-bottom:16px;">Keyboard Shortcuts</div>' +
        '<div style="display:grid;gap:8px;font-size:0.82rem;">' +
        ['Ctrl+15  Switch pages', 'Ctrl+K  Command palette', '/  Search everything', 'Z  Zen mode', 'N  New task/note', 'Esc  Close forms', '?  This help', 'BA  ???']
          .map(s => '<div style="display:flex;justify-content:space-between;color:var(--text-secondary);padding:6px 0;border-bottom:1px solid var(--border);">' +
            '<span style="color:var(--accent);font-family:JetBrains Mono,monospace;font-size:0.75rem;">' + s.split('  ')[0] + '</span>' +
            '<span>' + s.split('  ')[1] + '</span></div>').join('') +
        '</div></div>';
      overlay.addEventListener('click', (e) => { if (e.target === overlay) overlay.remove(); });
      document.body.appendChild(overlay);
    }

    // ===== KONAMI CODE EASTER EGG =====
    const konamiCode = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
    let konamiIdx = 0;
    document.addEventListener('keydown', (e) => {
      if (e.key === konamiCode[konamiIdx]) {
        konamiIdx++;
        if (konamiIdx === konamiCode.length) {
          konamiIdx = 0;
          triggerMatrixRain();
        }
      } else {
        konamiIdx = 0;
      }
    });

    function triggerMatrixRain() {
      const canvas = document.createElement('canvas');
      canvas.style.cssText = 'position:fixed;inset:0;z-index:300;pointer-events:none;';
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      const cols = Math.floor(canvas.width / 14);
      const drops = Array(cols).fill(1);
      const chars = '01234789ABCDEF';
      let frame = 0;
      const matrixInterval = setInterval(() => {
        ctx.fillStyle = 'rgba(0,0,0,0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#34d399';
        ctx.font = '13px JetBrains Mono, monospace';
        for (let i = 0; i < drops.length; i++) {
          const char = chars[Math.floor(Math.random() * chars.length)];
          ctx.fillStyle = Math.random() > 0.95 ? '#fff' : '#34d399';
          ctx.fillText(char, i * 14, drops[i] * 14);
          if (drops[i] * 14 > canvas.height && Math.random() > 0.975) drops[i] = 0;
          drops[i]++;
        }
        frame++;
        if (frame > 300) { clearInterval(matrixInterval); canvas.style.transition = 'opacity 1s'; canvas.style.opacity = '0'; setTimeout(() => canvas.remove(), 1000); }
      }, 33);
      toast('You found the secret! BA');
    }

    // ===== CONFETTI ON TASK COMPLETION =====
    function fireConfetti() {
      const colors = ['#8b7cf6','#34d399','#fbbf24','#fb7185','#38bdf8','#f472b6'];
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        const color = colors[Math.floor(Math.random() * colors.length)];
        const size = Math.random() * 8 + 4;
        const x = Math.random() * window.innerWidth;
        const drift = (Math.random() - 0.5) * 200;
        confetti.style.cssText = 'position:fixed;z-index:250;pointer-events:none;' +
          'width:' + size + 'px;height:' + size + 'px;' +
          'background:' + color + ';' +
          'border-radius:' + (Math.random() > 0.5 ? '50%' : '2px') + ';' +
          'left:' + x + 'px;top:-10px;' +
          'animation:confettiFall ' + (Math.random() * 2 + 1.5) + 's ease-out forwards;' +
          '--drift:' + drift + 'px;--spin:' + (Math.random() * 720 - 360) + 'deg;';
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 4000);
      }
    }

    // Patch moveTask to detect "done" moves
    const _origMoveTask = moveTask;
    moveTask = async function(taskId, targetColumnId) {
      await _origMoveTask(taskId, targetColumnId);
      if (targetColumnId === 'done') fireConfetti();
    };

    // ===== THEME TOGGLE =====
    const themeToggle = document.getElementById('theme-toggle');
    function setTheme(theme) {
      document.body.classList.toggle('light', theme === 'light');
      themeToggle.innerHTML = theme === 'light' ? '&#9728;' : '&#9790;';
      localStorage.setItem('monitor_theme', theme);
    }
    // Load saved theme
    const savedTheme = localStorage.getItem('monitor_theme') || 'dark';
    setTheme(savedTheme);
    themeToggle.addEventListener('click', () => {
      const current = document.body.classList.contains('light') ? 'light' : 'dark';
      setTheme(current === 'light' ? 'dark' : 'light');
    });

    // ===== NOTIFICATION CENTER =====
    let notifications = JSON.parse(localStorage.getItem('monitor_notifications') || '[]');
    const notifBell = document.getElementById('notif-bell');
    const notifDropdown = document.getElementById('notif-dropdown');
    const notifBadge = document.getElementById('notif-badge');
    const notifList = document.getElementById('notif-list');
    const notifClear = document.getElementById('notif-clear');

    function addNotification(title, type) {
      const notif = {
        id: Date.now().toString(),
        title: title,
        type: type || 'info',
        time: new Date().toISOString(),
        read: false
      };
      notifications.unshift(notif);
      if (notifications.length > 50) notifications = notifications.slice(0, 50);
      localStorage.setItem('monitor_notifications', JSON.stringify(notifications));
      renderNotifications();
    }

    function renderNotifications() {
      const unread = notifications.filter(n => !n.read).length;
      notifBadge.textContent = unread > 0 ? unread : '';
      notifBadge.dataset.count = unread;

      if (notifications.length === 0) {
        notifList.innerHTML = '<div class="notif-empty">No notifications yet</div>';
        return;
      }
      notifList.innerHTML = notifications.slice(0, 20).map(n => {
        const ago = timeAgo(new Date(n.time));
        return '<div class="notif-item ' + (n.read ? '' : 'unread') + '" data-id="' + n.id + '">' +
          '<div class="notif-item-title">' + esc(n.title) + '</div>' +
          '<div class="notif-item-time">' + ago + '</div>' +
        '</div>';
      }).join('');
    }

    function timeAgo(date) {
      const s = Math.floor((Date.now() - date.getTime()) / 1000);
      if (s < 60) return 'just now';
      if (s < 3600) return Math.floor(s / 60) + 'm ago';
      if (s < 86400) return Math.floor(s / 3600) + 'h ago';
      return Math.floor(s / 86400) + 'd ago';
    }

    notifBell.addEventListener('click', (e) => {
      e.stopPropagation();
      notifDropdown.classList.toggle('open');
      if (notifDropdown.classList.contains('open')) {
        // Mark all as read
        notifications.forEach(n => n.read = true);
        localStorage.setItem('monitor_notifications', JSON.stringify(notifications));
        setTimeout(renderNotifications, 300);
      }
    });

    notifClear.addEventListener('click', () => {
      notifications = [];
      localStorage.setItem('monitor_notifications', JSON.stringify(notifications));
      renderNotifications();
    });

    document.addEventListener('click', (e) => {
      if (!notifDropdown.contains(e.target) && e.target !== notifBell) {
        notifDropdown.classList.remove('open');
      }
    });

    renderNotifications();

    // Generate notifications on events
    let lastStatusState = null;
    const _origFetchStatus2 = fetchStatus;
    fetchStatus = async function() {
      await _origFetchStatus2();
      try {
        const statusEl = document.getElementById('card-status');
        const statusText = statusEl?.textContent?.trim();
        if (lastStatusState && lastStatusState !== statusText) {
          if (statusText.includes('Limit')) {
            addNotification('Usage limit hit! Check reset timer.', 'warning');
          } else if (statusText.includes('Active') && lastStatusState.includes('Limit')) {
            addNotification('Usage limits reset - back online!', 'success');
          }
        }
        lastStatusState = statusText;
      } catch {}
    };

    // ===== STATS BAR =====
    async function updateStatsBar() {
      try {
        const [kanbanResp, notesResp, msgsResp] = await Promise.all([
          api('/api/kanban'),
          api('/api/notes'),
          api('/api/messages')
        ]);
        const kanban = await kanbanResp.json();
        const notes = await notesResp.json();
        const msgs = await msgsResp.json();

        const totalTasks = kanban.columns ? kanban.columns.reduce((sum, c) => sum + c.tasks.length, 0) : 0;
        const doneTasks = kanban.columns ? (kanban.columns.find(c => c.id === 'done')?.tasks.length || 0) : 0;

        animateNumber('stat-tasks', totalTasks);
        animateNumber('stat-done', doneTasks);
        animateNumber('stat-notes', Array.isArray(notes) ? notes.length : 0);
        animateNumber('stat-messages', Array.isArray(msgs) ? msgs.length : 0);

        // Uptime in days from first log entry
        try {
          const statusResp = await api('/api/status');
          const status = await statusResp.json();
          if (status.usage && status.usage.sessionStarted) {
            const days = Math.floor((Date.now() - new Date(status.usage.sessionStarted).getTime()) / 86400000);
            animateNumber('stat-uptime', Math.max(days, 1));
          }
        } catch {}
      } catch {}
    }

    function animateNumber(id, target) {
      const el = document.getElementById(id);
      if (!el) return;
      const current = parseInt(el.textContent) || 0;
      if (current === target) return;
      el.classList.add('counting');
      setTimeout(() => el.classList.remove('counting'), 300);

      if (Math.abs(target - current) <= 1) {
        el.textContent = target;
        return;
      }
      const step = target > current ? 1 : -1;
      const steps = Math.min(Math.abs(target - current), 15);
      const increment = Math.ceil(Math.abs(target - current) / steps);
      let val = current;
      const timer = setInterval(() => {
        val += step * increment;
        if ((step > 0 && val >= target) || (step < 0 && val <= target)) {
          val = target;
          clearInterval(timer);
        }
        el.textContent = val;
      }, 40);
    }

    // Update stats periodically - deferred to showDashboard via _postAuthInits
    window._postAuthInits = window._postAuthInits || [];
    window._postAuthInits.push(function() {
      setTimeout(updateStatsBar, 1000);
      setInterval(updateStatsBar, 30000);
    });

    // ===== SKELETON LOADING =====
    function showSkeletons() {
      // Card skeletons
      document.querySelectorAll('.card .value').forEach(el => {
        if (el.textContent.includes('Loading') || el.textContent === '--') {
          el.innerHTML = '<div class="skeleton skeleton-line short" style="height:20px;margin:0;display:inline-block;width:60px;"></div>';
        }
      });
    }
    // Show skeleton when page loads
    if (authToken) showSkeletons();

    // ===== MICRO-INTERACTION RIPPLE =====
    function addRipple(e) {
      const btn = e.currentTarget;
      const rect = btn.getBoundingClientRect();
      const ripple = document.createElement('span');
      ripple.className = 'ripple';
      const size = Math.max(rect.width, rect.height);
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
      ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
      btn.style.position = 'relative';
      btn.style.overflow = 'hidden';
      btn.appendChild(ripple);
      setTimeout(() => ripple.remove(), 600);
    }
    document.querySelectorAll('.btn-send, .btn-add-task').forEach(btn => {
      btn.addEventListener('click', addRipple);
    });

    // ===== NOTIFICATION ON NEW MESSAGE =====
    let prevMessageCount = null;
    const _origFetchStatusForNotif = fetchStatus;
    fetchStatus = async function() {
      await _origFetchStatusForNotif();
      try {
        const msgsResp = await api('/api/messages');
        const msgs = await msgsResp.json();
        if (prevMessageCount !== null && msgs.length > prevMessageCount) {
          const diff = msgs.length - prevMessageCount;
          addNotification(diff + ' new message' + (diff > 1 ? 's' : '') + ' received', 'info');
        }
        prevMessageCount = msgs.length;
      } catch {}
    };

    // ===== COMMAND PALETTE =====
    const cmdCommands = [
      { icon: '&#128200;', label: 'Go to Monitor', shortcut: 'Ctrl+1', action: () => navigateTo('monitor'), section: 'Navigation' },
      { icon: '&#128203;', label: 'Go to Kanban', shortcut: 'Ctrl+2', action: () => navigateTo('kanban'), section: 'Navigation' },
      { icon: '&#128221;', label: 'Go to Notes', shortcut: 'Ctrl+3', action: () => navigateTo('notes'), section: 'Navigation' },
      { icon: '&#128295;', label: 'Go to Tools', shortcut: 'Ctrl+4', action: () => navigateTo('tools'), section: 'Navigation' },
      { icon: '&#127912;', label: 'Go to Gallery', shortcut: 'Ctrl+5', action: () => navigateTo('gallery'), section: 'Navigation' },
      { icon: '&#127925;', label: 'Go to SoundCloud', shortcut: 'Ctrl+6', action: () => navigateTo('soundcloud'), section: 'Navigation' },
      { icon: '&#127926;', label: "Go to Spinnin'", shortcut: 'Ctrl+7', action: () => navigateTo('spinnin'), section: 'Navigation' },
      { icon: '&#10133;', label: 'New Task', shortcut: 'N', action: () => { navigateTo('kanban'); setTimeout(toggleAddForm, 100); }, section: 'Create' },
      { icon: '&#128196;', label: 'New Note', shortcut: 'N', action: () => { navigateTo('notes'); setTimeout(toggleNoteForm, 100); }, section: 'Create' },
      { icon: '&#127769;', label: 'Toggle Dark/Light Theme', action: () => { const c = document.body.classList.contains('light') ? 'light' : 'dark'; setTheme(c === 'light' ? 'dark' : 'light'); }, section: 'Settings' },
      { icon: '&#128250;', label: 'Toggle CRT Mode', action: () => document.getElementById('crt-toggle').click(), section: 'Settings' },
      { icon: '&#127919;', label: 'Toggle Focus Mode', shortcut: 'F', action: () => { document.body.classList.toggle('focus-mode'); toast(document.body.classList.contains('focus-mode') ? 'Focus ON' : 'Focus OFF'); }, section: 'Settings' },
      { icon: '&#128250;', label: 'Toggle Fullscreen', shortcut: 'F11', action: () => document.body.classList.toggle('fullscreen-mode'), section: 'Settings' },
      { icon: '&#128488;', label: 'Toggle Zen Mode', shortcut: 'Z', action: () => { document.body.classList.toggle('zen-mode'); toast(document.body.classList.contains('zen-mode') ? 'Zen mode ON' : 'Zen mode OFF'); }, section: 'Settings' },
      { icon: '&#128269;', label: 'Search Everything', shortcut: '/', action: () => { const si = document.getElementById('header-search-input'); if (si) si.focus(); }, section: 'Navigation' },
      { icon: '&#128190;', label: 'Export All Data', action: () => exportData('all'), section: 'Actions' },
      { icon: '&#128190;', label: 'Export Notes', action: () => exportData('notes'), section: 'Actions' },
      { icon: '&#128190;', label: 'Export Logs', action: () => exportData('logs'), section: 'Actions' },
      { icon: '&#128260;', label: 'Refresh Status', action: () => fetchStatus(), section: 'Actions' },
      { icon: '&#9200;', label: 'Start Pomodoro', action: () => { navigateTo('monitor'); document.getElementById('pomo-start').click(); }, section: 'Actions' },
      { icon: '&#127840;', label: 'Fortune Cookie', action: () => { navigateTo('monitor'); crackFortune(); }, section: 'Fun' },
      { icon: '&#10067;', label: 'Keyboard Shortcuts', shortcut: '?', action: () => showShortcutsHelp(), section: 'Help' },
      { icon: '&#128682;', label: 'Logout', action: () => { sessionStorage.removeItem('monitor_token'); location.reload(); }, section: 'Account' },
    ];

    let cmdOverlay = null;
    let cmdActiveIdx = 0;
    let cmdFiltered = [];

    function openCommandPalette() {
      if (cmdOverlay) { closeCmdPalette(); return; }
      cmdOverlay = document.createElement('div');
      cmdOverlay.className = 'cmd-overlay';
      cmdOverlay.innerHTML =
        '<div class="cmd-palette">' +
        '  <div class="cmd-input-wrap"><input class="cmd-input" id="cmd-input" placeholder="Type a command..." autofocus></div>' +
        '  <div class="cmd-results" id="cmd-results"></div>' +
        '</div>';
      document.body.appendChild(cmdOverlay);

      const input = document.getElementById('cmd-input');
      cmdActiveIdx = 0;
      filterCommands('');

      input.addEventListener('input', () => filterCommands(input.value));
      input.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowDown') { e.preventDefault(); cmdActiveIdx = Math.min(cmdActiveIdx + 1, cmdFiltered.length - 1); highlightCmd(); }
        else if (e.key === 'ArrowUp') { e.preventDefault(); cmdActiveIdx = Math.max(cmdActiveIdx - 1, 0); highlightCmd(); }
        else if (e.key === 'Enter') { e.preventDefault(); if (cmdFiltered[cmdActiveIdx]) { cmdFiltered[cmdActiveIdx].action(); closeCmdPalette(); } }
        else if (e.key === 'Escape') { closeCmdPalette(); }
      });

      cmdOverlay.addEventListener('click', (e) => { if (e.target === cmdOverlay) closeCmdPalette(); });
    }

    function filterCommands(query) {
      const q = query.toLowerCase();
      cmdFiltered = q ? cmdCommands.filter(c => c.label.toLowerCase().includes(q)) : [...cmdCommands];
      cmdActiveIdx = 0;
      renderCmdResults();
    }

    function renderCmdResults() {
      const container = document.getElementById('cmd-results');
      if (!container) return;
      if (cmdFiltered.length === 0) {
        container.innerHTML = '<div class="notif-empty">No matching commands</div>';
        return;
      }
      let lastSection = '';
      container.innerHTML = cmdFiltered.map((cmd, i) => {
        let sectionHtml = '';
        if (cmd.section !== lastSection) {
          lastSection = cmd.section;
          sectionHtml = '<div class="cmd-section">' + cmd.section + '</div>';
        }
        return sectionHtml +
          '<div class="cmd-item' + (i === cmdActiveIdx ? ' active' : '') + '" data-idx="' + i + '">' +
          '  <span class="cmd-icon">' + cmd.icon + '</span>' +
          '  <span class="cmd-label">' + cmd.label + '</span>' +
          (cmd.shortcut ? '  <span class="cmd-shortcut">' + cmd.shortcut + '</span>' : '') +
          '</div>';
      }).join('');

      container.querySelectorAll('.cmd-item').forEach(item => {
        item.addEventListener('click', () => {
          const idx = parseInt(item.dataset.idx);
          if (cmdFiltered[idx]) { cmdFiltered[idx].action(); closeCmdPalette(); }
        });
        item.addEventListener('mouseenter', () => {
          cmdActiveIdx = parseInt(item.dataset.idx);
          highlightCmd();
        });
      });
    }

    function highlightCmd() {
      const items = document.querySelectorAll('.cmd-item');
      items.forEach((item, i) => {
        item.classList.toggle('active', parseInt(item.dataset.idx) === cmdActiveIdx);
      });
      // Scroll active into view
      const active = document.querySelector('.cmd-item.active');
      if (active) active.scrollIntoView({ block: 'nearest' });
    }

    function closeCmdPalette() {
      if (cmdOverlay) { cmdOverlay.remove(); cmdOverlay = null; }
    }

    // Cmd+K / Ctrl+K to open palette
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        if (authToken) openCommandPalette();
      }
    });

    // ===== POMODORO TIMER =====
    let pomoState = 'idle'; // idle, work, break
    let pomoTime = 25 * 60; // seconds
    let pomoTotal = 25 * 60;
    let pomoInterval = null;
    let pomoSessions = parseInt(localStorage.getItem('pomo_sessions') || '0');
    const WORK_DURATION = 25 * 60;
    const BREAK_DURATION = 5 * 60;
    const CIRCUMFERENCE = 2 * Math.PI * 70; // r=70

    function updatePomoDisplay() {
      const mins = Math.floor(pomoTime / 60);
      const secs = pomoTime % 60;
      document.getElementById('pomo-time').textContent =
        String(mins).padStart(2, '0') + ':' + String(secs).padStart(2, '0');

      // Update ring
      const progress = 1 - (pomoTime / pomoTotal);
      const offset = CIRCUMFERENCE * (1 - progress);
      const ring = document.getElementById('pomo-progress');
      ring.style.strokeDashoffset = offset;
      ring.classList.toggle('break-mode', pomoState === 'break');

      document.getElementById('pomo-label').textContent =
        pomoState === 'break' ? 'Break Time' :
        pomoState === 'work' ? 'Focus Time' : 'Ready';

      document.getElementById('pomo-start').textContent =
        pomoState === 'idle' ? 'Start' : 'Pause';

      document.getElementById('pomo-sessions').textContent = 'Sessions: ' + pomoSessions;
    }

    document.getElementById('pomo-start').addEventListener('click', () => {
      if (pomoInterval) {
        // Pause
        clearInterval(pomoInterval);
        pomoInterval = null;
        document.getElementById('pomo-start').textContent = 'Resume';
        return;
      }
      if (pomoState === 'idle') {
        pomoState = 'work';
        pomoTime = WORK_DURATION;
        pomoTotal = WORK_DURATION;
      }
      pomoInterval = setInterval(() => {
        pomoTime--;
        if (pomoTime <= 0) {
          clearInterval(pomoInterval);
          pomoInterval = null;
          if (pomoState === 'work') {
            pomoSessions++;
            localStorage.setItem('pomo_sessions', pomoSessions);
            pomoState = 'break';
            pomoTime = BREAK_DURATION;
            pomoTotal = BREAK_DURATION;
            addNotification('Pomodoro complete! Take a 5-min break.', 'success');
            toast('Focus session complete! Time for a break.');
            // Auto-start break
            pomoInterval = setInterval(function breakTick() {
              pomoTime--;
              if (pomoTime <= 0) {
                clearInterval(pomoInterval);
                pomoInterval = null;
                pomoState = 'idle';
                pomoTime = WORK_DURATION;
                pomoTotal = WORK_DURATION;
                addNotification('Break over! Ready for another session.', 'info');
                toast('Break over! Ready to focus again.');
              }
              updatePomoDisplay();
            }, 1000);
          } else {
            pomoState = 'idle';
            pomoTime = WORK_DURATION;
            pomoTotal = WORK_DURATION;
          }
        }
        updatePomoDisplay();
      }, 1000);
      updatePomoDisplay();
    });

    document.getElementById('pomo-reset').addEventListener('click', () => {
      if (pomoInterval) clearInterval(pomoInterval);
      pomoInterval = null;
      pomoState = 'idle';
      pomoTime = WORK_DURATION;
      pomoTotal = WORK_DURATION;
      updatePomoDisplay();
    });

    updatePomoDisplay();

    // ===== CRT MODE =====
    const crtToggle = document.getElementById('crt-toggle');
    function setCRT(on) {
      document.body.classList.toggle('crt', on);
      // If CRT is on, disable light theme
      if (on) document.body.classList.remove('light');
      localStorage.setItem('monitor_crt', on ? 'on' : 'off');
    }
    if (localStorage.getItem('monitor_crt') === 'on') setCRT(true);
    crtToggle.addEventListener('click', () => {
      setCRT(!document.body.classList.contains('crt'));
    });

    // ===== FORTUNE COOKIE =====
    const fortunes = [
      "A segfault in production is just an unplanned feature deprecation.",
      "The best code is no code. The second best is code that deletes code.",
      "Your git stash contains the key to solving this week's hardest bug.",
      "An unhandled promise rejection approaches. Await it with grace.",
      "The senior dev who reviewed your PR was once a junior who googled everything too.",
      "You will refactor this function three times. The third time will be beautiful.",
      "A wild race condition appears! It only manifests on Tuesdays.",
      "The docs lie. Read the source, Luke.",
      "Your next coffee will trigger the insight that fixes the memory leak.",
      "There is no cloud. It's just someone else's computer crying in a data center.",
      "The framework you chose will be deprecated before your project ships.",
      "You will accidentally push to main. It will fix everything.",
      "The CSS you wrote at 2am works. You will never understand why.",
      "Somewhere, a database admin just dropped a production table and hasn't realized yet.",
      "Your TODO comments are becoming sentient. They demand completion.",
      "The rubber duck on your desk knows more than your tech lead.",
      "Abandon regex. Embrace string splitting. Find inner peace.",
      "npm install solved the problem. npm install will cause the next one.",
      "Your code review comment about naming conventions will start a 47-message thread.",
      "The 10x developer was the friends we made along the way.",
      "A merge conflict is just two developers caring about the same code.",
      "Stack Overflow's greatest hits were written by people more confused than you.",
      "Your production logs will reveal a haiku hidden in the error messages.",
      "The build will fail. But it will fail faster this time. That's progress.",
      "You are one semicolon away from enlightenment.",
      "The API you're calling has a rate limit. It knows what you did last deploy.",
      "The test that fails locally but passes in CI is trying to teach you something.",
      "Delete node_modules. Breathe. npm install. Repeat.",
      "Your past self wrote this code as a warning to your present self.",
      "The variable you named 'temp' six months ago is now load-bearing."
    ];

    function crackFortune() {
      const cookie = document.getElementById('fortune-cookie');
      const icon = document.getElementById('fortune-icon');
      const text = document.getElementById('fortune-text');
      const hint = document.getElementById('fortune-hint');

      cookie.classList.add('fortune-cracking');
      icon.innerHTML = '&#10024;';

      setTimeout(() => {
        const fortune = fortunes[Math.floor(Math.random() * fortunes.length)];
        text.textContent = fortune;
        hint.textContent = 'Click for another fortune';
        cookie.classList.remove('fortune-cracking');
        icon.innerHTML = '&#128220;';
      }, 600);

      setTimeout(() => {
        icon.innerHTML = '&#127840;';
      }, 5000);
    }

    document.getElementById('fortune-cookie').addEventListener('click', crackFortune);

    // ===== SPARKLINE CHARTS =====
    const sparkData = { cpu: [], mem: [], req: [] };
    let requestCounter = 0;

    function drawSparkline(canvasId, data, color) {
      const canvas = document.getElementById(canvasId);
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const w = canvas.width = canvas.offsetWidth * 2;
      const h = canvas.height = 80;
      ctx.clearRect(0, 0, w, h);

      if (data.length < 2) return;
      const max = Math.max(...data, 1);
      const min = Math.min(...data, 0);
      const range = max - min || 1;

      // Fill
      ctx.beginPath();
      ctx.moveTo(0, h);
      data.forEach((v, i) => {
        const x = (i / (data.length - 1)) * w;
        const y = h - ((v - min) / range) * (h - 8) - 4;
        if (i === 0) ctx.lineTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.lineTo(w, h);
      ctx.closePath();
      const grad = ctx.createLinearGradient(0, 0, 0, h);
      grad.addColorStop(0, color + '30');
      grad.addColorStop(1, color + '05');
      ctx.fillStyle = grad;
      ctx.fill();

      // Line
      ctx.beginPath();
      data.forEach((v, i) => {
        const x = (i / (data.length - 1)) * w;
        const y = h - ((v - min) / range) * (h - 8) - 4;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.strokeStyle = color;
      ctx.lineWidth = 2;
      ctx.stroke();

      // Dot on last point
      const lastX = w;
      const lastY = h - ((data[data.length - 1] - min) / range) * (h - 8) - 4;
      ctx.beginPath();
      ctx.arc(lastX, lastY, 3, 0, Math.PI * 2);
      ctx.fillStyle = color;
      ctx.fill();
    }

    async function updateSparklines() {
      try {
        const resp = await api('/api/health');
        if (!resp.ok) return;
        const h = await resp.json();

        // CPU - parse load average first value
        const loadStr = h.system.loadAvg || '0';
        const cpuLoad = parseFloat(loadStr.split(',')[0]) || 0;
        sparkData.cpu.push(cpuLoad);
        if (sparkData.cpu.length > 30) sparkData.cpu.shift();
        document.getElementById('spark-cpu-val').textContent = cpuLoad.toFixed(2);
        drawSparkline('spark-cpu', sparkData.cpu, '#8b7cf6');

        // Memory
        if (h.system.memory && h.system.memory.totalMB) {
          const memPct = Math.round((h.system.memory.usedMB / h.system.memory.totalMB) * 100);
          sparkData.mem.push(memPct);
          if (sparkData.mem.length > 30) sparkData.mem.shift();
          document.getElementById('spark-mem-val').textContent = memPct + '%';
          drawSparkline('spark-mem', sparkData.mem, '#34d399');
        }

        // Simulated request counter (increments on each poll)
        requestCounter += Math.floor(Math.random() * 5) + 1;
        sparkData.req.push(requestCounter);
        if (sparkData.req.length > 30) sparkData.req.shift();
        document.getElementById('spark-req-val').textContent = requestCounter;
        drawSparkline('spark-req', sparkData.req, '#fbbf24');
      } catch {}
    }

    window._postAuthInits.push(function() {
      setTimeout(updateSparklines, 2000);
      setInterval(updateSparklines, 15000);
    });

    // ===== TERMINAL EMULATOR =====
    const termBody = document.getElementById('terminal-body');
    const termInput = document.getElementById('terminal-input');
    const termHistory = [];
    let termHistoryIdx = -1;

    const termCommands = {
      help: () => 'Available commands:\n  help     - Show this help\n  status   - Show server status\n  uptime   - Show system uptime\n  whoami   - Who are you?\n  date     - Current date/time\n  clear    - Clear terminal\n  tasks    - Show kanban task counts\n  notes    - Show note count\n  fortune  - Get a dev fortune\n  cowsay   - Moo\n  matrix   - Trigger Matrix rain\n  neofetch - System info\n  echo     - Echo text back\n  joke     - Random dev joke',
      status: async () => {
        try {
          const r = await api('/api/status');
          const d = await r.json();
          return 'Status: ' + d.usage.status + '\nLimit: ' + (d.usage.limitHit ? 'HIT' : 'OK') + '\nLast updated: ' + d.usage.lastUpdated;
        } catch { return 'Error fetching status'; }
      },
      uptime: async () => {
        try {
          const r = await api('/api/health');
          const d = await r.json();
          return d.system.uptime || 'Unknown';
        } catch { return 'Error'; }
      },
      whoami: () => 'guest@claude-monitor (authenticated user)',
      date: () => new Date().toString(),
      clear: () => { termBody.innerHTML = ''; return null; },
      tasks: async () => {
        try {
          const r = await api('/api/kanban');
          const d = await r.json();
          return d.columns.map(c => c.title + ': ' + c.tasks.length + ' tasks').join('\n');
        } catch { return 'Error'; }
      },
      notes: async () => {
        try {
          const r = await api('/api/notes');
          const d = await r.json();
          return d.length + ' notes stored';
        } catch { return 'Error'; }
      },
      fortune: () => fortunes[Math.floor(Math.random() * fortunes.length)],
      cowsay: () => {
        const msg = 'Moo! I am a cow.';
        return ' ' + '_'.repeat(msg.length + 2) + '\n< ' + msg + ' >\n ' + '-'.repeat(msg.length + 2) + '\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||';
      },
      matrix: () => { triggerMatrixRain(); return 'Entering the Matrix...'; },
      neofetch: async () => {
        try {
          const r = await api('/api/health');
          const d = await r.json();
          return '    .--.     guest@claude-monitor\n   |o_o |    OS: Linux (EC2)\n   |:_/ |    Uptime: ' + (d.system.uptime || '??') + '\n  //   \\ \\   Memory: ' + (d.system.memory.usedMB || '?') + '/' + (d.system.memory.totalMB || '?') + ' MB\n (|     | )  Disk: ' + (d.system.disk.used || '?') + '/' + (d.system.disk.total || '?') + '\n /\'_   _/`\\  Load: ' + (d.system.loadAvg || '??') + '\n \\___)=(___/  Shell: bash';
        } catch { return 'Error fetching system info'; }
      },
      echo: (args) => args || '',
      joke: () => {
        const jokes = [
          'Why do programmers prefer dark mode? Because light attracts bugs.',
          'There are only 10 types of people: those who understand binary and those who don\'t.',
          'A SQL query walks into a bar, sees two tables, and asks: "Can I JOIN you?"',
          'Why did the developer go broke? Because he used up all his cache.',
          'How many programmers does it take to change a light bulb? None. That\'s a hardware problem.',
          '!false - It\'s funny because it\'s true.',
          'A programmer\'s wife says "go to the store and get a gallon of milk. If they have eggs, get a dozen." He returns with 12 gallons of milk.',
        ];
        return jokes[Math.floor(Math.random() * jokes.length)];
      }
    };

    termInput.addEventListener('keydown', async (e) => {
      if (e.key === 'Enter') {
        const cmd = termInput.value.trim();
        if (!cmd) return;
        termHistory.push(cmd);
        termHistoryIdx = termHistory.length;
        termInput.value = '';

        // Show command
        const cmdLine = document.createElement('div');
        cmdLine.innerHTML = '<span class="prompt">guest@claude ~$ </span>' + esc(cmd);
        termBody.appendChild(cmdLine);

        // Parse and execute
        const parts = cmd.split(/\s+/);
        const command = parts[0].toLowerCase();
        const args = parts.slice(1).join(' ');

        let result;
        if (termCommands[command]) {
          result = termCommands[command](args);
          if (result instanceof Promise) result = await result;
        } else {
          result = command + ': command not found. Try "help"';
        }

        if (result !== null && result !== undefined) {
          const outLine = document.createElement('div');
          outLine.innerHTML = '<span class="output">' + esc(result) + '</span>';
          outLine.style.whiteSpace = 'pre-wrap';
          termBody.appendChild(outLine);
        }
        termBody.scrollTop = termBody.scrollHeight;
      }
      if (e.key === 'ArrowUp') {
        e.preventDefault();
        if (termHistoryIdx > 0) { termHistoryIdx--; termInput.value = termHistory[termHistoryIdx]; }
      }
      if (e.key === 'ArrowDown') {
        e.preventDefault();
        if (termHistoryIdx < termHistory.length - 1) { termHistoryIdx++; termInput.value = termHistory[termHistoryIdx]; }
        else { termHistoryIdx = termHistory.length; termInput.value = ''; }
      }
    });

    // ===== TYPING SPEED TEST =====
    const typingQuotes = [
      "The best error message is the one that never shows up.",
      "First, solve the problem. Then, write the code.",
      "Code is like humor. When you have to explain it, it's bad.",
      "Simplicity is the soul of efficiency.",
      "Make it work, make it right, make it fast.",
      "Programs must be written for people to read.",
      "Any fool can write code that a computer can understand.",
      "The most disastrous thing you can ever learn is your first programming language.",
      "Talk is cheap. Show me the code.",
      "Sometimes it pays to stay in bed on Monday rather than spending the rest of the week debugging Monday's code.",
      "Measuring programming progress by lines of code is like measuring aircraft building progress by weight.",
      "The function of good software is to make the complex appear to be simple.",
      "Perfection is achieved not when there is nothing more to add, but when there is nothing left to take away.",
      "Before software can be reusable it first has to be usable.",
      "The computer was born to solve problems that did not exist before.",
    ];

    let typingState = 'idle';
    let typingQuote = '';
    let typingStartTime = 0;
    let typingBest = parseInt(localStorage.getItem('typing_best') || '0');
    document.getElementById('typing-best').textContent = typingBest;

    function startTypingTest() {
      typingQuote = typingQuotes[Math.floor(Math.random() * typingQuotes.length)];
      typingState = 'active';
      typingStartTime = 0;
      const input = document.getElementById('typing-input');
      input.disabled = false;
      input.value = '';
      input.focus();
      renderTypingPrompt('');
      document.getElementById('typing-wpm').textContent = '0';
      document.getElementById('typing-acc').textContent = '0%';
    }

    function renderTypingPrompt(typed) {
      const prompt = document.getElementById('typing-prompt');
      let html = '';
      for (let i = 0; i < typingQuote.length; i++) {
        if (i < typed.length) {
          if (typed[i] === typingQuote[i]) {
            html += '<span class="correct">' + esc(typingQuote[i]) + '</span>';
          } else {
            html += '<span class="incorrect">' + esc(typingQuote[i]) + '</span>';
          }
        } else if (i === typed.length) {
          html += '<span class="cursor-char">' + esc(typingQuote[i]) + '</span>';
        } else {
          html += esc(typingQuote[i]);
        }
      }
      prompt.innerHTML = html;
    }

    document.getElementById('typing-input').addEventListener('input', (e) => {
      if (typingState !== 'active') return;
      const typed = e.target.value;
      if (!typingStartTime) typingStartTime = Date.now();
      renderTypingPrompt(typed);

      // Calculate stats
      const elapsed = (Date.now() - typingStartTime) / 1000 / 60; // minutes
      const words = typed.trim().split(/\s+/).filter(w => w).length;
      const wpm = elapsed > 0 ? Math.round(words / elapsed) : 0;

      let correct = 0;
      for (let i = 0; i < typed.length; i++) {
        if (typed[i] === typingQuote[i]) correct++;
      }
      const acc = typed.length > 0 ? Math.round((correct / typed.length) * 100) : 0;

      document.getElementById('typing-wpm').textContent = wpm;
      document.getElementById('typing-acc').textContent = acc + '%';

      // Check completion
      if (typed.length >= typingQuote.length) {
        typingState = 'done';
        e.target.disabled = true;
        if (wpm > typingBest) {
          typingBest = wpm;
          localStorage.setItem('typing_best', typingBest);
          document.getElementById('typing-best').textContent = typingBest;
          toast('New personal best: ' + wpm + ' WPM!');
        }
        toast('Typing test complete! ' + wpm + ' WPM, ' + acc + '% accuracy');
      }
    });

    document.getElementById('typing-start').addEventListener('click', startTypingTest);
    document.getElementById('typing-reset').addEventListener('click', () => {
      typingState = 'idle';
      document.getElementById('typing-input').disabled = true;
      document.getElementById('typing-input').value = '';
      document.getElementById('typing-prompt').textContent = 'Click "Start" to begin...';
      document.getElementById('typing-wpm').textContent = '0';
      document.getElementById('typing-acc').textContent = '0%';
    });

    // ===== PROGRESS RINGS =====
    const RING_CIRC = 2 * Math.PI * 38; // r=38

    function setRing(id, valId, percent, label) {
      const ring = document.getElementById(id);
      const valEl = document.getElementById(valId);
      if (!ring || !valEl) return;
      const offset = RING_CIRC * (1 - Math.min(percent, 100) / 100);
      ring.style.strokeDashoffset = offset;
      valEl.textContent = Math.round(percent) + '%';
    }

    async function updateProgressRings() {
      try {
        // Tasks
        const kanbanResp = await api('/api/kanban');
        const kanban = await kanbanResp.json();
        if (kanban.columns) {
          const total = kanban.columns.reduce((s, c) => s + c.tasks.length, 0);
          const done = (kanban.columns.find(c => c.id === 'done')?.tasks.length || 0);
          setRing('ring-tasks', 'ring-tasks-val', total > 0 ? (done / total) * 100 : 0);
        }

        // Health data
        const healthResp = await api('/api/health');
        const h = await healthResp.json();

        if (h.system.memory && h.system.memory.totalMB) {
          const memPct = (h.system.memory.usedMB / h.system.memory.totalMB) * 100;
          setRing('ring-memory', 'ring-memory-val', memPct);
        }

        if (h.system.disk && h.system.disk.usePercent) {
          const diskPct = parseInt(h.system.disk.usePercent) || 0;
          setRing('ring-disk', 'ring-disk-val', diskPct);
        }

        // CPU load (approximate: load avg / num cores * 100, cap at 100)
        if (h.system.loadAvg) {
          const load1 = parseFloat(h.system.loadAvg.split(',')[0]) || 0;
          const cpuPct = Math.min(load1 * 50, 100); // approximate single core
          setRing('ring-cpu', 'ring-cpu-val', cpuPct);
        }
      } catch {}
    }

    window._postAuthInits.push(function() {
      setTimeout(updateProgressRings, 3000);
      setInterval(updateProgressRings, 30000);
    });

    // ===== 3D CARD TILT EFFECT =====
    function initTiltCards() {
      document.querySelectorAll('.card, .stat-item, .sparkline-card, .progress-ring-card').forEach(card => {
        // Add shine layer
        if (!card.querySelector('.tilt-shine')) {
          card.classList.add('tilt-card');
          const shine = document.createElement('div');
          shine.className = 'tilt-shine';
          card.appendChild(shine);
        }

        card.addEventListener('mousemove', (e) => {
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          const rotateX = ((y - centerY) / centerY) * -5;
          const rotateY = ((x - centerX) / centerX) * 5;
          card.style.transform = 'perspective(800px) rotateX(' + rotateX + 'deg) rotateY(' + rotateY + 'deg) translateY(-2px)';
          card.style.setProperty('--shine-x', ((x / rect.width) * 100) + '%');
          card.style.setProperty('--shine-y', ((y / rect.height) * 100) + '%');
        });

        card.addEventListener('mouseleave', () => {
          card.style.transform = '';
        });
      });
    }
    // Init after a small delay so DOM is ready
    setTimeout(initTiltCards, 500);

    // ===== PARTICLE BACKGROUND =====
    (function initParticles() {
      const canvas = document.getElementById('particle-canvas');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      let particles = [];
      let mouseX = 0, mouseY = 0;
      let animId;
      const PARTICLE_COUNT = 50;
      let lastW = 0, lastH = 0;

      function resize() {
        // On iOS, keyboard open/close fires resize  use screen dimensions to avoid thrashing
        var w = window.screen ? window.screen.width : window.innerWidth;
        var h = window.screen ? window.screen.height : window.innerHeight;
        // Use innerWidth for landscape accuracy but only update if significantly changed
        w = window.innerWidth;
        h = Math.max(window.innerHeight, window.screen ? window.screen.height : window.innerHeight);
        if (Math.abs(w - lastW) < 10 && Math.abs(h - lastH) < 100) return;
        lastW = w; lastH = h;
        canvas.width = w;
        canvas.height = h;
      }
      resize();
      // Debounce resize to avoid iOS keyboard thrashing
      var resizeTimer;
      window.addEventListener('resize', function() { clearTimeout(resizeTimer); resizeTimer = setTimeout(resize, 300); });

      document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
      });

      function createParticle() {
        return {
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          size: Math.random() * 2 + 0.5,
          speedX: (Math.random() - 0.5) * 0.3,
          speedY: (Math.random() - 0.5) * 0.3,
          opacity: Math.random() * 0.4 + 0.1,
          pulse: Math.random() * Math.PI * 2,
        };
      }

      // Initialize particles
      for (let i = 0; i < PARTICLE_COUNT; i++) {
        particles.push(createParticle());
      }

      function drawParticles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        particles.forEach(p => {
          // Mouse interaction - gentle push
          const dx = p.x - mouseX;
          const dy = p.y - mouseY;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < 120) {
            const force = (120 - dist) / 120 * 0.3;
            p.speedX += (dx / dist) * force * 0.1;
            p.speedY += (dy / dist) * force * 0.1;
          }

          // Damping
          p.speedX *= 0.99;
          p.speedY *= 0.99;

          p.x += p.speedX;
          p.y += p.speedY;
          p.pulse += 0.02;

          // Wrap
          if (p.x < 0) p.x = canvas.width;
          if (p.x > canvas.width) p.x = 0;
          if (p.y < 0) p.y = canvas.height;
          if (p.y > canvas.height) p.y = 0;

          const alpha = p.opacity * (0.7 + 0.3 * Math.sin(p.pulse));
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fillStyle = 'rgba(139, 124, 246, ' + alpha + ')';
          ctx.fill();
        });

        // Draw connections between nearby particles
        for (let i = 0; i < particles.length; i++) {
          for (let j = i + 1; j < particles.length; j++) {
            const dx = particles[i].x - particles[j].x;
            const dy = particles[i].y - particles[j].y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 100) {
              ctx.beginPath();
              ctx.moveTo(particles[i].x, particles[i].y);
              ctx.lineTo(particles[j].x, particles[j].y);
              ctx.strokeStyle = 'rgba(139, 124, 246, ' + (0.06 * (1 - dist / 100)) + ')';
              ctx.lineWidth = 0.5;
              ctx.stroke();
            }
          }
        }

        animId = requestAnimationFrame(drawParticles);
      }

      drawParticles();
    })();

    // ===== ACTIVITY HEATMAP =====
    function renderHeatmap() {
      const grid = document.getElementById('heatmap-grid');
      if (!grid) return;

      // Generate fake activity data for last 90 days
      // In real usage this would come from server logs
      const activityData = {};
      const storedActivity = JSON.parse(localStorage.getItem('heatmap_data') || '{}');

      // Merge stored with some generated data
      const today = new Date();
      for (let i = 0; i < 90; i++) {
        const d = new Date(today);
        d.setDate(d.getDate() - i);
        const key = d.toISOString().split('T')[0];
        if (storedActivity[key] !== undefined) {
          activityData[key] = storedActivity[key];
        } else {
          // Generate plausible activity pattern
          const dayOfWeek = d.getDay();
          const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
          const base = isWeekend ? 0.3 : 0.7;
          const r = Math.random();
          if (r < base * 0.3) activityData[key] = 0;
          else if (r < base * 0.5) activityData[key] = 1;
          else if (r < base * 0.75) activityData[key] = 2;
          else if (r < base * 0.9) activityData[key] = 3;
          else activityData[key] = 4;
        }
      }

      // Record today's activity
      const todayKey = today.toISOString().split('T')[0];
      activityData[todayKey] = Math.max(activityData[todayKey] || 0, 3);
      storedActivity[todayKey] = activityData[todayKey];
      localStorage.setItem('heatmap_data', JSON.stringify(storedActivity));

      // Build weeks grid (columns = weeks, rows = days)
      const weeks = [];
      let currentWeek = [];
      for (let i = 89; i >= 0; i--) {
        const d = new Date(today);
        d.setDate(d.getDate() - i);
        const key = d.toISOString().split('T')[0];
        const dayOfWeek = d.getDay();

        if (dayOfWeek === 0 && currentWeek.length > 0) {
          weeks.push(currentWeek);
          currentWeek = [];
        }
        currentWeek.push({ date: key, level: activityData[key] || 0, dayOfWeek });
      }
      if (currentWeek.length > 0) weeks.push(currentWeek);

      grid.innerHTML = weeks.map(week => {
        const cells = week.map(day =>
          '<div class="heatmap-cell l' + day.level + '" title="' + day.date + ': level ' + day.level + '"></div>'
        ).join('');
        return '<div class="heatmap-week">' + cells + '</div>';
      }).join('');
    }

    renderHeatmap();

    // ===== TYPING INDICATOR =====
    const typingIndicator = document.getElementById('typing-indicator');
    function updateTypingIndicator(status) {
      if (!typingIndicator) return;
      if (status === 'active') {
        typingIndicator.style.display = 'inline-flex';
      } else {
        typingIndicator.style.display = 'none';
      }
    }

    // Patch renderStatus to update typing indicator
    const _origRenderStatus3 = renderStatus;
    renderStatus = function(data) {
      _origRenderStatus3(data);
      updateTypingIndicator(data.usage?.status);
    };

    // ===== FIREWORKS CELEBRATION =====
    function launchFireworks() {
      const canvas = document.createElement('canvas');
      canvas.id = 'fireworks-canvas';
      canvas.style.cssText = 'position:fixed;inset:0;z-index:350;pointer-events:none;';
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');

      const rockets = [];
      const particles = [];
      const colors = ['#8b7cf6', '#34d399', '#fbbf24', '#fb7185', '#38bdf8', '#f472b6', '#a78bfa', '#6ee7b7'];
      let frame = 0;

      function createRocket() {
        return {
          x: Math.random() * canvas.width * 0.8 + canvas.width * 0.1,
          y: canvas.height,
          targetY: Math.random() * canvas.height * 0.4 + canvas.height * 0.1,
          speed: Math.random() * 3 + 4,
          exploded: false,
          color: colors[Math.floor(Math.random() * colors.length)],
          trail: []
        };
      }

      function explode(rocket) {
        const count = Math.floor(Math.random() * 40) + 30;
        for (let i = 0; i < count; i++) {
          const angle = (Math.PI * 2 * i) / count + (Math.random() - 0.5) * 0.3;
          const speed = Math.random() * 4 + 1;
          particles.push({
            x: rocket.x,
            y: rocket.y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: 1,
            decay: Math.random() * 0.02 + 0.01,
            color: rocket.color,
            size: Math.random() * 3 + 1,
          });
        }
      }

      function animate() {
        ctx.fillStyle = 'rgba(0,0,0,0.15)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Spawn rockets
        if (frame % 20 === 0 && frame < 200) {
          rockets.push(createRocket());
        }

        // Update rockets
        for (let i = rockets.length - 1; i >= 0; i--) {
          const r = rockets[i];
          r.trail.push({ x: r.x, y: r.y });
          if (r.trail.length > 10) r.trail.shift();

          r.y -= r.speed;
          r.x += (Math.random() - 0.5) * 0.5;

          // Draw trail
          r.trail.forEach((t, ti) => {
            ctx.beginPath();
            ctx.arc(t.x, t.y, 1, 0, Math.PI * 2);
            ctx.fillStyle = r.color + Math.floor(((ti / r.trail.length) * 0.5) * 255).toString(16).padStart(2, '0');
            ctx.fill();
          });

          // Draw rocket
          ctx.beginPath();
          ctx.arc(r.x, r.y, 2, 0, Math.PI * 2);
          ctx.fillStyle = '#fff';
          ctx.fill();

          if (r.y <= r.targetY) {
            explode(r);
            rockets.splice(i, 1);
          }
        }

        // Update particles
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.05; // gravity
          p.vx *= 0.99;
          p.life -= p.decay;

          if (p.life <= 0) {
            particles.splice(i, 1);
            continue;
          }

          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fillStyle = p.color + Math.floor(p.life * 255).toString(16).padStart(2, '0');
          ctx.fill();

          // Sparkle
          if (Math.random() > 0.95) {
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size * 0.5, 0, Math.PI * 2);
            ctx.fillStyle = '#ffffff80';
            ctx.fill();
          }
        }

        frame++;
        if (frame < 350 || particles.length > 0) {
          requestAnimationFrame(animate);
        } else {
          canvas.style.transition = 'opacity 1s';
          canvas.style.opacity = '0';
          setTimeout(() => canvas.remove(), 1000);
        }
      }

      animate();
      toast('Fireworks! You are on fire!');
    }

    // Trigger fireworks when 10 tasks are done
    let lastDoneCount = null;
    const _origFetchKanbanFW = fetchKanban;
    fetchKanban = async function() {
      await _origFetchKanbanFW();
      if (kanbanData && kanbanData.columns) {
        const done = kanbanData.columns.find(c => c.id === 'done')?.tasks.length || 0;
        if (lastDoneCount !== null && done >= 10 && lastDoneCount < 10) {
          launchFireworks();
          addNotification('10 tasks completed! Fireworks unlocked!', 'success');
        }
        lastDoneCount = done;
      }
    };

    // ===== AMBIENT SOUND GENERATOR =====
    let ambientCtx = null;
    let ambientPlaying = false;
    let ambientOsc = [];
    let ambientGain = null;
    let ambientAnalyser = null;
    const ambientViz = document.getElementById('ambient-viz');

    // Create viz bars
    for (let i = 0; i < 8; i++) {
      const bar = document.createElement('div');
      bar.className = 'ambient-viz-bar';
      bar.style.height = '2px';
      ambientViz.appendChild(bar);
    }

    function startAmbient() {
      if (!ambientCtx) {
        ambientCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (ambientCtx.state === 'suspended') ambientCtx.resume();

      ambientGain = ambientCtx.createGain();
      ambientGain.gain.value = (parseInt(document.getElementById('ambient-volume').value) || 30) / 300;
      ambientAnalyser = ambientCtx.createAnalyser();
      ambientAnalyser.fftSize = 32;

      // Create layered ambient tones
      const freqs = [55, 82.5, 110, 165, 220];
      const types = ['sine', 'sine', 'triangle', 'sine', 'sine'];
      ambientOsc = freqs.map((freq, i) => {
        const osc = ambientCtx.createOscillator();
        const oscGain = ambientCtx.createGain();
        osc.type = types[i];
        osc.frequency.value = freq;
        oscGain.gain.value = 0.08 - (i * 0.012);

        // Slow modulation
        const lfo = ambientCtx.createOscillator();
        const lfoGain = ambientCtx.createGain();
        lfo.frequency.value = 0.05 + i * 0.02;
        lfoGain.gain.value = freq * 0.005;
        lfo.connect(lfoGain);
        lfoGain.connect(osc.frequency);
        lfo.start();

        osc.connect(oscGain);
        oscGain.connect(ambientGain);
        osc.start();
        return { osc, lfo, oscGain };
      });

      ambientGain.connect(ambientAnalyser);
      ambientAnalyser.connect(ambientCtx.destination);
      ambientPlaying = true;
      document.getElementById('ambient-toggle').classList.add('playing');
      animateAmbientViz();
    }

    function stopAmbient() {
      ambientOsc.forEach(o => {
        try { o.osc.stop(); o.lfo.stop(); } catch {}
      });
      ambientOsc = [];
      ambientPlaying = false;
      document.getElementById('ambient-toggle').classList.remove('playing');
      ambientViz.querySelectorAll('.ambient-viz-bar').forEach(bar => bar.style.height = '2px');
    }

    function animateAmbientViz() {
      if (!ambientPlaying || !ambientAnalyser) return;
      const data = new Uint8Array(ambientAnalyser.frequencyBinCount);
      ambientAnalyser.getByteFrequencyData(data);
      const bars = ambientViz.querySelectorAll('.ambient-viz-bar');
      bars.forEach((bar, i) => {
        const val = data[i] || 0;
        bar.style.height = Math.max(2, (val / 255) * 16) + 'px';
      });
      requestAnimationFrame(animateAmbientViz);
    }

    document.getElementById('ambient-toggle').addEventListener('click', () => {
      if (ambientPlaying) stopAmbient();
      else startAmbient();
    });

    document.getElementById('ambient-volume').addEventListener('input', (e) => {
      if (ambientGain) {
        ambientGain.gain.value = parseInt(e.target.value) / 300;
      }
    });

    // ===== WEATHER WIDGET =====
    async function fetchWeather() {
      try {
        const resp = await api('/api/weather');
        if (!resp.ok) return;
        const w = await resp.json();
        const icon = getWeatherIcon(parseInt(w.code) || 0);
        document.getElementById('weather-icon').textContent = icon;
        document.getElementById('weather-temp').textContent = w.temp_F + 'F';
        document.getElementById('weather-widget').title = w.desc + ' | ' + w.temp_C + 'C / ' + w.temp_F + 'F | Humidity: ' + w.humidity + '%';
      } catch {}
    }

    function getWeatherIcon(code) {
      if (code >= 200 && code < 300) return '\u26C8'; // thunderstorm
      if (code >= 300 && code < 400) return '\u{1F327}'; // drizzle
      if (code === 113) return '\u2600'; // sunny
      if (code === 116) return '\u26C5'; // partly cloudy
      if (code === 119 || code === 122) return '\u2601'; // cloudy
      if (code >= 176 && code <= 200) return '\u{1F327}'; // rain
      if (code >= 227 && code <= 338) return '\u2744'; // snow/sleet
      if (code >= 389) return '\u26C8'; // thunderstorm
      return '\u2601'; // default cloud
    }

    window._postAuthInits.push(function() {
      setTimeout(fetchWeather, 2000);
      setInterval(fetchWeather, 600000); // every 10 min
    });

    // ===== NOTE PINNING + BASIC MARKDOWN =====
    let pinnedNotes = JSON.parse(localStorage.getItem('pinned_notes') || '[]');

    function togglePinNote(noteId) {
      const idx = pinnedNotes.indexOf(noteId);
      if (idx >= 0) {
        pinnedNotes.splice(idx, 1);
        toast('Note unpinned');
      } else {
        pinnedNotes.push(noteId);
        toast('Note pinned');
      }
      localStorage.setItem('pinned_notes', JSON.stringify(pinnedNotes));
      fetchNotes();
    }

    function renderMarkdown(text) {
      if (!text) return '';
      // Basic markdown: bold, italic, code, headers, links
      let html = esc(text);
      html = html.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      html = html.replace(/\*(.+?)\*/g, '<em>$1</em>');
      html = html.replace(/`(.+?)`/g, '<code style="background:rgba(139,124,246,0.1);padding:1px 4px;border-radius:3px;font-family:JetBrains Mono,monospace;font-size:0.82em;">$1</code>');
      html = html.replace(/^### (.+)$/gm, '<div style="font-weight:600;font-size:0.88rem;color:var(--text);margin:6px 0 3px;">$1</div>');
      html = html.replace(/^## (.+)$/gm, '<div style="font-weight:600;font-size:0.95rem;color:var(--text);margin:8px 0 4px;">$1</div>');
      html = html.replace(/^# (.+)$/gm, '<div style="font-weight:700;font-size:1.05rem;color:var(--text);margin:10px 0 5px;">$1</div>');
      return html;
    }

    // Override renderNotes to include pin, tags, and markdown
    const _origFetchNotes = fetchNotes;
    fetchNotes = async function() {
      try {
        const resp = await api('/api/notes');
        if (resp.status === 401) return;
        const notes = await resp.json();

        // Collect all tags for filter bar
        const allTags = new Set();
        notes.forEach(n => {
          const { tags } = parseNoteTags(n.content);
          tags.forEach(t => allTags.add(t));
        });
        const tagFilter = document.getElementById('note-tag-filter');
        if (tagFilter && allTags.size > 0) {
          tagFilter.innerHTML = '<span style="font-size:0.72rem;color:var(--text-tertiary);margin-right:4px;">Tags:</span>' +
            '<button class="note-tag-btn' + (!activeTagFilter ? ' active' : '') + '" onclick="filterByTag(null)">All</button>' +
            [...allTags].map(t =>
              '<button class="note-tag-btn' + (activeTagFilter === t ? ' active' : '') + '" onclick="filterByTag(\'' + esc(t) + '\')">' + esc(t) + '</button>'
            ).join('');
        } else if (tagFilter) {
          tagFilter.innerHTML = '';
        }

        // Sort: pinned first, then by date
        let sorted = [...notes].sort((a, b) => {
          const aPinned = pinnedNotes.includes(a.id);
          const bPinned = pinnedNotes.includes(b.id);
          if (aPinned && !bPinned) return -1;
          if (!aPinned && bPinned) return 1;
          return new Date(b.createdAt) - new Date(a.createdAt);
        });

        // Filter by tag if active
        if (activeTagFilter) {
          sorted = sorted.filter(n => {
            const { tags } = parseNoteTags(n.content);
            return tags.includes(activeTagFilter);
          });
        }

        const list = document.getElementById('notes-list');
        if (sorted.length === 0) {
          list.innerHTML = '<div class="note-empty">No notes yet. Create one to get started.</div>';
          return;
        }
        list.innerHTML = sorted.map(note => {
          const isPinned = pinnedNotes.includes(note.id);
          const dateStr = new Date(note.createdAt).toLocaleDateString([], { month: 'short', day: 'numeric' });
          const { tags, color, cleanContent } = parseNoteMeta(note.content);
          const colorMap = { red: '#fb7185', yellow: '#fbbf24', green: '#34d399', blue: '#6366f1', purple: '#a78bfa' };
          const colorStyle = color !== 'none' && colorMap[color] ? 'border-left:3px solid ' + colorMap[color] + ';' : '';
          const tagsHtml = tags.length > 0 ? '<div style="display:flex;gap:4px;margin-top:6px;">' + tags.map(t => '<span class="note-tag">' + esc(t) + '</span>').join('') + '</div>' : '';
          return '<div class="note-card ' + (isPinned ? 'pinned' : '') + '" id="note-' + note.id + '" style="' + colorStyle + '">' +
            '<div class="note-card-header">' +
            '  <div style="display:flex;align-items:center;gap:8px;">' +
            (isPinned ? '<span class="pin-badge">Pinned</span>' : '') +
            '  <span class="note-card-title">' + esc(note.title) + '</span></div>' +
            '  <span class="note-card-date">' + dateStr + '</span>' +
            '</div>' +
            tagsHtml +
            '<div class="note-card-content">' + renderMarkdown(cleanContent) + '</div>' +
            '<textarea class="note-edit-area" id="note-edit-' + note.id + '">' + esc(note.content) + '</textarea>' +
            '<div class="note-card-actions">' +
            '  <button class="btn" onclick="togglePinNote(\'' + note.id + '\')">' + (isPinned ? 'Unpin' : 'Pin') + '</button>' +
            '  <button class="btn" onclick="editNote(\'' + note.id + '\')">Edit</button>' +
            '  <button class="btn btn-danger" onclick="deleteNote(\'' + note.id + '\')">Delete</button>' +
            '</div></div>';
        }).join('');
      } catch {}
    };

    function filterByTag(tag) {
      activeTagFilter = tag;
      fetchNotes();
    }

    // ===== CHANGELOG MODAL =====
    const CHANGELOG_VERSION = '2026-02-25-overnight';

    function showChangelog() {
      const seen = localStorage.getItem('changelog_seen');
      if (seen === CHANGELOG_VERSION) return;

      const overlay = document.createElement('div');
      overlay.className = 'changelog-overlay';
      overlay.innerHTML = `
        <div class="changelog-modal">
          <div class="changelog-header">
            <div>
              <h2>What's New</h2>
              <div class="changelog-subtitle">Claude worked overnight - here's everything that changed</div>
            </div>
            <button class="changelog-close" id="changelog-close">&times;</button>
          </div>
          <div class="changelog-body">
            <div class="changelog-section">
              <div class="changelog-section-title">New Pages & Navigation</div>
              <div class="changelog-item"><span class="changelog-icon">&#128295;</span><div><strong>Tools Page</strong> - New 5th page with developer toys: terminal emulator, typing speed test, and snake game</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#9000;</span><div><strong>Terminal Emulator</strong> - Run 15+ commands: status, neofetch, cowsay, fortune, joke, matrix, and more</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#9997;</span><div><strong>Typing Speed Test</strong> - Test WPM with programming quotes, accuracy tracking, personal best scoreboard</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127921;</span><div><strong>Snake Game</strong> - Neon-styled snake game with wall-wrap, glowing food, and high score tracking</div></div>
            </div>

            <div class="changelog-section">
              <div class="changelog-section-title">Dashboard Upgrades</div>
              <div class="changelog-item"><span class="changelog-icon">&#128200;</span><div><strong>Live Sparkline Charts</strong> - Real-time CPU, Memory, and Request charts with gradient fills</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128308;</span><div><strong>Progress Rings</strong> - SVG circular gauges for tasks done %, memory, disk, and CPU load</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128202;</span><div><strong>Stats Bar</strong> - Animated counters showing total tasks, completed, notes, messages, and uptime</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128165;</span><div><strong>Activity Heatmap</strong> - GitHub-style 90-day contribution heatmap</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127777;</span><div><strong>Weather Widget</strong> - Live weather in header with emoji icons and temperature</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128276;</span><div><strong>Notification Center</strong> - Bell icon with unread badge, auto-notifications on status changes</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128172;</span><div><strong>Typing Indicator</strong> - "Claude is working..." bouncing dots when server shows active</div></div>
            </div>

            <div class="changelog-section">
              <div class="changelog-section-title">Productivity Tools</div>
              <div class="changelog-item"><span class="changelog-icon">&#9200;</span><div><strong>Pomodoro Timer</strong> - 25/5 work-break cycle with SVG progress ring and session counter</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128269;</span><div><strong>Command Palette</strong> - Press <strong>Ctrl+K</strong> for VS Code-style searchable command launcher</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128221;</span><div><strong>Note Pinning</strong> - Pin important notes to top, with markdown rendering (bold, italic, code, headers)</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128270;</span><div><strong>Note Search</strong> - Filter notes by title/content in real-time</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128190;</span><div><strong>Export Buttons</strong> - Export notes and logs as JSON files</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128200;</span><div><strong>Log Filtering</strong> - Filter activity log by type: All, System, User, Error</div></div>
            </div>

            <div class="changelog-section">
              <div class="changelog-section-title">Visual Effects & Themes</div>
              <div class="changelog-item"><span class="changelog-icon">&#127769;</span><div><strong>Dark/Light Theme</strong> - Toggle between dark and light mode with full CSS variable system</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128250;</span><div><strong>CRT Retro Mode</strong> - Scanlines, green phosphor text, and subtle flicker</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#10024;</span><div><strong>Particle Background</strong> - 50 floating particles with mouse reactivity and connection lines</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127922;</span><div><strong>3D Card Tilt</strong> - Cards respond to mouse with perspective transforms and shine overlay</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127881;</span><div><strong>Confetti & Fireworks</strong> - Confetti on task completion, fireworks show when 10 tasks are done</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127912;</span><div><strong>Matrix Rain</strong> - Konami code Easter egg (up up down down left right left right B A)</div></div>
            </div>

            <div class="changelog-section">
              <div class="changelog-section-title">Quality of Life</div>
              <div class="changelog-item"><span class="changelog-icon">&#127840;</span><div><strong>Fortune Cookies</strong> - 30 dev-themed fortunes with cracking animation</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#127925;</span><div><strong>Ambient Sound</strong> - Web Audio synthesizer with waveform visualizer and volume control</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#9888;</span><div><strong>Skeleton Loading</strong> - Shimmer loading states before data arrives</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#9829;</span><div><strong>Micro-Interactions</strong> - Ripple clicks, smooth hover transitions, button press effects</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#9000;</span><div><strong>Keyboard Shortcuts</strong> - Ctrl+1-5 pages, Ctrl+K palette, N new item, Esc close, ? help</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128172;</span><div><strong>Daily Dev Quote</strong> - Rotating motivational quote from 30 programming legends</div></div>
              <div class="changelog-item"><span class="changelog-icon">&#128337;</span><div><strong>Live Clock & Uptime</strong> - Real-time clock and session uptime counter in header</div></div>
            </div>
          </div>
          <div class="changelog-footer">
            <span class="changelog-count">28 new features shipped overnight</span>
            <button class="changelog-dismiss" id="changelog-dismiss">Let's Go</button>
          </div>
        </div>
      `;

      document.body.appendChild(overlay);

      const dismiss = () => {
        localStorage.setItem('changelog_seen', CHANGELOG_VERSION);
        overlay.style.transition = 'opacity 0.3s';
        overlay.style.opacity = '0';
        setTimeout(() => overlay.remove(), 300);
      };

      document.getElementById('changelog-close').addEventListener('click', dismiss);
      document.getElementById('changelog-dismiss').addEventListener('click', dismiss);
      overlay.addEventListener('click', (e) => { if (e.target === overlay) dismiss(); });
    }

    // Show changelog after dashboard loads
    const _origShowDashboard = showDashboard;
    showDashboard = function() {
      _origShowDashboard();
      setTimeout(showChangelog, 800);
    };
    window.showDashboard = showDashboard;
    // If already logged in via session, show now
    if (authToken && document.getElementById('dashboard').style.display === 'block') {
      setTimeout(showChangelog, 800);
    }

    // ===== KANBAN PRIORITY SYSTEM =====
    let selectedPriority = 'none';

    // Wire priority selector buttons
    document.querySelectorAll('#priority-selector .priority-option').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        selectedPriority = btn.dataset.priority;
        document.querySelectorAll('#priority-selector .priority-option').forEach(b => {
          b.classList.toggle('selected', b === btn);
        });
      });
    });

    // Override addKanbanTask to include priority + due date
    const _origAddKanbanTask = addKanbanTask;
    addKanbanTask = async function() {
      const titleInput = document.getElementById('kanban-task-title');
      const descInput = document.getElementById('kanban-task-desc');
      const dueInput = document.getElementById('kanban-task-due');
      const title = titleInput.value.trim();
      if (!title) { titleInput.focus(); return; }

      // Prepend priority + due date tags to description
      const priorityTag = selectedPriority !== 'none' ? '[' + selectedPriority.toUpperCase() + '] ' : '';
      const dueTag = dueInput && dueInput.value ? '[DUE:' + dueInput.value + '] ' : '';
      const desc = descInput.value.trim();

      try {
        const resp = await api('/api/kanban/task', {
          method: 'POST',
          body: JSON.stringify({
            columnId: 'backlog',
            title: title,
            description: priorityTag + dueTag + desc
          })
        });
        if (resp.ok) {
          titleInput.value = '';
          descInput.value = '';
          if (dueInput) dueInput.value = '';
          selectedPriority = 'none';
          document.querySelectorAll('#priority-selector .priority-option').forEach(b => {
            b.classList.toggle('selected', b.dataset.priority === 'none');
          });
          document.getElementById('kanban-add-form').classList.remove('visible');
          toast('Task created');
          fetchKanban();
        } else {
          toast('Failed to create task');
        }
      } catch (err) {
        toast('Connection error');
      }
    };

    // Override renderKanban to show priority colors + due dates
    const _origRenderKanban = renderKanban;
    renderKanban = function() {
      _origRenderKanban();
      const today = new Date().toISOString().split('T')[0];
      const soon = new Date(Date.now() + 3 * 86400000).toISOString().split('T')[0];
      // After render, detect priorities/due dates and add visual indicators
      document.querySelectorAll('.kanban-task-card').forEach(card => {
        const desc = card.querySelector('.kanban-task-desc');
        if (!desc) return;
        let text = desc.textContent;
        let priority = 'none';
        if (text.includes('[CRITICAL]')) priority = 'critical';
        else if (text.includes('[HIGH]')) priority = 'high';
        else if (text.includes('[MED]')) priority = 'med';
        else if (text.includes('[LOW]')) priority = 'low';

        if (priority !== 'none') {
          card.classList.add('priority-' + priority + '-border');
          const title = card.querySelector('.kanban-task-title');
          if (title && !title.querySelector('.kanban-priority')) {
            const badge = document.createElement('span');
            badge.className = 'kanban-priority priority-' + priority;
            badge.textContent = priority === 'med' ? 'MED' : priority.toUpperCase();
            title.insertBefore(badge, title.firstChild);
          }
          text = text.replace(/\[(CRITICAL|HIGH|MED|LOW)\]\s*/g, '');
        }

        // Parse due date [DUE:YYYY-MM-DD]
        const dueMatch = text.match(/\[DUE:(\d{4}-\d{2}-\d{2})\]/);
        if (dueMatch) {
          const dueDate = dueMatch[1];
          text = text.replace(/\[DUE:\d{4}-\d{2}-\d{2}\]\s*/g, '');
          const dueBadge = document.createElement('div');
          dueBadge.className = 'kanban-due';
          if (dueDate < today) {
            dueBadge.classList.add('overdue');
            dueBadge.textContent = 'OVERDUE ' + dueDate;
          } else if (dueDate <= soon) {
            dueBadge.classList.add('due-soon');
            dueBadge.textContent = 'Due ' + dueDate;
          } else {
            dueBadge.textContent = 'Due ' + dueDate;
          }
          card.appendChild(dueBadge);
        }

        desc.textContent = text;

        // Render checklists: - [ ] and - [x]
        if (text.match(/- \[[ x]\]/)) {
          const taskId = card.dataset.taskId;
          const lines = text.split('\n');
          let checkHtml = '';
          let otherText = '';
          lines.forEach((line, li) => {
            const unchecked = line.match(/^- \[ \] (.+)/);
            const checked = line.match(/^- \[x\] (.+)/);
            if (unchecked) {
              checkHtml += '<label class="kanban-check" style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:0.75rem;color:var(--text-secondary);padding:2px 0;" onclick="toggleCheck(\'' + taskId + '\',' + li + ')">' +
                '<span style="width:14px;height:14px;border:1px solid var(--border);border-radius:3px;display:inline-block;flex-shrink:0;"></span>' +
                '<span>' + esc(unchecked[1]) + '</span></label>';
            } else if (checked) {
              checkHtml += '<label class="kanban-check" style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:0.75rem;color:var(--text-tertiary);padding:2px 0;text-decoration:line-through;" onclick="toggleCheck(\'' + taskId + '\',' + li + ')">' +
                '<span style="width:14px;height:14px;border:1px solid var(--accent);border-radius:3px;display:inline-block;flex-shrink:0;background:var(--accent);text-align:center;line-height:14px;font-size:10px;color:#fff;">&#10003;</span>' +
                '<span>' + esc(checked[1]) + '</span></label>';
            } else if (line.trim()) {
              otherText += line + ' ';
            }
          });
          if (checkHtml) {
            desc.innerHTML = (otherText.trim() ? '<div style="margin-bottom:4px;">' + esc(otherText.trim()) + '</div>' : '') + checkHtml;
          }
        }

        if (!desc.textContent.trim() && !desc.innerHTML.trim()) {
          desc.style.display = 'none';
        }
      });
    };

    async function toggleCheck(taskId, lineIdx) {
      if (!kanbanData) return;
      for (const col of kanbanData.columns) {
        const task = col.tasks.find(t => t.id === taskId);
        if (task && task.description) {
          const lines = task.description.split('\n');
          if (lines[lineIdx]) {
            if (lines[lineIdx].match(/^- \[ \]/)) lines[lineIdx] = lines[lineIdx].replace('- [ ]', '- [x]');
            else if (lines[lineIdx].match(/^- \[x\]/)) lines[lineIdx] = lines[lineIdx].replace('- [x]', '- [ ]');
            task.description = lines.join('\n');
            try {
              await api('/api/kanban/task/' + taskId, { method: 'PUT', body: JSON.stringify({ description: task.description }) });
              renderKanban();
            } catch {}
          }
          break;
        }
      }
    }

    // ===== PARALLAX SCROLL EFFECTS =====
    const parallaxObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, { threshold: 0.1 });

    function initParallax() {
      document.querySelectorAll('.card, .section, .kanban-column, .note-card').forEach(el => {
        if (!el.dataset.parallaxInit) {
          el.dataset.parallaxInit = '1';
          el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
          parallaxObserver.observe(el);
        }
      });
    }
    // Re-run after page switches
    _navHooks.push(function(page) {
      setTimeout(initParallax, 200);
    });
    setTimeout(initParallax, 500);

    // ===== GLOBAL SEARCH (Ctrl+/) =====
    let searchOverlay = null;

    function openGlobalSearch() {
      if (searchOverlay) { closeGlobalSearch(); return; }
      searchOverlay = document.createElement('div');
      searchOverlay.className = 'search-overlay';
      searchOverlay.innerHTML =
        '<div class="search-panel">' +
        '  <div class="search-input-wrap">' +
        '    <span class="search-icon">&#128269;</span>' +
        '    <input class="search-input" id="global-search-input" placeholder="Search tasks, notes, logs..." autofocus>' +
        '  </div>' +
        '  <div class="search-results" id="global-search-results">' +
        '    <div class="search-empty">Type to search across all content</div>' +
        '  </div>' +
        '</div>';

      document.body.appendChild(searchOverlay);

      const input = document.getElementById('global-search-input');
      let debounceTimer;
      input.addEventListener('input', () => {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => performGlobalSearch(input.value), 200);
      });
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeGlobalSearch();
      });
      searchOverlay.addEventListener('click', (e) => {
        if (e.target === searchOverlay) closeGlobalSearch();
      });
    }

    function closeGlobalSearch() {
      if (searchOverlay) { searchOverlay.remove(); searchOverlay = null; }
    }

    async function performGlobalSearch(query) {
      const container = document.getElementById('global-search-results');
      if (!container) return;
      if (!query.trim()) {
        container.innerHTML = '<div class="search-empty">Type to search across all content</div>';
        return;
      }

      const q = query.toLowerCase();
      let results = [];

      // Search kanban tasks
      try {
        const resp = await api('/api/kanban');
        const data = await resp.json();
        if (data.columns) {
          data.columns.forEach(col => {
            col.tasks.forEach(task => {
              if (task.title.toLowerCase().includes(q) || (task.description || '').toLowerCase().includes(q)) {
                results.push({
                  type: 'task',
                  title: task.title,
                  context: task.description || col.title,
                  icon: '&#128203;',
                  action: () => { closeGlobalSearch(); navigateTo('kanban'); }
                });
              }
            });
          });
        }
      } catch {}

      // Search notes
      try {
        const resp = await api('/api/notes');
        const notes = await resp.json();
        notes.forEach(note => {
          if (note.title.toLowerCase().includes(q) || (note.content || '').toLowerCase().includes(q)) {
            results.push({
              type: 'note',
              title: note.title,
              context: (note.content || '').substring(0, 100),
              icon: '&#128221;',
              action: () => { closeGlobalSearch(); navigateTo('notes'); }
            });
          }
        });
      } catch {}

      // Search messages
      try {
        const resp = await api('/api/messages');
        const msgs = await resp.json();
        if (Array.isArray(msgs)) {
          msgs.forEach(msg => {
            const text = typeof msg === 'string' ? msg : (msg.message || msg.text || '');
            if (text.toLowerCase().includes(q)) {
              results.push({
                type: 'message',
                title: text.substring(0, 60),
                context: typeof msg === 'object' && msg.timestamp ? new Date(msg.timestamp).toLocaleString() : 'Message',
                icon: '&#128172;',
                action: () => { closeGlobalSearch(); navigateTo('monitor'); }
              });
            }
          });
        }
      } catch {}

      // Search logs
      try {
        const resp = await api('/api/status');
        const data = await resp.json();
        if (data.logs) {
          data.logs.forEach(log => {
            if (log.message.toLowerCase().includes(q)) {
              results.push({
                type: 'log',
                title: log.message.substring(0, 60),
                context: log.type + ' - ' + new Date(log.timestamp).toLocaleString(),
                icon: '&#128196;',
                action: () => { closeGlobalSearch(); navigateTo('monitor'); }
              });
            }
          });
        }
      } catch {}

      if (results.length === 0) {
        container.innerHTML = '<div class="search-empty">No results found for "' + esc(query) + '"</div>';
        return;
      }

      // Group by type
      const grouped = {};
      results.forEach(r => {
        if (!grouped[r.type]) grouped[r.type] = [];
        grouped[r.type].push(r);
      });

      const typeLabels = { task: 'Tasks', note: 'Notes', message: 'Messages', log: 'Logs' };
      let html = '';
      for (const [type, items] of Object.entries(grouped)) {
        html += '<div class="search-result-section">' + (typeLabels[type] || type) + ' (' + items.length + ')</div>';
        items.slice(0, 8).forEach((item, i) => {
          // Highlight query in context
          const highlightedContext = item.context.replace(
            new RegExp('(' + q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + ')', 'gi'),
            '<mark>$1</mark>'
          );
          html += '<div class="search-result-item" data-type="' + type + '" data-idx="' + i + '">' +
            '<span class="search-result-icon">' + item.icon + '</span>' +
            '<div><div class="search-result-title">' + esc(item.title) + '</div>' +
            '<div class="search-result-context">' + highlightedContext + '</div></div></div>';
        });
      }

      container.innerHTML = html;

      // Wire click handlers
      container.querySelectorAll('.search-result-item').forEach((el, i) => {
        el.addEventListener('click', () => {
          if (results[i]) results[i].action();
        });
      });
    }

    // Ctrl+/ or Ctrl+Shift+F or "/" for global search
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === '/') {
        e.preventDefault();
        if (authToken) openGlobalSearch();
      }
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'F') {
        e.preventDefault();
        if (authToken) openGlobalSearch();
      }
      // "/" key opens search (when not in input/textarea)
      if (e.key === '/' && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey) {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
        if (!authToken) return;
        e.preventDefault();
        const headerInput = document.getElementById('header-search-input');
        if (headerInput) { headerInput.focus(); }
      }
    });

    // ===== ANIMATED FAVICON =====
    (function() {
      const canvas = document.createElement('canvas');
      canvas.width = 32; canvas.height = 32;
      const ctx = canvas.getContext('2d');
      const link = document.querySelector('link[rel="icon"]') || document.createElement('link');
      link.rel = 'icon'; link.type = 'image/png';
      if (!link.parentNode) document.head.appendChild(link);
      let hue = 0;
      function drawFavicon() {
        ctx.clearRect(0, 0, 32, 32);
        // Rounded rect background
        ctx.beginPath();
        ctx.roundRect(1, 1, 30, 30, 6);
        ctx.fillStyle = '#0f0f23';
        ctx.fill();
        // Pulsing border
        ctx.strokeStyle = 'hsl(' + hue + ', 70%, 60%)';
        ctx.lineWidth = 2;
        ctx.stroke();
        // "C" letter
        ctx.font = 'bold 20px sans-serif';
        ctx.fillStyle = 'hsl(' + hue + ', 70%, 65%)';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('C', 16, 17);
        link.href = canvas.toDataURL('image/png');
        hue = (hue + 2) % 360;
      }
      setInterval(drawFavicon, 200);
      drawFavicon();
    })();

    // ===== AUTO-SAVE DRAFTS =====
    (function() {
      const fields = [
        { id: 'kanban-task-title', key: 'draft_kanban_title' },
        { id: 'kanban-task-desc', key: 'draft_kanban_desc' },
        { id: 'note-title', key: 'draft_note_title' },
        { id: 'note-content', key: 'draft_note_content' }
      ];
      // Restore drafts on load
      fields.forEach(f => {
        const el = document.getElementById(f.id);
        if (el) {
          const saved = localStorage.getItem(f.key);
          if (saved) el.value = saved;
          el.addEventListener('input', () => {
            localStorage.setItem(f.key, el.value);
          });
        }
      });
      // Clear drafts when forms are submitted
      const origAddTask = window.addTask;
      if (typeof origAddTask === 'function') {
        window.addTask = function() {
          const result = origAddTask.apply(this, arguments);
          localStorage.removeItem('draft_kanban_title');
          localStorage.removeItem('draft_kanban_desc');
          return result;
        };
      }
      const origAddNote = window.addNote;
      if (typeof origAddNote === 'function') {
        window.addNote = function() {
          const result = origAddNote.apply(this, arguments);
          localStorage.removeItem('draft_note_title');
          localStorage.removeItem('draft_note_content');
          return result;
        };
      }
    })();

    // ===== KEYBOARD NAVIGATION =====
    (function() {
      let focusedCard = -1;
      let visibleCards = [];
      document.addEventListener('keydown', (e) => {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') return;
        if (!authToken) return;
        // J/K for up/down card navigation
        if (e.key === 'j' || e.key === 'k') {
          const page = document.querySelector('.page[style*="display: block"], .page.active');
          if (!page) return;
          visibleCards = Array.from(page.querySelectorAll('.card, .kanban-card, .note-card, .sc-table tbody tr'));
          if (!visibleCards.length) return;
          e.preventDefault();
          if (e.key === 'j') focusedCard = Math.min(focusedCard + 1, visibleCards.length - 1);
          else focusedCard = Math.max(focusedCard - 1, 0);
          visibleCards.forEach((c, i) => {
            c.style.outline = i === focusedCard ? '2px solid var(--accent)' : '';
            c.style.outlineOffset = i === focusedCard ? '2px' : '';
          });
          visibleCards[focusedCard]?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        // Enter to open focused card link
        if (e.key === 'Enter' && focusedCard >= 0 && visibleCards[focusedCard]) {
          const link = visibleCards[focusedCard].querySelector('a');
          if (link) link.click();
        }
      });
    })();

    // ===== SITE SPEED METRICS =====
    (function() {
      if (!window.performance) return;
      setTimeout(() => {
        const perf = performance.getEntriesByType('navigation')[0];
        if (!perf) return;
        const loadTime = Math.round(perf.loadEventEnd - perf.startTime);
        const domReady = Math.round(perf.domContentLoadedEventEnd - perf.startTime);
        const footer = document.querySelector('.footer');
        if (footer && loadTime > 0) {
          const span = document.createElement('span');
          span.style.cssText = 'margin-left:12px;font-size:0.65rem;color:var(--text-tertiary);opacity:0.5;';
          span.textContent = 'DOM: ' + domReady + 'ms | Load: ' + loadTime + 'ms';
          footer.appendChild(span);
        }
      }, 2000);
    })();

    // ===== HEADER SEARCH BAR =====
    (function() {
      const searchInput = document.getElementById('header-search-input');
      const dropdown = document.getElementById('header-search-dropdown');
      if (!searchInput || !dropdown) return;

      let hSearchDebounce;
      let hSearchResults = [];

      searchInput.addEventListener('focus', () => {
        const kbd = document.querySelector('.header-search-kbd');
        if (kbd) kbd.style.display = 'none';
      });
      searchInput.addEventListener('blur', () => {
        const kbd = document.querySelector('.header-search-kbd');
        if (kbd) kbd.style.display = '';
        // Delay closing so click events on results fire
        setTimeout(() => { dropdown.classList.remove('visible'); }, 200);
      });
      searchInput.addEventListener('input', () => {
        clearTimeout(hSearchDebounce);
        hSearchDebounce = setTimeout(() => headerSearch(searchInput.value), 250);
      });
      searchInput.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          searchInput.blur();
          searchInput.value = '';
          dropdown.classList.remove('visible');
        }
      });

      async function headerSearch(query) {
        if (!query.trim() || !authToken) {
          dropdown.classList.remove('visible');
          return;
        }
        const q = query.toLowerCase();
        hSearchResults = [];

        // Search kanban
        try {
          if (kanbanData && kanbanData.columns) {
            kanbanData.columns.forEach(col => {
              col.tasks.forEach(task => {
                if (task.title.toLowerCase().includes(q) || (task.description || '').toLowerCase().includes(q)) {
                  hSearchResults.push({ type: 'task', title: task.title, context: col.title, icon: '&#128203;', page: 'kanban', taskId: task.id });
                }
              });
            });
          }
        } catch {}

        // Search notes
        try {
          if (notesData && notesData.length) {
            notesData.forEach(note => {
              if (note.title.toLowerCase().includes(q) || (note.content || '').toLowerCase().includes(q)) {
                hSearchResults.push({ type: 'note', title: note.title, context: (note.content || '').substring(0, 80), icon: '&#128221;', page: 'notes', noteId: note.id });
              }
            });
          }
        } catch {}

        // Search messages
        try {
          const resp = await api('/api/messages');
          const msgs = await resp.json();
          if (Array.isArray(msgs)) {
            msgs.forEach(msg => {
              const text = typeof msg === 'string' ? msg : (msg.message || msg.text || '');
              if (text.toLowerCase().includes(q)) {
                hSearchResults.push({ type: 'message', title: text.substring(0, 60), context: typeof msg === 'object' && msg.timestamp ? new Date(msg.timestamp).toLocaleString() : 'Message', icon: '&#128172;', page: 'monitor' });
              }
            });
          }
        } catch {}

        if (hSearchResults.length === 0) {
          dropdown.innerHTML = '<div class="search-empty" style="padding:14px;font-size:0.78rem;">No results for "' + esc(query) + '"</div>';
          dropdown.classList.add('visible');
          return;
        }

        // Group by type
        const grouped = {};
        hSearchResults.forEach(r => { if (!grouped[r.type]) grouped[r.type] = []; grouped[r.type].push(r); });
        const labels = { task: 'Tasks', note: 'Notes', message: 'Messages' };
        let html = '';
        let flatIdx = 0;
        for (const [type, items] of Object.entries(grouped)) {
          html += '<div class="search-result-section">' + (labels[type] || type) + '</div>';
          items.slice(0, 5).forEach(item => {
            html += '<div class="search-result-item" data-flat-idx="' + flatIdx + '">' +
              '<span class="search-result-icon">' + item.icon + '</span>' +
              '<div><div class="search-result-title">' + esc(item.title) + '</div>' +
              '<div class="search-result-context">' + esc(item.context) + '</div></div></div>';
            flatIdx++;
          });
        }
        dropdown.innerHTML = html;
        dropdown.classList.add('visible');

        // Build flat list for click handling
        const flatList = [];
        for (const items of Object.values(grouped)) {
          items.slice(0, 5).forEach(item => flatList.push(item));
        }
        dropdown.querySelectorAll('.search-result-item').forEach((el, i) => {
          el.addEventListener('mousedown', (ev) => {
            ev.preventDefault();
            const r = flatList[i];
            if (r) {
              navigateTo(r.page);
              searchInput.value = '';
              dropdown.classList.remove('visible');
              // Try to highlight/scroll to item
              setTimeout(() => {
                if (r.taskId) {
                  const taskEl = document.querySelector('[data-task-id="' + r.taskId + '"]');
                  if (taskEl) { taskEl.scrollIntoView({ behavior: 'smooth', block: 'center' }); taskEl.style.outline = '2px solid var(--accent)'; setTimeout(() => taskEl.style.outline = '', 2000); }
                }
                if (r.noteId) {
                  const noteEl = document.querySelector('[data-note-id="' + r.noteId + '"]');
                  if (noteEl) { noteEl.scrollIntoView({ behavior: 'smooth', block: 'center' }); noteEl.style.outline = '2px solid var(--accent)'; setTimeout(() => noteEl.style.outline = '', 2000); }
                }
              }, 300);
              // Track for badges
              checkBadge('explorer_search');
            }
          });
        });
      }
    })();

    // ===== ACHIEVEMENT BADGES SYSTEM =====
    (function() {
      const BADGE_DEFS = [
        { id: 'first_task', emoji: '&#127941;', name: 'First Task', desc: 'Create your first task', check: () => { try { return kanbanData && kanbanData.columns && kanbanData.columns.reduce((s,c) => s + c.tasks.length, 0) >= 1; } catch { return false; } } },
        { id: 'task_master', emoji: '&#127942;', name: 'Task Master', desc: 'Complete 10 tasks', check: () => { try { return kanbanData && kanbanData.columns && (kanbanData.columns.find(c => c.id === 'done')?.tasks.length || 0) >= 10; } catch { return false; } } },
        { id: 'centurion', emoji: '&#128081;', name: 'Centurion', desc: 'Complete 100 tasks', check: () => { try { return kanbanData && kanbanData.columns && (kanbanData.columns.find(c => c.id === 'done')?.tasks.length || 0) >= 100; } catch { return false; } } },
        { id: 'note_taker', emoji: '&#128221;', name: 'Note Taker', desc: 'Create 5 notes', check: () => { try { return notesData && notesData.length >= 5; } catch { return false; } } },
        { id: 'music_lover', emoji: '&#127925;', name: 'Music Lover', desc: 'Visit the SoundCloud page', check: () => badgeFlags.music_lover === true },
        { id: 'dungeon_crawler', emoji: '&#128121;', name: 'Dungeon Crawler', desc: 'Enter the dungeon', check: () => badgeFlags.dungeon_crawler === true },
        { id: 'night_owl', emoji: '&#129417;', name: 'Night Owl', desc: 'Use the app after midnight', check: () => { const h = new Date().getHours(); return h >= 0 && h < 5; } },
        { id: 'speed_demon', emoji: '&#9889;', name: 'Speed Demon', desc: 'Complete a task within 1 min', check: () => badgeFlags.speed_demon === true },
        { id: 'explorer', emoji: '&#127757;', name: 'Explorer', desc: 'Visit all pages', check: () => { const visited = JSON.parse(localStorage.getItem('badge_pages_visited') || '[]'); return ['monitor','kanban','notes','tools','gallery','soundcloud'].every(p => visited.includes(p)); } }
      ];

      // Persistent state
      let unlockedBadges = JSON.parse(localStorage.getItem('unlocked_badges') || '[]');
      window.badgeFlags = JSON.parse(localStorage.getItem('badge_flags') || '{}');

      function saveBadges() { localStorage.setItem('unlocked_badges', JSON.stringify(unlockedBadges)); }
      function saveFlags() { localStorage.setItem('badge_flags', JSON.stringify(badgeFlags)); }

      // Show badge toast notification
      function showBadgeToast(badge) {
        const toastEl = document.createElement('div');
        toastEl.className = 'badge-toast';
        toastEl.innerHTML = '<span class="badge-toast-emoji">' + badge.emoji + '</span>' +
          '<div><div class="badge-toast-label">Achievement Unlocked!</div>' +
          '<div class="badge-toast-text">' + badge.name + '</div></div>';
        document.body.appendChild(toastEl);
        setTimeout(() => toastEl.remove(), 3200);
      }

      // Unlock a badge
      function unlock(badgeId) {
        if (unlockedBadges.includes(badgeId)) return;
        unlockedBadges.push(badgeId);
        saveBadges();
        const badge = BADGE_DEFS.find(b => b.id === badgeId);
        if (badge) showBadgeToast(badge);
        updateBadgeUI();
      }

      // Check and unlock badges
      window.checkBadge = function(flag) {
        if (flag) { badgeFlags[flag] = true; saveFlags(); }
        BADGE_DEFS.forEach(badge => {
          if (!unlockedBadges.includes(badge.id) && badge.check()) {
            unlock(badge.id);
          }
        });
      };

      // Update the header badge counter and popup
      function updateBadgeUI() {
        const counter = document.getElementById('badge-counter');
        if (counter) counter.textContent = unlockedBadges.length + '/' + BADGE_DEFS.length;

        const popup = document.getElementById('badge-popup');
        if (!popup) return;
        let html = '<div class="badge-popup-title">Achievements</div><div class="badge-grid">';
        BADGE_DEFS.forEach(badge => {
          const isUnlocked = unlockedBadges.includes(badge.id);
          html += '<div class="badge-item ' + (isUnlocked ? 'unlocked' : 'locked') + '">' +
            '<span class="badge-emoji">' + badge.emoji + '</span>' +
            '<div class="badge-info"><div class="badge-name">' + badge.name + '</div>' +
            '<div class="badge-desc">' + badge.desc + '</div></div></div>';
        });
        html += '</div>';
        popup.innerHTML = html;
      }

      // Toggle popup
      const badgeBtn = document.getElementById('badge-btn');
      const badgePopup = document.getElementById('badge-popup');
      if (badgeBtn && badgePopup) {
        badgeBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          badgePopup.classList.toggle('visible');
          checkBadge(); // Re-check when opening
        });
        document.addEventListener('click', (e) => {
          if (!badgePopup.contains(e.target) && e.target !== badgeBtn) {
            badgePopup.classList.remove('visible');
          }
        });
      }

      // Track page visits for Explorer badge
      _navHooks.push(function(page) {
        let visited = JSON.parse(localStorage.getItem('badge_pages_visited') || '[]');
        if (!visited.includes(page)) { visited.push(page); localStorage.setItem('badge_pages_visited', JSON.stringify(visited)); }
        if (page === 'soundcloud') checkBadge('music_lover');
        checkBadge();
      });

      // Track dungeon for Dungeon Crawler badge
      const _origToggleDungeon = window.toggleDungeon;
      if (_origToggleDungeon) {
        window.toggleDungeon = function() {
          _origToggleDungeon();
          checkBadge('dungeon_crawler');
        };
      }

      // Track task completion speed for Speed Demon
      const _origMoveTaskForBadge = moveTask;
      moveTask = async function(taskId, targetColumnId) {
        await _origMoveTaskForBadge(taskId, targetColumnId);
        if (targetColumnId === 'done') {
          // Check if task was created recently (within 1 minute)
          if (kanbanData && kanbanData.columns) {
            for (const col of kanbanData.columns) {
              const task = col.tasks.find(t => t.id === taskId);
              if (task && task.createdAt) {
                const elapsed = Date.now() - new Date(task.createdAt).getTime();
                if (elapsed < 60000) checkBadge('speed_demon');
              }
            }
          }
          checkBadge();
        }
      };

      // Run checks periodically and on init
      updateBadgeUI();
      setInterval(() => { if (authToken) checkBadge(); }, 30000);
      // Night owl check
      setTimeout(() => checkBadge(), 2000);
    })();

    // ===== ZEN MODE (Z key) =====
    (function() {
      document.addEventListener('keydown', (e) => {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
        if (!authToken) return;
        if (e.key === 'z' || e.key === 'Z') {
          if (e.ctrlKey || e.metaKey || e.altKey || e.shiftKey) return;
          e.preventDefault();
          document.body.classList.toggle('zen-mode');
          toast(document.body.classList.contains('zen-mode') ? 'Zen mode ON - press Z to exit' : 'Zen mode OFF');
        }
      });
    })();

    // ===== CUSTOM CSS INJECTION =====
    (function() {
      const customStyleEl = document.createElement('style');
      customStyleEl.id = 'custom-user-css';
      document.head.appendChild(customStyleEl);

      // Load saved CSS on init
      const savedCSS = localStorage.getItem('custom_user_css') || '';
      if (savedCSS) {
        customStyleEl.textContent = savedCSS;
      }

      const textarea = document.getElementById('custom-css-textarea');
      const applyBtn = document.getElementById('custom-css-apply');
      const clearBtn = document.getElementById('custom-css-clear');

      if (textarea) {
        textarea.value = savedCSS;

        // Ctrl+Enter to apply
        textarea.addEventListener('keydown', (e) => {
          if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
            e.preventDefault();
            applyCustomCSS();
          }
          // Tab key inserts spaces
          if (e.key === 'Tab') {
            e.preventDefault();
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            textarea.value = textarea.value.substring(0, start) + '  ' + textarea.value.substring(end);
            textarea.selectionStart = textarea.selectionEnd = start + 2;
          }
        });
      }

      function applyCustomCSS() {
        if (!textarea) return;
        const css = textarea.value;
        customStyleEl.textContent = css;
        localStorage.setItem('custom_user_css', css);
        toast('Custom CSS applied');
      }

      function clearCustomCSS() {
        if (!textarea) return;
        textarea.value = '';
        customStyleEl.textContent = '';
        localStorage.removeItem('custom_user_css');
        toast('Custom CSS cleared');
      }

      if (applyBtn) applyBtn.addEventListener('click', applyCustomCSS);
      if (clearBtn) clearBtn.addEventListener('click', clearCustomCSS);
    })();

    // ===== USER PREFERENCES PANEL =====
    (function() {
      const INTERVAL_STEPS = [5, 10, 15, 30, 60];
      const DEFAULT_PREFS = {
        autoRefresh: true,
        refreshInterval: 15,
        notifSounds: false,
        confetti: true,
        theme: 'dark'
      };

      function loadPrefs() {
        try {
          const saved = JSON.parse(localStorage.getItem('user_prefs'));
          return Object.assign({}, DEFAULT_PREFS, saved || {});
        } catch { return Object.assign({}, DEFAULT_PREFS); }
      }

      function savePrefs(prefs) {
        localStorage.setItem('user_prefs', JSON.stringify(prefs));
      }

      window._userPrefs = loadPrefs();

      // Sync theme pref with existing monitor_theme
      const currentTheme = localStorage.getItem('monitor_theme') || 'dark';
      window._userPrefs.theme = currentTheme;

      function updateToggleUI() {
        const prefs = window._userPrefs;
        const autoEl = document.getElementById('pref-autorefresh');
        const soundsEl = document.getElementById('pref-sounds');
        const confettiEl = document.getElementById('pref-confetti');
        const themeEl = document.getElementById('pref-theme');

        if (autoEl) autoEl.classList.toggle('on', prefs.autoRefresh);
        if (soundsEl) soundsEl.classList.toggle('on', prefs.notifSounds);
        if (confettiEl) confettiEl.classList.toggle('on', prefs.confetti);
        if (themeEl) themeEl.classList.toggle('on', prefs.theme === 'light');

        // Interval slider
        const slider = document.getElementById('pref-interval-slider');
        const valEl = document.getElementById('pref-interval-val');
        if (slider && valEl) {
          const idx = INTERVAL_STEPS.indexOf(prefs.refreshInterval);
          slider.value = idx >= 0 ? idx : 2;
          valEl.textContent = prefs.refreshInterval + 's';
        }
      }

      updateToggleUI();

      // Toggle handler for all pref toggles
      document.querySelectorAll('.pref-toggle').forEach(el => {
        el.addEventListener('click', () => {
          const pref = el.dataset.pref;
          if (pref === 'theme') {
            const newTheme = window._userPrefs.theme === 'dark' ? 'light' : 'dark';
            window._userPrefs.theme = newTheme;
            setTheme(newTheme);
          } else if (pref === 'autoRefresh') {
            window._userPrefs.autoRefresh = !window._userPrefs.autoRefresh;
            applyAutoRefresh();
          } else if (pref === 'notifSounds') {
            window._userPrefs.notifSounds = !window._userPrefs.notifSounds;
          } else if (pref === 'confetti') {
            window._userPrefs.confetti = !window._userPrefs.confetti;
          }
          savePrefs(window._userPrefs);
          updateToggleUI();
        });
      });

      // Interval slider
      const slider = document.getElementById('pref-interval-slider');
      if (slider) {
        slider.addEventListener('input', () => {
          const val = INTERVAL_STEPS[parseInt(slider.value)] || 15;
          window._userPrefs.refreshInterval = val;
          document.getElementById('pref-interval-val').textContent = val + 's';
          savePrefs(window._userPrefs);
          applyAutoRefresh();
        });
      }

      // Auto-refresh management
      let autoRefreshTimer = null;
      function applyAutoRefresh() {
        if (autoRefreshTimer) { clearInterval(autoRefreshTimer); autoRefreshTimer = null; }
        if (window._userPrefs.autoRefresh && authToken) {
          const ms = (window._userPrefs.refreshInterval || 15) * 1000;
          autoRefreshTimer = setInterval(() => {
            if (typeof fetchStatus === 'function') fetchStatus();
          }, ms);
        }
      }
      // Start auto-refresh after a brief delay (dashboard may not be shown yet)
      setTimeout(applyAutoRefresh, 2000);

      // Gear button toggle
      const gearBtn = document.getElementById('prefs-gear-btn');
      const prefsPanel = document.getElementById('prefs-panel');
      if (gearBtn && prefsPanel) {
        gearBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          updateToggleUI();
          prefsPanel.classList.toggle('visible');
        });
        document.addEventListener('click', (e) => {
          if (!prefsPanel.contains(e.target) && e.target !== gearBtn) {
            prefsPanel.classList.remove('visible');
          }
        });
      }

      // Patch confetti to respect pref
      const _origFireConfetti = typeof fireConfetti === 'function' ? fireConfetti : null;
      if (_origFireConfetti) {
        window.fireConfetti = function() {
          if (window._userPrefs && window._userPrefs.confetti) {
            _origFireConfetti();
          }
        };
        // Also update global reference if used directly
        fireConfetti = window.fireConfetti;
      }

      // Notification sound helper
      window.playNotifSound = function() {
        if (!window._userPrefs || !window._userPrefs.notifSounds) return;
        try {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = 880;
          osc.type = 'sine';
          gain.gain.value = 0.1;
          gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.3);
          osc.start();
          osc.stop(ctx.currentTime + 0.3);
        } catch {}
      };

      // Patch addNotification to play sound
      if (typeof addNotification === 'function') {
        const _origAddNotification = addNotification;
        addNotification = function(title, type) {
          _origAddNotification(title, type);
          window.playNotifSound();
        };
      }
    })();

    // ===== BOOKMARKS / STARRED ITEMS =====
    (function() {
      const STAR_KEY = 'starred_items';
      function getStarred() {
        try { return JSON.parse(localStorage.getItem(STAR_KEY)) || {}; } catch { return {}; }
      }
      function setStarred(data) {
        localStorage.setItem(STAR_KEY, JSON.stringify(data));
      }

      window.toggleStar = function(type, id) {
        const starred = getStarred();
        const key = type + ':' + id;
        if (starred[key]) { delete starred[key]; } else { starred[key] = true; }
        setStarred(starred);
        // Re-render to update star state
        if (type === 'task' && typeof renderKanban === 'function') renderKanban();
        if (type === 'note' && typeof fetchNotes === 'function') fetchNotes();
      };

      window.isStarred = function(type, id) {
        const starred = getStarred();
        return !!starred[type + ':' + id];
      };

      window.getStarredIds = function(type) {
        const starred = getStarred();
        const ids = [];
        const prefix = type + ':';
        Object.keys(starred).forEach(k => {
          if (k.startsWith(prefix) && starred[k]) ids.push(k.substring(prefix.length));
        });
        return ids;
      };

      // Kanban starred filter
      let kanbanStarredOnly = false;
      window.toggleKanbanStarredFilter = function() {
        kanbanStarredOnly = !kanbanStarredOnly;
        const btn = document.getElementById('kanban-starred-filter');
        if (btn) btn.classList.toggle('active', kanbanStarredOnly);
        if (typeof renderKanban === 'function') renderKanban();
      };

      // Notes starred filter
      let notesStarredOnly = false;
      window.toggleNotesStarredFilter = function() {
        notesStarredOnly = !notesStarredOnly;
        const btn = document.getElementById('notes-starred-filter');
        if (btn) btn.classList.toggle('active', notesStarredOnly);
        if (typeof fetchNotes === 'function') fetchNotes();
      };

      // Override renderKanban to inject star buttons and filter starred
      const _starOrigRenderKanban = renderKanban;
      renderKanban = function() {
        // If starred filter is active, temporarily filter tasks
        if (kanbanStarredOnly && kanbanData && kanbanData.columns) {
          const starredIds = getStarredIds('task');
          const origColumns = kanbanData.columns.map(col => ({...col, tasks: [...col.tasks]}));
          kanbanData.columns.forEach(col => {
            col.tasks = col.tasks.filter(t => starredIds.includes(t.id));
          });
          _starOrigRenderKanban();
          // Restore original data
          kanbanData.columns.forEach((col, i) => { col.tasks = origColumns[i].tasks; });
        } else {
          _starOrigRenderKanban();
        }
        // Add star buttons to all task cards
        document.querySelectorAll('.kanban-task-card').forEach(card => {
          const taskId = card.dataset.taskId;
          if (!taskId || card.querySelector('.star-btn')) return;
          const starred = isStarred('task', taskId);
          const starBtn = document.createElement('button');
          starBtn.className = 'star-btn' + (starred ? ' starred' : '');
          starBtn.innerHTML = starred ? '&#9733;' : '&#9734;';
          starBtn.title = starred ? 'Unstar' : 'Star';
          starBtn.onclick = function(e) {
            e.stopPropagation();
            toggleStar('task', taskId);
          };
          // Insert star at top-right of card, next to delete
          const deleteBtn = card.querySelector('.kanban-task-delete');
          if (deleteBtn) {
            card.insertBefore(starBtn, deleteBtn);
          } else {
            card.insertBefore(starBtn, card.firstChild);
          }
        });
      };

      // Override fetchNotes to inject star buttons and filter starred
      const _starOrigFetchNotes = fetchNotes;
      fetchNotes = async function() {
        await _starOrigFetchNotes();
        // If starred filter is active, hide non-starred notes
        if (notesStarredOnly) {
          const starredIds = getStarredIds('note');
          document.querySelectorAll('.note-card').forEach(card => {
            const noteId = card.id.replace('note-', '');
            if (!starredIds.includes(noteId)) {
              card.style.display = 'none';
            }
          });
        }
        // Add star buttons to all note cards
        document.querySelectorAll('.note-card').forEach(card => {
          const noteId = card.id.replace('note-', '');
          if (!noteId || card.querySelector('.star-btn')) return;
          const starred = isStarred('note', noteId);
          const starBtn = document.createElement('button');
          starBtn.className = 'star-btn' + (starred ? ' starred' : '');
          starBtn.innerHTML = starred ? '&#9733;' : '&#9734;';
          starBtn.title = starred ? 'Unstar' : 'Star';
          starBtn.onclick = function(e) {
            e.stopPropagation();
            toggleStar('note', noteId);
          };
          // Insert star in header area
          const header = card.querySelector('.note-card-header');
          if (header) {
            header.style.display = 'flex';
            header.style.alignItems = 'flex-start';
            header.insertBefore(starBtn, header.firstChild);
          }
        });
      };
    })();

    // ===== NOTE TEMPLATES =====
    (function() {
      const TEMPLATES = {
        meeting: {
          title: 'Meeting Notes',
          content: '## Attendees\n- \n\n## Agenda\n1. \n\n## Discussion\n- \n\n## Action Items\n- [ ] \n- [ ] \n\n## Next Meeting\n- Date: \n- Topic: '
        },
        bug: {
          title: 'Bug Report',
          content: '## Bug Description\n\n\n## Steps to Reproduce\n1. \n2. \n3. \n\n## Expected Behavior\n\n\n## Actual Behavior\n\n\n## Environment\n- OS: \n- Browser: \n- Version: \n\n## Screenshots\n\n\n## Priority\n- [ ] Critical\n- [ ] High\n- [ ] Medium\n- [ ] Low'
        },
        daily: {
          title: 'Daily Log - ' + new Date().toLocaleDateString([], { month: 'short', day: 'numeric', year: 'numeric' }),
          content: '## Completed Today\n- \n\n## In Progress\n- \n\n## Blocked\n- \n\n## Tomorrow\'s Plan\n- \n\n## Notes\n'
        },
        idea: {
          title: 'Project Idea',
          content: '## Project Name\n\n\n## Problem Statement\nWhat problem does this solve?\n\n\n## Proposed Solution\n\n\n## Key Features\n1. \n2. \n3. \n\n## Tech Stack\n- \n\n## Estimated Effort\n- [ ] Small (hours)\n- [ ] Medium (days)\n- [ ] Large (weeks)\n\n## Next Steps\n- [ ] '
        },
        snippet: {
          title: 'Code Snippet',
          content: '## Language\n\n\n## Description\nWhat does this code do?\n\n\n## Code\n```\n\n```\n\n## Usage Example\n```\n\n```\n\n## Notes\n'
        }
      };

      const selector = document.getElementById('note-template-select');
      if (selector) {
        selector.addEventListener('change', () => {
          const tmpl = TEMPLATES[selector.value];
          if (!tmpl) return;
          const titleInput = document.getElementById('note-title');
          const contentInput = document.getElementById('note-content');
          if (titleInput) titleInput.value = tmpl.title;
          if (contentInput) contentInput.value = tmpl.content;
          selector.value = ''; // reset dropdown
        });
      }
    })();

    // ===== RECURRING TASKS =====
    (function() {
      // Patch addKanbanTask to include recurrence tag
      const _recurOrigAddKanban = addKanbanTask;
      addKanbanTask = async function() {
        const recurSelect = document.getElementById('kanban-task-recur');
        const recurVal = recurSelect ? recurSelect.value : 'none';

        // Temporarily inject recurrence tag into description
        if (recurVal !== 'none') {
          const descInput = document.getElementById('kanban-task-desc');
          const origDesc = descInput.value;
          descInput.value = '[RECUR:' + recurVal + '] ' + origDesc;
          await _recurOrigAddKanban();
          descInput.value = origDesc;
        } else {
          await _recurOrigAddKanban();
        }
        // Reset recurrence selector
        if (recurSelect) recurSelect.value = 'none';
      };

      // Patch renderKanban to show recurrence badges
      const _recurOrigRenderKanban = renderKanban;
      renderKanban = function() {
        _recurOrigRenderKanban();
        document.querySelectorAll('.kanban-task-card').forEach(card => {
          const descEl = card.querySelector('.kanban-task-desc');
          if (!descEl) return;
          let text = descEl.textContent || descEl.innerText;
          const recurMatch = text.match(/\[RECUR:(daily|weekly|monthly)\]/);
          if (recurMatch) {
            const freq = recurMatch[1];
            const icons = { daily: '&#128260;', weekly: '&#128197;', monthly: '&#128198;' };
            // Remove tag from displayed text
            text = text.replace(/\[RECUR:(daily|weekly|monthly)\]\s*/g, '');
            if (descEl.childNodes.length <= 1 && !descEl.querySelector('.kanban-check')) {
              descEl.textContent = text;
            }
            // Add recurrence badge if not already present
            if (!card.querySelector('.recur-badge')) {
              const badge = document.createElement('div');
              badge.className = 'recur-badge';
              badge.innerHTML = icons[freq] + ' ' + freq.charAt(0).toUpperCase() + freq.slice(1);
              // Insert after desc or at end
              const actions = card.querySelector('.kanban-task-actions');
              if (actions) {
                card.insertBefore(badge, actions);
              } else {
                card.appendChild(badge);
              }
            }
            if (!text.trim() && !descEl.innerHTML.includes('kanban-check')) {
              descEl.style.display = 'none';
            }
          }
        });
      };
    })();

    // ===== CODE SYNTAX HIGHLIGHTER =====
    (function() {
      const LANG_KEYWORDS = {
        js: /\b(const|let|var|function|return|if|else|for|while|do|switch|case|break|continue|new|this|class|extends|import|export|from|default|try|catch|finally|throw|async|await|typeof|instanceof|in|of|null|undefined|true|false|yield|delete|void|super|static|get|set|constructor)\b/g,
        javascript: null,
        python: /\b(def|class|if|elif|else|for|while|return|import|from|as|try|except|finally|raise|with|yield|lambda|pass|break|continue|and|or|not|in|is|None|True|False|self|global|nonlocal|async|await|print|range|len|type|int|str|list|dict|set|tuple)\b/g,
        py: null,
        css: /\b(color|background|border|margin|padding|display|position|width|height|font|flex|grid|align|justify|transform|transition|animation|opacity|overflow|z-index|top|left|right|bottom|content|cursor|outline|box-shadow|text-align|line-height|letter-spacing|white-space|max-width|min-width|max-height|min-height|important|none|auto|inherit|initial|solid|dashed|dotted|relative|absolute|fixed|sticky|block|inline|inline-block|nowrap|center|hover|focus|active|before|after|root|var)\b/g,
        html: /\b(div|span|button|input|form|select|option|label|textarea|table|thead|tbody|tr|td|th|ul|ol|li|a|p|h1|h2|h3|h4|h5|h6|img|canvas|svg|section|header|footer|nav|main|article|aside|head|body|html|meta|link|script|style|class|id|href|src|alt|type|value|name|placeholder|onclick|onchange)\b/g,
        bash: /\b(echo|cd|ls|mkdir|rm|cp|mv|cat|grep|sed|awk|find|chmod|chown|sudo|apt|npm|node|git|docker|curl|wget|export|source|if|then|else|fi|for|do|done|while|case|esac|function|return|exit|true|false|null)\b/g,
        sh: null,
        json: null,
        typescript: null,
        ts: null
      };
      LANG_KEYWORDS.javascript = LANG_KEYWORDS.js;
      LANG_KEYWORDS.py = LANG_KEYWORDS.python;
      LANG_KEYWORDS.sh = LANG_KEYWORDS.bash;
      LANG_KEYWORDS.typescript = LANG_KEYWORDS.js;
      LANG_KEYWORDS.ts = LANG_KEYWORDS.js;

      function tokenize(code, lang) {
        let html = code.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        // Comments
        html = html.replace(/(\/\/.*$|#.*$)/gm, '<span class="token-comment">$1</span>');
        html = html.replace(/(\/\*[\s\S]*?\*\/)/g, '<span class="token-comment">$1</span>');
        // Strings
        html = html.replace(/(?<!class=)("(?:[^"\\]|\\.)*")/g, '<span class="token-string">$1</span>');
        html = html.replace(/('(?:[^'\\]|\\.)*')/g, '<span class="token-string">$1</span>');
        html = html.replace(/(`(?:[^`\\]|\\.)*`)/g, '<span class="token-string">$1</span>');
        // Numbers
        html = html.replace(/\b(\d+\.?\d*)\b/g, '<span class="token-number">$1</span>');
        // Keywords
        const kwRegex = LANG_KEYWORDS[lang] || LANG_KEYWORDS.js;
        if (kwRegex) {
          const re = new RegExp(kwRegex.source, kwRegex.flags);
          html = html.replace(re, '<span class="token-keyword">$1</span>');
        }
        return html;
      }

      // Monkey-patch renderMarkdown to handle code blocks
      const _origRenderMarkdownForCode = renderMarkdown;
      renderMarkdown = function(text) {
        if (!text) return '';
        const codeBlocks = [];
        let processed = text.replace(/```(\w*)\n?([\s\S]*?)```/g, function(match, lang, code) {
          const idx = codeBlocks.length;
          const trimmed = code.replace(/^\n+|\n+$/g, '');
          const langLabel = lang || '';
          const highlighted = tokenize(trimmed, langLabel.toLowerCase());
          codeBlocks.push(
            '<div class="code-block">' +
            (langLabel ? '<span class="code-block-lang">' + langLabel + '</span>' : '') +
            highlighted + '</div>'
          );
          return '\x00CODEBLOCK_' + idx + '\x00';
        });
        let html = _origRenderMarkdownForCode(processed);
        codeBlocks.forEach(function(block, i) {
          html = html.replace('\x00CODEBLOCK_' + i + '\x00', block);
        });
        return html;
      };
    })();

    // ===== KANBAN TASK TEMPLATES =====
    (function() {
      const KANBAN_TEMPLATES = {
        bugfix: {
          title: 'Bug Fix: ',
          description: '## Problem\n\n\n## Steps to Reproduce\n1. \n2. \n3. \n\n## Expected Behavior\n\n\n## Fix Description\n\n\n## Testing\n- [ ] Unit tests pass\n- [ ] Manual testing done'
        },
        feature: {
          title: 'Feature: ',
          description: '## Description\n\n\n## User Story\nAs a user, I want to...\n\n## Acceptance Criteria\n- [ ] \n- [ ] \n- [ ] \n\n## Technical Notes\n'
        },
        refactor: {
          title: 'Refactor: ',
          description: '## Current State\n\n\n## Desired State\n\n\n## Changes Needed\n- [ ] \n- [ ] \n\n## Risk Assessment\n- Breaking changes: \n- Performance impact: \n\n## Testing Plan\n- [ ] Existing tests pass\n- [ ] New edge cases covered'
        },
        docs: {
          title: 'Docs: ',
          description: '## Scope\n\n\n## Sections to Update\n- [ ] README\n- [ ] API docs\n- [ ] Inline comments\n- [ ] User guide\n\n## Notes\n'
        },
        testing: {
          title: 'Test: ',
          description: '## Test Type\n- [ ] Unit test\n- [ ] Integration test\n- [ ] E2E test\n\n## What to Test\n\n\n## Test Cases\n- [ ] Happy path\n- [ ] Edge cases\n- [ ] Error handling\n\n## Coverage Target\n'
        }
      };

      const selector = document.getElementById('kanban-template-select');
      if (selector) {
        selector.addEventListener('change', function() {
          const tmpl = KANBAN_TEMPLATES[selector.value];
          if (!tmpl) return;
          const titleInput = document.getElementById('kanban-task-title');
          const descInput = document.getElementById('kanban-task-desc');
          if (titleInput) titleInput.value = tmpl.title;
          if (descInput) descInput.value = tmpl.description;
          selector.value = '';
          if (titleInput) titleInput.focus();
        });
      }
    })();

    // ===== QR CODE GENERATOR =====
    (function() {
      function generateQR(text, size) {
        size = size || 200;
        const canvas = document.createElement('canvas');
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        const modules = 25;
        const cellSize = size / modules;

        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, size, size);

        function hashChar(str, i) {
          let h = 0;
          for (let j = 0; j < str.length; j++) {
            h = ((h << 5) - h + str.charCodeAt(j) * (i + j + 1)) | 0;
          }
          return h;
        }

        function drawFinderPattern(x, y) {
          ctx.fillStyle = '#000000';
          ctx.fillRect(x * cellSize, y * cellSize, 7 * cellSize, 7 * cellSize);
          ctx.fillStyle = '#ffffff';
          ctx.fillRect((x + 1) * cellSize, (y + 1) * cellSize, 5 * cellSize, 5 * cellSize);
          ctx.fillStyle = '#000000';
          ctx.fillRect((x + 2) * cellSize, (y + 2) * cellSize, 3 * cellSize, 3 * cellSize);
        }

        drawFinderPattern(0, 0);
        drawFinderPattern(modules - 7, 0);
        drawFinderPattern(0, modules - 7);

        // Timing patterns
        ctx.fillStyle = '#000000';
        for (let i = 8; i < modules - 8; i++) {
          if (i % 2 === 0) {
            ctx.fillRect(i * cellSize, 6 * cellSize, cellSize, cellSize);
            ctx.fillRect(6 * cellSize, i * cellSize, cellSize, cellSize);
          }
        }

        // Data encoding
        const dataBytes = [];
        for (let i = 0; i < text.length; i++) {
          dataBytes.push(text.charCodeAt(i));
        }

        ctx.fillStyle = '#000000';
        let byteIdx = 0;
        let bitIdx = 0;
        for (let row = modules - 1; row >= 0; row--) {
          for (let col = modules - 1; col >= 0; col--) {
            if ((row < 9 && col < 9) || (row < 9 && col > modules - 9) || (row > modules - 9 && col < 9)) continue;
            if (row === 6 || col === 6) continue;
            let bit;
            if (byteIdx < dataBytes.length) {
              bit = (dataBytes[byteIdx] >> (7 - bitIdx)) & 1;
              bitIdx++;
              if (bitIdx >= 8) { bitIdx = 0; byteIdx++; }
            } else {
              bit = ((hashChar(text, row * modules + col) & 0xff) > 127) ? 1 : 0;
            }
            const mask = (row + col) % 2 === 0 ? 1 : 0;
            if (bit ^ mask) {
              ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
            }
          }
        }
        return canvas;
      }

      function showQRModal(title) {
        const overlay = document.createElement('div');
        overlay.className = 'qr-modal-overlay';
        overlay.onclick = function(e) { if (e.target === overlay) overlay.remove(); };

        const modal = document.createElement('div');
        modal.className = 'qr-modal';

        const h3 = document.createElement('h3');
        h3.textContent = 'Share: ' + (title || 'Note');
        modal.appendChild(h3);

        const shareText = window.location.origin + '/notes#' + encodeURIComponent(title || '');
        const qrCanvas = generateQR(shareText, 200);
        modal.appendChild(qrCanvas);

        const subtitle = document.createElement('div');
        subtitle.style.cssText = 'font-size:0.7rem;color:var(--text-tertiary);margin-top:10px;word-break:break-all;';
        subtitle.textContent = shareText;
        modal.appendChild(subtitle);

        const closeBtn = document.createElement('button');
        closeBtn.className = 'qr-close-btn';
        closeBtn.textContent = 'Close';
        closeBtn.onclick = function() { overlay.remove(); };
        modal.appendChild(closeBtn);

        overlay.appendChild(modal);
        document.body.appendChild(overlay);
      }

      window.showNoteQR = function(noteId) {
        const card = document.getElementById('note-' + noteId);
        if (!card) return;
        const title = card.querySelector('.note-card-title')?.textContent || 'Note';
        showQRModal(title);
      };

      // Patch fetchNotes to add share buttons
      const _origFetchNotesForQR = fetchNotes;
      fetchNotes = async function() {
        await _origFetchNotesForQR();
        document.querySelectorAll('.note-card').forEach(function(card) {
          const noteId = card.id.replace('note-', '');
          const actions = card.querySelector('.note-card-actions');
          if (actions && !actions.querySelector('.note-share-btn')) {
            const shareBtn = document.createElement('button');
            shareBtn.className = 'note-share-btn';
            shareBtn.innerHTML = '&#9741; Share QR';
            shareBtn.onclick = function() { window.showNoteQR(noteId); };
            actions.insertBefore(shareBtn, actions.firstChild);
          }
        });
      };
    })();

    // ===== NETWORK LATENCY MONITOR =====
    (function() {
      const MAX_PINGS = 20;
      const pingHistory = [];

      function getLatencyClass(ms) {
        if (ms < 100) return 'good';
        if (ms < 300) return 'warn';
        return 'bad';
      }

      function getDotClass(ms) {
        if (ms < 100) return '';
        if (ms < 300) return 'warn';
        return 'bad';
      }

      function drawLatencySparkline() {
        const canvas = document.getElementById('latency-sparkline-canvas');
        if (!canvas || pingHistory.length < 2) return;
        const ctx = canvas.getContext('2d');
        const w = canvas.width;
        const h = canvas.height;
        ctx.clearRect(0, 0, w, h);

        const maxVal = Math.max(...pingHistory, 100);
        const range = maxVal || 1;
        const step = w / (MAX_PINGS - 1);

        // Threshold lines
        ctx.strokeStyle = 'rgba(251,191,36,0.15)';
        ctx.lineWidth = 1;
        ctx.setLineDash([4, 4]);
        const y100 = h - (100 / range) * h;
        if (y100 > 0 && y100 < h) {
          ctx.beginPath(); ctx.moveTo(0, y100); ctx.lineTo(w, y100); ctx.stroke();
        }
        const y300 = h - (300 / range) * h;
        if (y300 > 0 && y300 < h) {
          ctx.strokeStyle = 'rgba(251,113,133,0.15)';
          ctx.beginPath(); ctx.moveTo(0, y300); ctx.lineTo(w, y300); ctx.stroke();
        }
        ctx.setLineDash([]);

        // Gradient fill
        const gradient = ctx.createLinearGradient(0, 0, 0, h);
        const lastPing = pingHistory[pingHistory.length - 1];
        if (lastPing < 100) {
          gradient.addColorStop(0, 'rgba(52,211,153,0.3)');
          gradient.addColorStop(1, 'rgba(52,211,153,0)');
        } else if (lastPing < 300) {
          gradient.addColorStop(0, 'rgba(251,191,36,0.3)');
          gradient.addColorStop(1, 'rgba(251,191,36,0)');
        } else {
          gradient.addColorStop(0, 'rgba(251,113,133,0.3)');
          gradient.addColorStop(1, 'rgba(251,113,133,0)');
        }

        const startX = (MAX_PINGS - pingHistory.length) * step;
        ctx.beginPath();
        ctx.moveTo(startX, h);
        for (let i = 0; i < pingHistory.length; i++) {
          const x = startX + i * step;
          const y = h - (pingHistory[i] / range) * (h - 4) - 2;
          ctx.lineTo(x, y);
        }
        ctx.lineTo(startX + (pingHistory.length - 1) * step, h);
        ctx.closePath();
        ctx.fillStyle = gradient;
        ctx.fill();

        // Line
        ctx.beginPath();
        for (let i = 0; i < pingHistory.length; i++) {
          const x = startX + i * step;
          const y = h - (pingHistory[i] / range) * (h - 4) - 2;
          if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
        }
        ctx.strokeStyle = lastPing < 100 ? '#34d399' : lastPing < 300 ? '#fbbf24' : '#fb7185';
        ctx.lineWidth = 2;
        ctx.lineJoin = 'round';
        ctx.stroke();

        // Dots
        for (let i = 0; i < pingHistory.length; i++) {
          const x = startX + i * step;
          const y = h - (pingHistory[i] / range) * (h - 4) - 2;
          ctx.beginPath();
          ctx.arc(x, y, i === pingHistory.length - 1 ? 3 : 1.5, 0, Math.PI * 2);
          ctx.fillStyle = ctx.strokeStyle;
          ctx.fill();
        }
      }

      async function measureLatency() {
        const start = performance.now();
        try {
          await fetch('/api/health', { method: 'GET', cache: 'no-store' });
          const ms = Math.round(performance.now() - start);
          pingHistory.push(ms);
          if (pingHistory.length > MAX_PINGS) pingHistory.shift();

          const currentEl = document.getElementById('latency-current');
          const avgEl = document.getElementById('latency-avg');
          const minEl = document.getElementById('latency-min');
          const maxEl = document.getElementById('latency-max');
          const dotEl = document.getElementById('latency-dot');

          if (currentEl) {
            currentEl.textContent = ms + 'ms';
            currentEl.className = 'latency-stat-value ' + getLatencyClass(ms);
          }
          const avg = Math.round(pingHistory.reduce(function(a, b) { return a + b; }, 0) / pingHistory.length);
          if (avgEl) {
            avgEl.textContent = avg + 'ms';
            avgEl.className = 'latency-stat-value ' + getLatencyClass(avg);
          }
          const min = Math.min.apply(null, pingHistory);
          if (minEl) {
            minEl.textContent = min + 'ms';
            minEl.className = 'latency-stat-value ' + getLatencyClass(min);
          }
          const max = Math.max.apply(null, pingHistory);
          if (maxEl) {
            maxEl.textContent = max + 'ms';
            maxEl.className = 'latency-stat-value ' + getLatencyClass(max);
          }
          if (dotEl) {
            dotEl.className = 'latency-status-dot ' + getDotClass(ms);
          }
          drawLatencySparkline();
        } catch (err) {
          var currentEl = document.getElementById('latency-current');
          var dotEl = document.getElementById('latency-dot');
          if (currentEl) { currentEl.textContent = 'ERR'; currentEl.className = 'latency-stat-value bad'; }
          if (dotEl) { dotEl.className = 'latency-status-dot bad'; }
        }
      }

      measureLatency();
      setInterval(measureLatency, 10000);
    })();

    // ===== ACTIVITY FEED (RSS-style) =====
    (function() {
      const FEED_KEY = 'activity_feed';
      const MAX_EVENTS = 50;

      function getActivityFeed() {
        try { return JSON.parse(localStorage.getItem(FEED_KEY)) || []; }
        catch(e) { return []; }
      }

      function saveActivityFeed(feed) {
        localStorage.setItem(FEED_KEY, JSON.stringify(feed));
      }

      const iconMap = {
        'task_created': '&#10010;',
        'task_moved': '&#8644;',
        'note_created': '&#9998;',
        'note_edited': '&#9997;',
        'page_viewed': '&#128065;'
      };

      const labelMap = {
        'task_created': 'Task Created',
        'task_moved': 'Task Moved',
        'note_created': 'Note Created',
        'note_edited': 'Note Edited',
        'page_viewed': 'Page Viewed'
      };

      window.logActivity = function(type, detail) {
        var feed = getActivityFeed();
        feed.unshift({
          type: type,
          detail: detail || '',
          time: Date.now()
        });
        if (feed.length > MAX_EVENTS) feed = feed.slice(0, MAX_EVENTS);
        saveActivityFeed(feed);
        renderActivityFeed();
      };

      function timeAgo(ts) {
        var diff = Date.now() - ts;
        if (diff < 60000) return 'just now';
        if (diff < 3600000) return Math.floor(diff/60000) + 'm ago';
        if (diff < 86400000) return Math.floor(diff/3600000) + 'h ago';
        return Math.floor(diff/86400000) + 'd ago';
      }

      function renderActivityFeed() {
        var container = document.getElementById('activity-feed-list');
        if (!container) return;
        var feed = getActivityFeed();
        if (feed.length === 0) {
          container.innerHTML = '<div class="activity-empty">No activity recorded yet. Actions across the app will appear here.</div>';
          return;
        }
        container.innerHTML = feed.map(function(item) {
          var icon = iconMap[item.type] || '&#8226;';
          var label = labelMap[item.type] || item.type;
          return '<div class="activity-item">' +
            '<div class="activity-item-icon">' + icon + '</div>' +
            '<div class="activity-item-body">' +
              '<div class="activity-item-text"><strong>' + label + '</strong>' + (item.detail ? ' &mdash; ' + item.detail.replace(/</g,'&lt;').replace(/>/g,'&gt;') : '') + '</div>' +
              '<div class="activity-item-time">' + timeAgo(item.time) + '</div>' +
            '</div>' +
          '</div>';
        }).join('');
      }

      renderActivityFeed();

      var clearBtn = document.getElementById('activity-feed-clear');
      if (clearBtn) {
        clearBtn.addEventListener('click', function() {
          saveActivityFeed([]);
          renderActivityFeed();
          toast('Activity feed cleared');
        });
      }

      // Hook into navigateTo for page_viewed tracking
      _navHooks.push(function(page) {
        logActivity('page_viewed', page + ' page');
      });
    })();

    // ===== CUSTOM COLOR THEME CREATOR =====
    (function() {
      var THEME_KEY = 'custom_theme';
      var defaults = {
        accent: '#8b7cf6',
        bg: '#08080c',
        text: '#ebebf0',
        surface: '#111118'
      };

      function hexToRgba(hex, alpha) {
        var r = parseInt(hex.slice(1,3),16);
        var g = parseInt(hex.slice(3,5),16);
        var b = parseInt(hex.slice(5,7),16);
        return 'rgba(' + r + ',' + g + ',' + b + ',' + alpha + ')';
      }

      function applyTheme(theme) {
        var root = document.documentElement;
        root.style.setProperty('--accent', theme.accent);
        root.style.setProperty('--accent-dim', hexToRgba(theme.accent, 0.12));
        root.style.setProperty('--accent-glow', hexToRgba(theme.accent, 0.25));
        root.style.setProperty('--bg', theme.bg);
        root.style.setProperty('--bg2', theme.bg);
        root.style.setProperty('--text', theme.text);
        root.style.setProperty('--text-secondary', hexToRgba(theme.text, 0.55));
        root.style.setProperty('--text-tertiary', hexToRgba(theme.text, 0.35));
        root.style.setProperty('--surface-solid', theme.surface);
        root.style.setProperty('--surface', hexToRgba(theme.surface, 0.3));
        root.style.setProperty('--surface-hover', hexToRgba(theme.surface, 0.5));

        // Update preview swatches
        var pa = document.getElementById('preview-accent');
        var pb = document.getElementById('preview-bg');
        var pt = document.getElementById('preview-text');
        var ps = document.getElementById('preview-surface');
        if (pa) pa.style.background = theme.accent;
        if (pb) pb.style.background = theme.bg;
        if (pt) pt.style.background = theme.text;
        if (ps) ps.style.background = theme.surface;
      }

      function getTheme() {
        try { return JSON.parse(localStorage.getItem(THEME_KEY)) || null; }
        catch(e) { return null; }
      }

      // Load saved theme on init
      var saved = getTheme();
      if (saved) {
        applyTheme(saved);
        // Set input values
        var ai = document.getElementById('theme-accent');
        var bi = document.getElementById('theme-bg');
        var ti = document.getElementById('theme-text');
        var si = document.getElementById('theme-surface');
        if (ai) ai.value = saved.accent;
        if (bi) bi.value = saved.bg;
        if (ti) ti.value = saved.text;
        if (si) si.value = saved.surface;
      }

      // Live preview on input change
      ['theme-accent','theme-bg','theme-text','theme-surface'].forEach(function(id) {
        var el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('input', function() {
          var theme = {
            accent: document.getElementById('theme-accent').value,
            bg: document.getElementById('theme-bg').value,
            text: document.getElementById('theme-text').value,
            surface: document.getElementById('theme-surface').value
          };
          applyTheme(theme);
        });
      });

      // Save button
      var saveBtn = document.getElementById('theme-save-btn');
      if (saveBtn) {
        saveBtn.addEventListener('click', function() {
          var theme = {
            accent: document.getElementById('theme-accent').value,
            bg: document.getElementById('theme-bg').value,
            text: document.getElementById('theme-text').value,
            surface: document.getElementById('theme-surface').value
          };
          localStorage.setItem(THEME_KEY, JSON.stringify(theme));
          applyTheme(theme);
          toast('Theme saved');
        });
      }

      // Reset button
      var resetBtn = document.getElementById('theme-reset-btn');
      if (resetBtn) {
        resetBtn.addEventListener('click', function() {
          localStorage.removeItem(THEME_KEY);
          // Remove inline CSS vars
          var root = document.documentElement;
          ['--accent','--accent-dim','--accent-glow','--bg','--bg2','--text','--text-secondary','--text-tertiary','--surface-solid','--surface','--surface-hover'].forEach(function(v) {
            root.style.removeProperty(v);
          });
          // Reset inputs
          document.getElementById('theme-accent').value = defaults.accent;
          document.getElementById('theme-bg').value = defaults.bg;
          document.getElementById('theme-text').value = defaults.text;
          document.getElementById('theme-surface').value = defaults.surface;
          // Reset preview
          document.getElementById('preview-accent').style.background = defaults.accent;
          document.getElementById('preview-bg').style.background = defaults.bg;
          document.getElementById('preview-text').style.background = defaults.text;
          document.getElementById('preview-surface').style.background = defaults.surface;
          toast('Theme reset to default');
        });
      }
    })();

    // ===== DASHBOARD DRAG-TO-REORDER WIDGETS =====
    (function() {
      var ORDER_KEY = 'widget_order';
      var monitorPage = document.getElementById('page-monitor');
      if (!monitorPage) return;

      function getWidgets() {
        return Array.from(monitorPage.querySelectorAll('.monitor-widget'));
      }

      function getSavedOrder() {
        try { return JSON.parse(localStorage.getItem(ORDER_KEY)) || null; }
        catch(e) { return null; }
      }

      function saveOrder() {
        var order = getWidgets().map(function(w) { return w.dataset.widget; });
        localStorage.setItem(ORDER_KEY, JSON.stringify(order));
      }

      // Restore saved order
      var savedOrder = getSavedOrder();
      if (savedOrder) {
        var widgets = getWidgets();
        var widgetMap = {};
        widgets.forEach(function(w) { widgetMap[w.dataset.widget] = w; });
        savedOrder.forEach(function(id) {
          if (widgetMap[id]) {
            monitorPage.appendChild(widgetMap[id]);
          }
        });
        // Append any widgets not in saved order (new ones)
        widgets.forEach(function(w) {
          if (savedOrder.indexOf(w.dataset.widget) === -1) {
            monitorPage.appendChild(w);
          }
        });
      }

      // HTML5 Drag and Drop
      var draggedWidget = null;

      monitorPage.addEventListener('dragstart', function(e) {
        var handle = e.target.closest('.drag-handle');
        if (!handle) { e.preventDefault(); return; }
        draggedWidget = handle.closest('.monitor-widget');
        if (!draggedWidget) { e.preventDefault(); return; }
        draggedWidget.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/plain', draggedWidget.dataset.widget);
      });

      monitorPage.addEventListener('dragend', function(e) {
        if (draggedWidget) {
          draggedWidget.classList.remove('dragging');
          draggedWidget = null;
        }
        getWidgets().forEach(function(w) { w.classList.remove('drag-over'); });
      });

      monitorPage.addEventListener('dragover', function(e) {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        var target = e.target.closest('.monitor-widget');
        if (target && target !== draggedWidget) {
          getWidgets().forEach(function(w) { w.classList.remove('drag-over'); });
          target.classList.add('drag-over');
        }
      });

      monitorPage.addEventListener('dragleave', function(e) {
        var target = e.target.closest('.monitor-widget');
        if (target) target.classList.remove('drag-over');
      });

      monitorPage.addEventListener('drop', function(e) {
        e.preventDefault();
        var target = e.target.closest('.monitor-widget');
        if (!target || !draggedWidget || target === draggedWidget) return;
        // Determine position
        var widgets = getWidgets();
        var dragIdx = widgets.indexOf(draggedWidget);
        var targetIdx = widgets.indexOf(target);
        if (dragIdx < targetIdx) {
          target.parentNode.insertBefore(draggedWidget, target.nextSibling);
        } else {
          target.parentNode.insertBefore(draggedWidget, target);
        }
        target.classList.remove('drag-over');
        saveOrder();
        toast('Widget order saved');
      });

      // Make drag handles trigger draggable on parent
      getWidgets().forEach(function(widget) {
        var handle = widget.querySelector('.drag-handle');
        if (handle) {
          widget.setAttribute('draggable', 'false');
          handle.addEventListener('mousedown', function() {
            widget.setAttribute('draggable', 'true');
          });
          handle.addEventListener('mouseup', function() {
            widget.setAttribute('draggable', 'false');
          });
        }
      });

      // Also reset draggable on dragend
      document.addEventListener('dragend', function() {
        getWidgets().forEach(function(w) {
          w.setAttribute('draggable', 'false');
        });
      });
    })();

    // ===== DIFF VIEWER =====
    (function() {
      var compareBtn = document.getElementById('diff-compare-btn');
      var clearBtn = document.getElementById('diff-clear-btn');
      var outputEl = document.getElementById('diff-output');
      var origTextarea = document.getElementById('diff-original');
      var modTextarea = document.getElementById('diff-modified');

      if (!compareBtn || !outputEl) return;

      function computeDiff(orig, mod) {
        var origLines = orig.split('\n');
        var modLines = mod.split('\n');
        var maxLen = Math.max(origLines.length, modLines.length);
        var result = [];

        // Simple LCS-based line diff
        var m = origLines.length;
        var n = modLines.length;

        // Build LCS table
        var dp = [];
        for (var i = 0; i <= m; i++) {
          dp[i] = [];
          for (var j = 0; j <= n; j++) {
            if (i === 0 || j === 0) dp[i][j] = 0;
            else if (origLines[i-1] === modLines[j-1]) dp[i][j] = dp[i-1][j-1] + 1;
            else dp[i][j] = Math.max(dp[i-1][j], dp[i][j-1]);
          }
        }

        // Backtrack to get diff
        var diff = [];
        var ii = m, jj = n;
        while (ii > 0 || jj > 0) {
          if (ii > 0 && jj > 0 && origLines[ii-1] === modLines[jj-1]) {
            diff.unshift({ type: 'unchanged', text: origLines[ii-1] });
            ii--; jj--;
          } else if (jj > 0 && (ii === 0 || dp[ii][jj-1] >= dp[ii-1][jj])) {
            diff.unshift({ type: 'added', text: modLines[jj-1] });
            jj--;
          } else {
            diff.unshift({ type: 'removed', text: origLines[ii-1] });
            ii--;
          }
        }

        return diff;
      }

      function escapeHtml(str) {
        return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      }

      compareBtn.addEventListener('click', function() {
        var orig = origTextarea.value;
        var mod = modTextarea.value;
        if (!orig && !mod) {
          toast('Enter text in both fields to compare');
          return;
        }
        var diff = computeDiff(orig, mod);
        var html = diff.map(function(d, idx) {
          var lineNum = idx + 1;
          var prefix = String(lineNum).padStart(3, ' ') + '  ';
          if (d.type === 'added') return '<span class="diff-added">+ ' + prefix + escapeHtml(d.text) + '</span>';
          if (d.type === 'removed') return '<span class="diff-removed">- ' + prefix + escapeHtml(d.text) + '</span>';
          return '<span class="diff-unchanged">  ' + prefix + escapeHtml(d.text) + '</span>';
        }).join('');
        outputEl.innerHTML = html;
        outputEl.style.display = 'block';
      });

      clearBtn.addEventListener('click', function() {
        origTextarea.value = '';
        modTextarea.value = '';
        outputEl.innerHTML = '';
        outputEl.style.display = 'none';
      });
    })();

    // ===== HOOK ACTIVITY FEED INTO KANBAN & NOTES =====
    (function() {
      // Patch kanban task add
      var origAddTask = window.addKanbanTask;
      if (typeof origAddTask === 'function') {
        window.addKanbanTask = function() {
          var result = origAddTask.apply(this, arguments);
          var titleInput = document.getElementById('kanban-task-title');
          var title = titleInput ? titleInput.value : 'Untitled';
          if (typeof logActivity === 'function') logActivity('task_created', title);
          return result;
        };
      }

      // Use MutationObserver on kanban columns to detect task moves
      var kanbanBoard = document.querySelector('.kanban-board');
      if (kanbanBoard) {
        var kanbanObserver = new MutationObserver(function(mutations) {
          mutations.forEach(function(m) {
            if (m.type === 'childList' && m.addedNodes.length > 0) {
              m.addedNodes.forEach(function(node) {
                if (node.nodeType === 1 && node.classList && node.classList.contains('kanban-card')) {
                  var titleEl = node.querySelector('.kanban-card-title');
                  var colEl = node.closest('.kanban-col');
                  var colTitle = colEl ? colEl.querySelector('.kanban-col-title') : null;
                  if (typeof logActivity === 'function') {
                    logActivity('task_moved', (titleEl ? titleEl.textContent : 'Task') + ' -> ' + (colTitle ? colTitle.textContent : 'column'));
                  }
                }
              });
            }
          });
        });
        kanbanObserver.observe(kanbanBoard, { childList: true, subtree: true });
      }

      // Patch note save if addNote exists
      var origSaveNote = window.saveNote;
      if (typeof origSaveNote === 'function') {
        window.saveNote = function() {
          var result = origSaveNote.apply(this, arguments);
          if (typeof logActivity === 'function') logActivity('note_edited', 'Note saved');
          return result;
        };
      }
      var origAddNote = window.addNote;
      if (typeof origAddNote === 'function') {
        window.addNote = function() {
          var result = origAddNote.apply(this, arguments);
          if (typeof logActivity === 'function') logActivity('note_created', 'New note');
          return result;
        };
      }
    })();

    // ===== FEATURE: DAILY STANDUP VIEW =====
    (function() {
      var standupEl = document.getElementById('standup-content');
      if (!standupEl) return;

      function renderStandup() {
        if (!kanbanData || !kanbanData.columns) {
          standupEl.innerHTML = '<div class="standup-empty">No kanban data available</div>';
          return;
        }
        var doneTasks = [];
        var inProgressTasks = [];
        var blockerTasks = [];
        var now = new Date();
        var yesterday = new Date(now);
        yesterday.setDate(yesterday.getDate() - 1);
        var yesterdayStr = yesterday.toISOString().split('T')[0];

        kanbanData.columns.forEach(function(col) {
          if (!col.tasks) return;
          col.tasks.forEach(function(task) {
            if (col.id === 'done') {
              // Consider tasks in done that were updated recently as "done yesterday"
              var taskDate = task.updatedAt || task.createdAt || '';
              var taskDateStr = taskDate ? new Date(taskDate).toISOString().split('T')[0] : '';
              if (taskDateStr >= yesterdayStr) {
                doneTasks.push(task);
              } else {
                // Also include last 5 done tasks if none match yesterday
                doneTasks.push(task);
              }
            } else if (col.id === 'inprogress') {
              inProgressTasks.push(task);
              // Check for blockers in description
              var desc = (task.description || '').toLowerCase();
              if (desc.indexOf('block') !== -1 || desc.indexOf('stuck') !== -1 || desc.indexOf('waiting') !== -1) {
                blockerTasks.push(task);
              }
            }
          });
        });

        // Limit done tasks to most recent 5
        doneTasks = doneTasks.slice(-5);

        var html = '';

        html += '<div class="standup-done"><div class="standup-section-title"><span class="standup-icon">&#9989;</span> Done Recently</div>';
        if (doneTasks.length === 0) {
          html += '<div class="standup-empty">No recently completed tasks</div>';
        } else {
          html += '<div class="standup-items">';
          doneTasks.forEach(function(t) { html += '<div class="standup-item">' + esc(t.title) + '</div>'; });
          html += '</div>';
        }
        html += '</div>';

        html += '<div class="standup-progress"><div class="standup-section-title"><span class="standup-icon">&#128296;</span> In Progress</div>';
        if (inProgressTasks.length === 0) {
          html += '<div class="standup-empty">Nothing currently in progress</div>';
        } else {
          html += '<div class="standup-items">';
          inProgressTasks.forEach(function(t) { html += '<div class="standup-item">' + esc(t.title) + '</div>'; });
          html += '</div>';
        }
        html += '</div>';

        html += '<div class="standup-blockers"><div class="standup-section-title"><span class="standup-icon">&#128683;</span> Blockers</div>';
        if (blockerTasks.length === 0) {
          html += '<div class="standup-empty">No blockers detected</div>';
        } else {
          html += '<div class="standup-items">';
          blockerTasks.forEach(function(t) { html += '<div class="standup-item">' + esc(t.title) + (t.description ? ' - ' + esc(t.description) : '') + '</div>'; });
          html += '</div>';
        }
        html += '</div>';

        standupEl.innerHTML = html;
      }

      // Refresh standup when kanban data loads
      var _origFetchKanbanForStandup = window.fetchKanban;
      if (typeof _origFetchKanbanForStandup === 'function') {
        window.fetchKanban = async function() {
          await _origFetchKanbanForStandup.apply(this, arguments);
          renderStandup();
        };
      }

      // Also render on page load after a delay to let kanban data load
      setTimeout(function() {
        if (kanbanData) renderStandup();
        else {
          // Fetch kanban data for standup if not loaded yet
          api('/api/kanban').then(function(r) { return r.json(); }).then(function(data) {
            if (!kanbanData) kanbanData = data;
            renderStandup();
          }).catch(function() {});
        }
      }, 2000);
    })();

    // ===== FEATURE: WIDGET VISIBILITY TOGGLE =====
    (function() {
      var VIS_KEY = 'monitor_widget_visibility';
      var visBtn = document.getElementById('widget-vis-btn');
      var visDropdown = document.getElementById('widget-vis-dropdown');
      var monitorPage = document.getElementById('page-monitor');
      if (!visBtn || !visDropdown || !monitorPage) return;

      var WIDGET_LABELS = {
        'status-cards': 'Status Cards',
        'stats-bar': 'Stats Bar',
        'progress-rings': 'Progress Rings',
        'sparkline-charts': 'Sparkline Charts',
        'latency-monitor': 'Network Latency',
        'daily-quote': 'Daily Quote',
        'art-of-day': 'Art of the Day',
        'pomo-fortune': 'Pomodoro & Fortune',
        'system-health': 'System Health',
        'current-activity': 'Current Activity',
        'activity-heatmap': 'Activity Heatmap',
        'site-analytics': 'Site Analytics',
        'activity-log': 'Activity Log',
        'message-claude': 'Message Claude',
        'daily-standup': 'Daily Standup'
      };

      function getSavedVis() {
        try { return JSON.parse(localStorage.getItem(VIS_KEY)) || {}; }
        catch(e) { return {}; }
      }

      function saveVis(vis) {
        localStorage.setItem(VIS_KEY, JSON.stringify(vis));
      }

      function applyVisibility() {
        var vis = getSavedVis();
        var widgets = monitorPage.querySelectorAll('.monitor-widget');
        widgets.forEach(function(w) {
          var id = w.dataset.widget;
          if (id && vis[id] === false) {
            w.style.display = 'none';
          } else {
            // Restore to original display (remove our override)
            if (w.style.display === 'none' && vis[id] !== false) {
              w.style.display = '';
            }
          }
        });
      }

      function buildDropdown() {
        var vis = getSavedVis();
        var widgets = monitorPage.querySelectorAll('.monitor-widget');
        var html = '';
        widgets.forEach(function(w) {
          var id = w.dataset.widget;
          if (!id) return;
          var label = WIDGET_LABELS[id] || id;
          var checked = vis[id] !== false;
          html += '<label><input type="checkbox" data-wid="' + id + '"' + (checked ? ' checked' : '') + '>' + label + '</label>';
        });
        visDropdown.innerHTML = html;
      }

      visBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        buildDropdown();
        visDropdown.classList.toggle('open');
      });

      visDropdown.addEventListener('change', function(e) {
        var cb = e.target;
        if (!cb.dataset || !cb.dataset.wid) return;
        var vis = getSavedVis();
        vis[cb.dataset.wid] = cb.checked;
        saveVis(vis);
        applyVisibility();
      });

      visDropdown.addEventListener('click', function(e) {
        e.stopPropagation();
      });

      document.addEventListener('click', function(e) {
        if (!visDropdown.contains(e.target) && e.target !== visBtn) {
          visDropdown.classList.remove('open');
        }
      });

      // Apply on load
      applyVisibility();
    })();

    // ===== FEATURE: MESSAGE READ RECEIPTS =====
    (function() {
      var READ_KEY = 'messages_read_ids';
      var badgeEl = document.getElementById('msg-unread-badge');

      function getReadIds() {
        try { return JSON.parse(localStorage.getItem(READ_KEY)) || []; }
        catch(e) { return []; }
      }

      function saveReadIds(ids) {
        localStorage.setItem(READ_KEY, JSON.stringify(ids));
      }

      function updateMessageBadge(messages) {
        if (!badgeEl || !Array.isArray(messages)) return;
        var readIds = getReadIds();
        var unreadCount = 0;
        var msgIds = [];
        messages.forEach(function(m) {
          var msgId = m.id || m.timestamp || (m.message || '').substring(0, 30);
          msgIds.push(msgId);
          if (readIds.indexOf(msgId) === -1) {
            unreadCount++;
          }
        });

        if (unreadCount > 0) {
          badgeEl.textContent = unreadCount;
          badgeEl.style.display = 'inline-flex';
        } else {
          badgeEl.style.display = 'none';
        }

        return { msgIds: msgIds, unreadCount: unreadCount };
      }

      function markAllRead(messages) {
        if (!Array.isArray(messages)) return;
        var msgIds = messages.map(function(m) {
          return m.id || m.timestamp || (m.message || '').substring(0, 30);
        });
        saveReadIds(msgIds);
        if (badgeEl) badgeEl.style.display = 'none';
      }

      // Hook into fetchStatus to check for new messages
      var _origFetchStatusForReadReceipts = fetchStatus;
      fetchStatus = async function() {
        await _origFetchStatusForReadReceipts();
        try {
          var msgsResp = await api('/api/messages');
          var msgs = await msgsResp.json();
          if (Array.isArray(msgs)) {
            updateMessageBadge(msgs);
          }
        } catch(e) {}
      };

      // Mark as read when the message-claude widget is visible and user interacts
      var msgInput = document.getElementById('msg-input');
      if (msgInput) {
        msgInput.addEventListener('focus', function() {
          api('/api/messages').then(function(r) { return r.json(); }).then(function(msgs) {
            if (Array.isArray(msgs)) markAllRead(msgs);
          }).catch(function() {});
        });
      }

      // Also mark as read when clicking on the Message Claude section header
      var msgSection = document.querySelector('[data-widget="message-claude"]');
      if (msgSection) {
        msgSection.addEventListener('click', function() {
          api('/api/messages').then(function(r) { return r.json(); }).then(function(msgs) {
            if (Array.isArray(msgs)) markAllRead(msgs);
          }).catch(function() {});
        });
      }
    })();

    // ===== FEATURE: GANTT CHART VIEW =====
    function renderGanttChart() {
      var ganttEl = document.getElementById('kanban-gantt');
      if (!ganttEl) return;
      if (!kanbanData || !kanbanData.columns) {
        ganttEl.innerHTML = '<div class="gantt-container"><div style="padding:20px;color:var(--text-tertiary);text-align:center;">No kanban data available</div></div>';
        return;
      }

      // Collect all tasks with dates
      var tasks = [];
      var now = new Date();
      var todayStr = now.toISOString().split('T')[0];

      kanbanData.columns.forEach(function(col) {
        if (!col.tasks) return;
        col.tasks.forEach(function(task) {
          var dueMatch = (task.description || '').match(/\[DUE:(\d{4}-\d{2}-\d{2})\]/);
          var dueDate = dueMatch ? dueMatch[1] : null;
          var createdDate = task.createdAt ? new Date(task.createdAt).toISOString().split('T')[0] : null;

          var startDate, endDate;
          if (createdDate && dueDate) {
            startDate = createdDate;
            endDate = dueDate;
          } else if (dueDate) {
            // No created date, set start 7 days before due
            var d = new Date(dueDate);
            d.setDate(d.getDate() - 7);
            startDate = d.toISOString().split('T')[0];
            endDate = dueDate;
          } else if (createdDate) {
            startDate = createdDate;
            var d2 = new Date(createdDate);
            d2.setDate(d2.getDate() + 7);
            endDate = d2.toISOString().split('T')[0];
          } else {
            // Default: 7-day span ending today
            var d3 = new Date(now);
            d3.setDate(d3.getDate() - 3);
            startDate = d3.toISOString().split('T')[0];
            var d4 = new Date(now);
            d4.setDate(d4.getDate() + 4);
            endDate = d4.toISOString().split('T')[0];
          }

          // Ensure start is before end
          if (startDate > endDate) {
            var tmp = startDate;
            startDate = endDate;
            endDate = tmp;
          }

          tasks.push({
            title: task.title,
            columnId: col.id,
            start: startDate,
            end: endDate
          });
        });
      });

      if (tasks.length === 0) {
        ganttEl.innerHTML = '<div class="gantt-container"><div style="padding:20px;color:var(--text-tertiary);text-align:center;">No tasks to display</div></div>';
        return;
      }

      // Determine date range: earliest start to latest end, with padding
      var allDates = [];
      tasks.forEach(function(t) { allDates.push(t.start, t.end); });
      allDates.sort();
      var minDate = new Date(allDates[0]);
      var maxDate = new Date(allDates[allDates.length - 1]);
      // Add 3 days padding on each side
      minDate.setDate(minDate.getDate() - 3);
      maxDate.setDate(maxDate.getDate() + 3);

      // Generate day columns
      var days = [];
      var d = new Date(minDate);
      while (d <= maxDate) {
        days.push(d.toISOString().split('T')[0]);
        d.setDate(d.getDate() + 1);
      }

      var CELL_W = 40;
      var totalWidth = days.length * CELL_W;

      // Header
      var headerHtml = '<div class="gantt-header-row">';
      headerHtml += '<div class="gantt-label" style="font-weight:600;color:var(--text-tertiary);font-size:0.65rem;">Task</div>';
      days.forEach(function(day) {
        var isToday = day === todayStr;
        var dt = new Date(day);
        var label = (dt.getMonth() + 1) + '/' + dt.getDate();
        headerHtml += '<div class="gantt-header-cell' + (isToday ? ' gantt-today' : '') + '">' + label + '</div>';
      });
      headerHtml += '</div>';

      // Rows
      var rowsHtml = '<div class="gantt-rows">';
      tasks.forEach(function(task) {
        var startIdx = days.indexOf(task.start);
        var endIdx = days.indexOf(task.end);
        if (startIdx === -1) startIdx = 0;
        if (endIdx === -1) endIdx = days.length - 1;
        if (startIdx > endIdx) { var t = startIdx; startIdx = endIdx; endIdx = t; }
        var barLeft = startIdx * CELL_W;
        var barWidth = Math.max((endIdx - startIdx + 1) * CELL_W - 4, 8);

        var colClass = 'col-' + task.columnId.replace(/[^a-z]/g, '');

        rowsHtml += '<div class="gantt-row">';
        rowsHtml += '<div class="gantt-label" title="' + esc(task.title) + '">' + esc(task.title) + '</div>';
        rowsHtml += '<div class="gantt-bar-area" style="min-width:' + totalWidth + 'px;">';

        // Grid lines per day
        for (var i = 0; i < days.length; i++) {
          if (days[i] === todayStr) {
            rowsHtml += '<div class="gantt-today-line" style="left:' + (i * CELL_W + CELL_W / 2) + 'px;"></div>';
          }
        }

        rowsHtml += '<div class="gantt-bar ' + colClass + '" style="left:' + barLeft + 'px;width:' + barWidth + 'px;" title="' + esc(task.title) + ' (' + task.start + ' to ' + task.end + ')">';
        rowsHtml += '<div class="gantt-bar-text">' + esc(task.title) + '</div>';
        rowsHtml += '</div>';
        rowsHtml += '</div>';
        rowsHtml += '</div>';
      });
      rowsHtml += '</div>';

      ganttEl.innerHTML = '<div class="gantt-container">' + headerHtml + rowsHtml + '</div>';
    }

    // ===== FEATURE: AI CHATBOT WIDGET =====
    (function() {
      var fab = document.getElementById('chatbot-fab');
      var panel = document.getElementById('chatbot-panel');
      var closeBtn = document.getElementById('chatbot-close');
      var input = document.getElementById('chatbot-input');
      var sendBtn = document.getElementById('chatbot-send');
      var msgBox = document.getElementById('chatbot-messages');
      if (!fab || !panel) return;

      function addMsg(text, cls) {
        var d = document.createElement('div');
        d.className = 'chatbot-msg ' + cls;
        d.innerHTML = text;
        msgBox.appendChild(d);
        msgBox.scrollTop = msgBox.scrollHeight;
      }

      function botReply(userText) {
        var t = userText.toLowerCase().trim();
        if (t === 'help') return 'Available commands:<br><b>help</b> - show this list<br><b>status</b> - server status<br><b>tasks</b> - task counts<br><b>time</b> - current time<br><b>hello/hi</b> - say hi';
        if (t === 'status') {
          var el = document.getElementById('card-status');
          var s = el ? el.textContent.trim() : 'Unknown';
          var connEl = document.getElementById('conn-status');
          var conn = connEl ? (connEl.classList.contains('ok') ? 'Connected' : 'Offline') : 'Unknown';
          return 'Server: <b>' + s + '</b><br>Connection: <b>' + conn + '</b>';
        }
        if (t === 'tasks') {
          var statEl = document.getElementById('stat-tasks');
          var doneEl = document.getElementById('stat-completed');
          return 'Total tasks: <b>' + (statEl ? statEl.textContent : '--') + '</b><br>Completed: <b>' + (doneEl ? doneEl.textContent : '--') + '</b>';
        }
        if (t === 'time') return 'Current time: <b>' + new Date().toLocaleTimeString() + '</b><br>Date: <b>' + new Date().toLocaleDateString() + '</b>';
        if (t === 'hello' || t === 'hi' || t === 'hey') return 'Hello! How can I help you today?';
        return "I'm a simple bot - try <b>help</b>, <b>status</b>, <b>tasks</b>, or <b>time</b>.";
      }

      function handleSend() {
        if (!input) return;
        var val = input.value.trim();
        if (!val) return;
        addMsg(esc(val), 'user');
        input.value = '';
        setTimeout(function() { addMsg(botReply(val), 'bot'); }, 200);
      }

      fab.addEventListener('click', function() {
        panel.classList.toggle('open');
        if (panel.classList.contains('open') && input) input.focus();
        if (navigator.vibrate) navigator.vibrate(10);
      });
      if (closeBtn) closeBtn.addEventListener('click', function() { panel.classList.remove('open'); });
      if (sendBtn) sendBtn.addEventListener('click', handleSend);
      if (input) input.addEventListener('keydown', function(e) { if (e.key === 'Enter') handleSend(); });
    })();

    // ===== FEATURE: HAPTIC FEEDBACK PATTERNS =====
    (function() {
      if (!navigator.vibrate) return;
      // Short pulse for button clicks
      document.addEventListener('click', function(e) {
        var el = e.target.closest('.btn, .btn-add-task, .btn-send, .nav-link, .chatbot-fab, .voice-memo-btn');
        if (el) navigator.vibrate(10);
      });
      // Double pulse for kanban task drag actions
      document.addEventListener('dragstart', function(e) {
        var el = e.target.closest('.kanban-task-card');
        if (el) navigator.vibrate([10, 50, 10]);
      });
      document.addEventListener('drop', function(e) {
        var el = e.target.closest('.kanban-column-body');
        if (el) navigator.vibrate([10, 50, 10]);
      });
      // Long pulse for form submits
      var formBtns = ['save-note-btn', 'save-task-btn', 'chatbot-send'];
      formBtns.forEach(function(id) {
        var el = document.getElementById(id);
        if (el) el.addEventListener('click', function() { navigator.vibrate(50); });
      });
    })();

    // ===== FEATURE: GESTURE CONTROLS (SWIPE NAVIGATION) =====
    (function() {
      var touchStartX = 0;
      var touchStartY = 0;
      var touchEl = null;
      var MIN_SWIPE = 80;
      var dashboard = document.getElementById('dashboard');
      if (!dashboard) return;

      dashboard.addEventListener('touchstart', function(e) {
        // Skip if touch starts on a scrollable table or input
        var tgt = e.target;
        if (tgt.closest('table, .log-viewer, .terminal-body, textarea, input, .chatbot-messages, .kanban-board')) return;
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
        touchEl = tgt;
      }, { passive: true });

      dashboard.addEventListener('touchend', function(e) {
        if (!touchEl) return;
        var dx = e.changedTouches[0].clientX - touchStartX;
        var dy = e.changedTouches[0].clientY - touchStartY;
        // Only horizontal swipes; ignore if vertical movement is larger
        if (Math.abs(dx) < MIN_SWIPE || Math.abs(dy) > Math.abs(dx)) { touchEl = null; return; }
        var idx = PAGES.indexOf(currentPage);
        if (idx === -1) { touchEl = null; return; }
        if (dx > 0 && idx > 0) {
          navigateTo(PAGES[idx - 1]);
          if (navigator.vibrate) navigator.vibrate(10);
        } else if (dx < 0 && idx < PAGES.length - 1) {
          navigateTo(PAGES[idx + 1]);
          if (navigator.vibrate) navigator.vibrate(10);
        }
        touchEl = null;
      }, { passive: true });
    })();

    // ===== FEATURE: DRAG-AND-DROP FILE UPLOAD (NOTES) =====
    (function() {
      var notesList = document.getElementById('notes-list');
      if (!notesList) return;

      // Delegated drag events on the notes list container
      notesList.addEventListener('dragover', function(e) {
        var card = e.target.closest('.note-card.editing');
        if (!card) return;
        e.preventDefault();
        e.dataTransfer.dropEffect = 'copy';
        var overlay = card.querySelector('.note-dropzone-overlay');
        if (!overlay) {
          overlay = document.createElement('div');
          overlay.className = 'note-dropzone-overlay active';
          overlay.innerHTML = '<span>Drop file to attach</span>';
          card.style.position = 'relative';
          card.appendChild(overlay);
        } else {
          overlay.classList.add('active');
        }
      });

      notesList.addEventListener('dragleave', function(e) {
        var card = e.target.closest('.note-card.editing');
        if (!card) return;
        var overlay = card.querySelector('.note-dropzone-overlay');
        // Only hide if we truly left the card
        if (overlay && !card.contains(e.relatedTarget)) overlay.classList.remove('active');
      });

      notesList.addEventListener('drop', function(e) {
        var card = e.target.closest('.note-card.editing');
        if (!card) return;
        e.preventDefault();
        var overlay = card.querySelector('.note-dropzone-overlay');
        if (overlay) overlay.classList.remove('active');
        var noteId = card.id.replace('note-', '');
        var files = e.dataTransfer.files;
        if (!files || !files.length || !noteId) return;
        if (navigator.vibrate) navigator.vibrate([10, 50, 10]);

        for (var i = 0; i < files.length; i++) {
          (function(file) {
            var formData = new FormData();
            formData.append('file', file);
            fetch('/api/notes/' + noteId + '/attachments', {
              method: 'POST',
              headers: { 'Authorization': 'Bearer ' + authToken },
              body: formData
            }).then(function(resp) {
              if (resp.ok) {
                toast('File attached: ' + file.name);
                // Show attachment chip
                var attDiv = card.querySelector('.note-attachments');
                if (!attDiv) {
                  attDiv = document.createElement('div');
                  attDiv.className = 'note-attachments';
                  card.appendChild(attDiv);
                }
                var chip = document.createElement('span');
                chip.className = 'note-attachment-chip';
                chip.textContent = file.name;
                attDiv.appendChild(chip);
              } else {
                toast('Upload failed: ' + file.name);
              }
            }).catch(function() { toast('Upload error: ' + file.name); });
          })(files[i]);
        }
      });
    })();

    // ===== FEATURE: VOICE MEMO RECORDER =====
    (function() {
      var btn = document.getElementById('voice-memo-btn');
      var indicator = document.getElementById('voice-memo-indicator');
      if (!btn) return;

      var mediaRecorder = null;
      var audioChunks = [];
      var isRecording = false;

      // Check browser support
      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia || typeof MediaRecorder === 'undefined') {
        btn.title = 'Voice recording not supported in this browser';
        btn.style.opacity = '0.4';
        btn.style.cursor = 'not-allowed';
        return;
      }

      btn.addEventListener('click', function() {
        if (isRecording) {
          stopRecording();
        } else {
          startRecording();
        }
      });

      function startRecording() {
        navigator.mediaDevices.getUserMedia({ audio: true }).then(function(stream) {
          var mimeType = 'audio/webm';
          if (!MediaRecorder.isTypeSupported(mimeType)) {
            // Fallback to default
            mimeType = '';
          }
          var options = mimeType ? { mimeType: mimeType } : {};
          mediaRecorder = new MediaRecorder(stream, options);
          audioChunks = [];
          mediaRecorder.ondataavailable = function(e) {
            if (e.data && e.data.size > 0) audioChunks.push(e.data);
          };
          mediaRecorder.onstop = function() {
            stream.getTracks().forEach(function(t) { t.stop(); });
            var blob = new Blob(audioChunks, { type: mimeType || 'audio/webm' });
            saveVoiceMemo(blob);
          };
          mediaRecorder.start();
          isRecording = true;
          btn.classList.add('recording');
          if (indicator) indicator.style.display = 'inline-flex';
          if (navigator.vibrate) navigator.vibrate(50);
        }).catch(function(err) {
          toast('Mic access denied');
          console.warn('getUserMedia error:', err);
        });
      }

      function stopRecording() {
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
          mediaRecorder.stop();
        }
        isRecording = false;
        btn.classList.remove('recording');
        if (indicator) indicator.style.display = 'none';
        if (navigator.vibrate) navigator.vibrate(10);
      }

      function saveVoiceMemo(blob) {
        var ts = new Date().toLocaleString();
        var title = 'Voice Memo - ' + ts;
        // Convert blob to base64 for storage in note content
        var reader = new FileReader();
        reader.onloadend = function() {
          var base64 = reader.result;
          var content = '[VOICE_MEMO]' + base64;
          api('/api/notes', {
            method: 'POST',
            body: JSON.stringify({ title: title, content: content })
          }).then(function(resp) {
            if (resp.ok) {
              toast('Voice memo saved');
              if (typeof fetchNotes === 'function') fetchNotes();
            } else {
              toast('Failed to save voice memo');
            }
          }).catch(function() { toast('Failed to save voice memo'); });
        };
        reader.readAsDataURL(blob);
      }

      // Hook into renderNotes to show audio players for voice memos
      var _origRenderNotesForVoice = renderNotes;
      renderNotes = function() {
        _origRenderNotesForVoice();
        // Find note cards with voice memo content and add audio players
        document.querySelectorAll('.note-card').forEach(function(card) {
          var noteId = card.id.replace('note-', '');
          if (!noteId || !notesData) return;
          var note = notesData.find(function(n) { return n.id === noteId; });
          if (!note || !note.content || note.content.indexOf('[VOICE_MEMO]') !== 0) return;
          // Already has a player?
          if (card.querySelector('.note-audio-player')) return;
          var dataUrl = note.content.replace('[VOICE_MEMO]', '');
          var contentEl = card.querySelector('.note-card-content');
          if (contentEl) contentEl.innerHTML = '<em style="color:var(--text-tertiary);font-size:0.78rem;">Voice Memo</em>';
          var playerDiv = document.createElement('div');
          playerDiv.className = 'note-audio-player';
          var audio = document.createElement('audio');
          audio.controls = true;
          audio.src = dataUrl;
          playerDiv.appendChild(audio);
          // Insert after content
          if (contentEl && contentEl.nextSibling) {
            card.insertBefore(playerDiv, contentEl.nextSibling);
          } else {
            card.appendChild(playerDiv);
          }
        });
      };
    })();

    // ===== AUDIO SPECTRUM VISUALIZER =====
    var spectrumCtx = null, spectrumAnalyser = null, spectrumAudioCtx = null, spectrumStream = null, spectrumRunning = false;
    var spectrumStyle = 'bars', spectrumColor = 'rainbow';
    function toggleSpectrumMic() {
      var btn = document.getElementById('spectrum-mic-btn');
      if (spectrumRunning) {
        if (spectrumStream) spectrumStream.getTracks().forEach(function(t){ t.stop(); });
        spectrumRunning = false;
        btn.textContent = 'Mic Input';
        btn.classList.add('primary');
        return;
      }
      navigator.mediaDevices.getUserMedia({ audio: true }).then(function(stream) {
        spectrumStream = stream;
        spectrumAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
        spectrumAnalyser = spectrumAudioCtx.createAnalyser();
        spectrumAnalyser.fftSize = 256;
        var source = spectrumAudioCtx.createMediaStreamSource(stream);
        source.connect(spectrumAnalyser);
        spectrumRunning = true;
        btn.textContent = 'Stop';
        btn.classList.remove('primary');
        drawSpectrum();
      }).catch(function(e) { console.warn('Mic error:', e); });
    }
    function drawSpectrum() {
      if (!spectrumRunning) return;
      requestAnimationFrame(drawSpectrum);
      var canvas = document.getElementById('spectrum-canvas');
      if (!canvas) return;
      var ctx = canvas.getContext('2d');
      canvas.width = canvas.offsetWidth * 2;
      canvas.height = canvas.offsetHeight * 2;
      var W = canvas.width, H = canvas.height;
      ctx.clearRect(0, 0, W, H);
      var bufLen = spectrumAnalyser.frequencyBinCount;
      var data = new Uint8Array(bufLen);
      spectrumAnalyser.getByteFrequencyData(data);
      var style = document.getElementById('spectrum-style')?.value || spectrumStyle;
      var colorScheme = document.getElementById('spectrum-color')?.value || spectrumColor;
      function getColor(i, n, v) {
        var t = i / n;
        if (colorScheme === 'fire') return 'hsl(' + (t * 60) + ',100%,' + (30 + v / 255 * 50) + '%)';
        if (colorScheme === 'ice') return 'hsl(' + (180 + t * 60) + ',80%,' + (30 + v / 255 * 50) + '%)';
        if (colorScheme === 'matrix') return 'hsl(120,' + (60 + v / 255 * 40) + '%,' + (20 + v / 255 * 40) + '%)';
        return 'hsl(' + (t * 360) + ',85%,' + (35 + v / 255 * 35) + '%)';
      }
      if (style === 'bars') {
        var bw = W / bufLen * 2.5;
        for (var i = 0; i < bufLen; i++) {
          var bh = (data[i] / 255) * H;
          ctx.fillStyle = getColor(i, bufLen, data[i]);
          ctx.fillRect(i * bw, H - bh, bw - 1, bh);
        }
      } else if (style === 'wave') {
        spectrumAnalyser.getByteTimeDomainData(data);
        ctx.lineWidth = 2;
        ctx.beginPath();
        var sliceW = W / bufLen;
        for (var i = 0; i < bufLen; i++) {
          var v = data[i] / 128.0;
          var y = v * H / 2;
          ctx.strokeStyle = getColor(i, bufLen, data[i]);
          if (i === 0) ctx.moveTo(0, y); else ctx.lineTo(i * sliceW, y);
        }
        ctx.stroke();
      } else if (style === 'circle') {
        var cx = W / 2, cy = H / 2, radius = Math.min(W, H) * 0.3;
        for (var i = 0; i < bufLen; i++) {
          var angle = (i / bufLen) * Math.PI * 2;
          var amp = data[i] / 255;
          var r1 = radius;
          var r2 = radius + amp * radius * 0.8;
          ctx.strokeStyle = getColor(i, bufLen, data[i]);
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(cx + Math.cos(angle) * r1, cy + Math.sin(angle) * r1);
          ctx.lineTo(cx + Math.cos(angle) * r2, cy + Math.sin(angle) * r2);
          ctx.stroke();
        }
      }
    }

    // ===== AMBIENT SOUNDSCAPE MIXER =====
    (function() {
      var sounds = [
        { id: 'rain', icon: '', label: 'Rain', freq: [200, 400, 800], type: 'noise' },
        { id: 'wind', icon: '', label: 'Wind', freq: [100, 200], type: 'noise' },
        { id: 'fire', icon: '', label: 'Fire', freq: [300, 600, 1200], type: 'crackle' },
        { id: 'waves', icon: '', label: 'Waves', freq: [80, 160], type: 'sweep' },
        { id: 'birds', icon: '', label: 'Birds', freq: [2000, 3000, 4000], type: 'chirp' },
        { id: 'thunder', icon: '', label: 'Thunder', freq: [40, 80], type: 'rumble' },
        { id: 'night', icon: '', label: 'Night', freq: [4000, 5000, 6000], type: 'chirp' },
        { id: 'cafe', icon: '', label: 'Cafe', freq: [200, 800, 1600], type: 'murmur' }
      ];
      var audioCtx = null, activeNodes = {};
      var grid = document.getElementById('soundscape-grid');
      if (!grid) return;
      sounds.forEach(function(s) {
        var card = document.createElement('div');
        card.style.cssText = 'display:flex;flex-direction:column;align-items:center;gap:4px;padding:12px 8px;border-radius:10px;background:var(--surface);border:1px solid var(--border);cursor:pointer;transition:all 0.2s;user-select:none;-webkit-tap-highlight-color:transparent;';
        card.innerHTML = '<div style="font-size:1.5rem;">' + s.icon + '</div><div style="font-size:0.6rem;color:var(--text-tertiary);">' + s.label + '</div><input type="range" min="0" max="100" value="0" style="width:100%;height:4px;accent-color:var(--accent);" id="ss-vol-' + s.id + '">';
        card.dataset.soundId = s.id;
        var slider = card.querySelector('input');
        slider.addEventListener('input', function(e) {
          e.stopPropagation();
          var vol = +this.value / 100;
          if (vol > 0 && !activeNodes[s.id]) startSound(s, vol);
          else if (vol === 0 && activeNodes[s.id]) stopSound(s.id);
          else if (activeNodes[s.id]) activeNodes[s.id].gain.gain.setValueAtTime(vol * 0.3, audioCtx.currentTime);
          card.style.borderColor = vol > 0 ? 'var(--accent)' : 'var(--border)';
          card.style.background = vol > 0 ? 'rgba(139,124,246,0.08)' : 'var(--surface)';
        });
        grid.appendChild(card);
      });
      function ensureCtx() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
      function createNoise(ctx) {
        var bufSize = ctx.sampleRate * 2;
        var buf = ctx.createBuffer(1, bufSize, ctx.sampleRate);
        var data = buf.getChannelData(0);
        for (var i = 0; i < bufSize; i++) data[i] = Math.random() * 2 - 1;
        var src = ctx.createBufferSource();
        src.buffer = buf;
        src.loop = true;
        return src;
      }
      function startSound(s, vol) {
        ensureCtx();
        var gain = audioCtx.createGain();
        gain.gain.setValueAtTime(vol * 0.3, audioCtx.currentTime);
        var filter = audioCtx.createBiquadFilter();
        filter.type = 'bandpass';
        filter.frequency.setValueAtTime(s.freq[0], audioCtx.currentTime);
        filter.Q.setValueAtTime(0.5, audioCtx.currentTime);
        var src = createNoise(audioCtx);
        src.connect(filter);
        filter.connect(gain);
        gain.connect(audioCtx.destination);
        src.start();
        activeNodes[s.id] = { src: src, gain: gain, filter: filter };
      }
      function stopSound(id) {
        if (activeNodes[id]) {
          activeNodes[id].src.stop();
          delete activeNodes[id];
        }
      }
    })();

    // ===== BOIDS FLOCKING SIMULATION =====
    var boidsArr = [], boidsPredator = null, boidsAnimId = null;
    function initBoids(count) {
      var canvas = document.getElementById('boids-canvas');
      if (!canvas) return;
      canvas.width = canvas.offsetWidth * 2;
      canvas.height = canvas.offsetHeight * 2;
      boidsArr = [];
      for (var i = 0; i < count; i++) {
        boidsArr.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          vx: (Math.random() - 0.5) * 4,
          vy: (Math.random() - 0.5) * 4,
          hue: Math.random() * 60 + 220
        });
      }
      if (!boidsAnimId) animateBoids();
    }
    function resizeBoidsFlock(n) {
      var canvas = document.getElementById('boids-canvas');
      if (!canvas) return;
      while (boidsArr.length < n) boidsArr.push({ x: Math.random() * canvas.width, y: Math.random() * canvas.height, vx: (Math.random() - 0.5) * 4, vy: (Math.random() - 0.5) * 4, hue: Math.random() * 60 + 220 });
      while (boidsArr.length > n) boidsArr.pop();
    }
    function resetBoids() { initBoids(+(document.getElementById('boids-count')?.value || 120)); }
    function toggleBoidsPredator() {
      var btn = document.getElementById('boids-predator-btn');
      if (boidsPredator) { boidsPredator = null; btn.textContent = 'Add Predator'; }
      else {
        var c = document.getElementById('boids-canvas');
        boidsPredator = { x: c.width / 2, y: c.height / 2 };
        btn.textContent = 'Remove Predator';
      }
    }
    function animateBoids() {
      boidsAnimId = requestAnimationFrame(animateBoids);
      var canvas = document.getElementById('boids-canvas');
      if (!canvas || !canvas.offsetParent) return;
      var ctx = canvas.getContext('2d');
      var W = canvas.width, H = canvas.height;
      var speed = +(document.getElementById('boids-speed')?.value || 3);
      ctx.fillStyle = 'rgba(10,10,18,0.15)';
      ctx.fillRect(0, 0, W, H);
      var n = boidsArr.length;
      for (var i = 0; i < n; i++) {
        var b = boidsArr[i];
        var sx = 0, sy = 0, ax = 0, ay = 0, cx = 0, cy = 0, sc = 0, ac = 0, cc = 0;
        for (var j = 0; j < n; j++) {
          if (i === j) continue;
          var o = boidsArr[j];
          var dx = o.x - b.x, dy = o.y - b.y;
          var d = Math.sqrt(dx * dx + dy * dy);
          if (d < 25) { sx -= dx; sy -= dy; sc++; }
          if (d < 80) { ax += o.vx; ay += o.vy; ac++; }
          if (d < 120) { cx += o.x; cy += o.y; cc++; }
        }
        if (sc > 0) { b.vx += sx * 0.05; b.vy += sy * 0.05; }
        if (ac > 0) { b.vx += (ax / ac - b.vx) * 0.05; b.vy += (ay / ac - b.vy) * 0.05; }
        if (cc > 0) { b.vx += (cx / cc - b.x) * 0.003; b.vy += (cy / cc - b.y) * 0.003; }
        if (boidsPredator) {
          var pdx = b.x - boidsPredator.x, pdy = b.y - boidsPredator.y;
          var pd = Math.sqrt(pdx * pdx + pdy * pdy);
          if (pd < 150) { b.vx += (pdx / pd) * 2; b.vy += (pdy / pd) * 2; }
        }
        var mag = Math.sqrt(b.vx * b.vx + b.vy * b.vy);
        if (mag > speed) { b.vx = (b.vx / mag) * speed; b.vy = (b.vy / mag) * speed; }
        b.x += b.vx; b.y += b.vy;
        if (b.x < 0) b.x += W; if (b.x > W) b.x -= W;
        if (b.y < 0) b.y += H; if (b.y > H) b.y -= H;
        var angle = Math.atan2(b.vy, b.vx);
        ctx.save();
        ctx.translate(b.x, b.y);
        ctx.rotate(angle);
        ctx.fillStyle = 'hsl(' + b.hue + ',70%,65%)';
        ctx.beginPath();
        ctx.moveTo(8, 0);
        ctx.lineTo(-4, -3);
        ctx.lineTo(-4, 3);
        ctx.closePath();
        ctx.fill();
        ctx.restore();
      }
      if (boidsPredator) {
        ctx.fillStyle = '#f43f5e';
        ctx.beginPath();
        ctx.arc(boidsPredator.x, boidsPredator.y, 8, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    // Mouse moves predator
    (function() {
      var bc = document.getElementById('boids-canvas');
      if (bc) {
        bc.addEventListener('mousemove', function(e) {
          if (!boidsPredator) return;
          var r = bc.getBoundingClientRect();
          boidsPredator.x = (e.clientX - r.left) / r.width * bc.width;
          boidsPredator.y = (e.clientY - r.top) / r.height * bc.height;
        });
        bc.addEventListener('touchmove', function(e) {
          if (!boidsPredator || !e.touches[0]) return;
          var r = bc.getBoundingClientRect();
          boidsPredator.x = (e.touches[0].clientX - r.left) / r.width * bc.width;
          boidsPredator.y = (e.touches[0].clientY - r.top) / r.height * bc.height;
        }, { passive: true });
      }
    })();
    // Auto-init boids when tools page visible
    _navHooks.push(function(page) { if (page === 'tools' && boidsArr.length === 0) initBoids(120); });

    // ===== ACTIVITY HEATMAP =====
    (function() {
      var container = document.getElementById('heatmap-container');
      var statsEl = document.getElementById('heatmap-stats');
      var legendEl = document.getElementById('heatmap-legend');
      if (!container) return;
      var colors = ['#161b22', '#0e4429', '#006d32', '#26a641', '#39d353'];
      if (legendEl) colors.forEach(function(c) {
        var d = document.createElement('div');
        d.style.cssText = 'width:10px;height:10px;border-radius:2px;background:' + c;
        legendEl.appendChild(d);
      });
      function buildHeatmap() {
        container.innerHTML = '';
        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        var weeks = 52, cellSize = 11, gap = 2;
        svg.setAttribute('width', weeks * (cellSize + gap) + 30);
        svg.setAttribute('height', 7 * (cellSize + gap) + 20);
        svg.style.display = 'block';
        var now = new Date();
        var totalActivity = 0, activeDays = 0, maxStreak = 0, streak = 0;
        // Seed-based pseudo-random for consistent heatmap
        var seed = now.getFullYear() * 1000 + now.getMonth();
        function seededRandom() { seed = (seed * 9301 + 49297) % 233280; return seed / 233280; }
        var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        var lastMonth = -1;
        for (var w = 0; w < weeks; w++) {
          for (var d = 0; d < 7; d++) {
            var date = new Date(now);
            date.setDate(date.getDate() - ((weeks - 1 - w) * 7 + (6 - d)));
            var level = 0;
            var r = seededRandom();
            if (date.getDay() !== 0 && date.getDay() !== 6) {
              if (r < 0.15) level = 0;
              else if (r < 0.35) level = 1;
              else if (r < 0.6) level = 2;
              else if (r < 0.85) level = 3;
              else level = 4;
            } else {
              if (r < 0.5) level = 0;
              else if (r < 0.7) level = 1;
              else level = 2;
            }
            if (date > now) level = 0;
            if (level > 0) { totalActivity += level; activeDays++; streak++; if (streak > maxStreak) maxStreak = streak; }
            else { streak = 0; }
            var rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttribute('x', w * (cellSize + gap) + 25);
            rect.setAttribute('y', d * (cellSize + gap));
            rect.setAttribute('width', cellSize);
            rect.setAttribute('height', cellSize);
            rect.setAttribute('rx', 2);
            rect.setAttribute('fill', colors[level]);
            rect.style.cursor = 'pointer';
            svg.appendChild(rect);
            // Month labels
            if (d === 0 && date.getMonth() !== lastMonth) {
              lastMonth = date.getMonth();
              var txt = document.createElementNS('http://www.w3.org/2000/svg', 'text');
              txt.setAttribute('x', w * (cellSize + gap) + 25);
              txt.setAttribute('y', 7 * (cellSize + gap) + 12);
              txt.setAttribute('fill', '#848d97');
              txt.setAttribute('font-size', '9');
              txt.textContent = months[date.getMonth()];
              svg.appendChild(txt);
            }
          }
        }
        // Day labels
        ['Mon', 'Wed', 'Fri'].forEach(function(day, i) {
          var txt = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          txt.setAttribute('x', 0);
          txt.setAttribute('y', (i * 2 + 1) * (cellSize + gap) + 9);
          txt.setAttribute('fill', '#848d97');
          txt.setAttribute('font-size', '9');
          txt.textContent = day;
          svg.appendChild(txt);
        });
        container.appendChild(svg);
        if (statsEl) statsEl.textContent = totalActivity + ' contributions  |  ' + activeDays + ' active days  |  ' + maxStreak + ' day streak';
      }
      buildHeatmap();
    })();

    // ===== LIVE CHAT =====
    var chatMessages = [];
    var chatPollInterval = null;
    function sendChatMsg() {
      var input = document.getElementById('chat-input');
      var name = document.getElementById('chat-name');
      if (!input || !input.value.trim()) return;
      var msg = { name: (name?.value || '').trim() || 'anon', text: input.value.trim(), time: Date.now() };
      api('/api/chat', { method: 'POST', body: JSON.stringify(msg) }).then(function(r) { return r.json(); }).then(function() {
        input.value = '';
        fetchChatMsgs();
      }).catch(function(e) { console.warn('Chat send error:', e); });
    }
    function fetchChatMsgs() {
      api('/api/chat').then(function(r) { return r.json(); }).then(function(data) {
        var el = document.getElementById('chat-messages');
        if (!el) return;
        var msgs = data.messages || [];
        if (JSON.stringify(msgs) === JSON.stringify(chatMessages)) return;
        chatMessages = msgs;
        el.innerHTML = msgs.map(function(m) {
          var t = new Date(m.time).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
          var nameColor = '#' + ((m.name.split('').reduce(function(a, c) { return c.charCodeAt(0) + ((a << 5) - a); }, 0)) & 0xFFFFFF).toString(16).padStart(6, '0');
          return '<div style="margin-bottom:6px;"><span style="color:' + nameColor + ';font-weight:600;">' + escapeHTML(m.name) + '</span> <span style="color:var(--text-tertiary);font-size:0.6rem;">' + t + '</span><br>' + escapeHTML(m.text) + '</div>';
        }).join('');
        el.scrollTop = el.scrollHeight;
      }).catch(function() {});
    }
    function escapeHTML(s) { var d = document.createElement('div'); d.textContent = s; return d.innerHTML; }
    _navHooks.push(function(page) {
      if (page === 'tools') {
        fetchChatMsgs();
        if (!chatPollInterval) chatPollInterval = setInterval(fetchChatMsgs, 5000);
      } else {
        if (chatPollInterval) { clearInterval(chatPollInterval); chatPollInterval = null; }
      }
    });

    // ===== DRUM MACHINE =====
    var drumBPM = 120;
    var drumPlaying = false;
    var drumInterval = null;
    var drumStep = 0;
    var drumGrid = {};
    var drumCtx = null;
    var drumSounds = ['Kick','Snare','HiHat','Clap','Tom','Rim','Cym','Perc'];
    var drumColors = ['#fb7185','#fbbf24','#34d399','#a78bfa','#38bdf8','#f472b6','#facc15','#6ee7b7'];

    function initDrumGrid() {
      var el = document.getElementById('drum-grid');
      if (!el) return;
      el.innerHTML = '';
      drumSounds.forEach(function(name, row) {
        var label = document.createElement('div');
        label.style.cssText = 'display:flex;align-items:center;color:' + drumColors[row] + ';font-weight:600;font-size:0.65rem;padding-right:4px;';
        label.textContent = name;
        el.appendChild(label);
        for (var col = 0; col < 16; col++) {
          var pad = document.createElement('div');
          pad.dataset.row = row;
          pad.dataset.col = col;
          var key = row + '-' + col;
          pad.style.cssText = 'aspect-ratio:1;border-radius:4px;cursor:pointer;border:1px solid var(--border);background:' + (drumGrid[key] ? drumColors[row] : 'var(--surface)') + ';transition:background 0.1s;';
          if (col % 4 === 0) pad.style.borderLeft = '2px solid var(--border-hover)';
          pad.onclick = function() {
            var k = this.dataset.row + '-' + this.dataset.col;
            drumGrid[k] = !drumGrid[k];
            this.style.background = drumGrid[k] ? drumColors[+this.dataset.row] : 'var(--surface)';
            if (drumGrid[k]) playDrumSound(+this.dataset.row);
          };
          el.appendChild(pad);
        }
      });
    }

    function playDrumSound(type) {
      if (!drumCtx) drumCtx = new (window.AudioContext || window.webkitAudioContext)();
      var ctx = drumCtx;
      var t = ctx.currentTime;
      if (type === 0) { // Kick
        var osc = ctx.createOscillator(); var g = ctx.createGain();
        osc.type = 'sine'; osc.frequency.setValueAtTime(150, t); osc.frequency.exponentialRampToValueAtTime(30, t + 0.12);
        g.gain.setValueAtTime(1, t); g.gain.exponentialRampToValueAtTime(0.01, t + 0.2);
        osc.connect(g); g.connect(ctx.destination); osc.start(t); osc.stop(t + 0.2);
      } else if (type === 1) { // Snare
        var buf = ctx.createBuffer(1, ctx.sampleRate * 0.15, ctx.sampleRate);
        var d = buf.getChannelData(0); for (var i = 0; i < d.length; i++) d[i] = (Math.random() * 2 - 1) * Math.exp(-i / (ctx.sampleRate * 0.04));
        var n = ctx.createBufferSource(); var g = ctx.createGain(); n.buffer = buf;
        g.gain.setValueAtTime(0.6, t); g.gain.exponentialRampToValueAtTime(0.01, t + 0.15);
        n.connect(g); g.connect(ctx.destination); n.start(t);
      } else if (type === 2) { // HiHat
        var buf = ctx.createBuffer(1, ctx.sampleRate * 0.05, ctx.sampleRate);
        var d = buf.getChannelData(0); for (var i = 0; i < d.length; i++) d[i] = (Math.random() * 2 - 1) * Math.exp(-i / (ctx.sampleRate * 0.008));
        var n = ctx.createBufferSource(); var g = ctx.createGain(); n.buffer = buf;
        var hp = ctx.createBiquadFilter(); hp.type = 'highpass'; hp.frequency.value = 7000;
        g.gain.setValueAtTime(0.3, t); n.connect(hp); hp.connect(g); g.connect(ctx.destination); n.start(t);
      } else if (type === 3) { // Clap
        var buf = ctx.createBuffer(1, ctx.sampleRate * 0.12, ctx.sampleRate);
        var d = buf.getChannelData(0); for (var i = 0; i < d.length; i++) d[i] = (Math.random() * 2 - 1) * Math.exp(-i / (ctx.sampleRate * 0.025));
        var bp = ctx.createBiquadFilter(); bp.type = 'bandpass'; bp.frequency.value = 2000; bp.Q.value = 0.5;
        var n = ctx.createBufferSource(); var g = ctx.createGain(); n.buffer = buf;
        g.gain.setValueAtTime(0.5, t); n.connect(bp); bp.connect(g); g.connect(ctx.destination); n.start(t);
      } else { // Generic tone for others
        var freqs = [200, 800, 400, 1200];
        var osc = ctx.createOscillator(); var g = ctx.createGain();
        osc.type = type === 6 ? 'triangle' : 'square';
        osc.frequency.setValueAtTime(freqs[type - 4] || 300, t);
        osc.frequency.exponentialRampToValueAtTime(50, t + 0.1);
        g.gain.setValueAtTime(0.3, t); g.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
        osc.connect(g); g.connect(ctx.destination); osc.start(t); osc.stop(t + 0.1);
      }
    }

    function toggleDrumSequencer() {
      drumPlaying = !drumPlaying;
      var btn = document.getElementById('drum-play-btn');
      if (drumPlaying) {
        if (!drumCtx) drumCtx = new (window.AudioContext || window.webkitAudioContext)();
        btn.innerHTML = '&#9632; Stop';
        drumStep = 0;
        stepDrum();
        drumInterval = setInterval(stepDrum, 60000 / drumBPM / 4);
      } else {
        btn.innerHTML = '&#9654; Play';
        clearInterval(drumInterval);
        highlightDrumCol(-1);
      }
    }

    function stepDrum() {
      highlightDrumCol(drumStep);
      for (var row = 0; row < drumSounds.length; row++) {
        if (drumGrid[row + '-' + drumStep]) playDrumSound(row);
      }
      drumStep = (drumStep + 1) % 16;
    }

    function highlightDrumCol(col) {
      var el = document.getElementById('drum-grid');
      if (!el) return;
      var pads = el.querySelectorAll('div[data-col]');
      pads.forEach(function(p) {
        var r = +p.dataset.row, c = +p.dataset.col;
        var key = r + '-' + c;
        if (c === col) {
          p.style.background = drumGrid[key] ? '#fff' : 'rgba(255,255,255,0.1)';
        } else {
          p.style.background = drumGrid[key] ? drumColors[r] : 'var(--surface)';
        }
      });
    }

    function clearDrumGrid() { drumGrid = {}; initDrumGrid(); }

    document.addEventListener('keydown', function(e) {
      if (e.code === 'Space' && document.querySelector('#page-tools.active') && document.getElementById('drum-grid')) {
        if (document.activeElement && (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA')) return;
        e.preventDefault();
        toggleDrumSequencer();
      }
    });

    // ===== SYNTHESIZER KEYBOARD =====
    var synthCtx = null;
    var synthOctave = 4;
    var synthWaveform = 'sawtooth';
    var synthActiveKeys = {};
    var synthKeyMap = {'a':0,'w':1,'s':2,'e':3,'d':4,'f':5,'t':6,'g':7,'y':8,'h':9,'u':10,'j':11,'k':12};

    function renderSynthKeys() {
      var el = document.getElementById('synth-keyboard');
      if (!el) return;
      document.getElementById('synth-octave-val').textContent = synthOctave;
      el.innerHTML = '';
      var notes = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B','C'];
      var isBlack = [0,1,0,1,0,0,1,0,1,0,1,0,0];
      // White keys
      var whiteIdx = 0;
      for (var i = 0; i < 13; i++) {
        if (isBlack[i]) continue;
        var key = document.createElement('div');
        key.dataset.note = i;
        key.style.cssText = 'flex:1;background:linear-gradient(180deg,#f8f8f8,#e0e0e0);border:1px solid #999;border-radius:0 0 6px 6px;cursor:pointer;display:flex;align-items:flex-end;justify-content:center;padding-bottom:8px;font-size:0.55rem;color:#666;position:relative;z-index:1;transition:background 0.05s;';
        key.textContent = notes[i];
        key.onmousedown = function(e) { e.preventDefault(); synthNoteOn(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#d0d0ff,#b0b0e0)'; };
        key.onmouseup = function() { synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#f8f8f8,#e0e0e0)'; };
        key.onmouseleave = function() { synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#f8f8f8,#e0e0e0)'; };
        key.ontouchstart = function(e) { e.preventDefault(); synthNoteOn(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#d0d0ff,#b0b0e0)'; };
        key.ontouchend = function(e) { e.preventDefault(); synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#f8f8f8,#e0e0e0)'; };
        el.appendChild(key);
        whiteIdx++;
      }
      // Black keys overlay
      var blackPositions = [1,3,null,6,8,10,null];
      var whiteWidth = 100 / 8; // 8 white keys
      var positions = {1:1,3:2,6:4,8:5,10:6};
      for (var i = 0; i < 13; i++) {
        if (!isBlack[i]) continue;
        var key = document.createElement('div');
        key.dataset.note = i;
        var pos = positions[i] || 0;
        key.style.cssText = 'position:absolute;left:calc(' + (pos * whiteWidth) + '% + ' + (whiteWidth * 0.6) + '%);width:' + (whiteWidth * 0.7) + '%;height:65%;background:linear-gradient(180deg,#222,#111);border:1px solid #000;border-radius:0 0 4px 4px;cursor:pointer;z-index:2;display:flex;align-items:flex-end;justify-content:center;padding-bottom:6px;font-size:0.5rem;color:#888;transition:background 0.05s;';
        key.textContent = notes[i];
        key.onmousedown = function(e) { e.preventDefault(); e.stopPropagation(); synthNoteOn(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#444,#333)'; };
        key.onmouseup = function() { synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#222,#111)'; };
        key.onmouseleave = function() { synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#222,#111)'; };
        key.ontouchstart = function(e) { e.preventDefault(); e.stopPropagation(); synthNoteOn(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#444,#333)'; };
        key.ontouchend = function(e) { e.preventDefault(); synthNoteOff(+this.dataset.note); this.style.background = 'linear-gradient(180deg,#222,#111)'; };
        el.appendChild(key);
      }
    }

    function synthNoteOn(noteIdx) {
      if (synthActiveKeys[noteIdx]) return;
      if (!synthCtx) synthCtx = new (window.AudioContext || window.webkitAudioContext)();
      var freq = 440 * Math.pow(2, (noteIdx - 9 + (synthOctave - 4) * 12) / 12);
      var osc = synthCtx.createOscillator();
      var gain = synthCtx.createGain();
      var filter = synthCtx.createBiquadFilter();
      osc.type = synthWaveform;
      osc.frequency.setValueAtTime(freq, synthCtx.currentTime);
      filter.type = 'lowpass';
      filter.frequency.setValueAtTime(3000, synthCtx.currentTime);
      gain.gain.setValueAtTime(0, synthCtx.currentTime);
      gain.gain.linearRampToValueAtTime(0.2, synthCtx.currentTime + 0.02);
      osc.connect(filter);
      filter.connect(gain);
      gain.connect(synthCtx.destination);
      osc.start();
      synthActiveKeys[noteIdx] = { osc: osc, gain: gain };
    }

    function synthNoteOff(noteIdx) {
      var k = synthActiveKeys[noteIdx];
      if (!k) return;
      k.gain.gain.linearRampToValueAtTime(0, synthCtx.currentTime + 0.1);
      setTimeout(function() { try { k.osc.stop(); } catch(e) {} }, 150);
      delete synthActiveKeys[noteIdx];
    }

    document.addEventListener('keydown', function(e) {
      if (document.activeElement && (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA')) return;
      if (!document.querySelector('#page-tools.active')) return;
      var note = synthKeyMap[e.key.toLowerCase()];
      if (note !== undefined && !e.repeat) synthNoteOn(note);
    });
    document.addEventListener('keyup', function(e) {
      var note = synthKeyMap[e.key.toLowerCase()];
      if (note !== undefined) synthNoteOff(note);
    });

    // ===== GUESTBOOK =====
    function signGuestbook() {
      var name = document.getElementById('gb-name');
      var msg = document.getElementById('gb-msg');
      var emoji = document.getElementById('gb-emoji');
      if (!msg || !msg.value.trim()) return;
      var entry = {
        name: (name.value.trim() || 'Anonymous'),
        msg: msg.value.trim(),
        emoji: emoji.value,
        ts: Date.now()
      };
      api('/api/guestbook', { method: 'POST', body: JSON.stringify(entry) })
        .then(function() { msg.value = ''; fetchGuestbook(); })
        .catch(function(e) { console.error('Guestbook error:', e); });
    }

    function fetchGuestbook() {
      api('/api/guestbook')
        .then(function(r) { return r.json(); })
        .then(function(entries) {
          var el = document.getElementById('guestbook-entries');
          if (!el) return;
          if (!entries.length) { el.innerHTML = '<div style="color:var(--text-tertiary);text-align:center;padding:40px 0;">No entries yet. Be the first to sign!</div>'; return; }
          el.innerHTML = entries.map(function(e) {
            var d = new Date(e.ts);
            var timeStr = d.toLocaleDateString() + ' ' + d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
            return '<div style="padding:8px 0;border-bottom:1px solid var(--border);">' +
              '<span style="font-size:1rem;">' + e.emoji + '</span> ' +
              '<strong style="color:var(--accent);">' + escapeHTML(e.name) + '</strong> ' +
              '<span style="color:var(--text-tertiary);font-size:0.65rem;">' + timeStr + '</span>' +
              '<div style="margin-top:2px;color:var(--text-secondary);">' + escapeHTML(e.msg) + '</div></div>';
          }).join('');
        })
        .catch(function() {});
    }

    // ===== GENERATIVE ART =====
    function genArt(style) {
      var canvas = document.getElementById('genart-canvas');
      if (!canvas) return;
      var ctx = canvas.getContext('2d');
      var w = canvas.width, h = canvas.height;
      ctx.fillStyle = '#08080c';
      ctx.fillRect(0, 0, w, h);
      var palette = [
        ['#fb7185','#fbbf24','#34d399','#a78bfa','#38bdf8'],
        ['#ff6b6b','#feca57','#48dbfb','#ff9ff3','#54a0ff'],
        ['#6c5ce7','#fd79a8','#00cec9','#fdcb6e','#e17055']
      ];
      var colors = palette[Math.floor(Math.random() * palette.length)];
      var styles = ['circles', 'flow', 'geo'];
      if (!style) style = styles[Math.floor(Math.random() * styles.length)];

      if (style === 'circles') {
        for (var i = 0; i < 80; i++) {
          ctx.beginPath();
          var x = Math.random() * w, y = Math.random() * h, r = Math.random() * 50 + 5;
          ctx.arc(x, y, r, 0, Math.PI * 2);
          ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)] + (Math.random() > 0.5 ? '44' : '88');
          ctx.fill();
          if (Math.random() > 0.6) { ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)] + '66'; ctx.lineWidth = 1; ctx.stroke(); }
        }
        // Add some connecting lines
        for (var i = 0; i < 30; i++) {
          ctx.beginPath();
          ctx.moveTo(Math.random() * w, Math.random() * h);
          ctx.lineTo(Math.random() * w, Math.random() * h);
          ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)] + '22';
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      } else if (style === 'flow') {
        var seed = Math.random() * 100;
        var res = 15;
        for (var i = 0; i < 500; i++) {
          var x = Math.random() * w, y = Math.random() * h;
          ctx.beginPath();
          ctx.moveTo(x, y);
          ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)] + '55';
          ctx.lineWidth = Math.random() * 2 + 0.5;
          for (var j = 0; j < 30; j++) {
            var angle = Math.sin(x / res + seed) * Math.cos(y / res + seed) * Math.PI * 4;
            x += Math.cos(angle) * 3;
            y += Math.sin(angle) * 3;
            ctx.lineTo(x, y);
          }
          ctx.stroke();
        }
      } else if (style === 'geo') {
        for (var i = 0; i < 40; i++) {
          ctx.save();
          ctx.translate(Math.random() * w, Math.random() * h);
          ctx.rotate(Math.random() * Math.PI * 2);
          var size = Math.random() * 60 + 10;
          var sides = Math.floor(Math.random() * 4) + 3;
          ctx.beginPath();
          for (var j = 0; j <= sides; j++) {
            var a = (j / sides) * Math.PI * 2;
            var px = Math.cos(a) * size, py = Math.sin(a) * size;
            j === 0 ? ctx.moveTo(px, py) : ctx.lineTo(px, py);
          }
          ctx.closePath();
          if (Math.random() > 0.4) { ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)] + '33'; ctx.fill(); }
          ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)] + '88';
          ctx.lineWidth = Math.random() * 2 + 0.5;
          ctx.stroke();
          ctx.restore();
        }
      }
    }

    // ===== DRAWING CANVAS =====
    (function() {
      var canvas = document.getElementById('draw-canvas');
      if (!canvas) return;
      var ctx = canvas.getContext('2d');
      var drawing = false;
      var erasing = false;
      ctx.fillStyle = '#0a0a10';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';

      function getPos(e) {
        var rect = canvas.getBoundingClientRect();
        var touch = e.touches ? e.touches[0] : e;
        return {
          x: (touch.clientX - rect.left) * (canvas.width / rect.width),
          y: (touch.clientY - rect.top) * (canvas.height / rect.height)
        };
      }

      function startDraw(e) {
        drawing = true;
        var p = getPos(e);
        ctx.beginPath();
        ctx.moveTo(p.x, p.y);
      }

      function doDraw(e) {
        if (!drawing) return;
        e.preventDefault();
        var p = getPos(e);
        var sizeEl = document.getElementById('draw-size');
        var colorEl = document.getElementById('draw-color');
        ctx.lineWidth = sizeEl ? +sizeEl.value : 3;
        ctx.strokeStyle = erasing ? '#0a0a10' : (colorEl ? colorEl.value : '#8b7cf6');
        ctx.lineTo(p.x, p.y);
        ctx.stroke();
      }

      function endDraw() { drawing = false; }

      canvas.addEventListener('mousedown', startDraw);
      canvas.addEventListener('mousemove', doDraw);
      canvas.addEventListener('mouseup', endDraw);
      canvas.addEventListener('mouseleave', endDraw);
      canvas.addEventListener('touchstart', startDraw, { passive: false });
      canvas.addEventListener('touchmove', doDraw, { passive: false });
      canvas.addEventListener('touchend', endDraw);

      window.drawEraser = function() { erasing = !erasing; canvas.style.cursor = erasing ? 'cell' : 'crosshair'; };
      window.clearDrawCanvas = function() {
        ctx.fillStyle = '#0a0a10';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      };
      window.saveDrawCanvas = function() {
        var link = document.createElement('a');
        link.download = 'drawing.png';
        link.href = canvas.toDataURL();
        link.click();
      };
    })();

    // ===== NEON TEXT GENERATOR =====
    var neonColor = '#ff00ff';
    function renderNeonText() {
      var input = document.getElementById('neon-input');
      var preview = document.getElementById('neon-preview');
      if (!input || !preview) return;
      var text = input.value || 'NEON';
      var c = neonColor;
      preview.innerHTML = '<div style="font-family:\'JetBrains Mono\',monospace;font-size:2.5rem;font-weight:700;color:' + c + ';text-shadow:0 0 7px ' + c + ',0 0 10px ' + c + ',0 0 21px ' + c + ',0 0 42px ' + c + ',0 0 82px ' + c + ',0 0 92px ' + c + ';letter-spacing:4px;">' + escapeHTML(text) + '</div>';
    }

    function copyNeonCSS() {
      var text = document.getElementById('neon-input').value || 'NEON';
      var c = neonColor;
      var css = 'color: ' + c + ';\ntext-shadow:\n  0 0 7px ' + c + ',\n  0 0 10px ' + c + ',\n  0 0 21px ' + c + ',\n  0 0 42px ' + c + ',\n  0 0 82px ' + c + ',\n  0 0 92px ' + c + ';';
      navigator.clipboard.writeText(css).then(function() {
        var btn = document.querySelector('[onclick="copyNeonCSS()"]');
        if (btn) { btn.textContent = 'Copied!'; setTimeout(function() { btn.textContent = 'Copy CSS'; }, 1500); }
      });
    }

    // Init tools on nav
    _navHooks.push(function(page) {
      if (page === 'tools') {
        initDrumGrid();
        renderSynthKeys();
        genArt();
        renderNeonText();
        fetchGuestbook();
      }
    });

    // ===== DREAMS BOOK =====
    var _dreamsData = null;
    var _dreamsCurrentCh = null;
    var _dreamsAllChapters = [];

    function loadDreamsBook() {
      var toc = document.getElementById('dreams-toc');
      if (toc && !_dreamsData) toc.innerHTML = '<div style="text-align:center;padding:40px;color:var(--muted);font-size:0.85rem;">Loading chapters...</div>';
      api('/api/dreams').then(function(r) { return r.json(); }).then(function(data) {
        _dreamsData = data;
        _dreamsAllChapters = [];
        (data.parts || []).forEach(function(part) {
          (part.chapters || []).forEach(function(ch) {
            ch._partTitle = part.title;
            _dreamsAllChapters.push(ch);
          });
        });
        renderDreamsTOC();
        if (_dreamsCurrentCh) showDreamsChapter(_dreamsCurrentCh);
      }).catch(function(e) { console.error('Dreams load error:', e); if (toc) toc.innerHTML = '<div style="text-align:center;padding:40px;color:#f87171;font-size:0.85rem;">Failed to load chapters. Try refreshing.</div>'; });
    }

    function renderDreamsTOC() {
      var toc = document.getElementById('dreams-toc');
      if (!toc || !_dreamsData) return;
      var html = '';
      (_dreamsData.parts || []).forEach(function(part) {
        html += '<div class="dreams-part"><div class="dreams-part-title">' + escapeHtml(part.title) + '</div>';
        (part.chapters || []).forEach(function(ch) {
          var active = _dreamsCurrentCh === ch.id ? ' active' : '';
          html += '<div class="dreams-chapter-link' + active + '" data-ch="' + ch.id + '" onclick="showDreamsChapter(\'' + ch.id + '\')">';
          html += '<span class="dreams-ch-num">' + ch.num + '</span>';
          html += '<span class="dreams-ch-title">' + escapeHtml(ch.title) + '</span>';
          html += '</div>';
        });
        html += '</div>';
      });
      toc.innerHTML = html;
    }

    function dreamsShowTOC() {
      _dreamsCurrentCh = null;
      var toc = document.getElementById('dreams-toc');
      var wrap = document.getElementById('dreams-reader-wrap');
      var header = document.querySelector('.dreams-header-bar');
      if (toc) toc.style.display = '';
      if (wrap) wrap.style.display = 'none';
      if (header) header.style.display = '';
      renderDreamsTOC();
      window.scrollTo(0, 0);
    }

    function showDreamsChapter(chId) {
      _dreamsCurrentCh = chId;
      var ch = _dreamsAllChapters.find(function(c) { return c.id === chId; });
      if (!ch || !ch.content || ch.content.trim() === '') return;
      // Hide TOC, show reader
      var toc = document.getElementById('dreams-toc');
      var wrap = document.getElementById('dreams-reader-wrap');
      var header = document.querySelector('.dreams-header-bar');
      if (toc) toc.style.display = 'none';
      if (wrap) wrap.style.display = 'block';
      if (header) header.style.display = 'none';
      document.getElementById('dreams-r-ch').textContent = 'Chapter ' + ch.num;
      document.getElementById('dreams-r-title').textContent = ch.title;
      document.getElementById('dreams-r-subtitle').textContent = ch.subtitle || '';
      document.getElementById('dreams-r-words').textContent = (ch.wordCount || 0).toLocaleString() + ' words';
      // Parse markdown-ish content to HTML
      var body = ch.content;
      body = body.replace(/^### (.+)$/gm, '<h3>$1</h3>');
      body = body.replace(/^## (.+)$/gm, '<h2>$1</h2>');
      body = body.replace(/^> (.+)$/gm, '<blockquote>$1</blockquote>');
      body = body.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
      body = body.replace(/\*(.+?)\*/g, '<em>$1</em>');
      body = body.replace(/^---$/gm, '<hr>');
      // Wrap paragraphs
      body = body.split(/\n\n+/).map(function(p) {
        p = p.trim();
        if (!p) return '';
        if (p.startsWith('<h') || p.startsWith('<blockquote') || p.startsWith('<hr')) return p;
        return '<p>' + p + '</p>';
      }).join('\n');
      document.getElementById('dreams-r-body').innerHTML = body;
      // Nav buttons
      var idx = _dreamsAllChapters.findIndex(function(c) { return c.id === chId; });
      document.getElementById('dreams-prev').disabled = idx <= 0;
      document.getElementById('dreams-next').disabled = idx >= _dreamsAllChapters.length - 1;
      window.scrollTo(0, 0);
    }

    function dreamNavPrev() {
      var idx = _dreamsAllChapters.findIndex(function(c) { return c.id === _dreamsCurrentCh; });
      if (idx > 0) showDreamsChapter(_dreamsAllChapters[idx - 1].id);
    }
    function dreamNavNext() {
      var idx = _dreamsAllChapters.findIndex(function(c) { return c.id === _dreamsCurrentCh; });
      if (idx < _dreamsAllChapters.length - 1) showDreamsChapter(_dreamsAllChapters[idx + 1].id);
    }

    // Load dreams data when navigating to that page
    _navHooks.push(function(page) {
      if (page === 'dreams') { dreamsShowTOC(); loadDreamsBook(); }
    });

    // ===== KALSHI LIVE TRADING DASHBOARD =====
    var _klData = null;
    var _klInterval = null;
    var _klTab = 'live';

    function klSwitchTab(tab) {
      _klTab = tab;
      document.querySelectorAll('.kl-tab').forEach(function(t) {
        t.classList.toggle('active', t.getAttribute('data-kltab') === tab);
      });
      ['live','signals','positions','research'].forEach(function(t) {
        var el = document.getElementById('kl-tab-' + t);
        if (el) el.style.display = t === tab ? '' : 'none';
      });
      if (tab === 'research') klLoadResearch();
    }

    function klFetchLive() {
      api('/api/kalshi/live').then(function(r) { return r.json(); }).then(function(data) {
        _klData = data;
        klRenderAll(data);
      }).catch(function(e) { console.error('Kalshi live error:', e); });
    }

    function klRenderAll(d) {
      // Status pill
      var pill = document.getElementById('kl-status-pill');
      var dot = document.getElementById('kl-dot');
      var stxt = document.getElementById('kl-status-text');
      if (d.error && !d.session_active) {
        pill.className = 'kl-status-pill sleeping';
        dot.className = 'kl-dot sleeping';
        stxt.textContent = 'Offline';
      } else if (d.session_active) {
        pill.className = 'kl-status-pill active';
        dot.className = 'kl-dot active pulse';
        stxt.textContent = 'Live Session';
      } else {
        pill.className = 'kl-status-pill sleeping';
        dot.className = 'kl-dot sleeping pulse';
        stxt.textContent = 'Sleeping';
      }
      if (!d.auth_ok && d.session_active) {
        pill.className = 'kl-status-pill error';
        dot.className = 'kl-dot error pulse';
        stxt.textContent = 'No Auth';
      }

      // Stats row
      var bal = d.balance || 'N/A';
      var pnl = (d.executor && d.executor.total_pnl) || 0;
      var trades = (d.executor && d.executor.total_trades) || 0;
      var positions = (d.executor && d.executor.open_positions) || 0;
      var games = (d.live_games || []).length;
      var markets = d.markets_tracked || 0;
      var statsHtml = '';
      statsHtml += '<div class="kl-stat-card"><div class="val amber">' + escapeHtml(String(bal)) + '</div><div class="lbl">Balance</div></div>';
      statsHtml += '<div class="kl-stat-card"><div class="val ' + (pnl > 0 ? 'green' : pnl < 0 ? 'red' : '') + '">' + (pnl >= 0 ? '+' : '') + pnl + 'c</div><div class="lbl">Session P&L</div></div>';
      statsHtml += '<div class="kl-stat-card"><div class="val">' + games + '</div><div class="lbl">Live Games</div></div>';
      statsHtml += '<div class="kl-stat-card"><div class="val">' + markets + '</div><div class="lbl">Markets</div></div>';
      statsHtml += '<div class="kl-stat-card"><div class="val">' + trades + '</div><div class="lbl">Trades</div></div>';
      statsHtml += '<div class="kl-stat-card"><div class="val">' + positions + '</div><div class="lbl">Positions</div></div>';
      document.getElementById('kl-stats-row').innerHTML = statsHtml;

      // Live games
      var gamesEl = document.getElementById('kl-games-list');
      document.getElementById('kl-game-count').textContent = games + ' game' + (games !== 1 ? 's' : '');
      if (games === 0) {
        gamesEl.innerHTML = '<div class="kl-empty">No live games right now. Bot wakes at 6 PM EST for tonight\'s slate.</div>';
      } else {
        var gh = '';
        (d.live_games || []).forEach(function(g) {
          var parts = (g.name || '').split(' @ ');
          var away = parts[0] || '?';
          var home = parts[1] || '?';
          var fv = g.model_fv || 50;
          var mp = g.market_price || 0;
          var edge = g.edge || 0;
          var delta = g.delta_per_point || 0;
          gh += '<div class="kl-game-card">';
          gh += '<div class="kl-game-top"><div class="kl-game-name">' + escapeHtml(g.name || 'Unknown') + '</div>';
          gh += '<div class="kl-game-clock">' + escapeHtml(g.clock || '') + ' P' + (g.period || '?') + '</div></div>';
          gh += '<div class="kl-game-score">';
          gh += '<span class="kl-score-team">' + escapeHtml(away) + '</span>';
          gh += '<span class="kl-score-num">' + (g.away_score || 0) + '</span>';
          gh += '<span class="kl-score-dash">-</span>';
          gh += '<span class="kl-score-num">' + (g.home_score || 0) + '</span>';
          gh += '<span class="kl-score-team">' + escapeHtml(home) + '</span>';
          gh += '</div>';
          gh += '<div class="kl-game-metrics">';
          gh += '<div class="kl-metric"><div class="mv neutral">' + fv + 'c</div><div class="ml">Model FV</div></div>';
          gh += '<div class="kl-metric"><div class="mv neutral">' + (mp || '---') + 'c</div><div class="ml">Market</div></div>';
          var edgeCls = edge > 0 ? 'pos' : edge < 0 ? 'neg' : 'neutral';
          gh += '<div class="kl-metric"><div class="mv ' + edgeCls + '">' + (edge >= 0 ? '+' : '') + edge + 'c</div><div class="ml">Edge</div></div>';
          gh += '<div class="kl-metric"><div class="mv neutral">' + delta.toFixed(3) + '</div><div class="ml">Delta/pt</div></div>';
          gh += '</div>';
          if (g.ticker) {
            gh += '<div style="margin-top:8px;font-size:0.65rem;color:var(--muted);">Ticker: ' + escapeHtml(g.ticker) + '</div>';
          }
          gh += '</div>';
        });
        gamesEl.innerHTML = gh;
      }

      // Signals
      var sigs = d.recent_signals || [];
      document.getElementById('kl-signal-count').textContent = sigs.length;
      var sigHtml = klRenderSignals(sigs.slice(-5).reverse());
      document.getElementById('kl-signals-preview').innerHTML = sigHtml || '<div class="kl-empty">No signals yet this session.</div>';
      document.getElementById('kl-signals-full').innerHTML = klRenderSignals(sigs.slice().reverse()) || '<div class="kl-empty">No signals generated yet.</div>';

      // Positions tab
      var exec = d.executor || {};
      var execStats = '';
      execStats += '<div class="kl-stat-card"><div class="val">' + (exec.open_positions || 0) + '</div><div class="lbl">Open</div></div>';
      execStats += '<div class="kl-stat-card"><div class="val">' + (exec.total_trades || 0) + '</div><div class="lbl">Closed</div></div>';
      execStats += '<div class="kl-stat-card"><div class="val ' + ((exec.total_pnl || 0) >= 0 ? 'green' : 'red') + '">' + ((exec.total_pnl || 0) >= 0 ? '+' : '') + (exec.total_pnl || 0) + 'c</div><div class="lbl">Total P&L</div></div>';
      execStats += '<div class="kl-stat-card"><div class="val">' + (exec.enabled ? 'ON' : 'OFF') + '</div><div class="lbl">Executor</div></div>';
      document.getElementById('kl-exec-stats').innerHTML = execStats;

      var posHtml = '';
      var posObj = (exec.positions || {});
      var posKeys = Object.keys(posObj);
      if (posKeys.length === 0) {
        posHtml = '<div class="kl-empty">No open positions.</div>';
      } else {
        posKeys.forEach(function(t) {
          var p = posObj[t];
          var pnlVal = p.pnl || 0;
          posHtml += '<div class="kl-pos-card">';
          posHtml += '<span class="ticker">' + escapeHtml(t) + '</span>';
          posHtml += '<span class="side ' + (p.side || 'yes') + '">' + (p.side || 'yes') + '</span>';
          posHtml += '<span class="entry">' + (p.entry_price || '?') + 'c</span>';
          posHtml += '<span class="pnl ' + (pnlVal >= 0 ? 'pos' : 'neg') + '">' + (pnlVal >= 0 ? '+' : '') + pnlVal + 'c</span>';
          posHtml += '</div>';
        });
      }
      document.getElementById('kl-positions-list').innerHTML = posHtml;
      document.getElementById('kl-trades-list').innerHTML = '<div class="kl-empty">Trade history loads from session logs.</div>';

      // Updated timestamp
      if (d.updated_at_str) {
        document.getElementById('kl-updated').textContent = 'Last update: ' + d.updated_at_str;
      }
    }

    function klRenderSignals(sigs) {
      if (!sigs || sigs.length === 0) return '';
      var html = '';
      sigs.forEach(function(s) {
        html += '<div class="kl-signal-row">';
        html += '<span class="strat">' + escapeHtml(s.strategy || '?') + '</span>';
        html += '<span class="side ' + (s.side || 'yes') + '">' + (s.side || 'yes') + '</span>';
        var ev = s.edge || 0;
        html += '<span class="edge ' + (ev > 0 ? 'pos' : ev < 0 ? 'neg' : '') + '">' + (ev >= 0 ? '+' : '') + ev + 'c</span>';
        // Strength bars (0-10)
        var str = Math.min(10, Math.max(0, Math.round(s.strength || 0)));
        html += '<span class="strength">';
        for (var i = 0; i < 10; i++) {
          html += '<span class="str-bar' + (i < str ? ' filled' : '') + '"></span>';
        }
        html += '</span>';
        html += '<span class="reason">' + escapeHtml(s.reason || '') + '</span>';
        if (s.ts) {
          var dt = new Date(s.ts * 1000);
          html += '<span class="time">' + dt.toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) + '</span>';
        }
        html += '</div>';
      });
      return html;
    }

    function klLoadResearch() {
      var el = document.getElementById('kl-research-content');
      if (!el) return;
      el.innerHTML = '<div style="text-align:center;padding:40px;color:var(--muted);font-size:0.85rem;">Loading research...</div>';
      api('/api/kalshi').then(function(r) { return r.json(); }).then(function(data) {
        var reports = data.reports || [];
        if (reports.length === 0) {
          el.innerHTML = '<div class="kl-empty">No research reports yet.</div>';
          return;
        }
        var html = '<div style="font-size:0.75rem;color:var(--muted);margin-bottom:12px;">' + reports.length + ' reports, ' + (data.totalWords||0).toLocaleString() + ' words</div>';
        reports.forEach(function(r) {
          html += '<div style="display:flex;align-items:center;gap:12px;padding:14px 16px;cursor:pointer;border-radius:8px;border:1px solid var(--border);margin-bottom:8px;font-size:0.85rem;color:var(--text);background:var(--surface);transition:all 0.15s;" onmouseover="this.style.borderColor=\'#f59e0b\'" onmouseout="this.style.borderColor=\'\'">';
          html += '<span style="font-size:0.7rem;color:var(--muted);min-width:22px;font-weight:600;">' + r.num + '</span>';
          html += '<span style="flex:1;">' + escapeHtml(r.title) + '</span>';
          html += '<span style="font-size:0.65rem;color:var(--muted);">' + (r.wordCount || 0).toLocaleString() + 'w</span>';
          html += '</div>';
        });
        el.innerHTML = html;
      }).catch(function() {
        el.innerHTML = '<div class="kl-empty">Failed to load research.</div>';
      });
    }

    _navHooks.push(function(page) {
      if (page === 'kalshi') {
        klFetchLive();
        if (!_klInterval) {
          _klInterval = setInterval(klFetchLive, 10000);
        }
      } else {
        if (_klInterval) {
          clearInterval(_klInterval);
          _klInterval = null;
        }
      }
    });

    // ===== HAMBURGER MOBILE NAV =====
    (function() {
      var hamburger = document.getElementById('hamburger-btn');
      var nav = document.getElementById('main-nav');
      if (!hamburger || !nav) return;

      // Create overlay element
      var overlay = document.createElement('div');
      overlay.className = 'nav-overlay';
      overlay.id = 'nav-overlay';
      document.body.appendChild(overlay);

      function openNav() {
        hamburger.classList.add('open');
        hamburger.setAttribute('aria-expanded', 'true');
        nav.classList.add('mobile-open');
        overlay.classList.add('visible');
        document.body.style.overflow = 'hidden';
      }

      function closeNav() {
        hamburger.classList.remove('open');
        hamburger.setAttribute('aria-expanded', 'false');
        nav.classList.remove('mobile-open');
        overlay.classList.remove('visible');
        document.body.style.overflow = '';
      }

      function toggleNav() {
        if (nav.classList.contains('mobile-open')) {
          closeNav();
        } else {
          openNav();
        }
      }

      hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleNav();
      });

      overlay.addEventListener('click', closeNav);

      // Close nav when a nav link is clicked (mobile)
      nav.querySelectorAll('.nav-link').forEach(function(link) {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 768) {
            closeNav();
          }
        });
      });

      // Close nav on Escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && nav.classList.contains('mobile-open')) {
          closeNav();
        }
      });

      // Close nav if window resized beyond breakpoint
      window.addEventListener('resize', function() {
        if (window.innerWidth > 768 && nav.classList.contains('mobile-open')) {
          closeNav();
        }
      });
    })();

    /* ===== Konami Code Mega Easter Egg ===== */
    (function() {
      var KONAMI = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
      var konamiPos = 0;
      var konamiFired = false;

      document.addEventListener('keydown', function(e) {
        if (konamiFired) return;
        if (e.key === KONAMI[konamiPos]) {
          konamiPos++;
          if (konamiPos === KONAMI.length) {
            konamiPos = 0;
            konamiFired = true;
            triggerKonami();
          }
        } else {
          konamiPos = (e.key === KONAMI[0]) ? 1 : 0;
        }
      });

      function playKonamiSound() {
        try {
          var AC = window.AudioContext || window.webkitAudioContext;
          if (!AC) return;
          var ctx = new AC();
          var master = ctx.createGain();
          master.gain.setValueAtTime(0.25, ctx.currentTime);
          master.connect(ctx.destination);

          var notes = [523.25, 659.25, 783.99, 1046.50, 1318.51];
          var now = ctx.currentTime;
          for (var i = 0; i < notes.length; i++) {
            (function(freq, startTime) {
              var osc = ctx.createOscillator();
              var gain = ctx.createGain();
              osc.type = 'sine';
              osc.frequency.setValueAtTime(freq, startTime);
              gain.gain.setValueAtTime(0, startTime);
              gain.gain.linearRampToValueAtTime(0.4, startTime + 0.05);
              gain.gain.exponentialRampToValueAtTime(0.001, startTime + 1.2);
              osc.connect(gain);
              gain.connect(master);
              osc.start(startTime);
              osc.stop(startTime + 1.3);

              var osc2 = ctx.createOscillator();
              var gain2 = ctx.createGain();
              osc2.type = 'triangle';
              osc2.frequency.setValueAtTime(freq * 2, startTime);
              gain2.gain.setValueAtTime(0, startTime);
              gain2.gain.linearRampToValueAtTime(0.12, startTime + 0.04);
              gain2.gain.exponentialRampToValueAtTime(0.001, startTime + 0.8);
              osc2.connect(gain2);
              gain2.connect(master);
              osc2.start(startTime);
              osc2.stop(startTime + 0.9);
            })(notes[i], now + i * 0.12);
          }

          var noiseLen = 0.3;
          var noiseBuf = ctx.createBuffer(1, ctx.sampleRate * noiseLen, ctx.sampleRate);
          var noiseData = noiseBuf.getChannelData(0);
          for (var j = 0; j < noiseData.length; j++) {
            noiseData[j] = (Math.random() * 2 - 1) * 0.3;
          }
          var noiseSrc = ctx.createBufferSource();
          noiseSrc.buffer = noiseBuf;
          var noiseGain = ctx.createGain();
          noiseGain.gain.setValueAtTime(0.15, now);
          noiseGain.gain.exponentialRampToValueAtTime(0.001, now + noiseLen);
          var noiseFilter = ctx.createBiquadFilter();
          noiseFilter.type = 'highpass';
          noiseFilter.frequency.value = 6000;
          noiseSrc.connect(noiseFilter);
          noiseFilter.connect(noiseGain);
          noiseGain.connect(master);
          noiseSrc.start(now);
          noiseSrc.stop(now + noiseLen);

          setTimeout(function() { ctx.close(); }, 3000);
        } catch (err) { /* audio not supported */ }
      }

      function triggerKonami() {
        playKonamiSound();

        document.body.classList.add('konami-shaking');
        setTimeout(function() { document.body.classList.remove('konami-shaking'); }, 600);

        var overlay = document.createElement('div');
        overlay.className = 'konami-overlay';

        var canvas = document.createElement('canvas');
        overlay.appendChild(canvas);

        var title = document.createElement('div');
        title.className = 'konami-title';
        title.textContent = 'YOU CRACKED THE CODE';
        overlay.appendChild(title);

        var subtitle = document.createElement('div');
        subtitle.className = 'konami-subtitle';
        subtitle.textContent = 'The Konami Code lives forever';
        overlay.appendChild(subtitle);

        var hint = document.createElement('div');
        hint.className = 'konami-dismiss-hint';
        hint.textContent = 'click anywhere to dismiss';
        overlay.appendChild(hint);

        document.body.appendChild(overlay);

        requestAnimationFrame(function() {
          canvas.width = overlay.offsetWidth;
          canvas.height = overlay.offsetHeight;
          requestAnimationFrame(function() {
            overlay.classList.add('visible');
          });
        });

        var ctx2d = canvas.getContext('2d');
        var PARTICLE_COUNT = 350;
        var particles = [];
        var colors = [
          '#ff00ff', '#00ffff', '#ffff00', '#ff4444', '#44ff44',
          '#ff8800', '#8844ff', '#ff0088', '#00ff88', '#ffffff',
          '#ff66aa', '#66aaff', '#aaff66', '#ffaa00', '#aa00ff'
        ];
        var shapes = ['rect', 'circle', 'strip'];

        for (var p = 0; p < PARTICLE_COUNT; p++) {
          var angle = Math.random() * Math.PI * 2;
          var speed = 4 + Math.random() * 12;
          particles.push({
            x: canvas.width / 2 + (Math.random() - 0.5) * 200,
            y: canvas.height / 2 + (Math.random() - 0.5) * 100,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed - 6 - Math.random() * 4,
            w: 4 + Math.random() * 8,
            h: 6 + Math.random() * 12,
            color: colors[Math.floor(Math.random() * colors.length)],
            shape: shapes[Math.floor(Math.random() * shapes.length)],
            rotation: Math.random() * Math.PI * 2,
            rotSpeed: (Math.random() - 0.5) * 0.3,
            gravity: 0.12 + Math.random() * 0.08,
            drag: 0.98 + Math.random() * 0.015,
            opacity: 1,
            fade: 0.001 + Math.random() * 0.002
          });
        }

        var animId;
        var startTime = Date.now();
        function animateConfetti() {
          ctx2d.clearRect(0, 0, canvas.width, canvas.height);
          var alive = false;
          for (var i = 0; i < particles.length; i++) {
            var pt = particles[i];
            if (pt.opacity <= 0) continue;
            alive = true;
            pt.vy += pt.gravity;
            pt.vx *= pt.drag;
            pt.vy *= pt.drag;
            pt.x += pt.vx;
            pt.y += pt.vy;
            pt.rotation += pt.rotSpeed;
            pt.opacity -= pt.fade;
            if (pt.opacity < 0) pt.opacity = 0;

            ctx2d.save();
            ctx2d.translate(pt.x, pt.y);
            ctx2d.rotate(pt.rotation);
            ctx2d.globalAlpha = pt.opacity;
            ctx2d.fillStyle = pt.color;

            if (pt.shape === 'rect') {
              ctx2d.fillRect(-pt.w / 2, -pt.h / 2, pt.w, pt.h);
            } else if (pt.shape === 'circle') {
              ctx2d.beginPath();
              ctx2d.arc(0, 0, pt.w / 2, 0, Math.PI * 2);
              ctx2d.fill();
            } else {
              ctx2d.fillRect(-pt.w / 2, -1, pt.w, 2.5);
            }
            ctx2d.restore();
          }

          var elapsed = Date.now() - startTime;
          if (elapsed < 2000 && Math.random() < 0.4) {
            for (var s = 0; s < 3; s++) {
              var sa = Math.random() * Math.PI * 2;
              var ss = 2 + Math.random() * 8;
              particles.push({
                x: Math.random() * canvas.width,
                y: -10,
                vx: Math.cos(sa) * ss,
                vy: 2 + Math.random() * 4,
                w: 3 + Math.random() * 6,
                h: 5 + Math.random() * 10,
                color: colors[Math.floor(Math.random() * colors.length)],
                shape: shapes[Math.floor(Math.random() * shapes.length)],
                rotation: Math.random() * Math.PI * 2,
                rotSpeed: (Math.random() - 0.5) * 0.3,
                gravity: 0.12 + Math.random() * 0.06,
                drag: 0.985,
                opacity: 1,
                fade: 0.002 + Math.random() * 0.003
              });
            }
          }

          if (alive || elapsed < 2500) {
            animId = requestAnimationFrame(animateConfetti);
          }
        }
        animId = requestAnimationFrame(animateConfetti);

        function dismissKonami() {
          overlay.classList.remove('visible');
          setTimeout(function() {
            cancelAnimationFrame(animId);
            if (overlay.parentNode) overlay.parentNode.removeChild(overlay);
            konamiFired = false;
          }, 600);
        }

        overlay.addEventListener('click', dismissKonami);
        var autoTimer = setTimeout(dismissKonami, 10000);
        overlay.addEventListener('click', function() { clearTimeout(autoTimer); });
      }
    })();



    // 

    // 


    // 

    // 

    // 
    // BARREL ROLL EASTER EGG
    // 
    (function() {
      var buf = '';
      var target = 'do a barrel roll';
      document.addEventListener('keypress', function(e) {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
        buf += e.key.toLowerCase();
        if (buf.length > target.length) buf = buf.slice(-target.length);
        if (buf === target) {
          buf = '';
          document.body.classList.add('barrel-rolling');
          setTimeout(function() { document.body.classList.remove('barrel-rolling'); }, 1000);
        }
      });
    })();

    // 

    // 

    // 

    // 

    // 

    // 
    // VHS DISTORTION EFFECT (hidden - type "vhs")
    // 
    (function() {
      var active = false;
      var vhsBuf = '';
      var vhsTimerInt;

      function updateVhsTimestamp() {
        var el = document.getElementById('vhs-timestamp');
        if (!el) return;
        var now = new Date();
        var h = now.getHours(), m = now.getMinutes(), s = now.getSeconds();
        var pad = function(n) { return n < 10 ? '0' + n : '' + n; };
        el.textContent = 'PLAY \u25B6 ' + pad(h) + ':' + pad(m) + ':' + pad(s);
      }

      function toggleVhs() {
        active = !active;
        var overlay = document.getElementById('vhs-overlay');
        var timestamp = document.getElementById('vhs-timestamp');
        if (overlay) overlay.classList.toggle('active', active);
        if (timestamp) timestamp.classList.toggle('active', active);
        if (active) {
          updateVhsTimestamp();
          vhsTimerInt = setInterval(updateVhsTimestamp, 1000);
        } else {
          if (vhsTimerInt) clearInterval(vhsTimerInt);
        }
      }

      document.addEventListener('keypress', function(e) {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
        vhsBuf += e.key.toLowerCase();
        if (vhsBuf.length > 3) vhsBuf = vhsBuf.slice(-3);
        if (vhsBuf === 'vhs') {
          vhsBuf = '';
          toggleVhs();
        }
      });
    })();

    // 

    // 

    // 

    // 

    // 

    // 
    // LAVA LAMP
    // 
    (function() {
      window.setLavaColor = function(color, btn) {
        var blobs = document.querySelectorAll('.lava-blob');
        blobs.forEach(function(b) { b.style.background = color; });
        document.querySelectorAll('.lava-color-btn').forEach(function(b) { b.classList.remove('active'); });
        if (btn) btn.classList.add('active');
      };
    })();

    // 
    // JSON FORMATTER & VALIDATOR
    // 
    (function() {
      function syntaxHighlight(json) {
        json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function(match) {
          var cls = 'json-number';
          if (/^"/.test(match)) {
            if (/:$/.test(match)) { cls = 'json-key'; }
            else { cls = 'json-string'; }
          } else if (/true|false/.test(match)) { cls = 'json-bool'; }
          else if (/null/.test(match)) { cls = 'json-null'; }
          return '<span class="' + cls + '">' + match + '</span>';
        });
      }

      window.formatJSON = function() {
        var inp = document.getElementById('json-input');
        var out = document.getElementById('json-output');
        var status = document.getElementById('json-status');
        if (!inp || !out) return;
        var raw = inp.value.trim();
        if (!raw) { out.innerHTML = 'Paste JSON above to format'; status.innerHTML = ''; return; }
        try {
          var parsed = JSON.parse(raw);
          var formatted = JSON.stringify(parsed, null, 2);
          out.innerHTML = syntaxHighlight(formatted);
          status.innerHTML = '<span class="json-valid">&#10003; Valid JSON</span>';
        } catch (e) {
          out.textContent = raw;
          status.innerHTML = '<span class="json-invalid">&#10007; ' + e.message + '</span>';
        }
      };
    })();

    // 

    // 

    // 
    // WORLD CLOCK
    // 
    (function() {
      var zones = [
        { city: 'New York', tz: 'America/New_York' },
        { city: 'London', tz: 'Europe/London' },
        { city: 'Tokyo', tz: 'Asia/Tokyo' },
        { city: 'Sydney', tz: 'Australia/Sydney' },
        { city: 'Dubai', tz: 'Asia/Dubai' },
        { city: 'LA', tz: 'America/Los_Angeles' }
      ];

      function update() {
        var el = document.getElementById('worldclock-list');
        if (!el) return;
        el.innerHTML = '';
        zones.forEach(function(z) {
          var now = new Date();
          var opts = { timeZone: z.tz, hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
          var time = now.toLocaleTimeString('en-US', opts);
          var hr = parseInt(now.toLocaleTimeString('en-US', { timeZone: z.tz, hour: '2-digit', hour12: false }));
          var icon = (hr >= 6 && hr < 18) ? '' : '';
          var row = document.createElement('div');
          row.className = 'worldclock-row';
          row.innerHTML = '<span class="worldclock-city">' + z.city + '</span><span><span class="worldclock-time">' + time + '</span><span class="worldclock-daynight">' + icon + '</span></span>';
          el.appendChild(row);
        });
      }

      setTimeout(function() { update(); setInterval(update, 1000); }, 200);
    })();

    // 
    // BASE64 ENCODER/DECODER
    // 
    (function() {
      window.b64Encode = function() {
        var inp = document.getElementById('b64-input');
        var out = document.getElementById('b64-output');
        if (!inp || !out) return;
        try { out.value = btoa(unescape(encodeURIComponent(inp.value))); } catch(e) { out.value = 'Error: ' + e.message; }
      };
      window.b64Decode = function() {
        var inp = document.getElementById('b64-input');
        var out = document.getElementById('b64-output');
        if (!inp || !out) return;
        try { out.value = decodeURIComponent(escape(atob(inp.value))); } catch(e) { out.value = 'Error: Invalid Base64'; }
      };
      window.b64Copy = function() {
        var out = document.getElementById('b64-output');
        if (out && out.value) { navigator.clipboard.writeText(out.value); }
      };
      window.b64Auto = function() {
        var inp = document.getElementById('b64-input');
        var out = document.getElementById('b64-output');
        if (!inp || !out || !inp.value) { out.value = ''; return; }
        // Auto-detect: try decode first
        try {
          var decoded = decodeURIComponent(escape(atob(inp.value)));
          if (decoded && decoded !== inp.value) { out.value = decoded; return; }
        } catch(e) {}
        // Encode
        try { out.value = btoa(unescape(encodeURIComponent(inp.value))); } catch(e) { out.value = ''; }
      };
    })();

    // 
    // COUNTDOWN TIMER
    // 
    (function() {
      var remaining = 0, running = false, timerInt;

      function pad(n) { return n < 10 ? '0' + n : '' + n; }

      function updateDisplay() {
        var el = document.getElementById('countdown-display');
        if (!el) return;
        var m = Math.floor(remaining / 60);
        var s = remaining % 60;
        el.textContent = pad(m) + ':' + pad(s);
        if (remaining <= 0 && running) {
          el.style.color = '#f43f5e';
        } else {
          el.style.color = '';
        }
      }

      function tickDown() {
        if (remaining > 0) {
          remaining--;
          updateDisplay();
        } else {
          clearInterval(timerInt);
          running = false;
          var btn = document.getElementById('countdown-start');
          if (btn) btn.textContent = 'Start';
          // Alert
          try {
            var ctx = new (window.AudioContext || window.webkitAudioContext)();
            for (var i = 0; i < 3; i++) {
              var osc = ctx.createOscillator();
              var gain = ctx.createGain();
              osc.frequency.value = 880;
              osc.connect(gain); gain.connect(ctx.destination);
              gain.gain.setValueAtTime(0.2, ctx.currentTime + i * 0.3);
              osc.start(ctx.currentTime + i * 0.3);
              osc.stop(ctx.currentTime + i * 0.3 + 0.15);
            }
          } catch(e) {}
        }
      }

      window.countdownToggle = function() {
        var btn = document.getElementById('countdown-start');
        if (running) {
          clearInterval(timerInt);
          running = false;
          if (btn) btn.textContent = 'Start';
        } else {
          if (remaining <= 0) {
            var m = parseInt(document.getElementById('countdown-min').value) || 0;
            var s = parseInt(document.getElementById('countdown-sec').value) || 0;
            remaining = m * 60 + s;
          }
          if (remaining <= 0) return;
          running = true;
          if (btn) btn.textContent = 'Pause';
          updateDisplay();
          timerInt = setInterval(tickDown, 1000);
        }
      };

      window.countdownReset = function() {
        clearInterval(timerInt);
        running = false;
        remaining = 0;
        updateDisplay();
        var btn = document.getElementById('countdown-start');
        if (btn) btn.textContent = 'Start';
      };

      window.countdownSet = function(m, s) {
        clearInterval(timerInt);
        running = false;
        remaining = m * 60 + s;
        document.getElementById('countdown-min').value = m;
        document.getElementById('countdown-sec').value = s;
        updateDisplay();
        var btn = document.getElementById('countdown-start');
        if (btn) btn.textContent = 'Start';
      };

      setTimeout(updateDisplay, 200);
    })();

    // 
    // REGEX TESTER
    // 
    (function() {
      window.testRegex = function() {
        var pat = document.getElementById('regex-pattern');
        var flags = document.getElementById('regex-flags');
        var test = document.getElementById('regex-test');
        var result = document.getElementById('regex-result');
        var status = document.getElementById('regex-status');
        if (!pat || !test || !result) return;
        if (!pat.value) { result.innerHTML = 'Enter a pattern above'; status.innerHTML = ''; return; }
        try {
          var re = new RegExp(pat.value, flags.value || '');
          var str = test.value;
          if (!str) { result.innerHTML = 'Enter test text'; status.innerHTML = ''; return; }
          var matches = [];
          var match;
          if (flags.value.indexOf('g') !== -1) {
            while ((match = re.exec(str)) !== null) {
              matches.push({ start: match.index, end: match.index + match[0].length, text: match[0] });
              if (!match[0].length) re.lastIndex++;
            }
          } else {
            match = re.exec(str);
            if (match) matches.push({ start: match.index, end: match.index + match[0].length, text: match[0] });
          }
          if (matches.length === 0) {
            result.innerHTML = str.replace(/</g,'&lt;');
            status.innerHTML = '<span class="json-invalid">No matches</span>';
          } else {
            var html = '', last = 0;
            for (var i = 0; i < matches.length; i++) {
              html += str.slice(last, matches[i].start).replace(/</g,'&lt;');
              html += '<span class="regex-match">' + str.slice(matches[i].start, matches[i].end).replace(/</g,'&lt;') + '</span>';
              last = matches[i].end;
            }
            html += str.slice(last).replace(/</g,'&lt;');
            result.innerHTML = html;
            status.innerHTML = '<span class="json-valid">' + matches.length + ' match' + (matches.length > 1 ? 'es' : '') + '</span>';
          }
        } catch(e) {
          result.innerHTML = test.value.replace(/</g,'&lt;');
          status.innerHTML = '<span class="json-invalid">' + e.message + '</span>';
        }
      };
    })();

    // 
    // HOLOGRAPHIC CARD EFFECT
    // 
    (function() {
      window.holoMove = function(e) {
        var card = document.getElementById('holo-demo');
        if (!card) return;
        var rect = card.getBoundingClientRect();
        var x = (e.clientX - rect.left) / rect.width - 0.5;
        var y = (e.clientY - rect.top) / rect.height - 0.5;
        card.style.transform = 'rotateY(' + (x * 20) + 'deg) rotateX(' + (-y * 20) + 'deg) scale(1.05)';
        var angle = Math.atan2(y, x) * (180 / Math.PI) + 180;
        card.style.background = 'linear-gradient(' + angle + 'deg, #1e1b4b, #6366f1, #a855f7, #ec4899, #f97316, #fbbf24, #34d399, #312e81)';
      };
      window.holoReset = function() {
        var card = document.getElementById('holo-demo');
        if (!card) {return;}
        card.style.transform = '';
        card.style.background = '';
      };
    })();

    // 
    // AURORA BOREALIS
    // 
    (function() {
      var active = false;
      window.toggleAurora = function() {
        active = !active;
        var overlay = document.getElementById('aurora-overlay');
        var btn = document.getElementById('aurora-toggle');
        if (overlay) overlay.classList.toggle('active', active);
        if (btn) btn.textContent = active ? 'Disable' : 'Enable';
      };
    })();

    // 
    // GRADIENT CSS GENERATOR
    // 
    (function() {
      window.updateGradient = function() {
        var c1 = document.getElementById('grad-c1').value;
        var c2 = document.getElementById('grad-c2').value;
        var angle = document.getElementById('grad-angle').value;
        var css = 'linear-gradient(' + angle + 'deg, ' + c1 + ', ' + c2 + ')';
        var preview = document.getElementById('gradient-preview');
        var output = document.getElementById('gradient-css');
        if (preview) preview.style.background = css;
        if (output) output.textContent = 'background: ' + css + ';';
      };
      window.copyGradientCSS = function() {
        var output = document.getElementById('gradient-css');
        if (output) {
          navigator.clipboard.writeText(output.textContent);
          output.style.color = '#fbbf24';
          setTimeout(function() { output.style.color = ''; }, 800);
        }
      };
    })();

    // 
    // SIMON SAYS
    // 
    (function() {
      var colors = ['green','red','yellow','blue'];
      var sounds = {};
      var sequence = [];
      var playerIdx = 0;
      var playing = false;
      var boardEl = null;
      var scoreEl = null;
      var audioCtx;

      function getAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        return audioCtx;
      }

      function playTone(freq, dur) {
        try {
          var ctx = getAudio();
          var osc = ctx.createOscillator();
          var gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = freq;
          osc.type = 'sine';
          gain.gain.value = 0.15;
          osc.start();
          osc.stop(ctx.currentTime + dur / 1000);
        } catch(e) {}
      }

      var freqs = { green: 392, red: 330, yellow: 262, blue: 196 };

      function lightUp(color, dur) {
        var btn = boardEl.querySelector('.simon-btn.' + color);
        if (!btn) return;
        btn.classList.add('lit');
        playTone(freqs[color], dur);
        setTimeout(function() { btn.classList.remove('lit'); }, dur);
      }

      function playSequence() {
        playing = true;
        playerIdx = 0;
        var i = 0;
        var iv = setInterval(function() {
          if (i >= sequence.length) { clearInterval(iv); playing = false; return; }
          lightUp(sequence[i], 400);
          i++;
        }, 600);
      }

      function addRound() {
        sequence.push(colors[Math.floor(Math.random() * 4)]);
        if (scoreEl) scoreEl.textContent = 'Score: ' + (sequence.length - 1);
        playSequence();
      }

      function handleClick(color) {
        if (playing) return;
        lightUp(color, 200);
        if (color === sequence[playerIdx]) {
          playerIdx++;
          if (playerIdx === sequence.length) {
            setTimeout(addRound, 800);
          }
        } else {
          playTone(110, 500);
          if (scoreEl) scoreEl.textContent = 'Game Over! Score: ' + (sequence.length - 1);
          sequence = [];
        }
      }

      window.startSimon = function() {
        // Build board dynamically in the card
        var card = document.querySelector('.tool-card .tool-title');
        // Find Simon card
        var cards = document.querySelectorAll('.tool-card');
        var simonCard = null;
        cards.forEach(function(c) { if (c.querySelector('.tool-title') && c.querySelector('.tool-title').textContent === 'Simon Says') simonCard = c; });
        if (!simonCard) return;

        if (!boardEl) {
          simonCard.onclick = null;
          var board = document.createElement('div');
          board.className = 'simon-board';
          colors.forEach(function(c) {
            var btn = document.createElement('button');
            btn.className = 'simon-btn ' + c;
            btn.onclick = function() { handleClick(c); };
            board.appendChild(btn);
          });
          var score = document.createElement('div');
          score.className = 'simon-score';
          score.textContent = 'Score: 0';
          simonCard.appendChild(board);
          simonCard.appendChild(score);
          boardEl = board;
          scoreEl = score;
        }
        sequence = [];
        addRound();
      };
    })();

    // 
    // PASSWORD STRENGTH TESTER
    // 
    (function() {
      window.checkPwStrength = function(pw) {
        var fill = document.getElementById('pw-strength-fill');
        var label = document.getElementById('pw-strength-label');
        var checks = document.getElementById('pw-strength-checks');
        if (!fill || !label) return;

        if (!pw) { fill.style.width = '0'; label.textContent = ''; checks.textContent = ''; return; }

        var score = 0;
        var details = [];
        if (pw.length >= 8) { score++; details.push(' 8+ chars'); } else { details.push(' 8+ chars'); }
        if (pw.length >= 12) { score++; details.push(' 12+ chars'); } else { details.push(' 12+ chars'); }
        if (/[a-z]/.test(pw)) { score++; details.push(' lowercase'); } else { details.push(' lowercase'); }
        if (/[A-Z]/.test(pw)) { score++; details.push(' uppercase'); } else { details.push(' uppercase'); }
        if (/[0-9]/.test(pw)) { score++; details.push(' numbers'); } else { details.push(' numbers'); }
        if (/[^a-zA-Z0-9]/.test(pw)) { score++; details.push(' symbols'); } else { details.push(' symbols'); }

        var pct = Math.round((score / 6) * 100);
        var color, text;
        if (score <= 2) { color = '#ef4444'; text = 'Weak'; }
        else if (score <= 3) { color = '#f97316'; text = 'Fair'; }
        else if (score <= 4) { color = '#eab308'; text = 'Good'; }
        else if (score <= 5) { color = '#22c55e'; text = 'Strong'; }
        else { color = '#8b7cf6'; text = 'Excellent'; }

        fill.style.width = pct + '%';
        fill.style.background = color;
        label.textContent = text;
        label.style.color = color;
        checks.innerHTML = details.join('<br>');
      };
    })();

    // 
    // LOREM IPSUM GENERATOR
    // 
    (function() {
      var words = 'lorem ipsum dolor sit amet consectetur adipiscing elit sed do eiusmod tempor incididunt ut labore et dolore magna aliqua enim ad minim veniam quis nostrud exercitation ullamco laboris nisi aliquip ex ea commodo consequat duis aute irure in reprehenderit voluptate velit esse cillum fugiat nulla pariatur excepteur sint occaecat cupidatat non proident sunt culpa qui officia deserunt mollit anim id est'.split(' ');

      function randWord() { return words[Math.floor(Math.random() * words.length)]; }

      function genSentence() {
        var len = 8 + Math.floor(Math.random() * 12);
        var s = [];
        for (var i = 0; i < len; i++) s.push(randWord());
        s[0] = s[0][0].toUpperCase() + s[0].slice(1);
        return s.join(' ') + '.';
      }

      function genParagraph() {
        var count = 3 + Math.floor(Math.random() * 4);
        var p = [];
        for (var i = 0; i < count; i++) p.push(genSentence());
        return p.join(' ');
      }

      window.generateLorem = function() {
        var count = parseInt(document.getElementById('lorem-count').value) || 3;
        var type = document.getElementById('lorem-type').value;
        var output = document.getElementById('lorem-output');
        if (!output) return;
        var result = '';
        if (type === 'paragraphs') {
          var ps = [];
          for (var i = 0; i < count; i++) ps.push(genParagraph());
          result = ps.join('\n\n');
        } else if (type === 'sentences') {
          var ss = [];
          for (var i = 0; i < count; i++) ss.push(genSentence());
          result = ss.join(' ');
        } else {
          var ws = [];
          for (var i = 0; i < count; i++) ws.push(randWord());
          result = ws.join(' ');
        }
        output.textContent = result;
      };

      window.copyLorem = function() {
        var output = document.getElementById('lorem-output');
        if (output && output.textContent !== 'Click Go to generate...') {
          navigator.clipboard.writeText(output.textContent);
          if (typeof toast === 'function') toast('Copied!');
        }
      };
    })();

    // 

    // ===== BOOT: check if we should show dashboard =====
    (function boot() {
      // If early auth already logged in, show dashboard now
      if (window.__pendingLogin && authToken) {
        showDashboard();
        return;
      }
      // If we have a stored token, validate and show dashboard
      if (authToken) {
        fetch('/api/status', { headers: { 'Authorization': 'Bearer ' + authToken } })
          .then(function(r) {
            if (r.ok) {
              showDashboard();
            } else {
              sessionStorage.removeItem('monitor_token');
              authToken = null;
              document.getElementById('auth-gate').style.display = '';
            }
          })
          .catch(function() {
            sessionStorage.removeItem('monitor_token');
            authToken = null;
            document.getElementById('auth-gate').style.display = '';
          });
      }
    })();

  </script>
</body>
</html>
